const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/raw-in9isEBO.js","assets/basedecoder-B2c5_Eok.js","assets/lzw-_aCqfs4w.js","assets/jpeg-CKYXsxFN.js","assets/deflate-B9JhHpvg.js","assets/pako.esm-Cram60i4.js","assets/packbits-DDWKfGV_.js","assets/lerc-oLJ7S0dO.js","assets/webimage-DBgUwIbt.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();/**
* @vue/shared v3.5.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function zg(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const st={},go=[],Fi=()=>{},tw=()=>!1,Nh=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),Hg=t=>t.startsWith("onUpdate:"),bn=Object.assign,Xg=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},a1=Object.prototype.hasOwnProperty,et=(t,e)=>a1.call(t,e),ve=Array.isArray,po=t=>Bh(t)==="[object Map]",nw=t=>Bh(t)==="[object Set]",Oe=t=>typeof t=="function",Mt=t=>typeof t=="string",Ks=t=>typeof t=="symbol",_t=t=>t!==null&&typeof t=="object",iw=t=>(_t(t)||Oe(t))&&Oe(t.then)&&Oe(t.catch),sw=Object.prototype.toString,Bh=t=>sw.call(t),l1=t=>Bh(t).slice(8,-1),rw=t=>Bh(t)==="[object Object]",Vg=t=>Mt(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Oa=zg(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Uh=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},c1=/-(\w)/g,ks=Uh(t=>t.replace(c1,(e,n)=>n?n.toUpperCase():"")),h1=/\B([A-Z])/g,Ys=Uh(t=>t.replace(h1,"-$1").toLowerCase()),ow=Uh(t=>t.charAt(0).toUpperCase()+t.slice(1)),Bu=Uh(t=>t?`on${ow(t)}`:""),Is=(t,e)=>!Object.is(t,e),kc=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},aw=(t,e,n,i=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:i,value:n})},Df=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let I_;const Gh=()=>I_||(I_=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Wg(t){if(ve(t)){const e={};for(let n=0;n<t.length;n++){const i=t[n],s=Mt(i)?g1(i):Wg(i);if(s)for(const r in s)e[r]=s[r]}return e}else if(Mt(t)||_t(t))return t}const u1=/;(?![^(]*\))/g,d1=/:([^]+)/,f1=/\/\*[^]*?\*\//g;function g1(t){const e={};return t.replace(f1,"").split(u1).forEach(n=>{if(n){const i=n.split(d1);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function $h(t){let e="";if(Mt(t))e=t;else if(ve(t))for(let n=0;n<t.length;n++){const i=$h(t[n]);i&&(e+=i+" ")}else if(_t(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const p1="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",m1=zg(p1);function lw(t){return!!t||t===""}const cw=t=>!!(t&&t.__v_isRef===!0),Un=t=>Mt(t)?t:t==null?"":ve(t)||_t(t)&&(t.toString===sw||!Oe(t.toString))?cw(t)?Un(t.value):JSON.stringify(t,hw,2):String(t),hw=(t,e)=>cw(e)?hw(t,e.value):po(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[i,s],r)=>(n[Uu(i,r)+" =>"]=s,n),{})}:nw(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>Uu(n))}:Ks(e)?Uu(e):_t(e)&&!ve(e)&&!rw(e)?String(e):e,Uu=(t,e="")=>{var n;return Ks(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};/**
* @vue/reactivity v3.5.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Mn;class _1{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Mn,!e&&Mn&&(this.index=(Mn.scopes||(Mn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=Mn;try{return Mn=this,e()}finally{Mn=n}}}on(){++this._on===1&&(this.prevScope=Mn,Mn=this)}off(){this._on>0&&--this._on===0&&(Mn=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(this.effects.length=0,n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function y1(){return Mn}let ut;const Gu=new WeakSet;class uw{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Mn&&Mn.active&&Mn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Gu.has(this)&&(Gu.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||fw(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,P_(this),gw(this);const e=ut,n=gi;ut=this,gi=!0;try{return this.fn()}finally{pw(this),ut=e,gi=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)qg(e);this.deps=this.depsTail=void 0,P_(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Gu.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Of(this)&&this.run()}get dirty(){return Of(this)}}let dw=0,La,ka;function fw(t,e=!1){if(t.flags|=8,e){t.next=ka,ka=t;return}t.next=La,La=t}function Kg(){dw++}function Yg(){if(--dw>0)return;if(ka){let e=ka;for(ka=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;La;){let e=La;for(La=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(i){t||(t=i)}e=n}}if(t)throw t}function gw(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function pw(t){let e,n=t.depsTail,i=n;for(;i;){const s=i.prevDep;i.version===-1?(i===n&&(n=s),qg(i),E1(i)):e=i,i.dep.activeLink=i.prevActiveLink,i.prevActiveLink=void 0,i=s}t.deps=e,t.depsTail=n}function Of(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(mw(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function mw(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===nl)||(t.globalVersion=nl,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!Of(t))))return;t.flags|=2;const e=t.dep,n=ut,i=gi;ut=t,gi=!0;try{gw(t);const s=t.fn(t._value);(e.version===0||Is(s,t._value))&&(t.flags|=128,t._value=s,e.version++)}catch(s){throw e.version++,s}finally{ut=n,gi=i,pw(t),t.flags&=-3}}function qg(t,e=!1){const{dep:n,prevSub:i,nextSub:s}=t;if(i&&(i.nextSub=s,t.prevSub=void 0),s&&(s.prevSub=i,t.nextSub=void 0),n.subs===t&&(n.subs=i,!i&&n.computed)){n.computed.flags&=-5;for(let r=n.computed.deps;r;r=r.nextDep)qg(r,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function E1(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let gi=!0;const _w=[];function rs(){_w.push(gi),gi=!1}function os(){const t=_w.pop();gi=t===void 0?!0:t}function P_(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=ut;ut=void 0;try{e()}finally{ut=n}}}let nl=0;class x1{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Zg{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!ut||!gi||ut===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==ut)n=this.activeLink=new x1(ut,this),ut.deps?(n.prevDep=ut.depsTail,ut.depsTail.nextDep=n,ut.depsTail=n):ut.deps=ut.depsTail=n,yw(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const i=n.nextDep;i.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=i),n.prevDep=ut.depsTail,n.nextDep=void 0,ut.depsTail.nextDep=n,ut.depsTail=n,ut.deps===n&&(ut.deps=i)}return n}trigger(e){this.version++,nl++,this.notify(e)}notify(e){Kg();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{Yg()}}}function yw(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let i=e.deps;i;i=i.nextDep)yw(i)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const Lf=new WeakMap,xr=Symbol(""),kf=Symbol(""),il=Symbol("");function rn(t,e,n){if(gi&&ut){let i=Lf.get(t);i||Lf.set(t,i=new Map);let s=i.get(n);s||(i.set(n,s=new Zg),s.map=i,s.key=n),s.track()}}function Ji(t,e,n,i,s,r){const o=Lf.get(t);if(!o){nl++;return}const a=l=>{l&&l.trigger()};if(Kg(),e==="clear")o.forEach(a);else{const l=ve(t),c=l&&Vg(n);if(l&&n==="length"){const h=Number(i);o.forEach((u,d)=>{(d==="length"||d===il||!Ks(d)&&d>=h)&&a(u)})}else switch((n!==void 0||o.has(void 0))&&a(o.get(n)),c&&a(o.get(il)),e){case"add":l?c&&a(o.get("length")):(a(o.get(xr)),po(t)&&a(o.get(kf)));break;case"delete":l||(a(o.get(xr)),po(t)&&a(o.get(kf)));break;case"set":po(t)&&a(o.get(xr));break}}Yg()}function Nr(t){const e=Qe(t);return e===t?e:(rn(e,"iterate",il),ri(t)?e:e.map(Kt))}function jh(t){return rn(t=Qe(t),"iterate",il),t}const w1={__proto__:null,[Symbol.iterator](){return $u(this,Symbol.iterator,Kt)},concat(...t){return Nr(this).concat(...t.map(e=>ve(e)?Nr(e):e))},entries(){return $u(this,"entries",t=>(t[1]=Kt(t[1]),t))},every(t,e){return Vi(this,"every",t,e,void 0,arguments)},filter(t,e){return Vi(this,"filter",t,e,n=>n.map(Kt),arguments)},find(t,e){return Vi(this,"find",t,e,Kt,arguments)},findIndex(t,e){return Vi(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Vi(this,"findLast",t,e,Kt,arguments)},findLastIndex(t,e){return Vi(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Vi(this,"forEach",t,e,void 0,arguments)},includes(...t){return ju(this,"includes",t)},indexOf(...t){return ju(this,"indexOf",t)},join(t){return Nr(this).join(t)},lastIndexOf(...t){return ju(this,"lastIndexOf",t)},map(t,e){return Vi(this,"map",t,e,void 0,arguments)},pop(){return da(this,"pop")},push(...t){return da(this,"push",t)},reduce(t,...e){return M_(this,"reduce",t,e)},reduceRight(t,...e){return M_(this,"reduceRight",t,e)},shift(){return da(this,"shift")},some(t,e){return Vi(this,"some",t,e,void 0,arguments)},splice(...t){return da(this,"splice",t)},toReversed(){return Nr(this).toReversed()},toSorted(t){return Nr(this).toSorted(t)},toSpliced(...t){return Nr(this).toSpliced(...t)},unshift(...t){return da(this,"unshift",t)},values(){return $u(this,"values",Kt)}};function $u(t,e,n){const i=jh(t),s=i[e]();return i!==t&&!ri(t)&&(s._next=s.next,s.next=()=>{const r=s._next();return r.value&&(r.value=n(r.value)),r}),s}const S1=Array.prototype;function Vi(t,e,n,i,s,r){const o=jh(t),a=o!==t&&!ri(t),l=o[e];if(l!==S1[e]){const u=l.apply(t,r);return a?Kt(u):u}let c=n;o!==t&&(a?c=function(u,d){return n.call(this,Kt(u),d,t)}:n.length>2&&(c=function(u,d){return n.call(this,u,d,t)}));const h=l.call(o,c,i);return a&&s?s(h):h}function M_(t,e,n,i){const s=jh(t);let r=n;return s!==t&&(ri(t)?n.length>3&&(r=function(o,a,l){return n.call(this,o,a,l,t)}):r=function(o,a,l){return n.call(this,o,Kt(a),l,t)}),s[e](r,...i)}function ju(t,e,n){const i=Qe(t);rn(i,"iterate",il);const s=i[e](...n);return(s===-1||s===!1)&&ep(n[0])?(n[0]=Qe(n[0]),i[e](...n)):s}function da(t,e,n=[]){rs(),Kg();const i=Qe(t)[e].apply(t,n);return Yg(),os(),i}const C1=zg("__proto__,__v_isRef,__isVue"),Ew=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Ks));function b1(t){Ks(t)||(t=String(t));const e=Qe(this);return rn(e,"has",t),e.hasOwnProperty(t)}class xw{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,i){if(n==="__v_skip")return e.__v_skip;const s=this._isReadonly,r=this._isShallow;if(n==="__v_isReactive")return!s;if(n==="__v_isReadonly")return s;if(n==="__v_isShallow")return r;if(n==="__v_raw")return i===(s?r?O1:bw:r?Cw:Sw).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(i)?e:void 0;const o=ve(e);if(!s){let l;if(o&&(l=w1[n]))return l;if(n==="hasOwnProperty")return b1}const a=Reflect.get(e,n,cn(e)?e:i);return(Ks(n)?Ew.has(n):C1(n))||(s||rn(e,"get",n),r)?a:cn(a)?o&&Vg(n)?a:a.value:_t(a)?s?Tw(a):Ao(a):a}}class ww extends xw{constructor(e=!1){super(!1,e)}set(e,n,i,s){let r=e[n];if(!this._isShallow){const l=Ns(r);if(!ri(i)&&!Ns(i)&&(r=Qe(r),i=Qe(i)),!ve(e)&&cn(r)&&!cn(i))return l||(r.value=i),!0}const o=ve(e)&&Vg(n)?Number(n)<e.length:et(e,n),a=Reflect.set(e,n,i,cn(e)?e:s);return e===Qe(s)&&(o?Is(i,r)&&Ji(e,"set",n,i):Ji(e,"add",n,i)),a}deleteProperty(e,n){const i=et(e,n);e[n];const s=Reflect.deleteProperty(e,n);return s&&i&&Ji(e,"delete",n,void 0),s}has(e,n){const i=Reflect.has(e,n);return(!Ks(n)||!Ew.has(n))&&rn(e,"has",n),i}ownKeys(e){return rn(e,"iterate",ve(e)?"length":xr),Reflect.ownKeys(e)}}class T1 extends xw{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const R1=new ww,v1=new T1,A1=new ww(!0);const Nf=t=>t,Zl=t=>Reflect.getPrototypeOf(t);function I1(t,e,n){return function(...i){const s=this.__v_raw,r=Qe(s),o=po(r),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,c=s[t](...i),h=n?Nf:e?eh:Kt;return!e&&rn(r,"iterate",l?kf:xr),{next(){const{value:u,done:d}=c.next();return d?{value:u,done:d}:{value:a?[h(u[0]),h(u[1])]:h(u),done:d}},[Symbol.iterator](){return this}}}}function Jl(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function P1(t,e){const n={get(s){const r=this.__v_raw,o=Qe(r),a=Qe(s);t||(Is(s,a)&&rn(o,"get",s),rn(o,"get",a));const{has:l}=Zl(o),c=e?Nf:t?eh:Kt;if(l.call(o,s))return c(r.get(s));if(l.call(o,a))return c(r.get(a));r!==o&&r.get(s)},get size(){const s=this.__v_raw;return!t&&rn(Qe(s),"iterate",xr),s.size},has(s){const r=this.__v_raw,o=Qe(r),a=Qe(s);return t||(Is(s,a)&&rn(o,"has",s),rn(o,"has",a)),s===a?r.has(s):r.has(s)||r.has(a)},forEach(s,r){const o=this,a=o.__v_raw,l=Qe(a),c=e?Nf:t?eh:Kt;return!t&&rn(l,"iterate",xr),a.forEach((h,u)=>s.call(r,c(h),c(u),o))}};return bn(n,t?{add:Jl("add"),set:Jl("set"),delete:Jl("delete"),clear:Jl("clear")}:{add(s){!e&&!ri(s)&&!Ns(s)&&(s=Qe(s));const r=Qe(this);return Zl(r).has.call(r,s)||(r.add(s),Ji(r,"add",s,s)),this},set(s,r){!e&&!ri(r)&&!Ns(r)&&(r=Qe(r));const o=Qe(this),{has:a,get:l}=Zl(o);let c=a.call(o,s);c||(s=Qe(s),c=a.call(o,s));const h=l.call(o,s);return o.set(s,r),c?Is(r,h)&&Ji(o,"set",s,r):Ji(o,"add",s,r),this},delete(s){const r=Qe(this),{has:o,get:a}=Zl(r);let l=o.call(r,s);l||(s=Qe(s),l=o.call(r,s)),a&&a.call(r,s);const c=r.delete(s);return l&&Ji(r,"delete",s,void 0),c},clear(){const s=Qe(this),r=s.size!==0,o=s.clear();return r&&Ji(s,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(s=>{n[s]=I1(s,t,e)}),n}function Jg(t,e){const n=P1(t,e);return(i,s,r)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?i:Reflect.get(et(n,s)&&s in i?n:i,s,r)}const M1={get:Jg(!1,!1)},F1={get:Jg(!1,!0)},D1={get:Jg(!0,!1)};const Sw=new WeakMap,Cw=new WeakMap,bw=new WeakMap,O1=new WeakMap;function L1(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function k1(t){return t.__v_skip||!Object.isExtensible(t)?0:L1(l1(t))}function Ao(t){return Ns(t)?t:Qg(t,!1,R1,M1,Sw)}function N1(t){return Qg(t,!1,A1,F1,Cw)}function Tw(t){return Qg(t,!0,v1,D1,bw)}function Qg(t,e,n,i,s){if(!_t(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const r=k1(t);if(r===0)return t;const o=s.get(t);if(o)return o;const a=new Proxy(t,r===2?i:n);return s.set(t,a),a}function mo(t){return Ns(t)?mo(t.__v_raw):!!(t&&t.__v_isReactive)}function Ns(t){return!!(t&&t.__v_isReadonly)}function ri(t){return!!(t&&t.__v_isShallow)}function ep(t){return t?!!t.__v_raw:!1}function Qe(t){const e=t&&t.__v_raw;return e?Qe(e):t}function B1(t){return!et(t,"__v_skip")&&Object.isExtensible(t)&&aw(t,"__v_skip",!0),t}const Kt=t=>_t(t)?Ao(t):t,eh=t=>_t(t)?Tw(t):t;function cn(t){return t?t.__v_isRef===!0:!1}function es(t){return U1(t,!1)}function U1(t,e){return cn(t)?t:new G1(t,e)}class G1{constructor(e,n){this.dep=new Zg,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:Qe(e),this._value=n?e:Kt(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,i=this.__v_isShallow||ri(e)||Ns(e);e=i?e:Qe(e),Is(e,n)&&(this._rawValue=e,this._value=i?e:Kt(e),this.dep.trigger())}}function $1(t){return cn(t)?t.value:t}const j1={get:(t,e,n)=>e==="__v_raw"?t:$1(Reflect.get(t,e,n)),set:(t,e,n,i)=>{const s=t[e];return cn(s)&&!cn(n)?(s.value=n,!0):Reflect.set(t,e,n,i)}};function Rw(t){return mo(t)?t:new Proxy(t,j1)}class z1{constructor(e,n,i){this.fn=e,this.setter=n,this._value=void 0,this.dep=new Zg(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=nl-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=i}notify(){if(this.flags|=16,!(this.flags&8)&&ut!==this)return fw(this,!0),!0}get value(){const e=this.dep.track();return mw(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function H1(t,e,n=!1){let i,s;return Oe(t)?i=t:(i=t.get,s=t.set),new z1(i,s,n)}const Ql={},th=new WeakMap;let rr;function X1(t,e=!1,n=rr){if(n){let i=th.get(n);i||th.set(n,i=[]),i.push(t)}}function V1(t,e,n=st){const{immediate:i,deep:s,once:r,scheduler:o,augmentJob:a,call:l}=n,c=E=>s?E:ri(E)||s===!1||s===0?Qi(E,1):Qi(E);let h,u,d,f,g=!1,m=!1;if(cn(t)?(u=()=>t.value,g=ri(t)):mo(t)?(u=()=>c(t),g=!0):ve(t)?(m=!0,g=t.some(E=>mo(E)||ri(E)),u=()=>t.map(E=>{if(cn(E))return E.value;if(mo(E))return c(E);if(Oe(E))return l?l(E,2):E()})):Oe(t)?e?u=l?()=>l(t,2):t:u=()=>{if(d){rs();try{d()}finally{os()}}const E=rr;rr=h;try{return l?l(t,3,[f]):t(f)}finally{rr=E}}:u=Fi,e&&s){const E=u,w=s===!0?1/0:s;u=()=>Qi(E(),w)}const p=y1(),y=()=>{h.stop(),p&&p.active&&Xg(p.effects,h)};if(r&&e){const E=e;e=(...w)=>{E(...w),y()}}let _=m?new Array(t.length).fill(Ql):Ql;const x=E=>{if(!(!(h.flags&1)||!h.dirty&&!E))if(e){const w=h.run();if(s||g||(m?w.some((b,v)=>Is(b,_[v])):Is(w,_))){d&&d();const b=rr;rr=h;try{const v=[w,_===Ql?void 0:m&&_[0]===Ql?[]:_,f];_=w,l?l(e,3,v):e(...v)}finally{rr=b}}}else h.run()};return a&&a(x),h=new uw(u),h.scheduler=o?()=>o(x,!1):x,f=E=>X1(E,!1,h),d=h.onStop=()=>{const E=th.get(h);if(E){if(l)l(E,4);else for(const w of E)w();th.delete(h)}},e?i?x(!0):_=h.run():o?o(x.bind(null,!0),!0):h.run(),y.pause=h.pause.bind(h),y.resume=h.resume.bind(h),y.stop=y,y}function Qi(t,e=1/0,n){if(e<=0||!_t(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),e--,cn(t))Qi(t.value,e,n);else if(ve(t))for(let i=0;i<t.length;i++)Qi(t[i],e,n);else if(nw(t)||po(t))t.forEach(i=>{Qi(i,e,n)});else if(rw(t)){for(const i in t)Qi(t[i],e,n);for(const i of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,i)&&Qi(t[i],e,n)}return t}/**
* @vue/runtime-core v3.5.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Fl(t,e,n,i){try{return i?t(...i):t()}catch(s){zh(s,e,n)}}function Ni(t,e,n,i){if(Oe(t)){const s=Fl(t,e,n,i);return s&&iw(s)&&s.catch(r=>{zh(r,e,n)}),s}if(ve(t)){const s=[];for(let r=0;r<t.length;r++)s.push(Ni(t[r],e,n,i));return s}}function zh(t,e,n,i=!0){const s=e?e.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||st;if(e){let a=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${n}`;for(;a;){const h=a.ec;if(h){for(let u=0;u<h.length;u++)if(h[u](t,l,c)===!1)return}a=a.parent}if(r){rs(),Fl(r,null,10,[t,l,c]),os();return}}W1(t,n,s,i,o)}function W1(t,e,n,i=!0,s=!1){if(s)throw t;console.error(t)}const yn=[];let Ri=-1;const _o=[];let Cs=null,Jr=0;const vw=Promise.resolve();let nh=null;function Aw(t){const e=nh||vw;return t?e.then(this?t.bind(this):t):e}function K1(t){let e=Ri+1,n=yn.length;for(;e<n;){const i=e+n>>>1,s=yn[i],r=sl(s);r<t||r===t&&s.flags&2?e=i+1:n=i}return e}function tp(t){if(!(t.flags&1)){const e=sl(t),n=yn[yn.length-1];!n||!(t.flags&2)&&e>=sl(n)?yn.push(t):yn.splice(K1(e),0,t),t.flags|=1,Iw()}}function Iw(){nh||(nh=vw.then(Mw))}function Y1(t){ve(t)?_o.push(...t):Cs&&t.id===-1?Cs.splice(Jr+1,0,t):t.flags&1||(_o.push(t),t.flags|=1),Iw()}function F_(t,e,n=Ri+1){for(;n<yn.length;n++){const i=yn[n];if(i&&i.flags&2){if(t&&i.id!==t.uid)continue;yn.splice(n,1),n--,i.flags&4&&(i.flags&=-2),i(),i.flags&4||(i.flags&=-2)}}}function Pw(t){if(_o.length){const e=[...new Set(_o)].sort((n,i)=>sl(n)-sl(i));if(_o.length=0,Cs){Cs.push(...e);return}for(Cs=e,Jr=0;Jr<Cs.length;Jr++){const n=Cs[Jr];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}Cs=null,Jr=0}}const sl=t=>t.id==null?t.flags&2?-1:1/0:t.id;function Mw(t){try{for(Ri=0;Ri<yn.length;Ri++){const e=yn[Ri];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Fl(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Ri<yn.length;Ri++){const e=yn[Ri];e&&(e.flags&=-2)}Ri=-1,yn.length=0,Pw(),nh=null,(yn.length||_o.length)&&Mw()}}let ii=null,Fw=null;function ih(t){const e=ii;return ii=t,Fw=t&&t.type.__scopeId||null,e}function q1(t,e=ii,n){if(!e||t._n)return t;const i=(...s)=>{i._d&&$_(-1);const r=ih(e);let o;try{o=t(...s)}finally{ih(r),i._d&&$_(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function cr(t,e){if(ii===null)return t;const n=Wh(ii),i=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[r,o,a,l=st]=e[s];r&&(Oe(r)&&(r={mounted:r,updated:r}),r.deep&&Qi(o),i.push({dir:r,instance:n,value:o,oldValue:void 0,arg:a,modifiers:l}))}return t}function er(t,e,n,i){const s=t.dirs,r=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];r&&(a.oldValue=r[o].value);let l=a.dir[i];l&&(rs(),Ni(l,n,8,[t.el,a,t,e]),os())}}const Z1=Symbol("_vte"),J1=t=>t.__isTeleport,Q1=Symbol("_leaveCb");function np(t,e){t.shapeFlag&6&&t.component?(t.transition=e,np(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Dw(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function Na(t,e,n,i,s=!1){if(ve(t)){t.forEach((g,m)=>Na(g,e&&(ve(e)?e[m]:e),n,i,s));return}if(Ba(i)&&!s){i.shapeFlag&512&&i.type.__asyncResolved&&i.component.subTree.component&&Na(t,e,n,i.component.subTree);return}const r=i.shapeFlag&4?Wh(i.component):i.el,o=s?null:r,{i:a,r:l}=t,c=e&&e.r,h=a.refs===st?a.refs={}:a.refs,u=a.setupState,d=Qe(u),f=u===st?tw:g=>et(d,g);if(c!=null&&c!==l){if(Mt(c))h[c]=null,f(c)&&(u[c]=null);else if(cn(c)){c.value=null;const g=e;g.k&&(h[g.k]=null)}}if(Oe(l))Fl(l,a,12,[o,h]);else{const g=Mt(l),m=cn(l);if(g||m){const p=()=>{if(t.f){const y=g?f(l)?u[l]:h[l]:l.value;if(s)ve(y)&&Xg(y,r);else if(ve(y))y.includes(r)||y.push(r);else if(g)h[l]=[r],f(l)&&(u[l]=h[l]);else{const _=[r];l.value=_,t.k&&(h[t.k]=_)}}else g?(h[l]=o,f(l)&&(u[l]=o)):m&&(l.value=o,t.k&&(h[t.k]=o))};o?(p.id=-1,Bn(p,n)):p()}}}Gh().requestIdleCallback;Gh().cancelIdleCallback;const Ba=t=>!!t.type.__asyncLoader,Ow=t=>t.type.__isKeepAlive;function eR(t,e){Lw(t,"a",e)}function tR(t,e){Lw(t,"da",e)}function Lw(t,e,n=xn){const i=t.__wdc||(t.__wdc=()=>{let s=n;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(Hh(e,i,n),n){let s=n.parent;for(;s&&s.parent;)Ow(s.parent.vnode)&&nR(i,e,n,s),s=s.parent}}function nR(t,e,n,i){const s=Hh(e,t,i,!0);Bw(()=>{Xg(i[e],s)},n)}function Hh(t,e,n=xn,i=!1){if(n){const s=n[t]||(n[t]=[]),r=e.__weh||(e.__weh=(...o)=>{rs();const a=Dl(n),l=Ni(e,n,t,o);return a(),os(),l});return i?s.unshift(r):s.push(r),r}}const ls=t=>(e,n=xn)=>{(!ol||t==="sp")&&Hh(t,(...i)=>e(...i),n)},iR=ls("bm"),kw=ls("m"),sR=ls("bu"),rR=ls("u"),Nw=ls("bum"),Bw=ls("um"),oR=ls("sp"),aR=ls("rtg"),lR=ls("rtc");function cR(t,e=xn){Hh("ec",t,e)}const hR=Symbol.for("v-ndc");function Nc(t,e,n,i){let s;const r=n,o=ve(t);if(o||Mt(t)){const a=o&&mo(t);let l=!1,c=!1;a&&(l=!ri(t),c=Ns(t),t=jh(t)),s=new Array(t.length);for(let h=0,u=t.length;h<u;h++)s[h]=e(l?c?eh(Kt(t[h])):Kt(t[h]):t[h],h,void 0,r)}else if(typeof t=="number"){s=new Array(t);for(let a=0;a<t;a++)s[a]=e(a+1,a,void 0,r)}else if(_t(t))if(t[Symbol.iterator])s=Array.from(t,(a,l)=>e(a,l,void 0,r));else{const a=Object.keys(t);s=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const h=a[l];s[l]=e(t[h],h,l,r)}}else s=[];return s}const Bf=t=>t?oS(t)?Wh(t):Bf(t.parent):null,Ua=bn(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Bf(t.parent),$root:t=>Bf(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>Gw(t),$forceUpdate:t=>t.f||(t.f=()=>{tp(t.update)}),$nextTick:t=>t.n||(t.n=Aw.bind(t.proxy)),$watch:t=>FR.bind(t)}),zu=(t,e)=>t!==st&&!t.__isScriptSetup&&et(t,e),uR={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:i,data:s,props:r,accessCache:o,type:a,appContext:l}=t;let c;if(e[0]!=="$"){const f=o[e];if(f!==void 0)switch(f){case 1:return i[e];case 2:return s[e];case 4:return n[e];case 3:return r[e]}else{if(zu(i,e))return o[e]=1,i[e];if(s!==st&&et(s,e))return o[e]=2,s[e];if((c=t.propsOptions[0])&&et(c,e))return o[e]=3,r[e];if(n!==st&&et(n,e))return o[e]=4,n[e];Uf&&(o[e]=0)}}const h=Ua[e];let u,d;if(h)return e==="$attrs"&&rn(t.attrs,"get",""),h(t);if((u=a.__cssModules)&&(u=u[e]))return u;if(n!==st&&et(n,e))return o[e]=4,n[e];if(d=l.config.globalProperties,et(d,e))return d[e]},set({_:t},e,n){const{data:i,setupState:s,ctx:r}=t;return zu(s,e)?(s[e]=n,!0):i!==st&&et(i,e)?(i[e]=n,!0):et(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(r[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:i,appContext:s,propsOptions:r,type:o}},a){let l,c;return!!(n[a]||t!==st&&a[0]!=="$"&&et(t,a)||zu(e,a)||(l=r[0])&&et(l,a)||et(i,a)||et(Ua,a)||et(s.config.globalProperties,a)||(c=o.__cssModules)&&c[a])},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:et(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function D_(t){return ve(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let Uf=!0;function dR(t){const e=Gw(t),n=t.proxy,i=t.ctx;Uf=!1,e.beforeCreate&&O_(e.beforeCreate,t,"bc");const{data:s,computed:r,methods:o,watch:a,provide:l,inject:c,created:h,beforeMount:u,mounted:d,beforeUpdate:f,updated:g,activated:m,deactivated:p,beforeDestroy:y,beforeUnmount:_,destroyed:x,unmounted:E,render:w,renderTracked:b,renderTriggered:v,errorCaptured:A,serverPrefetch:P,expose:M,inheritAttrs:Y,components:j,directives:K,filters:ee}=e;if(c&&fR(c,i,null),o)for(const V in o){const z=o[V];Oe(z)&&(i[V]=z.bind(n))}if(s){const V=s.call(n,n);_t(V)&&(t.data=Ao(V))}if(Uf=!0,r)for(const V in r){const z=r[V],re=Oe(z)?z.bind(n,n):Oe(z.get)?z.get.bind(n,n):Fi,ue=!Oe(z)&&Oe(z.set)?z.set.bind(n):Fi,ye=or({get:re,set:ue});Object.defineProperty(i,V,{enumerable:!0,configurable:!0,get:()=>ye.value,set:N=>ye.value=N})}if(a)for(const V in a)Uw(a[V],i,n,V);if(l){const V=Oe(l)?l.call(n):l;Reflect.ownKeys(V).forEach(z=>{ER(z,V[z])})}h&&O_(h,t,"c");function Q(V,z){ve(z)?z.forEach(re=>V(re.bind(n))):z&&V(z.bind(n))}if(Q(iR,u),Q(kw,d),Q(sR,f),Q(rR,g),Q(eR,m),Q(tR,p),Q(cR,A),Q(lR,b),Q(aR,v),Q(Nw,_),Q(Bw,E),Q(oR,P),ve(M))if(M.length){const V=t.exposed||(t.exposed={});M.forEach(z=>{Object.defineProperty(V,z,{get:()=>n[z],set:re=>n[z]=re,enumerable:!0})})}else t.exposed||(t.exposed={});w&&t.render===Fi&&(t.render=w),Y!=null&&(t.inheritAttrs=Y),j&&(t.components=j),K&&(t.directives=K),P&&Dw(t)}function fR(t,e,n=Fi){ve(t)&&(t=Gf(t));for(const i in t){const s=t[i];let r;_t(s)?"default"in s?r=Bc(s.from||i,s.default,!0):r=Bc(s.from||i):r=Bc(s),cn(r)?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):e[i]=r}}function O_(t,e,n){Ni(ve(t)?t.map(i=>i.bind(e.proxy)):t.bind(e.proxy),e,n)}function Uw(t,e,n,i){let s=i.includes(".")?Qw(n,i):()=>n[i];if(Mt(t)){const r=e[t];Oe(r)&&Eo(s,r)}else if(Oe(t))Eo(s,t.bind(n));else if(_t(t))if(ve(t))t.forEach(r=>Uw(r,e,n,i));else{const r=Oe(t.handler)?t.handler.bind(n):e[t.handler];Oe(r)&&Eo(s,r,t)}}function Gw(t){const e=t.type,{mixins:n,extends:i}=e,{mixins:s,optionsCache:r,config:{optionMergeStrategies:o}}=t.appContext,a=r.get(e);let l;return a?l=a:!s.length&&!n&&!i?l=e:(l={},s.length&&s.forEach(c=>sh(l,c,o,!0)),sh(l,e,o)),_t(e)&&r.set(e,l),l}function sh(t,e,n,i=!1){const{mixins:s,extends:r}=e;r&&sh(t,r,n,!0),s&&s.forEach(o=>sh(t,o,n,!0));for(const o in e)if(!(i&&o==="expose")){const a=gR[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const gR={data:L_,props:k_,emits:k_,methods:ba,computed:ba,beforeCreate:dn,created:dn,beforeMount:dn,mounted:dn,beforeUpdate:dn,updated:dn,beforeDestroy:dn,beforeUnmount:dn,destroyed:dn,unmounted:dn,activated:dn,deactivated:dn,errorCaptured:dn,serverPrefetch:dn,components:ba,directives:ba,watch:mR,provide:L_,inject:pR};function L_(t,e){return e?t?function(){return bn(Oe(t)?t.call(this,this):t,Oe(e)?e.call(this,this):e)}:e:t}function pR(t,e){return ba(Gf(t),Gf(e))}function Gf(t){if(ve(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function dn(t,e){return t?[...new Set([].concat(t,e))]:e}function ba(t,e){return t?bn(Object.create(null),t,e):e}function k_(t,e){return t?ve(t)&&ve(e)?[...new Set([...t,...e])]:bn(Object.create(null),D_(t),D_(e??{})):e}function mR(t,e){if(!t)return e;if(!e)return t;const n=bn(Object.create(null),t);for(const i in e)n[i]=dn(t[i],e[i]);return n}function $w(){return{app:null,config:{isNativeTag:tw,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let _R=0;function yR(t,e){return function(i,s=null){Oe(i)||(i=bn({},i)),s!=null&&!_t(s)&&(s=null);const r=$w(),o=new WeakSet,a=[];let l=!1;const c=r.app={_uid:_R++,_component:i,_props:s,_container:null,_context:r,_instance:null,version:ev,get config(){return r.config},set config(h){},use(h,...u){return o.has(h)||(h&&Oe(h.install)?(o.add(h),h.install(c,...u)):Oe(h)&&(o.add(h),h(c,...u))),c},mixin(h){return r.mixins.includes(h)||r.mixins.push(h),c},component(h,u){return u?(r.components[h]=u,c):r.components[h]},directive(h,u){return u?(r.directives[h]=u,c):r.directives[h]},mount(h,u,d){if(!l){const f=c._ceVNode||oi(i,s);return f.appContext=r,d===!0?d="svg":d===!1&&(d=void 0),t(f,h,d),l=!0,c._container=h,h.__vue_app__=c,Wh(f.component)}},onUnmount(h){a.push(h)},unmount(){l&&(Ni(a,c._instance,16),t(null,c._container),delete c._container.__vue_app__)},provide(h,u){return r.provides[h]=u,c},runWithContext(h){const u=yo;yo=c;try{return h()}finally{yo=u}}};return c}}let yo=null;function ER(t,e){if(xn){let n=xn.provides;const i=xn.parent&&xn.parent.provides;i===n&&(n=xn.provides=Object.create(i)),n[t]=e}}function Bc(t,e,n=!1){const i=KR();if(i||yo){let s=yo?yo._context.provides:i?i.parent==null||i.ce?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:void 0;if(s&&t in s)return s[t];if(arguments.length>1)return n&&Oe(e)?e.call(i&&i.proxy):e}}const jw={},zw=()=>Object.create(jw),Hw=t=>Object.getPrototypeOf(t)===jw;function xR(t,e,n,i=!1){const s={},r=zw();t.propsDefaults=Object.create(null),Xw(t,e,s,r);for(const o in t.propsOptions[0])o in s||(s[o]=void 0);n?t.props=i?s:N1(s):t.type.props?t.props=s:t.props=r,t.attrs=r}function wR(t,e,n,i){const{props:s,attrs:r,vnode:{patchFlag:o}}=t,a=Qe(s),[l]=t.propsOptions;let c=!1;if((i||o>0)&&!(o&16)){if(o&8){const h=t.vnode.dynamicProps;for(let u=0;u<h.length;u++){let d=h[u];if(Xh(t.emitsOptions,d))continue;const f=e[d];if(l)if(et(r,d))f!==r[d]&&(r[d]=f,c=!0);else{const g=ks(d);s[g]=$f(l,a,g,f,t,!1)}else f!==r[d]&&(r[d]=f,c=!0)}}}else{Xw(t,e,s,r)&&(c=!0);let h;for(const u in a)(!e||!et(e,u)&&((h=Ys(u))===u||!et(e,h)))&&(l?n&&(n[u]!==void 0||n[h]!==void 0)&&(s[u]=$f(l,a,u,void 0,t,!0)):delete s[u]);if(r!==a)for(const u in r)(!e||!et(e,u))&&(delete r[u],c=!0)}c&&Ji(t.attrs,"set","")}function Xw(t,e,n,i){const[s,r]=t.propsOptions;let o=!1,a;if(e)for(let l in e){if(Oa(l))continue;const c=e[l];let h;s&&et(s,h=ks(l))?!r||!r.includes(h)?n[h]=c:(a||(a={}))[h]=c:Xh(t.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,o=!0)}if(r){const l=Qe(n),c=a||st;for(let h=0;h<r.length;h++){const u=r[h];n[u]=$f(s,l,u,c[u],t,!et(c,u))}}return o}function $f(t,e,n,i,s,r){const o=t[n];if(o!=null){const a=et(o,"default");if(a&&i===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&Oe(l)){const{propsDefaults:c}=s;if(n in c)i=c[n];else{const h=Dl(s);i=c[n]=l.call(null,e),h()}}else i=l;s.ce&&s.ce._setProp(n,i)}o[0]&&(r&&!a?i=!1:o[1]&&(i===""||i===Ys(n))&&(i=!0))}return i}const SR=new WeakMap;function Vw(t,e,n=!1){const i=n?SR:e.propsCache,s=i.get(t);if(s)return s;const r=t.props,o={},a=[];let l=!1;if(!Oe(t)){const h=u=>{l=!0;const[d,f]=Vw(u,e,!0);bn(o,d),f&&a.push(...f)};!n&&e.mixins.length&&e.mixins.forEach(h),t.extends&&h(t.extends),t.mixins&&t.mixins.forEach(h)}if(!r&&!l)return _t(t)&&i.set(t,go),go;if(ve(r))for(let h=0;h<r.length;h++){const u=ks(r[h]);N_(u)&&(o[u]=st)}else if(r)for(const h in r){const u=ks(h);if(N_(u)){const d=r[h],f=o[u]=ve(d)||Oe(d)?{type:d}:bn({},d),g=f.type;let m=!1,p=!0;if(ve(g))for(let y=0;y<g.length;++y){const _=g[y],x=Oe(_)&&_.name;if(x==="Boolean"){m=!0;break}else x==="String"&&(p=!1)}else m=Oe(g)&&g.name==="Boolean";f[0]=m,f[1]=p,(m||et(f,"default"))&&a.push(u)}}const c=[o,a];return _t(t)&&i.set(t,c),c}function N_(t){return t[0]!=="$"&&!Oa(t)}const ip=t=>t==="_"||t==="_ctx"||t==="$stable",sp=t=>ve(t)?t.map(Ai):[Ai(t)],CR=(t,e,n)=>{if(e._n)return e;const i=q1((...s)=>sp(e(...s)),n);return i._c=!1,i},Ww=(t,e,n)=>{const i=t._ctx;for(const s in t){if(ip(s))continue;const r=t[s];if(Oe(r))e[s]=CR(s,r,i);else if(r!=null){const o=sp(r);e[s]=()=>o}}},Kw=(t,e)=>{const n=sp(e);t.slots.default=()=>n},Yw=(t,e,n)=>{for(const i in e)(n||!ip(i))&&(t[i]=e[i])},bR=(t,e,n)=>{const i=t.slots=zw();if(t.vnode.shapeFlag&32){const s=e._;s?(Yw(i,e,n),n&&aw(i,"_",s,!0)):Ww(e,i)}else e&&Kw(t,e)},TR=(t,e,n)=>{const{vnode:i,slots:s}=t;let r=!0,o=st;if(i.shapeFlag&32){const a=e._;a?n&&a===1?r=!1:Yw(s,e,n):(r=!e.$stable,Ww(e,s)),o=e}else e&&(Kw(t,e),o={default:1});if(r)for(const a in s)!ip(a)&&o[a]==null&&delete s[a]},Bn=UR;function RR(t){return vR(t)}function vR(t,e){const n=Gh();n.__VUE__=!0;const{insert:i,remove:s,patchProp:r,createElement:o,createText:a,createComment:l,setText:c,setElementText:h,parentNode:u,nextSibling:d,setScopeId:f=Fi,insertStaticContent:g}=t,m=(C,R,O,G=null,B=null,$=null,ie=void 0,ne=null,q=!!R.dynamicChildren)=>{if(C===R)return;C&&!fa(C,R)&&(G=ge(C),N(C,B,$,!0),C=null),R.patchFlag===-2&&(q=!1,R.dynamicChildren=null);const{type:W,ref:pe,shapeFlag:J}=R;switch(W){case Vh:p(C,R,O,G);break;case Bs:y(C,R,O,G);break;case Xu:C==null&&_(R,O,G,ie);break;case on:j(C,R,O,G,B,$,ie,ne,q);break;default:J&1?w(C,R,O,G,B,$,ie,ne,q):J&6?K(C,R,O,G,B,$,ie,ne,q):(J&64||J&128)&&W.process(C,R,O,G,B,$,ie,ne,q,Xe)}pe!=null&&B?Na(pe,C&&C.ref,$,R||C,!R):pe==null&&C&&C.ref!=null&&Na(C.ref,null,$,C,!0)},p=(C,R,O,G)=>{if(C==null)i(R.el=a(R.children),O,G);else{const B=R.el=C.el;R.children!==C.children&&c(B,R.children)}},y=(C,R,O,G)=>{C==null?i(R.el=l(R.children||""),O,G):R.el=C.el},_=(C,R,O,G)=>{[C.el,C.anchor]=g(C.children,R,O,G,C.el,C.anchor)},x=({el:C,anchor:R},O,G)=>{let B;for(;C&&C!==R;)B=d(C),i(C,O,G),C=B;i(R,O,G)},E=({el:C,anchor:R})=>{let O;for(;C&&C!==R;)O=d(C),s(C),C=O;s(R)},w=(C,R,O,G,B,$,ie,ne,q)=>{R.type==="svg"?ie="svg":R.type==="math"&&(ie="mathml"),C==null?b(R,O,G,B,$,ie,ne,q):P(C,R,B,$,ie,ne,q)},b=(C,R,O,G,B,$,ie,ne)=>{let q,W;const{props:pe,shapeFlag:J,transition:_e,dirs:we}=C;if(q=C.el=o(C.type,$,pe&&pe.is,pe),J&8?h(q,C.children):J&16&&A(C.children,q,null,G,B,Hu(C,$),ie,ne),we&&er(C,null,G,"created"),v(q,C,C.scopeId,ie,G),pe){for(const Ye in pe)Ye!=="value"&&!Oa(Ye)&&r(q,Ye,null,pe[Ye],$,G);"value"in pe&&r(q,"value",null,pe.value,$),(W=pe.onVnodeBeforeMount)&&Ei(W,G,C)}we&&er(C,null,G,"beforeMount");const Ne=AR(B,_e);Ne&&_e.beforeEnter(q),i(q,R,O),((W=pe&&pe.onVnodeMounted)||Ne||we)&&Bn(()=>{W&&Ei(W,G,C),Ne&&_e.enter(q),we&&er(C,null,G,"mounted")},B)},v=(C,R,O,G,B)=>{if(O&&f(C,O),G)for(let $=0;$<G.length;$++)f(C,G[$]);if(B){let $=B.subTree;if(R===$||tS($.type)&&($.ssContent===R||$.ssFallback===R)){const ie=B.vnode;v(C,ie,ie.scopeId,ie.slotScopeIds,B.parent)}}},A=(C,R,O,G,B,$,ie,ne,q=0)=>{for(let W=q;W<C.length;W++){const pe=C[W]=ne?bs(C[W]):Ai(C[W]);m(null,pe,R,O,G,B,$,ie,ne)}},P=(C,R,O,G,B,$,ie)=>{const ne=R.el=C.el;let{patchFlag:q,dynamicChildren:W,dirs:pe}=R;q|=C.patchFlag&16;const J=C.props||st,_e=R.props||st;let we;if(O&&tr(O,!1),(we=_e.onVnodeBeforeUpdate)&&Ei(we,O,R,C),pe&&er(R,C,O,"beforeUpdate"),O&&tr(O,!0),(J.innerHTML&&_e.innerHTML==null||J.textContent&&_e.textContent==null)&&h(ne,""),W?M(C.dynamicChildren,W,ne,O,G,Hu(R,B),$):ie||z(C,R,ne,null,O,G,Hu(R,B),$,!1),q>0){if(q&16)Y(ne,J,_e,O,B);else if(q&2&&J.class!==_e.class&&r(ne,"class",null,_e.class,B),q&4&&r(ne,"style",J.style,_e.style,B),q&8){const Ne=R.dynamicProps;for(let Ye=0;Ye<Ne.length;Ye++){const qe=Ne[Ye],Xt=J[qe],Vt=_e[qe];(Vt!==Xt||qe==="value")&&r(ne,qe,Xt,Vt,B,O)}}q&1&&C.children!==R.children&&h(ne,R.children)}else!ie&&W==null&&Y(ne,J,_e,O,B);((we=_e.onVnodeUpdated)||pe)&&Bn(()=>{we&&Ei(we,O,R,C),pe&&er(R,C,O,"updated")},G)},M=(C,R,O,G,B,$,ie)=>{for(let ne=0;ne<R.length;ne++){const q=C[ne],W=R[ne],pe=q.el&&(q.type===on||!fa(q,W)||q.shapeFlag&198)?u(q.el):O;m(q,W,pe,null,G,B,$,ie,!0)}},Y=(C,R,O,G,B)=>{if(R!==O){if(R!==st)for(const $ in R)!Oa($)&&!($ in O)&&r(C,$,R[$],null,B,G);for(const $ in O){if(Oa($))continue;const ie=O[$],ne=R[$];ie!==ne&&$!=="value"&&r(C,$,ne,ie,B,G)}"value"in O&&r(C,"value",R.value,O.value,B)}},j=(C,R,O,G,B,$,ie,ne,q)=>{const W=R.el=C?C.el:a(""),pe=R.anchor=C?C.anchor:a("");let{patchFlag:J,dynamicChildren:_e,slotScopeIds:we}=R;we&&(ne=ne?ne.concat(we):we),C==null?(i(W,O,G),i(pe,O,G),A(R.children||[],O,pe,B,$,ie,ne,q)):J>0&&J&64&&_e&&C.dynamicChildren?(M(C.dynamicChildren,_e,O,B,$,ie,ne),(R.key!=null||B&&R===B.subTree)&&qw(C,R,!0)):z(C,R,O,pe,B,$,ie,ne,q)},K=(C,R,O,G,B,$,ie,ne,q)=>{R.slotScopeIds=ne,C==null?R.shapeFlag&512?B.ctx.activate(R,O,G,ie,q):ee(R,O,G,B,$,ie,q):te(C,R,q)},ee=(C,R,O,G,B,$,ie)=>{const ne=C.component=WR(C,G,B);if(Ow(C)&&(ne.ctx.renderer=Xe),YR(ne,!1,ie),ne.asyncDep){if(B&&B.registerDep(ne,Q,ie),!C.el){const q=ne.subTree=oi(Bs);y(null,q,R,O),C.placeholder=q.el}}else Q(ne,C,R,O,B,$,ie)},te=(C,R,O)=>{const G=R.component=C.component;if(NR(C,R,O))if(G.asyncDep&&!G.asyncResolved){V(G,R,O);return}else G.next=R,G.update();else R.el=C.el,G.vnode=R},Q=(C,R,O,G,B,$,ie)=>{const ne=()=>{if(C.isMounted){let{next:J,bu:_e,u:we,parent:Ne,vnode:Ye}=C;{const qn=Zw(C);if(qn){J&&(J.el=Ye.el,V(C,J,ie)),qn.asyncDep.then(()=>{C.isUnmounted||ne()});return}}let qe=J,Xt;tr(C,!1),J?(J.el=Ye.el,V(C,J,ie)):J=Ye,_e&&kc(_e),(Xt=J.props&&J.props.onVnodeBeforeUpdate)&&Ei(Xt,Ne,J,Ye),tr(C,!0);const Vt=U_(C),vn=C.subTree;C.subTree=Vt,m(vn,Vt,u(vn.el),ge(vn),C,B,$),J.el=Vt.el,qe===null&&BR(C,Vt.el),we&&Bn(we,B),(Xt=J.props&&J.props.onVnodeUpdated)&&Bn(()=>Ei(Xt,Ne,J,Ye),B)}else{let J;const{el:_e,props:we}=R,{bm:Ne,m:Ye,parent:qe,root:Xt,type:Vt}=C,vn=Ba(R);tr(C,!1),Ne&&kc(Ne),!vn&&(J=we&&we.onVnodeBeforeMount)&&Ei(J,qe,R),tr(C,!0);{Xt.ce&&Xt.ce._def.shadowRoot!==!1&&Xt.ce._injectChildStyle(Vt);const qn=C.subTree=U_(C);m(null,qn,O,G,C,B,$),R.el=qn.el}if(Ye&&Bn(Ye,B),!vn&&(J=we&&we.onVnodeMounted)){const qn=R;Bn(()=>Ei(J,qe,qn),B)}(R.shapeFlag&256||qe&&Ba(qe.vnode)&&qe.vnode.shapeFlag&256)&&C.a&&Bn(C.a,B),C.isMounted=!0,R=O=G=null}};C.scope.on();const q=C.effect=new uw(ne);C.scope.off();const W=C.update=q.run.bind(q),pe=C.job=q.runIfDirty.bind(q);pe.i=C,pe.id=C.uid,q.scheduler=()=>tp(pe),tr(C,!0),W()},V=(C,R,O)=>{R.component=C;const G=C.vnode.props;C.vnode=R,C.next=null,wR(C,R.props,G,O),TR(C,R.children,O),rs(),F_(C),os()},z=(C,R,O,G,B,$,ie,ne,q=!1)=>{const W=C&&C.children,pe=C?C.shapeFlag:0,J=R.children,{patchFlag:_e,shapeFlag:we}=R;if(_e>0){if(_e&128){ue(W,J,O,G,B,$,ie,ne,q);return}else if(_e&256){re(W,J,O,G,B,$,ie,ne,q);return}}we&8?(pe&16&&oe(W,B,$),J!==W&&h(O,J)):pe&16?we&16?ue(W,J,O,G,B,$,ie,ne,q):oe(W,B,$,!0):(pe&8&&h(O,""),we&16&&A(J,O,G,B,$,ie,ne,q))},re=(C,R,O,G,B,$,ie,ne,q)=>{C=C||go,R=R||go;const W=C.length,pe=R.length,J=Math.min(W,pe);let _e;for(_e=0;_e<J;_e++){const we=R[_e]=q?bs(R[_e]):Ai(R[_e]);m(C[_e],we,O,null,B,$,ie,ne,q)}W>pe?oe(C,B,$,!0,!1,J):A(R,O,G,B,$,ie,ne,q,J)},ue=(C,R,O,G,B,$,ie,ne,q)=>{let W=0;const pe=R.length;let J=C.length-1,_e=pe-1;for(;W<=J&&W<=_e;){const we=C[W],Ne=R[W]=q?bs(R[W]):Ai(R[W]);if(fa(we,Ne))m(we,Ne,O,null,B,$,ie,ne,q);else break;W++}for(;W<=J&&W<=_e;){const we=C[J],Ne=R[_e]=q?bs(R[_e]):Ai(R[_e]);if(fa(we,Ne))m(we,Ne,O,null,B,$,ie,ne,q);else break;J--,_e--}if(W>J){if(W<=_e){const we=_e+1,Ne=we<pe?R[we].el:G;for(;W<=_e;)m(null,R[W]=q?bs(R[W]):Ai(R[W]),O,Ne,B,$,ie,ne,q),W++}}else if(W>_e)for(;W<=J;)N(C[W],B,$,!0),W++;else{const we=W,Ne=W,Ye=new Map;for(W=Ne;W<=_e;W++){const Zt=R[W]=q?bs(R[W]):Ai(R[W]);Zt.key!=null&&Ye.set(Zt.key,W)}let qe,Xt=0;const Vt=_e-Ne+1;let vn=!1,qn=0;const Js=new Array(Vt);for(W=0;W<Vt;W++)Js[W]=0;for(W=we;W<=J;W++){const Zt=C[W];if(Xt>=Vt){N(Zt,B,$,!0);continue}let An;if(Zt.key!=null)An=Ye.get(Zt.key);else for(qe=Ne;qe<=_e;qe++)if(Js[qe-Ne]===0&&fa(Zt,R[qe])){An=qe;break}An===void 0?N(Zt,B,$,!0):(Js[An-Ne]=W+1,An>=qn?qn=An:vn=!0,m(Zt,R[An],O,null,B,$,ie,ne,q),Xt++)}const aa=vn?IR(Js):go;for(qe=aa.length-1,W=Vt-1;W>=0;W--){const Zt=Ne+W,An=R[Zt],la=R[Zt+1],ql=Zt+1<pe?la.el||la.placeholder:G;Js[W]===0?m(null,An,O,ql,B,$,ie,ne,q):vn&&(qe<0||W!==aa[qe]?ye(An,O,ql,2):qe--)}}},ye=(C,R,O,G,B=null)=>{const{el:$,type:ie,transition:ne,children:q,shapeFlag:W}=C;if(W&6){ye(C.component.subTree,R,O,G);return}if(W&128){C.suspense.move(R,O,G);return}if(W&64){ie.move(C,R,O,Xe);return}if(ie===on){i($,R,O);for(let J=0;J<q.length;J++)ye(q[J],R,O,G);i(C.anchor,R,O);return}if(ie===Xu){x(C,R,O);return}if(G!==2&&W&1&&ne)if(G===0)ne.beforeEnter($),i($,R,O),Bn(()=>ne.enter($),B);else{const{leave:J,delayLeave:_e,afterLeave:we}=ne,Ne=()=>{C.ctx.isUnmounted?s($):i($,R,O)},Ye=()=>{$._isLeaving&&$[Q1](!0),J($,()=>{Ne(),we&&we()})};_e?_e($,Ne,Ye):Ye()}else i($,R,O)},N=(C,R,O,G=!1,B=!1)=>{const{type:$,props:ie,ref:ne,children:q,dynamicChildren:W,shapeFlag:pe,patchFlag:J,dirs:_e,cacheIndex:we}=C;if(J===-2&&(B=!1),ne!=null&&(rs(),Na(ne,null,O,C,!0),os()),we!=null&&(R.renderCache[we]=void 0),pe&256){R.ctx.deactivate(C);return}const Ne=pe&1&&_e,Ye=!Ba(C);let qe;if(Ye&&(qe=ie&&ie.onVnodeBeforeUnmount)&&Ei(qe,R,C),pe&6)H(C.component,O,G);else{if(pe&128){C.suspense.unmount(O,G);return}Ne&&er(C,null,R,"beforeUnmount"),pe&64?C.type.remove(C,R,O,Xe,G):W&&!W.hasOnce&&($!==on||J>0&&J&64)?oe(W,R,O,!1,!0):($===on&&J&384||!B&&pe&16)&&oe(q,R,O),G&&be(C)}(Ye&&(qe=ie&&ie.onVnodeUnmounted)||Ne)&&Bn(()=>{qe&&Ei(qe,R,C),Ne&&er(C,null,R,"unmounted")},O)},be=C=>{const{type:R,el:O,anchor:G,transition:B}=C;if(R===on){Z(O,G);return}if(R===Xu){E(C);return}const $=()=>{s(O),B&&!B.persisted&&B.afterLeave&&B.afterLeave()};if(C.shapeFlag&1&&B&&!B.persisted){const{leave:ie,delayLeave:ne}=B,q=()=>ie(O,$);ne?ne(C.el,$,q):q()}else $()},Z=(C,R)=>{let O;for(;C!==R;)O=d(C),s(C),C=O;s(R)},H=(C,R,O)=>{const{bum:G,scope:B,job:$,subTree:ie,um:ne,m:q,a:W}=C;B_(q),B_(W),G&&kc(G),B.stop(),$&&($.flags|=8,N(ie,C,R,O)),ne&&Bn(ne,R),Bn(()=>{C.isUnmounted=!0},R)},oe=(C,R,O,G=!1,B=!1,$=0)=>{for(let ie=$;ie<C.length;ie++)N(C[ie],R,O,G,B)},ge=C=>{if(C.shapeFlag&6)return ge(C.component.subTree);if(C.shapeFlag&128)return C.suspense.next();const R=d(C.anchor||C.el),O=R&&R[Z1];return O?d(O):R};let Ie=!1;const je=(C,R,O)=>{C==null?R._vnode&&N(R._vnode,null,null,!0):m(R._vnode||null,C,R,null,null,null,O),R._vnode=C,Ie||(Ie=!0,F_(),Pw(),Ie=!1)},Xe={p:m,um:N,m:ye,r:be,mt:ee,mc:A,pc:z,pbc:M,n:ge,o:t};return{render:je,hydrate:void 0,createApp:yR(je)}}function Hu({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function tr({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function AR(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function qw(t,e,n=!1){const i=t.children,s=e.children;if(ve(i)&&ve(s))for(let r=0;r<i.length;r++){const o=i[r];let a=s[r];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[r]=bs(s[r]),a.el=o.el),!n&&a.patchFlag!==-2&&qw(o,a)),a.type===Vh&&a.patchFlag!==-1&&(a.el=o.el),a.type===Bs&&!a.el&&(a.el=o.el)}}function IR(t){const e=t.slice(),n=[0];let i,s,r,o,a;const l=t.length;for(i=0;i<l;i++){const c=t[i];if(c!==0){if(s=n[n.length-1],t[s]<c){e[i]=s,n.push(i);continue}for(r=0,o=n.length-1;r<o;)a=r+o>>1,t[n[a]]<c?r=a+1:o=a;c<t[n[r]]&&(r>0&&(e[i]=n[r-1]),n[r]=i)}}for(r=n.length,o=n[r-1];r-- >0;)n[r]=o,o=e[o];return n}function Zw(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Zw(e)}function B_(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const PR=Symbol.for("v-scx"),MR=()=>Bc(PR);function Eo(t,e,n){return Jw(t,e,n)}function Jw(t,e,n=st){const{immediate:i,deep:s,flush:r,once:o}=n,a=bn({},n),l=e&&i||!e&&r!=="post";let c;if(ol){if(r==="sync"){const f=MR();c=f.__watcherHandles||(f.__watcherHandles=[])}else if(!l){const f=()=>{};return f.stop=Fi,f.resume=Fi,f.pause=Fi,f}}const h=xn;a.call=(f,g,m)=>Ni(f,h,g,m);let u=!1;r==="post"?a.scheduler=f=>{Bn(f,h&&h.suspense)}:r!=="sync"&&(u=!0,a.scheduler=(f,g)=>{g?f():tp(f)}),a.augmentJob=f=>{e&&(f.flags|=4),u&&(f.flags|=2,h&&(f.id=h.uid,f.i=h))};const d=V1(t,e,a);return ol&&(c?c.push(d):l&&d()),d}function FR(t,e,n){const i=this.proxy,s=Mt(t)?t.includes(".")?Qw(i,t):()=>i[t]:t.bind(i,i);let r;Oe(e)?r=e:(r=e.handler,n=e);const o=Dl(this),a=Jw(s,r.bind(i),n);return o(),a}function Qw(t,e){const n=e.split(".");return()=>{let i=t;for(let s=0;s<n.length&&i;s++)i=i[n[s]];return i}}const DR=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${ks(e)}Modifiers`]||t[`${Ys(e)}Modifiers`];function OR(t,e,...n){if(t.isUnmounted)return;const i=t.vnode.props||st;let s=n;const r=e.startsWith("update:"),o=r&&DR(i,e.slice(7));o&&(o.trim&&(s=n.map(h=>Mt(h)?h.trim():h)),o.number&&(s=n.map(Df)));let a,l=i[a=Bu(e)]||i[a=Bu(ks(e))];!l&&r&&(l=i[a=Bu(Ys(e))]),l&&Ni(l,t,6,s);const c=i[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Ni(c,t,6,s)}}function eS(t,e,n=!1){const i=e.emitsCache,s=i.get(t);if(s!==void 0)return s;const r=t.emits;let o={},a=!1;if(!Oe(t)){const l=c=>{const h=eS(c,e,!0);h&&(a=!0,bn(o,h))};!n&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!r&&!a?(_t(t)&&i.set(t,null),null):(ve(r)?r.forEach(l=>o[l]=null):bn(o,r),_t(t)&&i.set(t,o),o)}function Xh(t,e){return!t||!Nh(e)?!1:(e=e.slice(2).replace(/Once$/,""),et(t,e[0].toLowerCase()+e.slice(1))||et(t,Ys(e))||et(t,e))}function U_(t){const{type:e,vnode:n,proxy:i,withProxy:s,propsOptions:[r],slots:o,attrs:a,emit:l,render:c,renderCache:h,props:u,data:d,setupState:f,ctx:g,inheritAttrs:m}=t,p=ih(t);let y,_;try{if(n.shapeFlag&4){const E=s||i,w=E;y=Ai(c.call(w,E,h,u,f,d,g)),_=a}else{const E=e;y=Ai(E.length>1?E(u,{attrs:a,slots:o,emit:l}):E(u,null)),_=e.props?a:LR(a)}}catch(E){Ga.length=0,zh(E,t,1),y=oi(Bs)}let x=y;if(_&&m!==!1){const E=Object.keys(_),{shapeFlag:w}=x;E.length&&w&7&&(r&&E.some(Hg)&&(_=kR(_,r)),x=Io(x,_,!1,!0))}return n.dirs&&(x=Io(x,null,!1,!0),x.dirs=x.dirs?x.dirs.concat(n.dirs):n.dirs),n.transition&&np(x,n.transition),y=x,ih(p),y}const LR=t=>{let e;for(const n in t)(n==="class"||n==="style"||Nh(n))&&((e||(e={}))[n]=t[n]);return e},kR=(t,e)=>{const n={};for(const i in t)(!Hg(i)||!(i.slice(9)in e))&&(n[i]=t[i]);return n};function NR(t,e,n){const{props:i,children:s,component:r}=t,{props:o,children:a,patchFlag:l}=e,c=r.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return i?G_(i,o,c):!!o;if(l&8){const h=e.dynamicProps;for(let u=0;u<h.length;u++){const d=h[u];if(o[d]!==i[d]&&!Xh(c,d))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?G_(i,o,c):!0:!!o;return!1}function G_(t,e,n){const i=Object.keys(e);if(i.length!==Object.keys(t).length)return!0;for(let s=0;s<i.length;s++){const r=i[s];if(e[r]!==t[r]&&!Xh(n,r))return!0}return!1}function BR({vnode:t,parent:e},n){for(;e;){const i=e.subTree;if(i.suspense&&i.suspense.activeBranch===t&&(i.el=t.el),i===t)(t=e.vnode).el=n,e=e.parent;else break}}const tS=t=>t.__isSuspense;function UR(t,e){e&&e.pendingBranch?ve(t)?e.effects.push(...t):e.effects.push(t):Y1(t)}const on=Symbol.for("v-fgt"),Vh=Symbol.for("v-txt"),Bs=Symbol.for("v-cmt"),Xu=Symbol.for("v-stc"),Ga=[];let Xn=null;function it(t=!1){Ga.push(Xn=t?null:[])}function GR(){Ga.pop(),Xn=Ga[Ga.length-1]||null}let rl=1;function $_(t,e=!1){rl+=t,t<0&&Xn&&e&&(Xn.hasOnce=!0)}function nS(t){return t.dynamicChildren=rl>0?Xn||go:null,GR(),rl>0&&Xn&&Xn.push(t),t}function dt(t,e,n,i,s,r){return nS(de(t,e,n,i,s,r,!0))}function iS(t,e,n,i,s){return nS(oi(t,e,n,i,s,!0))}function sS(t){return t?t.__v_isVNode===!0:!1}function fa(t,e){return t.type===e.type&&t.key===e.key}const rS=({key:t})=>t??null,Uc=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?Mt(t)||cn(t)||Oe(t)?{i:ii,r:t,k:e,f:!!n}:t:null);function de(t,e=null,n=null,i=0,s=null,r=t===on?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&rS(e),ref:e&&Uc(e),scopeId:Fw,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:i,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:ii};return a?(rp(l,n),r&128&&t.normalize(l)):n&&(l.shapeFlag|=Mt(n)?8:16),rl>0&&!o&&Xn&&(l.patchFlag>0||r&6)&&l.patchFlag!==32&&Xn.push(l),l}const oi=$R;function $R(t,e=null,n=null,i=0,s=null,r=!1){if((!t||t===hR)&&(t=Bs),sS(t)){const a=Io(t,e,!0);return n&&rp(a,n),rl>0&&!r&&Xn&&(a.shapeFlag&6?Xn[Xn.indexOf(t)]=a:Xn.push(a)),a.patchFlag=-2,a}if(QR(t)&&(t=t.__vccOpts),e){e=jR(e);let{class:a,style:l}=e;a&&!Mt(a)&&(e.class=$h(a)),_t(l)&&(ep(l)&&!ve(l)&&(l=bn({},l)),e.style=Wg(l))}const o=Mt(t)?1:tS(t)?128:J1(t)?64:_t(t)?4:Oe(t)?2:0;return de(t,e,n,i,s,o,r,!0)}function jR(t){return t?ep(t)||Hw(t)?bn({},t):t:null}function Io(t,e,n=!1,i=!1){const{props:s,ref:r,patchFlag:o,children:a,transition:l}=t,c=e?HR(s||{},e):s,h={__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&rS(c),ref:e&&e.ref?n&&r?ve(r)?r.concat(Uc(e)):[r,Uc(e)]:Uc(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:a,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==on?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Io(t.ssContent),ssFallback:t.ssFallback&&Io(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&i&&np(h,l.clone(h)),h}function zR(t=" ",e=0){return oi(Vh,null,t,e)}function vi(t="",e=!1){return e?(it(),iS(Bs,null,t)):oi(Bs,null,t)}function Ai(t){return t==null||typeof t=="boolean"?oi(Bs):ve(t)?oi(on,null,t.slice()):sS(t)?bs(t):oi(Vh,null,String(t))}function bs(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Io(t)}function rp(t,e){let n=0;const{shapeFlag:i}=t;if(e==null)e=null;else if(ve(e))n=16;else if(typeof e=="object")if(i&65){const s=e.default;s&&(s._c&&(s._d=!1),rp(t,s()),s._c&&(s._d=!0));return}else{n=32;const s=e._;!s&&!Hw(e)?e._ctx=ii:s===3&&ii&&(ii.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Oe(e)?(e={default:e,_ctx:ii},n=32):(e=String(e),i&64?(n=16,e=[zR(e)]):n=8);t.children=e,t.shapeFlag|=n}function HR(...t){const e={};for(let n=0;n<t.length;n++){const i=t[n];for(const s in i)if(s==="class")e.class!==i.class&&(e.class=$h([e.class,i.class]));else if(s==="style")e.style=Wg([e.style,i.style]);else if(Nh(s)){const r=e[s],o=i[s];o&&r!==o&&!(ve(r)&&r.includes(o))&&(e[s]=r?[].concat(r,o):o)}else s!==""&&(e[s]=i[s])}return e}function Ei(t,e,n,i=null){Ni(t,e,7,[n,i])}const XR=$w();let VR=0;function WR(t,e,n){const i=t.type,s=(e?e.appContext:t.appContext)||XR,r={uid:VR++,vnode:t,type:i,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new _1(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Vw(i,s),emitsOptions:eS(i,s),emit:null,emitted:null,propsDefaults:st,inheritAttrs:i.inheritAttrs,ctx:st,data:st,props:st,attrs:st,slots:st,refs:st,setupState:st,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=e?e.root:r,r.emit=OR.bind(null,r),t.ce&&t.ce(r),r}let xn=null;const KR=()=>xn||ii;let rh,jf;{const t=Gh(),e=(n,i)=>{let s;return(s=t[n])||(s=t[n]=[]),s.push(i),r=>{s.length>1?s.forEach(o=>o(r)):s[0](r)}};rh=e("__VUE_INSTANCE_SETTERS__",n=>xn=n),jf=e("__VUE_SSR_SETTERS__",n=>ol=n)}const Dl=t=>{const e=xn;return rh(t),t.scope.on(),()=>{t.scope.off(),rh(e)}},j_=()=>{xn&&xn.scope.off(),rh(null)};function oS(t){return t.vnode.shapeFlag&4}let ol=!1;function YR(t,e=!1,n=!1){e&&jf(e);const{props:i,children:s}=t.vnode,r=oS(t);xR(t,i,r,e),bR(t,s,n||e);const o=r?qR(t,e):void 0;return e&&jf(!1),o}function qR(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,uR);const{setup:i}=n;if(i){rs();const s=t.setupContext=i.length>1?JR(t):null,r=Dl(t),o=Fl(i,t,0,[t.props,s]),a=iw(o);if(os(),r(),(a||t.sp)&&!Ba(t)&&Dw(t),a){if(o.then(j_,j_),e)return o.then(l=>{z_(t,l)}).catch(l=>{zh(l,t,0)});t.asyncDep=o}else z_(t,o)}else aS(t)}function z_(t,e,n){Oe(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:_t(e)&&(t.setupState=Rw(e)),aS(t)}function aS(t,e,n){const i=t.type;t.render||(t.render=i.render||Fi);{const s=Dl(t);rs();try{dR(t)}finally{os(),s()}}}const ZR={get(t,e){return rn(t,"get",""),t[e]}};function JR(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,ZR),slots:t.slots,emit:t.emit,expose:e}}function Wh(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Rw(B1(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Ua)return Ua[n](t)},has(e,n){return n in e||n in Ua}})):t.proxy}function QR(t){return Oe(t)&&"__vccOpts"in t}const or=(t,e)=>H1(t,e,ol),ev="3.5.20";/**
* @vue/runtime-dom v3.5.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let zf;const H_=typeof window<"u"&&window.trustedTypes;if(H_)try{zf=H_.createPolicy("vue",{createHTML:t=>t})}catch{}const lS=zf?t=>zf.createHTML(t):t=>t,tv="http://www.w3.org/2000/svg",nv="http://www.w3.org/1998/Math/MathML",Yi=typeof document<"u"?document:null,X_=Yi&&Yi.createElement("template"),iv={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,i)=>{const s=e==="svg"?Yi.createElementNS(tv,t):e==="mathml"?Yi.createElementNS(nv,t):n?Yi.createElement(t,{is:n}):Yi.createElement(t);return t==="select"&&i&&i.multiple!=null&&s.setAttribute("multiple",i.multiple),s},createText:t=>Yi.createTextNode(t),createComment:t=>Yi.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Yi.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,i,s,r){const o=n?n.previousSibling:e.lastChild;if(s&&(s===r||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),n),!(s===r||!(s=s.nextSibling)););else{X_.innerHTML=lS(i==="svg"?`<svg>${t}</svg>`:i==="mathml"?`<math>${t}</math>`:t);const a=X_.content;if(i==="svg"||i==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},sv=Symbol("_vtc");function rv(t,e,n){const i=t[sv];i&&(e=(e?[e,...i]:[...i]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const oh=Symbol("_vod"),cS=Symbol("_vsh"),ov={name:"show",beforeMount(t,{value:e},{transition:n}){t[oh]=t.style.display==="none"?"":t.style.display,n&&e?n.beforeEnter(t):ga(t,e)},mounted(t,{value:e},{transition:n}){n&&e&&n.enter(t)},updated(t,{value:e,oldValue:n},{transition:i}){!e!=!n&&(i?e?(i.beforeEnter(t),ga(t,!0),i.enter(t)):i.leave(t,()=>{ga(t,!1)}):ga(t,e))},beforeUnmount(t,{value:e}){ga(t,e)}};function ga(t,e){t.style.display=e?t[oh]:"none",t[cS]=!e}const av=Symbol(""),lv=/(^|;)\s*display\s*:/;function cv(t,e,n){const i=t.style,s=Mt(n);let r=!1;if(n&&!s){if(e)if(Mt(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();n[a]==null&&Gc(i,a,"")}else for(const o in e)n[o]==null&&Gc(i,o,"");for(const o in n)o==="display"&&(r=!0),Gc(i,o,n[o])}else if(s){if(e!==n){const o=i[av];o&&(n+=";"+o),i.cssText=n,r=lv.test(n)}}else e&&t.removeAttribute("style");oh in t&&(t[oh]=r?i.display:"",t[cS]&&(i.display="none"))}const V_=/\s*!important$/;function Gc(t,e,n){if(ve(n))n.forEach(i=>Gc(t,e,i));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const i=hv(t,e);V_.test(n)?t.setProperty(Ys(i),n.replace(V_,""),"important"):t[i]=n}}const W_=["Webkit","Moz","ms"],Vu={};function hv(t,e){const n=Vu[e];if(n)return n;let i=ks(e);if(i!=="filter"&&i in t)return Vu[e]=i;i=ow(i);for(let s=0;s<W_.length;s++){const r=W_[s]+i;if(r in t)return Vu[e]=r}return e}const K_="http://www.w3.org/1999/xlink";function Y_(t,e,n,i,s,r=m1(e)){i&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(K_,e.slice(6,e.length)):t.setAttributeNS(K_,e,n):n==null||r&&!lw(n)?t.removeAttribute(e):t.setAttribute(e,r?"":Ks(n)?String(n):n)}function q_(t,e,n,i,s){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?lS(n):n);return}const r=t.tagName;if(e==="value"&&r!=="PROGRESS"&&!r.includes("-")){const a=r==="OPTION"?t.getAttribute("value")||"":t.value,l=n==null?t.type==="checkbox"?"on":"":String(n);(a!==l||!("_value"in t))&&(t.value=l),n==null&&t.removeAttribute(e),t._value=n;return}let o=!1;if(n===""||n==null){const a=typeof t[e];a==="boolean"?n=lw(n):n==null&&a==="string"?(n="",o=!0):a==="number"&&(n=0,o=!0)}try{t[e]=n}catch{}o&&t.removeAttribute(s||e)}function Qr(t,e,n,i){t.addEventListener(e,n,i)}function uv(t,e,n,i){t.removeEventListener(e,n,i)}const Z_=Symbol("_vei");function dv(t,e,n,i,s=null){const r=t[Z_]||(t[Z_]={}),o=r[e];if(i&&o)o.value=i;else{const[a,l]=fv(e);if(i){const c=r[e]=mv(i,s);Qr(t,a,c,l)}else o&&(uv(t,a,o,l),r[e]=void 0)}}const J_=/(?:Once|Passive|Capture)$/;function fv(t){let e;if(J_.test(t)){e={};let i;for(;i=t.match(J_);)t=t.slice(0,t.length-i[0].length),e[i[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Ys(t.slice(2)),e]}let Wu=0;const gv=Promise.resolve(),pv=()=>Wu||(gv.then(()=>Wu=0),Wu=Date.now());function mv(t,e){const n=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=n.attached)return;Ni(_v(i,n.value),e,5,[i])};return n.value=t,n.attached=pv(),n}function _v(t,e){if(ve(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(i=>s=>!s._stopped&&i&&i(s))}else return e}const Q_=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,yv=(t,e,n,i,s,r)=>{const o=s==="svg";e==="class"?rv(t,i,o):e==="style"?cv(t,n,i):Nh(e)?Hg(e)||dv(t,e,n,i,r):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Ev(t,e,i,o))?(q_(t,e,i),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Y_(t,e,i,o,r,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Mt(i))?q_(t,ks(e),i,r,e):(e==="true-value"?t._trueValue=i:e==="false-value"&&(t._falseValue=i),Y_(t,e,i,o))};function Ev(t,e,n,i){if(i)return!!(e==="innerHTML"||e==="textContent"||e in t&&Q_(e)&&Oe(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=t.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Q_(e)&&Mt(n)?!1:e in t}const e0=t=>{const e=t.props["onUpdate:modelValue"]||!1;return ve(e)?n=>kc(e,n):e};function xv(t){t.target.composing=!0}function t0(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Ku=Symbol("_assign"),eo={created(t,{modifiers:{lazy:e,trim:n,number:i}},s){t[Ku]=e0(s);const r=i||s.props&&s.props.type==="number";Qr(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;n&&(a=a.trim()),r&&(a=Df(a)),t[Ku](a)}),n&&Qr(t,"change",()=>{t.value=t.value.trim()}),e||(Qr(t,"compositionstart",xv),Qr(t,"compositionend",t0),Qr(t,"change",t0))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:n,modifiers:{lazy:i,trim:s,number:r}},o){if(t[Ku]=e0(o),t.composing)return;const a=(r||t.type==="number")&&!/^0\d/.test(t.value)?Df(t.value):t.value,l=e??"";a!==l&&(document.activeElement===t&&t.type!=="range"&&(i&&e===n||s&&t.value.trim()===l)||(t.value=l))}},wv=["ctrl","shift","alt","meta"],Sv={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>wv.some(n=>t[`${n}Key`]&&!e.includes(n))},Cv=(t,e)=>{const n=t._withMods||(t._withMods={}),i=e.join(".");return n[i]||(n[i]=(s,...r)=>{for(let o=0;o<e.length;o++){const a=Sv[e[o]];if(a&&a(s,e))return}return t(s,...r)})},bv={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Tv=(t,e)=>{const n=t._withKeys||(t._withKeys={}),i=e.join(".");return n[i]||(n[i]=s=>{if(!("key"in s))return;const r=Ys(s.key);if(e.some(o=>o===r||bv[o]===r))return t(s)})},Rv=bn({patchProp:yv},iv);let n0;function vv(){return n0||(n0=RR(Rv))}const Av=(...t)=>{const e=vv().createApp(...t),{mount:n}=e;return e.mount=i=>{const s=Pv(i);if(!s)return;const r=e._component;!Oe(r)&&!r.render&&!r.template&&(r.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const o=n(s,!1,Iv(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function Iv(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Pv(t){return Mt(t)?document.querySelector(t):t}const Mv=t=>({setHttpHandler(e){t.httpHandler=e},httpHandler(){return t.httpHandler},updateHttpClientConfig(e,n){t.httpHandler?.updateHttpClientConfig(e,n)},httpHandlerConfigs(){return t.httpHandler.httpHandlerConfigs()}}),Fv=t=>({httpHandler:t.httpHandler()});var i0;(function(t){t.HEADER="header",t.QUERY="query"})(i0||(i0={}));var s0;(function(t){t.HEADER="header",t.QUERY="query"})(s0||(s0={}));var al;(function(t){t.HTTP="http",t.HTTPS="https"})(al||(al={}));var ah;(function(t){t.MD5="md5",t.CRC32="crc32",t.CRC32C="crc32c",t.SHA1="sha1",t.SHA256="sha256"})(ah||(ah={}));var r0;(function(t){t[t.HEADER=0]="HEADER",t[t.TRAILER=1]="TRAILER"})(r0||(r0={}));const Hf="__smithy_context";var o0;(function(t){t.PROFILE="profile",t.SSO_SESSION="sso-session",t.SERVICES="services"})(o0||(o0={}));var a0;(function(t){t.HTTP_0_9="http/0.9",t.HTTP_1_0="http/1.0",t.TDS_8_0="tds/8.0"})(a0||(a0={}));class Ft{constructor(e){this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?e.protocol.slice(-1)!==":"?`${e.protocol}:`:e.protocol:"https:",this.path=e.path?e.path.charAt(0)!=="/"?`/${e.path}`:e.path:"/",this.username=e.username,this.password=e.password,this.fragment=e.fragment}static clone(e){const n=new Ft({...e,headers:{...e.headers}});return n.query&&(n.query=Dv(n.query)),n}static isInstance(e){if(!e)return!1;const n=e;return"method"in n&&"protocol"in n&&"hostname"in n&&"path"in n&&typeof n.query=="object"&&typeof n.headers=="object"}clone(){return Ft.clone(this)}}function Dv(t){return Object.keys(t).reduce((e,n)=>{const i=t[n];return{...e,[n]:Array.isArray(i)?[...i]:i}},{})}let Rr=class{constructor(e){this.statusCode=e.statusCode,this.reason=e.reason,this.headers=e.headers||{},this.body=e.body}static isInstance(e){if(!e)return!1;const n=e;return typeof n.statusCode=="number"&&typeof n.headers=="object"}};function Ov(t){return e=>async n=>{const{request:i}=n;return Ft.isInstance(i)&&i.body&&t.runtime==="node"&&t.requestHandler?.constructor?.name!=="FetchHttpHandler"&&(i.headers={...i.headers,Expect:"100-continue"}),e({...n,request:i})}}const Lv={step:"build",tags:["SET_EXPECT_HEADER","EXPECT_HEADER"],name:"addExpectContinueMiddleware",override:!0},kv=t=>({applyToStack:e=>{e.add(Ov(t),Lv)}}),Po={WHEN_SUPPORTED:"WHEN_SUPPORTED",WHEN_REQUIRED:"WHEN_REQUIRED"},Nv=Po.WHEN_SUPPORTED,Yu={WHEN_SUPPORTED:"WHEN_SUPPORTED",WHEN_REQUIRED:"WHEN_REQUIRED"},Bv=Po.WHEN_SUPPORTED;var ot;(function(t){t.MD5="MD5",t.CRC32="CRC32",t.CRC32C="CRC32C",t.CRC64NVME="CRC64NVME",t.SHA1="SHA1",t.SHA256="SHA256"})(ot||(ot={}));var l0;(function(t){t.HEADER="header",t.TRAILER="trailer"})(l0||(l0={}));const Xf=ot.CRC32;var c0;(function(t){t.ENV="env",t.CONFIG="shared config entry"})(c0||(c0={}));function Uv(t,e,n){return t.$source||(t.$source={}),t.$source[e]=n,t}function Rt(t,e,n){t.__aws_sdk_context?t.__aws_sdk_context.features||(t.__aws_sdk_context.features={}):t.__aws_sdk_context={features:{}},t.__aws_sdk_context.features[e]=n}const h0=t=>Rr.isInstance(t)?t.headers?.date??t.headers?.Date:void 0,op=t=>new Date(Date.now()+t),Gv=(t,e)=>Math.abs(op(e).getTime()-t)>=3e5,u0=(t,e)=>{const n=Date.parse(t);return Gv(n,e)?n-Date.now():e},$a=(t,e)=>{if(!e)throw new Error(`Property \`${t}\` is not resolved for AWS SDK SigV4Auth`);return e},hS=async t=>{const e=$a("context",t.context),n=$a("config",t.config),i=e.endpointV2?.properties?.authSchemes?.[0],r=await $a("signer",n.signer)(i),o=t?.signingRegion,a=t?.signingRegionSet,l=t?.signingName;return{config:n,signer:r,signingRegion:o,signingRegionSet:a,signingName:l}};class uS{async sign(e,n,i){if(!Ft.isInstance(e))throw new Error("The request is not an instance of `HttpRequest` and cannot be signed");const s=await hS(i),{config:r,signer:o}=s;let{signingRegion:a,signingName:l}=s;const c=i.context;if(c?.authSchemes?.length??!1){const[u,d]=c.authSchemes;u?.name==="sigv4a"&&d?.name==="sigv4"&&(a=d?.signingRegion??a,l=d?.signingName??l)}return await o.sign(e,{signingDate:op(r.systemClockOffset),signingRegion:a,signingService:l})}errorHandler(e){return n=>{const i=n.ServerTime??h0(n.$response);if(i){const s=$a("config",e.config),r=s.systemClockOffset;s.systemClockOffset=u0(i,s.systemClockOffset),s.systemClockOffset!==r&&n.$metadata&&(n.$metadata.clockSkewCorrected=!0)}throw n}}successHandler(e,n){const i=h0(e);if(i){const s=$a("config",n.config);s.systemClockOffset=u0(i,s.systemClockOffset)}}}class $v extends uS{async sign(e,n,i){if(!Ft.isInstance(e))throw new Error("The request is not an instance of `HttpRequest` and cannot be signed");const{config:s,signer:r,signingRegion:o,signingRegionSet:a,signingName:l}=await hS(i),h=(await s.sigv4aSigningRegionSet?.()??a??[o]).join(",");return await r.sign(e,{signingDate:op(s.systemClockOffset),signingRegion:h,signingService:l})}}const Wo=t=>t[Hf]||(t[Hf]={}),pi=t=>{if(typeof t=="function")return t;const e=Promise.resolve(t);return()=>e},jv=(t,e)=>{if(!e||e.length===0)return t;const n=[];for(const i of e)for(const s of t)s.schemeId.split("#")[1]===i&&n.push(s);for(const i of t)n.find(({schemeId:s})=>s===i.schemeId)||n.push(i);return n};function zv(t){const e=new Map;for(const n of t)e.set(n.schemeId,n);return e}const Hv=(t,e)=>(n,i)=>async s=>{const r=t.httpAuthSchemeProvider(await e.httpAuthSchemeParametersProvider(t,i,s.input)),o=t.authSchemePreference?await t.authSchemePreference():[],a=jv(r,o),l=zv(t.httpAuthSchemes),c=Wo(i),h=[];for(const u of a){const d=l.get(u.schemeId);if(!d){h.push(`HttpAuthScheme \`${u.schemeId}\` was not enabled for this service.`);continue}const f=d.identityProvider(await e.identityProviderConfigProvider(t));if(!f){h.push(`HttpAuthScheme \`${u.schemeId}\` did not have an IdentityProvider configured.`);continue}const{identityProperties:g={},signingProperties:m={}}=u.propertiesExtractor?.(t,i)||{};u.identityProperties=Object.assign(u.identityProperties||{},g),u.signingProperties=Object.assign(u.signingProperties||{},m),c.selectedHttpAuthScheme={httpAuthOption:u,identity:await f(u.identityProperties),signer:d.signer};break}if(!c.selectedHttpAuthScheme)throw new Error(h.join(`
`));return n(s)},Xv={step:"serialize",tags:["HTTP_AUTH_SCHEME"],name:"httpAuthSchemeMiddleware",override:!0,relation:"before",toMiddleware:"endpointV2Middleware"},Vv=(t,{httpAuthSchemeParametersProvider:e,identityProviderConfigProvider:n})=>({applyToStack:i=>{i.addRelativeTo(Hv(t,{httpAuthSchemeParametersProvider:e,identityProviderConfigProvider:n}),Xv)}}),Wv=(t,e)=>(n,i)=>async s=>{const{response:r}=await n(s);try{const o=await e(r,t);return{response:r,output:o}}catch(o){if(Object.defineProperty(o,"$response",{value:r}),!("$metadata"in o)){const a="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";try{o.message+=`
  `+a}catch{!i.logger||i.logger?.constructor?.name==="NoOpLogger"?console.warn(a):i.logger?.warn?.(a)}typeof o.$responseBodyText<"u"&&o.$response&&(o.$response.body=o.$responseBodyText);try{if(Rr.isInstance(r)){const{headers:l={}}=r,c=Object.entries(l);o.$metadata={httpStatusCode:r.statusCode,requestId:qu(/^x-[\w-]+-request-?id$/,c),extendedRequestId:qu(/^x-[\w-]+-id-2$/,c),cfId:qu(/^x-[\w-]+-cf-id$/,c)}}}catch{}}throw o}},qu=(t,e)=>(e.find(([n])=>n.match(t))||[void 0,void 0])[1],Kv=(t,e)=>(n,i)=>async s=>{const r=t,o=i.endpointV2?.url&&r.urlParser?async()=>r.urlParser(i.endpointV2.url):r.endpoint;if(!o)throw new Error("No valid endpoint provider available.");const a=await e(s.input,{...t,endpoint:o});return n({...s,request:a})},Yv={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},dS={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function Kh(t,e,n){return{applyToStack:i=>{i.add(Wv(t,n),Yv),i.add(Kv(t,e),dS)}}}const qv=t=>e=>{throw e},Zv=(t,e)=>{},Jv=t=>(e,n)=>async i=>{if(!Ft.isInstance(i.request))return e(i);const r=Wo(n).selectedHttpAuthScheme;if(!r)throw new Error("No HttpAuthScheme was selected: unable to sign request");const{httpAuthOption:{signingProperties:o={}},identity:a,signer:l}=r,c=await e({...i,request:await l.sign(i.request,a,o)}).catch((l.errorHandler||qv)(o));return(l.successHandler||Zv)(c.response,o),c},fS={step:"finalizeRequest",tags:["HTTP_SIGNING"],name:"httpSigningMiddleware",aliases:["apiKeyMiddleware","tokenMiddleware","awsAuthMiddleware"],override:!0,relation:"after",toMiddleware:"retryMiddleware"},Qv=t=>({applyToStack:e=>{e.addRelativeTo(Jv(),fS)}}),xo=t=>{if(typeof t=="function")return t;const e=Promise.resolve(t);return()=>e},Us={},Ko=new Array(64);for(let t=0,e=65,n=90;t+e<=n;t++){const i=String.fromCharCode(t+e);Us[i]=t,Ko[t]=i}for(let t=0,e=97,n=122;t+e<=n;t++){const i=String.fromCharCode(t+e),s=t+26;Us[i]=s,Ko[s]=i}for(let t=0;t<10;t++){Us[t.toString(10)]=t+52;const e=t.toString(10),n=t+52;Us[e]=n,Ko[n]=e}Us["+"]=62;Ko[62]="+";Us["/"]=63;Ko[63]="/";const wo=6,ja=8,eA=63,ap=t=>{let e=t.length/4*3;t.slice(-2)==="=="?e-=2:t.slice(-1)==="="&&e--;const n=new ArrayBuffer(e),i=new DataView(n);for(let s=0;s<t.length;s+=4){let r=0,o=0;for(let c=s,h=s+3;c<=h;c++)if(t[c]!=="="){if(!(t[c]in Us))throw new TypeError(`Invalid character ${t[c]} in base64 string.`);r|=Us[t[c]]<<(h-c)*wo,o+=wo}else r>>=wo;const a=s/4*3;r>>=o%ja;const l=Math.floor(o/ja);for(let c=0;c<l;c++){const h=(l-c-1)*ja;i.setUint8(a+c,(r&255<<h)>>h)}}return new Uint8Array(n)},vr=t=>new TextEncoder().encode(t),Mo=t=>typeof t=="string"?vr(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t),lp=t=>{if(typeof t=="string")return t;if(typeof t!="object"||typeof t.byteOffset!="number"||typeof t.byteLength!="number")throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return new TextDecoder("utf-8").decode(t)};function Yh(t){let e;typeof t=="string"?e=vr(t):e=t;const n=typeof e=="object"&&typeof e.length=="number",i=typeof e=="object"&&typeof e.byteOffset=="number"&&typeof e.byteLength=="number";if(!n&&!i)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");let s="";for(let r=0;r<e.length;r+=3){let o=0,a=0;for(let c=r,h=Math.min(r+3,e.length);c<h;c++)o|=e[c]<<(h-c-1)*ja,a+=ja;const l=Math.ceil(a/wo);o<<=l*wo-a;for(let c=1;c<=l;c++){const h=(l-c)*wo;s+=Ko[(o&eA<<h)>>h]}s+="==".slice(0,4-l)}return s}function tA(t,e="utf-8"){return e==="base64"?Yh(t):lp(t)}function nA(t,e){return e==="base64"?wr.mutate(ap(t)):wr.mutate(vr(t))}class wr extends Uint8Array{static fromString(e,n="utf-8"){switch(typeof e){case"string":return nA(e,n);default:throw new Error(`Unsupported conversion from ${typeof e} to Uint8ArrayBlobAdapter.`)}}static mutate(e){return Object.setPrototypeOf(e,wr.prototype),e}transformToString(e="utf-8"){return tA(this,e)}}const iA=typeof ReadableStream=="function"?ReadableStream:function(){};class sA extends iA{}const Vf=t=>typeof ReadableStream=="function"&&(t?.constructor?.name===ReadableStream.name||t instanceof ReadableStream),rA=({expectedChecksum:t,checksum:e,source:n,checksumSourceLocation:i,base64Encoder:s})=>{if(!Vf(n))throw new Error(`@smithy/util-stream: unsupported source type ${n?.constructor?.name??n} in ChecksumStream.`);const r=s??Yh;if(typeof TransformStream!="function")throw new Error("@smithy/util-stream: unable to instantiate ChecksumStream because API unavailable: ReadableStream/TransformStream.");const o=new TransformStream({start(){},async transform(l,c){e.update(l),c.enqueue(l)},async flush(l){const c=await e.digest(),h=r(c);if(t!==h){const u=new Error(`Checksum mismatch: expected "${t}" but received "${h}" in response header "${i}".`);l.error(u)}else l.terminate()}});n.pipeThrough(o);const a=o.readable;return Object.setPrototypeOf(a,sA.prototype),a};class oA{constructor(e){this.allocByteArray=e,this.byteLength=0,this.byteArrays=[]}push(e){this.byteArrays.push(e),this.byteLength+=e.byteLength}flush(){if(this.byteArrays.length===1){const i=this.byteArrays[0];return this.reset(),i}const e=this.allocByteArray(this.byteLength);let n=0;for(let i=0;i<this.byteArrays.length;++i){const s=this.byteArrays[i];e.set(s,n),n+=s.byteLength}return this.reset(),e}reset(){this.byteArrays=[],this.byteLength=0}}function aA(t,e,n){const i=t.getReader();let s=!1,r=0;const o=["",new oA(c=>new Uint8Array(c))];let a=-1;const l=async c=>{const{value:h,done:u}=await i.read(),d=h;if(u){if(a!==-1){const f=Zu(o,a);za(f)>0&&c.enqueue(f)}c.close()}else{const f=hA(d,!1);if(a!==f&&(a>=0&&c.enqueue(Zu(o,a)),a=f),a===-1){c.enqueue(d);return}const g=za(d);r+=g;const m=za(o[a]);if(g>=e&&m===0)c.enqueue(d);else{const p=cA(o,a,d);!s&&r>e*2&&(s=!0,n?.warn(`@smithy/util-stream - stream chunk size ${g} is below threshold of ${e}, automatically buffering.`)),p>=e?c.enqueue(Zu(o,a)):await l(c)}}};return new ReadableStream({pull:l})}const lA=aA;function cA(t,e,n){switch(e){case 0:return t[0]+=n,za(t[0]);case 1:case 2:return t[e].push(n),za(t[e])}}function Zu(t,e){switch(e){case 0:const n=t[0];return t[0]="",n;case 1:case 2:return t[e].flush()}throw new Error(`@smithy/util-stream - invalid index ${e} given to flush()`)}function za(t){return t?.byteLength??t?.length??0}function hA(t,e=!0){return e&&typeof Buffer<"u"&&t instanceof Buffer?2:t instanceof Uint8Array?1:typeof t=="string"?0:-1}const uA=(t,e)=>{const{base64Encoder:n,bodyLengthChecker:i,checksumAlgorithmFn:s,checksumLocationName:r,streamHasher:o}=e,a=n!==void 0&&i!==void 0&&s!==void 0&&r!==void 0&&o!==void 0,l=a?o(s,t):void 0,c=t.getReader();return new ReadableStream({async pull(h){const{value:u,done:d}=await c.read();if(d){if(h.enqueue(`0\r
`),a){const f=n(await l);h.enqueue(`${r}:${f}\r
`),h.enqueue(`\r
`)}h.close()}else h.enqueue(`${(i(u)||0).toString(16)}\r
${u}\r
`)}})};async function dA(t,e){let n=0;const i=[],s=t.getReader();let r=!1;for(;!r;){const{done:l,value:c}=await s.read();if(c&&(i.push(c),n+=c?.byteLength??0),n>=e)break;r=l}s.releaseLock();const o=new Uint8Array(Math.min(e,n));let a=0;for(const l of i){if(l.byteLength>o.byteLength-a){o.set(l.subarray(0,o.byteLength-a),a);break}else o.set(l,a);a+=l.length}return o}const Sr=t=>encodeURIComponent(t).replace(/[!'()*]/g,fA),fA=t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`;function gA(t){const e=[];for(let n of Object.keys(t).sort()){const i=t[n];if(n=Sr(n),Array.isArray(i))for(let s=0,r=i.length;s<r;s++)e.push(`${n}=${Sr(i[s])}`);else{let s=n;(i||typeof i=="string")&&(s+=`=${Sr(i)}`),e.push(s)}}return e.join("&")}function d0(t,e){return new Request(t,e)}function pA(t=0){return new Promise((e,n)=>{t&&setTimeout(()=>{const i=new Error(`Request did not complete within ${t} ms`);i.name="TimeoutError",n(i)},t)})}const Ju={supported:void 0};class cp{static create(e){return typeof e?.handle=="function"?e:new cp(e)}constructor(e){typeof e=="function"?this.configProvider=e().then(n=>n||{}):(this.config=e??{},this.configProvider=Promise.resolve(this.config)),Ju.supported===void 0&&(Ju.supported=typeof Request<"u"&&"keepalive"in d0("https://[::1]"))}destroy(){}async handle(e,{abortSignal:n,requestTimeout:i}={}){this.config||(this.config=await this.configProvider);const s=i??this.config.requestTimeout,r=this.config.keepAlive===!0,o=this.config.credentials;if(n?.aborted){const _=new Error("Request aborted");return _.name="AbortError",Promise.reject(_)}let a=e.path;const l=gA(e.query||{});l&&(a+=`?${l}`),e.fragment&&(a+=`#${e.fragment}`);let c="";if(e.username!=null||e.password!=null){const _=e.username??"",x=e.password??"";c=`${_}:${x}@`}const{port:h,method:u}=e,d=`${e.protocol}//${c}${e.hostname}${h?`:${h}`:""}${a}`,f=u==="GET"||u==="HEAD"?void 0:e.body,g={body:f,headers:new Headers(e.headers),method:u,credentials:o};this.config?.cache&&(g.cache=this.config.cache),f&&(g.duplex="half"),typeof AbortController<"u"&&(g.signal=n),Ju.supported&&(g.keepalive=r),typeof this.config.requestInit=="function"&&Object.assign(g,this.config.requestInit(e));let m=()=>{};const p=d0(d,g),y=[fetch(p).then(_=>{const x=_.headers,E={};for(const b of x.entries())E[b[0]]=b[1];return _.body!=null?{response:new Rr({headers:E,reason:_.statusText,statusCode:_.status,body:_.body})}:_.blob().then(b=>({response:new Rr({headers:E,reason:_.statusText,statusCode:_.status,body:b})}))}),pA(s)];return n&&y.push(new Promise((_,x)=>{const E=()=>{const w=new Error("Request aborted");w.name="AbortError",x(w)};if(typeof n.addEventListener=="function"){const w=n;w.addEventListener("abort",E,{once:!0}),m=()=>w.removeEventListener("abort",E)}else n.onabort=E})),Promise.race(y).finally(m)}updateHttpClientConfig(e,n){this.config=void 0,this.configProvider=this.configProvider.then(i=>(i[e]=n,i))}httpHandlerConfigs(){return this.config??{}}}const gS=async t=>typeof Blob=="function"&&t instanceof Blob||t.constructor?.name==="Blob"?Blob.prototype.arrayBuffer!==void 0?new Uint8Array(await t.arrayBuffer()):mA(t):_A(t);async function mA(t){const e=await yA(t),n=ap(e);return new Uint8Array(n)}async function _A(t){const e=[],n=t.getReader();let i=!1,s=0;for(;!i;){const{done:a,value:l}=await n.read();l&&(e.push(l),s+=l.length),i=a}const r=new Uint8Array(s);let o=0;for(const a of e)r.set(a,o),o+=a.length;return r}function yA(t){return new Promise((e,n)=>{const i=new FileReader;i.onloadend=()=>{if(i.readyState!==2)return n(new Error("Reader aborted too early"));const s=i.result??"",r=s.indexOf(","),o=r>-1?r+1:s.length;e(s.substring(o))},i.onabort=()=>n(new Error("Read aborted")),i.onerror=()=>n(i.error),i.readAsDataURL(t)})}const pS={},Wf={};for(let t=0;t<256;t++){let e=t.toString(16).toLowerCase();e.length===1&&(e=`0${e}`),pS[t]=e,Wf[e]=t}function mS(t){if(t.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const e=new Uint8Array(t.length/2);for(let n=0;n<t.length;n+=2){const i=t.slice(n,n+2).toLowerCase();if(i in Wf)e[n/2]=Wf[i];else throw new Error(`Cannot decode unrecognized sequence ${i} as hexadecimal`)}return e}function Dn(t){let e="";for(let n=0;n<t.byteLength;n++)e+=pS[t[n]];return e}const f0="The stream has already been transformed.",EA=t=>{if(!g0(t)&&!Vf(t)){const s=t?.__proto__?.constructor?.name||t;throw new Error(`Unexpected stream implementation, expect Blob or ReadableStream, got ${s}`)}let e=!1;const n=async()=>{if(e)throw new Error(f0);return e=!0,await gS(t)},i=s=>{if(typeof s.stream!="function")throw new Error(`Cannot transform payload Blob to web stream. Please make sure the Blob.stream() is polyfilled.
If you are using React Native, this API is not yet supported, see: https://react-native.canny.io/feature-requests/p/fetch-streaming-body`);return s.stream()};return Object.assign(t,{transformToByteArray:n,transformToString:async s=>{const r=await n();if(s==="base64")return Yh(r);if(s==="hex")return Dn(r);if(s===void 0||s==="utf8"||s==="utf-8")return lp(r);if(typeof TextDecoder=="function")return new TextDecoder(s).decode(r);throw new Error("TextDecoder is not available, please make sure polyfill is provided.")},transformToWebStream:()=>{if(e)throw new Error(f0);if(e=!0,g0(t))return i(t);if(Vf(t))return t;throw new Error(`Cannot transform payload to web stream, got ${t}`)}})},g0=t=>typeof Blob=="function"&&t instanceof Blob;async function xA(t){return typeof t.stream=="function"&&(t=t.stream()),t.tee()}const _S=async(t=new Uint8Array,e)=>{if(t instanceof Uint8Array)return wr.mutate(t);if(!t)return wr.mutate(new Uint8Array);const n=e.streamCollector(t);return wr.mutate(await n)};function p0(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}const Fo=t=>{switch(t){case"true":return!0;case"false":return!1;default:throw new Error(`Unable to parse boolean value "${t}"`)}},Kf=t=>{if(t!=null){if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return String(e)!==String(t)&&xS.warn(ES(`Expected number but observed string: ${t}`)),e}if(typeof t=="number")return t;throw new TypeError(`Expected number, got ${typeof t}: ${t}`)}},wA=Math.ceil(2**127*(2-2**-23)),m0=t=>{const e=Kf(t);if(e!==void 0&&!Number.isNaN(e)&&e!==1/0&&e!==-1/0&&Math.abs(e)>wA)throw new TypeError(`Expected 32-bit float, got ${t}`);return e},Yf=t=>{if(t!=null){if(Number.isInteger(t)&&!Number.isNaN(t))return t;throw new TypeError(`Expected integer, got ${typeof t}: ${t}`)}},_0=t=>hp(t,32),y0=t=>hp(t,16),E0=t=>hp(t,8),hp=(t,e)=>{const n=Yf(t);if(n!==void 0&&SA(n,e)!==n)throw new TypeError(`Expected ${e}-bit integer, got ${t}`);return n},SA=(t,e)=>{switch(e){case 32:return Int32Array.of(t)[0];case 16:return Int16Array.of(t)[0];case 8:return Int8Array.of(t)[0]}},Ps=(t,e)=>{if(t==null)throw e?new TypeError(`Expected a non-null value for ${e}`):new TypeError("Expected a non-null value");return t},yS=t=>{if(t==null)return;if(typeof t=="object"&&!Array.isArray(t))return t;const e=Array.isArray(t)?"array":typeof t;throw new TypeError(`Expected object, got ${e}: ${t}`)},At=t=>{if(t!=null){if(typeof t=="string")return t;if(["boolean","number","bigint"].includes(typeof t))return xS.warn(ES(`Expected string, got ${typeof t}: ${t}`)),String(t);throw new TypeError(`Expected string, got ${typeof t}: ${t}`)}},CA=t=>Kf(typeof t=="string"?Yo(t):t),bA=t=>m0(typeof t=="string"?Yo(t):t),TA=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,Yo=t=>{const e=t.match(TA);if(e===null||e[0].length!==t.length)throw new TypeError("Expected real number, got implicit NaN");return parseFloat(t)},up=t=>Yf(typeof t=="string"?Yo(t):t),Ha=t=>_0(typeof t=="string"?Yo(t):t),lh=t=>y0(typeof t=="string"?Yo(t):t),RA=t=>E0(typeof t=="string"?Yo(t):t),ES=t=>String(new TypeError(t).stack||t).split(`
`).slice(0,5).filter(e=>!e.includes("stackTraceWarning")).join(`
`),xS={warn:console.warn},vA=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dp=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function $c(t){const e=t.getUTCFullYear(),n=t.getUTCMonth(),i=t.getUTCDay(),s=t.getUTCDate(),r=t.getUTCHours(),o=t.getUTCMinutes(),a=t.getUTCSeconds(),l=s<10?`0${s}`:`${s}`,c=r<10?`0${r}`:`${r}`,h=o<10?`0${o}`:`${o}`,u=a<10?`0${a}`:`${a}`;return`${vA[i]}, ${l} ${dp[n]} ${e} ${c}:${h}:${u} GMT`}const AA=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?(([-+]\d{2}\:\d{2})|[zZ])$/),qh=t=>{if(t==null)return;if(typeof t!="string")throw new TypeError("RFC-3339 date-times must be expressed as strings");const e=AA.exec(t);if(!e)throw new TypeError("Invalid RFC-3339 date-time value");const[n,i,s,r,o,a,l,c,h]=e,u=lh(ll(i)),d=Ms(s,"month",1,12),f=Ms(r,"day",1,31),g=jc(u,d,f,{hours:o,minutes:a,seconds:l,fractionalMilliseconds:c});return h.toUpperCase()!="Z"&&g.setTime(g.getTime()-UA(h)),g},IA=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d{2}) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),PA=new RegExp(/^(?:Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d{2})-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? GMT$/),MA=new RegExp(/^(?:Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( [1-9]|\d{2}) (\d{1,2}):(\d{2}):(\d{2})(?:\.(\d+))? (\d{4})$/),qf=t=>{if(t==null)return;if(typeof t!="string")throw new TypeError("RFC-7231 date-times must be expressed as strings");let e=IA.exec(t);if(e){const[n,i,s,r,o,a,l,c]=e;return jc(lh(ll(r)),Qu(s),Ms(i,"day",1,31),{hours:o,minutes:a,seconds:l,fractionalMilliseconds:c})}if(e=PA.exec(t),e){const[n,i,s,r,o,a,l,c]=e;return OA(jc(FA(r),Qu(s),Ms(i,"day",1,31),{hours:o,minutes:a,seconds:l,fractionalMilliseconds:c}))}if(e=MA.exec(t),e){const[n,i,s,r,o,a,l,c]=e;return jc(lh(ll(c)),Qu(i),Ms(s.trimLeft(),"day",1,31),{hours:r,minutes:o,seconds:a,fractionalMilliseconds:l})}throw new TypeError("Invalid RFC-7231 date-time value")},A8=t=>{if(t==null)return;let e;if(typeof t=="number")e=t;else if(typeof t=="string")e=CA(t);else if(typeof t=="object"&&t.tag===1)e=t.value;else throw new TypeError("Epoch timestamps must be expressed as floating point numbers or their string representation");if(Number.isNaN(e)||e===1/0||e===-1/0)throw new TypeError("Epoch timestamps must be valid, non-Infinite, non-NaN numerics");return new Date(Math.round(e*1e3))},jc=(t,e,n,i)=>{const s=e-1;return kA(t,s,n),new Date(Date.UTC(t,s,n,Ms(i.hours,"hour",0,23),Ms(i.minutes,"minute",0,59),Ms(i.seconds,"seconds",0,60),BA(i.fractionalMilliseconds)))},FA=t=>{const e=new Date().getUTCFullYear(),n=Math.floor(e/100)*100+lh(ll(t));return n<e?n+100:n},DA=50*365*24*60*60*1e3,OA=t=>t.getTime()-new Date().getTime()>DA?new Date(Date.UTC(t.getUTCFullYear()-100,t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds())):t,Qu=t=>{const e=dp.indexOf(t);if(e<0)throw new TypeError(`Invalid month: ${t}`);return e+1},LA=[31,28,31,30,31,30,31,31,30,31,30,31],kA=(t,e,n)=>{let i=LA[e];if(e===1&&NA(t)&&(i=29),n>i)throw new TypeError(`Invalid day for ${dp[e]} in ${t}: ${n}`)},NA=t=>t%4===0&&(t%100!==0||t%400===0),Ms=(t,e,n,i)=>{const s=RA(ll(t));if(s<n||s>i)throw new TypeError(`${e} must be between ${n} and ${i}, inclusive`);return s},BA=t=>t==null?0:bA("0."+t)*1e3,UA=t=>{const e=t[0];let n=1;if(e=="+")n=1;else if(e=="-")n=-1;else throw new TypeError(`Offset direction, ${e}, must be "+" or "-"`);const i=Number(t.substring(1,3)),s=Number(t.substring(4,6));return n*(i*60+s)*60*1e3},ll=t=>{let e=0;for(;e<t.length-1&&t.charAt(e)==="0";)e++;return e===0?t:t.slice(e)};let ec;const GA=new Uint8Array(16);function $A(){if(!ec&&(ec=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ec))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ec(GA)}const Wt=[];for(let t=0;t<256;++t)Wt.push((t+256).toString(16).slice(1));function jA(t,e=0){return Wt[t[e+0]]+Wt[t[e+1]]+Wt[t[e+2]]+Wt[t[e+3]]+"-"+Wt[t[e+4]]+Wt[t[e+5]]+"-"+Wt[t[e+6]]+Wt[t[e+7]]+"-"+Wt[t[e+8]]+Wt[t[e+9]]+"-"+Wt[t[e+10]]+Wt[t[e+11]]+Wt[t[e+12]]+Wt[t[e+13]]+Wt[t[e+14]]+Wt[t[e+15]]}const zA=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),x0={randomUUID:zA};function HA(t,e,n){if(x0.randomUUID&&!t)return x0.randomUUID();t=t||{};const i=t.random||(t.rng||$A)();return i[6]=i[6]&15|64,i[8]=i[8]&63|128,jA(i)}function XA(t){return(t.includes(",")||t.includes('"'))&&(t=`"${t.replace(/"/g,'\\"')}"`),t}const VA=(t,e,n,i,s,r)=>{if(e!=null&&e[n]!==void 0){const o=i();if(o.length<=0)throw new Error("Empty value provided for input HTTP label: "+n+".");t=t.replace(s,r?o.split("/").map(a=>p0(a)).join("/"):p0(o))}else throw new Error("No value provided for input HTTP label: "+n+".");return t};function Zh(t,e){return new WA(t,e)}class WA{constructor(e,n){this.input=e,this.context=n,this.query={},this.method="",this.headers={},this.path="",this.body=null,this.hostname="",this.resolvePathStack=[]}async build(){const{hostname:e,protocol:n="https",port:i,path:s}=await this.context.endpoint();this.path=s;for(const r of this.resolvePathStack)r(this.path);return new Ft({protocol:n,hostname:this.hostname||e,port:i,method:this.method,path:this.path,query:this.query,body:this.body,headers:this.headers})}hn(e){return this.hostname=e,this}bp(e){return this.resolvePathStack.push(n=>{this.path=`${n?.endsWith("/")?n.slice(0,-1):n||""}`+e}),this}p(e,n,i,s){return this.resolvePathStack.push(r=>{this.path=VA(r,this.input,e,n,i,s)}),this}h(e){return this.headers=e,this}q(e){return this.query=e,this}b(e){return this.body=e,this}m(e){return this.method=e,this}}function KA(t,e,n){t.__smithy_context?t.__smithy_context.features||(t.__smithy_context.features={}):t.__smithy_context={features:{}},t.__smithy_context.features[e]=n}class YA{constructor(e){this.authSchemes=new Map;for(const[n,i]of Object.entries(e))i!==void 0&&this.authSchemes.set(n,i)}getIdentityProvider(e){return this.authSchemes.get(e)}}const qA=t=>e=>wS(e)&&e.expiration.getTime()-Date.now()<t,ZA=3e5,JA=qA(ZA),wS=t=>t.expiration!==void 0,QA=(t,e,n)=>{if(t===void 0)return;const i=typeof t!="function"?async()=>Promise.resolve(t):t;let s,r,o,a=!1;const l=async c=>{r||(r=i(c));try{s=await r,o=!0,a=!1}finally{r=void 0}return s};return e===void 0?async c=>((!o||c?.forceRefresh)&&(s=await l(c)),s):async c=>((!o||c?.forceRefresh)&&(s=await l(c)),a?s:n(s)?(e(s)&&await l(c),s):(a=!0,s))};class fp extends Error{constructor(e,n=!0){let i,s=!0;typeof n=="boolean"?(i=void 0,s=n):n!=null&&typeof n=="object"&&(i=n.logger,s=n.tryNextLink??!0),super(e),this.name="ProviderError",this.tryNextLink=s,Object.setPrototypeOf(this,fp.prototype),i?.debug?.(`@smithy/property-provider ${s?"->":"(!)"} ${e}`)}static from(e,n=!0){return Object.assign(new this(e.message,n),e)}}class qo extends fp{constructor(e,n=!0){super(e,n),this.name="CredentialsProviderError",Object.setPrototypeOf(this,qo.prototype)}}const eI=(t,e,n)=>{let i,s,r,o=!1;const a=async()=>{s||(s=t());try{i=await s,r=!0,o=!1}finally{s=void 0}return i};return async l=>((!r||l?.forceRefresh)&&(i=await a()),i)},tI=t=>(t.sigv4aSigningRegionSet=xo(t.sigv4aSigningRegionSet),t),nI="X-Amz-Algorithm",iI="X-Amz-Credential",SS="X-Amz-Date",sI="X-Amz-SignedHeaders",rI="X-Amz-Expires",CS="X-Amz-Signature",bS="X-Amz-Security-Token",TS="authorization",RS=SS.toLowerCase(),oI="date",aI=[TS,RS,oI],lI=CS.toLowerCase(),Zf="x-amz-content-sha256",cI=bS.toLowerCase(),hI={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},uI=/^proxy-/,dI=/^sec-/,ed="AWS4-HMAC-SHA256",fI="AWS4-HMAC-SHA256-PAYLOAD",gI="UNSIGNED-PAYLOAD",pI=50,vS="aws4_request",mI=60*60*24*7,tc={},td=[],nd=(t,e,n)=>`${t}/${e}/${n}/${vS}`,_I=async(t,e,n,i,s)=>{const r=await w0(t,e.secretAccessKey,e.accessKeyId),o=`${n}:${i}:${s}:${Dn(r)}:${e.sessionToken}`;if(o in tc)return tc[o];for(td.push(o);td.length>pI;)delete tc[td.shift()];let a=`AWS4${e.secretAccessKey}`;for(const l of[n,i,s,vS])a=await w0(t,a,l);return tc[o]=a},w0=(t,e,n)=>{const i=new t(e);return i.update(Mo(n)),i.digest()},S0=({headers:t},e,n)=>{const i={};for(const s of Object.keys(t).sort()){if(t[s]==null)continue;const r=s.toLowerCase();(r in hI||e?.has(r)||uI.test(r)||dI.test(r))&&(!n||n&&!n.has(r))||(i[r]=t[s].trim().replace(/\s+/g," "))}return i},AS=t=>typeof ArrayBuffer=="function"&&t instanceof ArrayBuffer||Object.prototype.toString.call(t)==="[object ArrayBuffer]",id=async({headers:t,body:e},n)=>{for(const i of Object.keys(t))if(i.toLowerCase()===Zf)return t[i];if(e==null)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if(typeof e=="string"||ArrayBuffer.isView(e)||AS(e)){const i=new n;return i.update(Mo(e)),Dn(await i.digest())}return gI};class yI{format(e){const n=[];for(const r of Object.keys(e)){const o=vr(r);n.push(Uint8Array.from([o.byteLength]),o,this.formatHeaderValue(e[r]))}const i=new Uint8Array(n.reduce((r,o)=>r+o.byteLength,0));let s=0;for(const r of n)i.set(r,s),s+=r.byteLength;return i}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const n=new DataView(new ArrayBuffer(3));return n.setUint8(0,3),n.setInt16(1,e.value,!1),new Uint8Array(n.buffer);case"integer":const i=new DataView(new ArrayBuffer(5));return i.setUint8(0,4),i.setInt32(1,e.value,!1),new Uint8Array(i.buffer);case"long":const s=new Uint8Array(9);return s[0]=5,s.set(e.value.bytes,1),s;case"binary":const r=new DataView(new ArrayBuffer(3+e.value.byteLength));r.setUint8(0,6),r.setUint16(1,e.value.byteLength,!1);const o=new Uint8Array(r.buffer);return o.set(e.value,3),o;case"string":const a=vr(e.value),l=new DataView(new ArrayBuffer(3+a.byteLength));l.setUint8(0,7),l.setUint16(1,a.byteLength,!1);const c=new Uint8Array(l.buffer);return c.set(a,3),c;case"timestamp":const h=new Uint8Array(9);return h[0]=8,h.set(xI.fromNumber(e.value.valueOf()).bytes,1),h;case"uuid":if(!EI.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const u=new Uint8Array(17);return u[0]=9,u.set(mS(e.value.replace(/\-/g,"")),1),u}}}var C0;(function(t){t[t.boolTrue=0]="boolTrue",t[t.boolFalse=1]="boolFalse",t[t.byte=2]="byte",t[t.short=3]="short",t[t.integer=4]="integer",t[t.long=5]="long",t[t.byteArray=6]="byteArray",t[t.string=7]="string",t[t.timestamp=8]="timestamp",t[t.uuid=9]="uuid"})(C0||(C0={}));const EI=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;let xI=class IS{constructor(e){if(this.bytes=e,e.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>9223372036854776e3||e<-9223372036854776e3)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const n=new Uint8Array(8);for(let i=7,s=Math.abs(Math.round(e));i>-1&&s>0;i--,s/=256)n[i]=s;return e<0&&b0(n),new IS(n)}valueOf(){const e=this.bytes.slice(0),n=e[0]&128;return n&&b0(e),parseInt(Dn(e),16)*(n?-1:1)}toString(){return String(this.valueOf())}};function b0(t){for(let e=0;e<8;e++)t[e]^=255;for(let e=7;e>-1&&(t[e]++,t[e]===0);e--);}const wI=(t,e)=>{t=t.toLowerCase();for(const n of Object.keys(e))if(t===n.toLowerCase())return!0;return!1},SI=(t,e={})=>{const{headers:n,query:i={}}=Ft.clone(t);for(const s of Object.keys(n)){const r=s.toLowerCase();(r.slice(0,6)==="x-amz-"&&!e.unhoistableHeaders?.has(r)||e.hoistableHeaders?.has(r))&&(i[s]=n[s],delete n[s])}return{...t,headers:n,query:i}},T0=t=>{t=Ft.clone(t);for(const e of Object.keys(t.headers))aI.indexOf(e.toLowerCase())>-1&&delete t.headers[e];return t},CI=({query:t={}})=>{const e=[],n={};for(const i of Object.keys(t)){if(i.toLowerCase()===lI)continue;const s=Sr(i);e.push(s);const r=t[i];typeof r=="string"?n[s]=`${s}=${Sr(r)}`:Array.isArray(r)&&(n[s]=r.slice(0).reduce((o,a)=>o.concat([`${s}=${Sr(a)}`]),[]).sort().join("&"))}return e.sort().map(i=>n[i]).filter(i=>i).join("&")},bI=t=>TI(t).toISOString().replace(/\.\d{3}Z$/,"Z"),TI=t=>typeof t=="number"?new Date(t*1e3):typeof t=="string"?Number(t)?new Date(Number(t)*1e3):new Date(t):t;class RI{constructor({applyChecksum:e,credentials:n,region:i,service:s,sha256:r,uriEscapePath:o=!0}){this.service=s,this.sha256=r,this.uriEscapePath=o,this.applyChecksum=typeof e=="boolean"?e:!0,this.regionProvider=pi(i),this.credentialProvider=pi(n)}createCanonicalRequest(e,n,i){const s=Object.keys(n).sort();return`${e.method}
${this.getCanonicalPath(e)}
${CI(e)}
${s.map(r=>`${r}:${n[r]}`).join(`
`)}

${s.join(";")}
${i}`}async createStringToSign(e,n,i,s){const r=new this.sha256;r.update(Mo(i));const o=await r.digest();return`${s}
${e}
${n}
${Dn(o)}`}getCanonicalPath({path:e}){if(this.uriEscapePath){const n=[];for(const r of e.split("/"))r?.length!==0&&r!=="."&&(r===".."?n.pop():n.push(r));const i=`${e?.startsWith("/")?"/":""}${n.join("/")}${n.length>0&&e?.endsWith("/")?"/":""}`;return Sr(i).replace(/%2F/g,"/")}return e}validateResolvedCredentials(e){if(typeof e!="object"||typeof e.accessKeyId!="string"||typeof e.secretAccessKey!="string")throw new Error("Resolved credential object is not valid")}formatDate(e){const n=bI(e).replace(/[\-:]/g,"");return{longDate:n,shortDate:n.slice(0,8)}}getCanonicalHeaderList(e){return Object.keys(e).sort().join(";")}}class Jf extends RI{constructor({applyChecksum:e,credentials:n,region:i,service:s,sha256:r,uriEscapePath:o=!0}){super({applyChecksum:e,credentials:n,region:i,service:s,sha256:r,uriEscapePath:o}),this.headerFormatter=new yI}async presign(e,n={}){const{signingDate:i=new Date,expiresIn:s=3600,unsignableHeaders:r,unhoistableHeaders:o,signableHeaders:a,hoistableHeaders:l,signingRegion:c,signingService:h}=n,u=await this.credentialProvider();this.validateResolvedCredentials(u);const d=c??await this.regionProvider(),{longDate:f,shortDate:g}=this.formatDate(i);if(s>mI)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");const m=nd(g,d,h??this.service),p=SI(T0(e),{unhoistableHeaders:o,hoistableHeaders:l});u.sessionToken&&(p.query[bS]=u.sessionToken),p.query[nI]=ed,p.query[iI]=`${u.accessKeyId}/${m}`,p.query[SS]=f,p.query[rI]=s.toString(10);const y=S0(p,r,a);return p.query[sI]=this.getCanonicalHeaderList(y),p.query[CS]=await this.getSignature(f,m,this.getSigningKey(u,d,g,h),this.createCanonicalRequest(p,y,await id(e,this.sha256))),p}async sign(e,n){return typeof e=="string"?this.signString(e,n):e.headers&&e.payload?this.signEvent(e,n):e.message?this.signMessage(e,n):this.signRequest(e,n)}async signEvent({headers:e,payload:n},{signingDate:i=new Date,priorSignature:s,signingRegion:r,signingService:o}){const a=r??await this.regionProvider(),{shortDate:l,longDate:c}=this.formatDate(i),h=nd(l,a,o??this.service),u=await id({headers:{},body:n},this.sha256),d=new this.sha256;d.update(e);const f=Dn(await d.digest()),g=[fI,c,h,s,f,u].join(`
`);return this.signString(g,{signingDate:i,signingRegion:a,signingService:o})}async signMessage(e,{signingDate:n=new Date,signingRegion:i,signingService:s}){return this.signEvent({headers:this.headerFormatter.format(e.message.headers),payload:e.message.body},{signingDate:n,signingRegion:i,signingService:s,priorSignature:e.priorSignature}).then(o=>({message:e.message,signature:o}))}async signString(e,{signingDate:n=new Date,signingRegion:i,signingService:s}={}){const r=await this.credentialProvider();this.validateResolvedCredentials(r);const o=i??await this.regionProvider(),{shortDate:a}=this.formatDate(n),l=new this.sha256(await this.getSigningKey(r,o,a,s));return l.update(Mo(e)),Dn(await l.digest())}async signRequest(e,{signingDate:n=new Date,signableHeaders:i,unsignableHeaders:s,signingRegion:r,signingService:o}={}){const a=await this.credentialProvider();this.validateResolvedCredentials(a);const l=r??await this.regionProvider(),c=T0(e),{longDate:h,shortDate:u}=this.formatDate(n),d=nd(u,l,o??this.service);c.headers[RS]=h,a.sessionToken&&(c.headers[cI]=a.sessionToken);const f=await id(c,this.sha256);!wI(Zf,c.headers)&&this.applyChecksum&&(c.headers[Zf]=f);const g=S0(c,s,i),m=await this.getSignature(h,d,this.getSigningKey(a,l,u,o),this.createCanonicalRequest(c,g,f));return c.headers[TS]=`${ed} Credential=${a.accessKeyId}/${d}, SignedHeaders=${this.getCanonicalHeaderList(g)}, Signature=${m}`,c}async getSignature(e,n,i,s){const r=await this.createStringToSign(e,n,s,ed),o=new this.sha256(await i);return o.update(Mo(r)),Dn(await o.digest())}getSigningKey(e,n,i,s){return _I(this.sha256,e,i,n,s||this.service)}}const vI=t=>{let e=t.credentials,n=!!t.credentials,i;Object.defineProperty(t,"credentials",{set(c){c&&c!==e&&c!==i&&(n=!0),e=c;const h=AI(t,{credentials:e,credentialDefaultProvider:t.credentialDefaultProvider}),u=II(t,h);n&&!u.attributed?(i=async d=>u(d).then(f=>Uv(f,"CREDENTIALS_CODE","e")),i.memoized=u.memoized,i.configBound=u.configBound,i.attributed=!0):i=u},get(){return i},enumerable:!0,configurable:!0}),t.credentials=e;const{signingEscapePath:s=!0,systemClockOffset:r=t.systemClockOffset||0,sha256:o}=t;let a;return t.signer?a=xo(t.signer):t.regionInfoProvider?a=()=>xo(t.region)().then(async c=>[await t.regionInfoProvider(c,{useFipsEndpoint:await t.useFipsEndpoint(),useDualstackEndpoint:await t.useDualstackEndpoint()})||{},c]).then(([c,h])=>{const{signingRegion:u,signingService:d}=c;t.signingRegion=t.signingRegion||u||h,t.signingName=t.signingName||d||t.serviceId;const f={...t,credentials:t.credentials,region:t.signingRegion,service:t.signingName,sha256:o,uriEscapePath:s},g=t.signerConstructor||Jf;return new g(f)}):a=async c=>{c=Object.assign({},{name:"sigv4",signingName:t.signingName||t.defaultSigningName,signingRegion:await xo(t.region)(),properties:{}},c);const h=c.signingRegion,u=c.signingName;t.signingRegion=t.signingRegion||h,t.signingName=t.signingName||u||t.serviceId;const d={...t,credentials:t.credentials,region:t.signingRegion,service:t.signingName,sha256:o,uriEscapePath:s},f=t.signerConstructor||Jf;return new f(d)},Object.assign(t,{systemClockOffset:r,signingEscapePath:s,signer:a})};function AI(t,{credentials:e,credentialDefaultProvider:n}){let i;return e?e?.memoized?i=e:i=QA(e,JA,wS):n?i=xo(n(Object.assign({},t,{parentClientConfig:t}))):i=async()=>{throw new Error("@aws-sdk/core::resolveAwsSdkSigV4Config - `credentials` not provided and no credentialDefaultProvider was configured.")},i.memoized=!0,i}function II(t,e){if(e.configBound)return e;const n=async i=>e({...i,callerClientConfig:t});return n.memoized=e.memoized,n.configBound=!0,n}const R0=typeof TextEncoder=="function"?new TextEncoder:null,PI=t=>{if(typeof t=="string"){if(R0)return R0.encode(t).byteLength;let e=t.length;for(let n=e-1;n>=0;n--){const i=t.charCodeAt(n);i>127&&i<=2047?e++:i>2047&&i<=65535&&(e+=2),i>=56320&&i<=57343&&n--}return e}else{if(typeof t.byteLength=="number")return t.byteLength;if(typeof t.size=="number")return t.size}throw new Error(`Body Length computation failed for ${t}`)},nr=(t,e)=>{const n=[];if(t&&n.push(t),e)for(const i of e)n.push(i);return n},us=(t,e)=>`${t||"anonymous"}${e&&e.length>0?` (a.k.a. ${e.join(",")})`:""}`,ch=()=>{let t=[],e=[],n=!1;const i=new Set,s=u=>u.sort((d,f)=>v0[f.step]-v0[d.step]||A0[f.priority||"normal"]-A0[d.priority||"normal"]),r=u=>{let d=!1;const f=g=>{const m=nr(g.name,g.aliases);if(m.includes(u)){d=!0;for(const p of m)i.delete(p);return!1}return!0};return t=t.filter(f),e=e.filter(f),d},o=u=>{let d=!1;const f=g=>{if(g.middleware===u){d=!0;for(const m of nr(g.name,g.aliases))i.delete(m);return!1}return!0};return t=t.filter(f),e=e.filter(f),d},a=u=>(t.forEach(d=>{u.add(d.middleware,{...d})}),e.forEach(d=>{u.addRelativeTo(d.middleware,{...d})}),u.identifyOnResolve?.(h.identifyOnResolve()),u),l=u=>{const d=[];return u.before.forEach(f=>{f.before.length===0&&f.after.length===0?d.push(f):d.push(...l(f))}),d.push(u),u.after.reverse().forEach(f=>{f.before.length===0&&f.after.length===0?d.push(f):d.push(...l(f))}),d},c=(u=!1)=>{const d=[],f=[],g={};return t.forEach(p=>{const y={...p,before:[],after:[]};for(const _ of nr(y.name,y.aliases))g[_]=y;d.push(y)}),e.forEach(p=>{const y={...p,before:[],after:[]};for(const _ of nr(y.name,y.aliases))g[_]=y;f.push(y)}),f.forEach(p=>{if(p.toMiddleware){const y=g[p.toMiddleware];if(y===void 0){if(u)return;throw new Error(`${p.toMiddleware} is not found when adding ${us(p.name,p.aliases)} middleware ${p.relation} ${p.toMiddleware}`)}p.relation==="after"&&y.after.push(p),p.relation==="before"&&y.before.push(p)}}),s(d).map(l).reduce((p,y)=>(p.push(...y),p),[])},h={add:(u,d={})=>{const{name:f,override:g,aliases:m}=d,p={step:"initialize",priority:"normal",middleware:u,...d},y=nr(f,m);if(y.length>0){if(y.some(_=>i.has(_))){if(!g)throw new Error(`Duplicate middleware name '${us(f,m)}'`);for(const _ of y){const x=t.findIndex(w=>w.name===_||w.aliases?.some(b=>b===_));if(x===-1)continue;const E=t[x];if(E.step!==p.step||p.priority!==E.priority)throw new Error(`"${us(E.name,E.aliases)}" middleware with ${E.priority} priority in ${E.step} step cannot be overridden by "${us(f,m)}" middleware with ${p.priority} priority in ${p.step} step.`);t.splice(x,1)}}for(const _ of y)i.add(_)}t.push(p)},addRelativeTo:(u,d)=>{const{name:f,override:g,aliases:m}=d,p={middleware:u,...d},y=nr(f,m);if(y.length>0){if(y.some(_=>i.has(_))){if(!g)throw new Error(`Duplicate middleware name '${us(f,m)}'`);for(const _ of y){const x=e.findIndex(w=>w.name===_||w.aliases?.some(b=>b===_));if(x===-1)continue;const E=e[x];if(E.toMiddleware!==p.toMiddleware||E.relation!==p.relation)throw new Error(`"${us(E.name,E.aliases)}" middleware ${E.relation} "${E.toMiddleware}" middleware cannot be overridden by "${us(f,m)}" middleware ${p.relation} "${p.toMiddleware}" middleware.`);e.splice(x,1)}}for(const _ of y)i.add(_)}e.push(p)},clone:()=>a(ch()),use:u=>{u.applyToStack(h)},remove:u=>typeof u=="string"?r(u):o(u),removeByTag:u=>{let d=!1;const f=g=>{const{tags:m,name:p,aliases:y}=g;if(m&&m.includes(u)){const _=nr(p,y);for(const x of _)i.delete(x);return d=!0,!1}return!0};return t=t.filter(f),e=e.filter(f),d},concat:u=>{const d=a(ch());return d.use(u),d.identifyOnResolve(n||d.identifyOnResolve()||(u.identifyOnResolve?.()??!1)),d},applyToStack:a,identify:()=>c(!0).map(u=>{const d=u.step??u.relation+" "+u.toMiddleware;return us(u.name,u.aliases)+" - "+d}),identifyOnResolve(u){return typeof u=="boolean"&&(n=u),n},resolve:(u,d)=>{for(const f of c().map(g=>g.middleware).reverse())u=f(u,d);return n&&console.log(h.identify()),u}};return h},v0={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},A0={high:3,normal:2,low:1};class MI{constructor(e){this.config=e,this.middlewareStack=ch()}send(e,n,i){const s=typeof n!="function"?n:void 0,r=typeof n=="function"?n:i,o=s===void 0&&this.config.cacheMiddleware===!0;let a;if(o){this.handlers||(this.handlers=new WeakMap);const l=this.handlers;l.has(e.constructor)?a=l.get(e.constructor):(a=e.resolveMiddleware(this.middlewareStack,this.config,s),l.set(e.constructor,a))}else delete this.handlers,a=e.resolveMiddleware(this.middlewareStack,this.config,s);if(r)a(e).then(l=>r(null,l.output),l=>r(l)).catch(()=>{});else return a(e).then(l=>l.output)}destroy(){this.config?.requestHandler?.destroy?.(),delete this.handlers}}class Ol{constructor(){this.middlewareStack=ch()}static classBuilder(){return new FI}resolveMiddlewareWithContext(e,n,i,{middlewareFn:s,clientName:r,commandName:o,inputFilterSensitiveLog:a,outputFilterSensitiveLog:l,smithyContext:c,additionalContext:h,CommandCtor:u}){for(const p of s.bind(this)(u,e,n,i))this.middlewareStack.use(p);const d=e.concat(this.middlewareStack),{logger:f}=n,g={logger:f,clientName:r,commandName:o,inputFilterSensitiveLog:a,outputFilterSensitiveLog:l,[Hf]:{commandInstance:this,...c},...h},{requestHandler:m}=n;return d.resolve(p=>m.handle(p.request,i||{}),g)}}class FI{constructor(){this._init=()=>{},this._ep={},this._middlewareFn=()=>[],this._commandName="",this._clientName="",this._additionalContext={},this._smithyContext={},this._inputFilterSensitiveLog=e=>e,this._outputFilterSensitiveLog=e=>e,this._serializer=null,this._deserializer=null}init(e){this._init=e}ep(e){return this._ep=e,this}m(e){return this._middlewareFn=e,this}s(e,n,i={}){return this._smithyContext={service:e,operation:n,...i},this}c(e={}){return this._additionalContext=e,this}n(e,n){return this._clientName=e,this._commandName=n,this}f(e=i=>i,n=i=>i){return this._inputFilterSensitiveLog=e,this._outputFilterSensitiveLog=n,this}ser(e){return this._serializer=e,this}de(e){return this._deserializer=e,this}sc(e){return this._operationSchema=e,this._smithyContext.operationSchema=e,this}build(){const e=this;let n;return n=class extends Ol{static getEndpointParameterInstructions(){return e._ep}constructor(...[i]){super(),this.serialize=e._serializer,this.deserialize=e._deserializer,this.input=i??{},e._init(this),this.schema=e._operationSchema}resolveMiddleware(i,s,r){return this.resolveMiddlewareWithContext(i,s,r,{CommandCtor:n,middlewareFn:e._middlewareFn,clientName:e._clientName,commandName:e._commandName,inputFilterSensitiveLog:e._inputFilterSensitiveLog,outputFilterSensitiveLog:e._outputFilterSensitiveLog,smithyContext:e._smithyContext,additionalContext:e._additionalContext})}}}}const Wn="***SensitiveInformation***";class ao extends Error{constructor(e){super(e.message),Object.setPrototypeOf(this,Object.getPrototypeOf(this).constructor.prototype),this.name=e.name,this.$fault=e.$fault,this.$metadata=e.$metadata}static isInstance(e){if(!e)return!1;const n=e;return ao.prototype.isPrototypeOf(n)||!!n.$fault&&!!n.$metadata&&(n.$fault==="client"||n.$fault==="server")}static[Symbol.hasInstance](e){if(!e)return!1;const n=e;return this===ao?ao.isInstance(e):ao.isInstance(e)?n.name&&this.name?this.prototype.isPrototypeOf(e)||n.name===this.name:this.prototype.isPrototypeOf(e):!1}}const Tn=(t,e={})=>{Object.entries(e).filter(([,i])=>i!==void 0).forEach(([i,s])=>{(t[i]==null||t[i]==="")&&(t[i]=s)});const n=t.message||t.Message||"UnknownError";return t.message=n,delete t.Message,t},DI=({output:t,parsedBody:e,exceptionCtor:n,errorCode:i})=>{const s=LI(t),r=s.httpStatusCode?s.httpStatusCode+"":void 0,o=new n({name:e?.code||e?.Code||i||r||"UnknownError",$fault:"client",$metadata:s});throw Tn(o,e)},OI=t=>({output:e,parsedBody:n,errorCode:i})=>{DI({output:e,parsedBody:n,exceptionCtor:t,errorCode:i})},LI=t=>({httpStatusCode:t.statusCode,requestId:t.headers["x-amzn-requestid"]??t.headers["x-amzn-request-id"]??t.headers["x-amz-request-id"],extendedRequestId:t.headers["x-amz-id-2"],cfId:t.headers["x-amz-cf-id"]}),kI=t=>{switch(t){case"standard":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}},NI=t=>{const e=[];for(const n in ah){const i=ah[n];t[i]!==void 0&&e.push({algorithmId:()=>i,checksumConstructor:()=>t[i]})}return{addChecksumAlgorithm(n){e.push(n)},checksumAlgorithms(){return e}}},BI=t=>{const e={};return t.checksumAlgorithms().forEach(n=>{e[n.algorithmId()]=n.checksumConstructor()}),e},UI=t=>({setRetryStrategy(e){t.retryStrategy=e},retryStrategy(){return t.retryStrategy}}),GI=t=>{const e={};return e.retryStrategy=t.retryStrategy(),e},$I=t=>Object.assign(NI(t),UI(t)),jI=t=>Object.assign(BI(t),GI(t)),Qf=t=>Array.isArray(t)?t:[t],PS=t=>{const e="#text";for(const n in t)t.hasOwnProperty(n)&&t[n][e]!==void 0?t[n]=t[n][e]:typeof t[n]=="object"&&t[n]!==null&&(t[n]=PS(t[n]));return t},Gn=t=>t!=null;class gp{trace(){}debug(){}info(){}warn(){}error(){}}function ct(t,e,n){let i,s,r;if(typeof e>"u"&&typeof n>"u")i={},r=t;else{if(i=t,typeof e=="function")return s=e,r=n,zI(i,s,r);r=e}for(const o of Object.keys(r)){if(!Array.isArray(r[o])){i[o]=r[o];continue}MS(i,null,r,o)}return i}const I8=(t,e)=>{const n={};for(const i in e)MS(n,t,e,i);return n},zI=(t,e,n)=>ct(t,Object.entries(n).reduce((i,[s,r])=>(Array.isArray(r)?i[s]=r:typeof r=="function"?i[s]=[e,r()]:i[s]=[e,r],i),{})),MS=(t,e,n,i)=>{if(e!==null){let o=n[i];typeof o=="function"&&(o=[,o]);const[a=HI,l=XI,c=i]=o;(typeof a=="function"&&a(e[c])||typeof a!="function"&&a)&&(t[i]=l(e[c]));return}let[s,r]=n[i];if(typeof r=="function"){let o;const a=s===void 0&&(o=r())!=null,l=typeof s=="function"&&!!s(void 0)||typeof s!="function"&&!!s;a?t[i]=o:l&&(t[i]=r())}else{const o=s===void 0&&r!=null,a=typeof s=="function"&&!!s(r)||typeof s!="function"&&!!s;(o||a)&&(t[i]=r)}},HI=t=>t!=null,XI=t=>t,VI=t=>t.toISOString().replace(".000Z","Z"),WI=(t,e)=>_S(t,e).then(n=>e.utf8Encoder(n)),FS=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",KI=FS+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",YI="["+FS+"]["+KI+"]*",qI=new RegExp("^"+YI+"$");function DS(t,e){const n=[];let i=e.exec(t);for(;i;){const s=[];s.startIndex=e.lastIndex-i[0].length;const r=i.length;for(let o=0;o<r;o++)s.push(i[o]);n.push(s),i=e.exec(t)}return n}const pp=function(t){const e=qI.exec(t);return!(e===null||typeof e>"u")};function ZI(t){return typeof t<"u"}const JI={allowBooleanAttributes:!1,unpairedTags:[]};function QI(t,e){e=Object.assign({},JI,e);const n=[];let i=!1,s=!1;t[0]==="\uFEFF"&&(t=t.substr(1));for(let r=0;r<t.length;r++)if(t[r]==="<"&&t[r+1]==="?"){if(r+=2,r=P0(t,r),r.err)return r}else if(t[r]==="<"){let o=r;if(r++,t[r]==="!"){r=M0(t,r);continue}else{let a=!1;t[r]==="/"&&(a=!0,r++);let l="";for(;r<t.length&&t[r]!==">"&&t[r]!==" "&&t[r]!=="	"&&t[r]!==`
`&&t[r]!=="\r";r++)l+=t[r];if(l=l.trim(),l[l.length-1]==="/"&&(l=l.substring(0,l.length-1),r--),!aP(l)){let u;return l.trim().length===0?u="Invalid space after '<'.":u="Tag '"+l+"' is an invalid name.",wt("InvalidTag",u,fn(t,r))}const c=nP(t,r);if(c===!1)return wt("InvalidAttr","Attributes for '"+l+"' have open quote.",fn(t,r));let h=c.value;if(r=c.index,h[h.length-1]==="/"){const u=r-h.length;h=h.substring(0,h.length-1);const d=F0(h,e);if(d===!0)i=!0;else return wt(d.err.code,d.err.msg,fn(t,u+d.err.line))}else if(a)if(c.tagClosed){if(h.trim().length>0)return wt("InvalidTag","Closing tag '"+l+"' can't have attributes or invalid starting.",fn(t,o));if(n.length===0)return wt("InvalidTag","Closing tag '"+l+"' has not been opened.",fn(t,o));{const u=n.pop();if(l!==u.tagName){let d=fn(t,u.tagStartPos);return wt("InvalidTag","Expected closing tag '"+u.tagName+"' (opened in line "+d.line+", col "+d.col+") instead of closing tag '"+l+"'.",fn(t,o))}n.length==0&&(s=!0)}}else return wt("InvalidTag","Closing tag '"+l+"' doesn't have proper closing.",fn(t,r));else{const u=F0(h,e);if(u!==!0)return wt(u.err.code,u.err.msg,fn(t,r-h.length+u.err.line));if(s===!0)return wt("InvalidXml","Multiple possible root nodes found.",fn(t,r));e.unpairedTags.indexOf(l)!==-1||n.push({tagName:l,tagStartPos:o}),i=!0}for(r++;r<t.length;r++)if(t[r]==="<")if(t[r+1]==="!"){r++,r=M0(t,r);continue}else if(t[r+1]==="?"){if(r=P0(t,++r),r.err)return r}else break;else if(t[r]==="&"){const u=rP(t,r);if(u==-1)return wt("InvalidChar","char '&' is not expected.",fn(t,r));r=u}else if(s===!0&&!I0(t[r]))return wt("InvalidXml","Extra text at the end",fn(t,r));t[r]==="<"&&r--}}else{if(I0(t[r]))continue;return wt("InvalidChar","char '"+t[r]+"' is not expected.",fn(t,r))}if(i){if(n.length==1)return wt("InvalidTag","Unclosed tag '"+n[0].tagName+"'.",fn(t,n[0].tagStartPos));if(n.length>0)return wt("InvalidXml","Invalid '"+JSON.stringify(n.map(r=>r.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return wt("InvalidXml","Start tag expected.",1);return!0}function I0(t){return t===" "||t==="	"||t===`
`||t==="\r"}function P0(t,e){const n=e;for(;e<t.length;e++)if(t[e]=="?"||t[e]==" "){const i=t.substr(n,e-n);if(e>5&&i==="xml")return wt("InvalidXml","XML declaration allowed only at the start of the document.",fn(t,e));if(t[e]=="?"&&t[e+1]==">"){e++;break}else continue}return e}function M0(t,e){if(t.length>e+5&&t[e+1]==="-"&&t[e+2]==="-"){for(e+=3;e<t.length;e++)if(t[e]==="-"&&t[e+1]==="-"&&t[e+2]===">"){e+=2;break}}else if(t.length>e+8&&t[e+1]==="D"&&t[e+2]==="O"&&t[e+3]==="C"&&t[e+4]==="T"&&t[e+5]==="Y"&&t[e+6]==="P"&&t[e+7]==="E"){let n=1;for(e+=8;e<t.length;e++)if(t[e]==="<")n++;else if(t[e]===">"&&(n--,n===0))break}else if(t.length>e+9&&t[e+1]==="["&&t[e+2]==="C"&&t[e+3]==="D"&&t[e+4]==="A"&&t[e+5]==="T"&&t[e+6]==="A"&&t[e+7]==="["){for(e+=8;e<t.length;e++)if(t[e]==="]"&&t[e+1]==="]"&&t[e+2]===">"){e+=2;break}}return e}const eP='"',tP="'";function nP(t,e){let n="",i="",s=!1;for(;e<t.length;e++){if(t[e]===eP||t[e]===tP)i===""?i=t[e]:i!==t[e]||(i="");else if(t[e]===">"&&i===""){s=!0;break}n+=t[e]}return i!==""?!1:{value:n,index:e,tagClosed:s}}const iP=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function F0(t,e){const n=DS(t,iP),i={};for(let s=0;s<n.length;s++){if(n[s][1].length===0)return wt("InvalidAttr","Attribute '"+n[s][2]+"' has no space in starting.",pa(n[s]));if(n[s][3]!==void 0&&n[s][4]===void 0)return wt("InvalidAttr","Attribute '"+n[s][2]+"' is without value.",pa(n[s]));if(n[s][3]===void 0&&!e.allowBooleanAttributes)return wt("InvalidAttr","boolean attribute '"+n[s][2]+"' is not allowed.",pa(n[s]));const r=n[s][2];if(!oP(r))return wt("InvalidAttr","Attribute '"+r+"' is an invalid name.",pa(n[s]));if(!i.hasOwnProperty(r))i[r]=1;else return wt("InvalidAttr","Attribute '"+r+"' is repeated.",pa(n[s]))}return!0}function sP(t,e){let n=/\d/;for(t[e]==="x"&&(e++,n=/[\da-fA-F]/);e<t.length;e++){if(t[e]===";")return e;if(!t[e].match(n))break}return-1}function rP(t,e){if(e++,t[e]===";")return-1;if(t[e]==="#")return e++,sP(t,e);let n=0;for(;e<t.length;e++,n++)if(!(t[e].match(/\w/)&&n<20)){if(t[e]===";")break;return-1}return e}function wt(t,e,n){return{err:{code:t,msg:e,line:n.line||n,col:n.col}}}function oP(t){return pp(t)}function aP(t){return pp(t)}function fn(t,e){const n=t.substring(0,e).split(/\r?\n/);return{line:n.length,col:n[n.length-1].length+1}}function pa(t){return t.startIndex+t[1].length}const lP={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(t,e){return e},attributeValueProcessor:function(t,e){return e},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(t,e,n){return t},captureMetaData:!1},cP=function(t){return Object.assign({},lP,t)};let hh;typeof Symbol!="function"?hh="@@xmlMetadata":hh=Symbol("XML Node Metadata");class hr{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,n){e==="__proto__"&&(e="#__proto__"),this.child.push({[e]:n})}addChild(e,n){e.tagname==="__proto__"&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,":@":e[":@"]}):this.child.push({[e.tagname]:e.child}),n!==void 0&&(this.child[this.child.length-1][hh]={startIndex:n})}static getMetaDataSymbol(){return hh}}function hP(t,e){const n={};if(t[e+3]==="O"&&t[e+4]==="C"&&t[e+5]==="T"&&t[e+6]==="Y"&&t[e+7]==="P"&&t[e+8]==="E"){e=e+9;let i=1,s=!1,r=!1,o="";for(;e<t.length;e++)if(t[e]==="<"&&!r){if(s&&ur(t,"!ENTITY",e)){e+=7;let a,l;[a,l,e]=uP(t,e+1),l.indexOf("&")===-1&&(n[a]={regx:RegExp(`&${a};`,"g"),val:l})}else if(s&&ur(t,"!ELEMENT",e)){e+=8;const{index:a}=fP(t,e+1);e=a}else if(s&&ur(t,"!ATTLIST",e))e+=8;else if(s&&ur(t,"!NOTATION",e)){e+=9;const{index:a}=dP(t,e+1);e=a}else if(ur(t,"!--",e))r=!0;else throw new Error("Invalid DOCTYPE");i++,o=""}else if(t[e]===">"){if(r?t[e-1]==="-"&&t[e-2]==="-"&&(r=!1,i--):i--,i===0)break}else t[e]==="["?s=!0:o+=t[e];if(i!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:n,i:e}}const Rs=(t,e)=>{for(;e<t.length&&/\s/.test(t[e]);)e++;return e};function uP(t,e){e=Rs(t,e);let n="";for(;e<t.length&&!/\s/.test(t[e])&&t[e]!=='"'&&t[e]!=="'";)n+=t[e],e++;if(mp(n),e=Rs(t,e),t.substring(e,e+6).toUpperCase()==="SYSTEM")throw new Error("External entities are not supported");if(t[e]==="%")throw new Error("Parameter entities are not supported");let i="";return[e,i]=zc(t,e,"entity"),e--,[n,i,e]}function dP(t,e){e=Rs(t,e);let n="";for(;e<t.length&&!/\s/.test(t[e]);)n+=t[e],e++;mp(n),e=Rs(t,e);const i=t.substring(e,e+6).toUpperCase();if(i!=="SYSTEM"&&i!=="PUBLIC")throw new Error(`Expected SYSTEM or PUBLIC, found "${i}"`);e+=i.length,e=Rs(t,e);let s=null,r=null;if(i==="PUBLIC")[e,s]=zc(t,e,"publicIdentifier"),e=Rs(t,e),(t[e]==='"'||t[e]==="'")&&([e,r]=zc(t,e,"systemIdentifier"));else if(i==="SYSTEM"&&([e,r]=zc(t,e,"systemIdentifier"),!r))throw new Error("Missing mandatory system identifier for SYSTEM notation");return{notationName:n,publicIdentifier:s,systemIdentifier:r,index:--e}}function zc(t,e,n){let i="";const s=t[e];if(s!=='"'&&s!=="'")throw new Error(`Expected quoted string, found "${s}"`);for(e++;e<t.length&&t[e]!==s;)i+=t[e],e++;if(t[e]!==s)throw new Error(`Unterminated ${n} value`);return e++,[e,i]}function fP(t,e){e=Rs(t,e);let n="";for(;e<t.length&&!/\s/.test(t[e]);)n+=t[e],e++;if(!mp(n))throw new Error(`Invalid element name: "${n}"`);e=Rs(t,e);let i="";if(t[e]==="E"&&ur(t,"MPTY",e))e+=4;else if(t[e]==="A"&&ur(t,"NY",e))e+=2;else if(t[e]==="("){for(e++;e<t.length&&t[e]!==")";)i+=t[e],e++;if(t[e]!==")")throw new Error("Unterminated content model")}else throw new Error(`Invalid Element Expression, found "${t[e]}"`);return{elementName:n,contentModel:i.trim(),index:e}}function ur(t,e,n){for(let i=0;i<e.length;i++)if(e[i]!==t[n+i+1])return!1;return!0}function mp(t){if(pp(t))return t;throw new Error(`Invalid entity name ${t}`)}const gP=/^[-+]?0x[a-fA-F0-9]+$/,pP=/^([\-\+])?(0*)([0-9]*(\.[0-9]*)?)$/,mP={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function _P(t,e={}){if(e=Object.assign({},mP,e),!t||typeof t!="string")return t;let n=t.trim();if(e.skipLike!==void 0&&e.skipLike.test(n))return t;if(t==="0")return 0;if(e.hex&&gP.test(n))return wP(n,16);if(n.search(/.+[eE].+/)!==-1)return EP(t,n,e);{const i=pP.exec(n);if(i){const s=i[1]||"",r=i[2];let o=xP(i[3]);const a=s?t[r.length+1]===".":t[r.length]===".";if(!e.leadingZeros&&(r.length>1||r.length===1&&!a))return t;{const l=Number(n),c=String(l);if(l===0)return l;if(c.search(/[eE]/)!==-1)return e.eNotation?l:t;if(n.indexOf(".")!==-1)return c==="0"||c===o||c===`${s}${o}`?l:t;let h=r?o:n;return r?h===c||s+h===c?l:t:h===c||h===s+c?l:t}}else return t}}const yP=/^([-+])?(0*)(\d*(\.\d*)?[eE][-\+]?\d+)$/;function EP(t,e,n){if(!n.eNotation)return t;const i=e.match(yP);if(i){let s=i[1]||"";const r=i[3].indexOf("e")===-1?"E":"e",o=i[2],a=s?t[o.length+1]===r:t[o.length]===r;return o.length>1&&a?t:o.length===1&&(i[3].startsWith(`.${r}`)||i[3][0]===r)?Number(e):n.leadingZeros&&!a?(e=(i[1]||"")+i[3],Number(e)):t}else return t}function xP(t){return t&&t.indexOf(".")!==-1&&(t=t.replace(/0+$/,""),t==="."?t="0":t[0]==="."?t="0"+t:t[t.length-1]==="."&&(t=t.substring(0,t.length-1))),t}function wP(t,e){if(parseInt)return parseInt(t,e);if(Number.parseInt)return Number.parseInt(t,e);if(window&&window.parseInt)return window.parseInt(t,e);throw new Error("parseInt, Number.parseInt, window.parseInt are not supported")}function SP(t){return typeof t=="function"?t:Array.isArray(t)?e=>{for(const n of t)if(typeof n=="string"&&e===n||n instanceof RegExp&&n.test(e))return!0}:()=>!1}class CP{constructor(e){this.options=e,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"¢"},pound:{regex:/&(pound|#163);/g,val:"£"},yen:{regex:/&(yen|#165);/g,val:"¥"},euro:{regex:/&(euro|#8364);/g,val:"€"},copyright:{regex:/&(copy|#169);/g,val:"©"},reg:{regex:/&(reg|#174);/g,val:"®"},inr:{regex:/&(inr|#8377);/g,val:"₹"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(n,i)=>String.fromCodePoint(Number.parseInt(i,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(n,i)=>String.fromCodePoint(Number.parseInt(i,16))}},this.addExternalEntities=bP,this.parseXml=IP,this.parseTextData=TP,this.resolveNameSpace=RP,this.buildAttributesMap=AP,this.isItStopNode=DP,this.replaceEntitiesValue=MP,this.readStopNodeData=LP,this.saveTextToParentTag=FP,this.addChild=PP,this.ignoreAttributesFn=SP(this.options.ignoreAttributes)}}function bP(t){const e=Object.keys(t);for(let n=0;n<e.length;n++){const i=e[n];this.lastEntities[i]={regex:new RegExp("&"+i+";","g"),val:t[i]}}}function TP(t,e,n,i,s,r,o){if(t!==void 0&&(this.options.trimValues&&!i&&(t=t.trim()),t.length>0)){o||(t=this.replaceEntitiesValue(t));const a=this.options.tagValueProcessor(e,t,n,s,r);return a==null?t:typeof a!=typeof t||a!==t?a:this.options.trimValues?tg(t,this.options.parseTagValue,this.options.numberParseOptions):t.trim()===t?tg(t,this.options.parseTagValue,this.options.numberParseOptions):t}}function RP(t){if(this.options.removeNSPrefix){const e=t.split(":"),n=t.charAt(0)==="/"?"/":"";if(e[0]==="xmlns")return"";e.length===2&&(t=n+e[1])}return t}const vP=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function AP(t,e,n){if(this.options.ignoreAttributes!==!0&&typeof t=="string"){const i=DS(t,vP),s=i.length,r={};for(let o=0;o<s;o++){const a=this.resolveNameSpace(i[o][1]);if(this.ignoreAttributesFn(a,e))continue;let l=i[o][4],c=this.options.attributeNamePrefix+a;if(a.length)if(this.options.transformAttributeName&&(c=this.options.transformAttributeName(c)),c==="__proto__"&&(c="#__proto__"),l!==void 0){this.options.trimValues&&(l=l.trim()),l=this.replaceEntitiesValue(l);const h=this.options.attributeValueProcessor(a,l,e);h==null?r[c]=l:typeof h!=typeof l||h!==l?r[c]=h:r[c]=tg(l,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(r[c]=!0)}if(!Object.keys(r).length)return;if(this.options.attributesGroupName){const o={};return o[this.options.attributesGroupName]=r,o}return r}}const IP=function(t){t=t.replace(/\r\n?/g,`
`);const e=new hr("!xml");let n=e,i="",s="";for(let r=0;r<t.length;r++)if(t[r]==="<")if(t[r+1]==="/"){const a=gr(t,">",r,"Closing Tag is not closed.");let l=t.substring(r+2,a).trim();if(this.options.removeNSPrefix){const u=l.indexOf(":");u!==-1&&(l=l.substr(u+1))}this.options.transformTagName&&(l=this.options.transformTagName(l)),n&&(i=this.saveTextToParentTag(i,n,s));const c=s.substring(s.lastIndexOf(".")+1);if(l&&this.options.unpairedTags.indexOf(l)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${l}>`);let h=0;c&&this.options.unpairedTags.indexOf(c)!==-1?(h=s.lastIndexOf(".",s.lastIndexOf(".")-1),this.tagsNodeStack.pop()):h=s.lastIndexOf("."),s=s.substring(0,h),n=this.tagsNodeStack.pop(),i="",r=a}else if(t[r+1]==="?"){let a=eg(t,r,!1,"?>");if(!a)throw new Error("Pi Tag is not closed.");if(i=this.saveTextToParentTag(i,n,s),!(this.options.ignoreDeclaration&&a.tagName==="?xml"||this.options.ignorePiTags)){const l=new hr(a.tagName);l.add(this.options.textNodeName,""),a.tagName!==a.tagExp&&a.attrExpPresent&&(l[":@"]=this.buildAttributesMap(a.tagExp,s,a.tagName)),this.addChild(n,l,s,r)}r=a.closeIndex+1}else if(t.substr(r+1,3)==="!--"){const a=gr(t,"-->",r+4,"Comment is not closed.");if(this.options.commentPropName){const l=t.substring(r+4,a-2);i=this.saveTextToParentTag(i,n,s),n.add(this.options.commentPropName,[{[this.options.textNodeName]:l}])}r=a}else if(t.substr(r+1,2)==="!D"){const a=hP(t,r);this.docTypeEntities=a.entities,r=a.i}else if(t.substr(r+1,2)==="!["){const a=gr(t,"]]>",r,"CDATA is not closed.")-2,l=t.substring(r+9,a);i=this.saveTextToParentTag(i,n,s);let c=this.parseTextData(l,n.tagname,s,!0,!1,!0,!0);c==null&&(c=""),this.options.cdataPropName?n.add(this.options.cdataPropName,[{[this.options.textNodeName]:l}]):n.add(this.options.textNodeName,c),r=a+2}else{let a=eg(t,r,this.options.removeNSPrefix),l=a.tagName;const c=a.rawTagName;let h=a.tagExp,u=a.attrExpPresent,d=a.closeIndex;this.options.transformTagName&&(l=this.options.transformTagName(l)),n&&i&&n.tagname!=="!xml"&&(i=this.saveTextToParentTag(i,n,s,!1));const f=n;f&&this.options.unpairedTags.indexOf(f.tagname)!==-1&&(n=this.tagsNodeStack.pop(),s=s.substring(0,s.lastIndexOf("."))),l!==e.tagname&&(s+=s?"."+l:l);const g=r;if(this.isItStopNode(this.options.stopNodes,s,l)){let m="";if(h.length>0&&h.lastIndexOf("/")===h.length-1)l[l.length-1]==="/"?(l=l.substr(0,l.length-1),s=s.substr(0,s.length-1),h=l):h=h.substr(0,h.length-1),r=a.closeIndex;else if(this.options.unpairedTags.indexOf(l)!==-1)r=a.closeIndex;else{const y=this.readStopNodeData(t,c,d+1);if(!y)throw new Error(`Unexpected end of ${c}`);r=y.i,m=y.tagContent}const p=new hr(l);l!==h&&u&&(p[":@"]=this.buildAttributesMap(h,s,l)),m&&(m=this.parseTextData(m,l,s,!0,u,!0,!0)),s=s.substr(0,s.lastIndexOf(".")),p.add(this.options.textNodeName,m),this.addChild(n,p,s,g)}else{if(h.length>0&&h.lastIndexOf("/")===h.length-1){l[l.length-1]==="/"?(l=l.substr(0,l.length-1),s=s.substr(0,s.length-1),h=l):h=h.substr(0,h.length-1),this.options.transformTagName&&(l=this.options.transformTagName(l));const m=new hr(l);l!==h&&u&&(m[":@"]=this.buildAttributesMap(h,s,l)),this.addChild(n,m,s,g),s=s.substr(0,s.lastIndexOf("."))}else{const m=new hr(l);this.tagsNodeStack.push(n),l!==h&&u&&(m[":@"]=this.buildAttributesMap(h,s,l)),this.addChild(n,m,s,g),n=m}i="",r=d}}else i+=t[r];return e.child};function PP(t,e,n,i){this.options.captureMetaData||(i=void 0);const s=this.options.updateTag(e.tagname,n,e[":@"]);s===!1||(typeof s=="string"&&(e.tagname=s),t.addChild(e,i))}const MP=function(t){if(this.options.processEntities){for(let e in this.docTypeEntities){const n=this.docTypeEntities[e];t=t.replace(n.regx,n.val)}for(let e in this.lastEntities){const n=this.lastEntities[e];t=t.replace(n.regex,n.val)}if(this.options.htmlEntities)for(let e in this.htmlEntities){const n=this.htmlEntities[e];t=t.replace(n.regex,n.val)}t=t.replace(this.ampEntity.regex,this.ampEntity.val)}return t};function FP(t,e,n,i){return t&&(i===void 0&&(i=e.child.length===0),t=this.parseTextData(t,e.tagname,n,!1,e[":@"]?Object.keys(e[":@"]).length!==0:!1,i),t!==void 0&&t!==""&&e.add(this.options.textNodeName,t),t=""),t}function DP(t,e,n){const i="*."+n;for(const s in t){const r=t[s];if(i===r||e===r)return!0}return!1}function OP(t,e,n=">"){let i,s="";for(let r=e;r<t.length;r++){let o=t[r];if(i)o===i&&(i="");else if(o==='"'||o==="'")i=o;else if(o===n[0])if(n[1]){if(t[r+1]===n[1])return{data:s,index:r}}else return{data:s,index:r};else o==="	"&&(o=" ");s+=o}}function gr(t,e,n,i){const s=t.indexOf(e,n);if(s===-1)throw new Error(i);return s+e.length-1}function eg(t,e,n,i=">"){const s=OP(t,e+1,i);if(!s)return;let r=s.data;const o=s.index,a=r.search(/\s/);let l=r,c=!0;a!==-1&&(l=r.substring(0,a),r=r.substring(a+1).trimStart());const h=l;if(n){const u=l.indexOf(":");u!==-1&&(l=l.substr(u+1),c=l!==s.data.substr(u+1))}return{tagName:l,tagExp:r,closeIndex:o,attrExpPresent:c,rawTagName:h}}function LP(t,e,n){const i=n;let s=1;for(;n<t.length;n++)if(t[n]==="<")if(t[n+1]==="/"){const r=gr(t,">",n,`${e} is not closed`);if(t.substring(n+2,r).trim()===e&&(s--,s===0))return{tagContent:t.substring(i,n),i:r};n=r}else if(t[n+1]==="?")n=gr(t,"?>",n+1,"StopNode is not closed.");else if(t.substr(n+1,3)==="!--")n=gr(t,"-->",n+3,"StopNode is not closed.");else if(t.substr(n+1,2)==="![")n=gr(t,"]]>",n,"StopNode is not closed.")-2;else{const r=eg(t,n,">");r&&((r&&r.tagName)===e&&r.tagExp[r.tagExp.length-1]!=="/"&&s++,n=r.closeIndex)}}function tg(t,e,n){if(e&&typeof t=="string"){const i=t.trim();return i==="true"?!0:i==="false"?!1:_P(t,n)}else return ZI(t)?t:""}const sd=hr.getMetaDataSymbol();function kP(t,e){return OS(t,e)}function OS(t,e,n){let i;const s={};for(let r=0;r<t.length;r++){const o=t[r],a=NP(o);let l="";if(n===void 0?l=a:l=n+"."+a,a===e.textNodeName)i===void 0?i=o[a]:i+=""+o[a];else{if(a===void 0)continue;if(o[a]){let c=OS(o[a],e,l);const h=UP(c,e);o[sd]!==void 0&&(c[sd]=o[sd]),o[":@"]?BP(c,o[":@"],l,e):Object.keys(c).length===1&&c[e.textNodeName]!==void 0&&!e.alwaysCreateTextNode?c=c[e.textNodeName]:Object.keys(c).length===0&&(e.alwaysCreateTextNode?c[e.textNodeName]="":c=""),s[a]!==void 0&&s.hasOwnProperty(a)?(Array.isArray(s[a])||(s[a]=[s[a]]),s[a].push(c)):e.isArray(a,l,h)?s[a]=[c]:s[a]=c}}}return typeof i=="string"?i.length>0&&(s[e.textNodeName]=i):i!==void 0&&(s[e.textNodeName]=i),s}function NP(t){const e=Object.keys(t);for(let n=0;n<e.length;n++){const i=e[n];if(i!==":@")return i}}function BP(t,e,n,i){if(e){const s=Object.keys(e),r=s.length;for(let o=0;o<r;o++){const a=s[o];i.isArray(a,n+"."+a,!0,!0)?t[a]=[e[a]]:t[a]=e[a]}}}function UP(t,e){const{textNodeName:n}=e,i=Object.keys(t).length;return!!(i===0||i===1&&(t[n]||typeof t[n]=="boolean"||t[n]===0))}class GP{constructor(e){this.externalEntities={},this.options=cP(e)}parse(e,n){if(typeof e!="string")if(e.toString)e=e.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(n){n===!0&&(n={});const r=QI(e,n);if(r!==!0)throw Error(`${r.err.msg}:${r.err.line}:${r.err.col}`)}const i=new CP(this.options);i.addExternalEntities(this.externalEntities);const s=i.parseXml(e);return this.options.preserveOrder||s===void 0?s:kP(s,this.options)}addEntity(e,n){if(n.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(e.indexOf("&")!==-1||e.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(n==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[e]=n}static getMetaDataSymbol(){return hr.getMetaDataSymbol()}}const _p=(t,e)=>WI(t,e).then(n=>{if(n.length){const i=new GP({attributeNamePrefix:"",htmlEntities:!0,ignoreAttributes:!1,ignoreDeclaration:!0,parseTagValue:!1,trimValues:!1,tagValueProcessor:(l,c)=>c.trim()===""&&c.includes(`
`)?"":void 0});i.addEntity("#xD","\r"),i.addEntity("#10",`
`);let s;try{s=i.parse(n,!0)}catch(l){throw l&&typeof l=="object"&&Object.defineProperty(l,"$responseBodyText",{value:n}),l}const r="#text",o=Object.keys(s)[0],a=s[o];return a[r]&&(a[o]=a[r],delete a[r]),PS(a)}return{}}),$P=async(t,e)=>{const n=await _p(t,e);return n.Error&&(n.Error.message=n.Error.message??n.Error.Message),n},jP=(t,e)=>{if(e?.Error?.Code!==void 0)return e.Error.Code;if(e?.Code!==void 0)return e.Code;if(t.statusCode==404)return"NotFound"},ng=[ot.CRC32,ot.CRC32C,ot.CRC64NVME,ot.SHA1,ot.SHA256],zP=[ot.SHA256,ot.SHA1,ot.CRC32,ot.CRC32C,ot.CRC64NVME],HP=(t,{requestChecksumRequired:e,requestAlgorithmMember:n,requestChecksumCalculation:i})=>{if(!n)return i===Po.WHEN_SUPPORTED||e?Xf:void 0;if(!t[n])return;const s=t[n];if(!ng.includes(s))throw new Error(`The checksum algorithm "${s}" is not supported by the client. Select one of ${ng}.`);return s},yp=t=>t===ot.MD5?"content-md5":`x-amz-checksum-${t.toLowerCase()}`,XP=(t,e)=>{const n=t.toLowerCase();for(const i of Object.keys(e))if(n===i.toLowerCase())return!0;return!1},VP=(t,e)=>{const n=t.toLowerCase();for(const i of Object.keys(e))if(i.toLowerCase().startsWith(n))return!0;return!1},LS=t=>t!==void 0&&typeof t!="string"&&!ArrayBuffer.isView(t)&&!AS(t);function Ep(t,e,n,i){function s(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function a(h){try{c(i.next(h))}catch(u){o(u)}}function l(h){try{c(i.throw(h))}catch(u){o(u)}}function c(h){h.done?r(h.value):s(h.value).then(a,l)}c((i=i.apply(t,e||[])).next())})}function xp(t,e){var n={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},i,s,r,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(h){return l([c,h])}}function l(c){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(n=0)),n;)try{if(i=1,s&&(r=c[0]&2?s.return:c[0]?s.throw||((r=s.return)&&r.call(s),0):s.next)&&!(r=r.call(s,c[1])).done)return r;switch(s=0,r&&(c=[c[0]&2,r.value]),c[0]){case 0:case 1:r=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,s=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(r=n.trys,!(r=r.length>0&&r[r.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!r||c[1]>r[0]&&c[1]<r[3])){n.label=c[1];break}if(c[0]===6&&n.label<r[1]){n.label=r[1],r=c;break}if(r&&n.label<r[2]){n.label=r[2],n.ops.push(c);break}r[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(h){c=[6,h],s=0}finally{i=r=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function kS(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}const WP=t=>new TextEncoder().encode(t);var KP=typeof Buffer<"u"&&Buffer.from?function(t){return Buffer.from(t,"utf8")}:WP;function Gs(t){return t instanceof Uint8Array?t:typeof t=="string"?KP(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t)}function cl(t){return typeof t=="string"?t.length===0:t.byteLength===0}function NS(t){return new Uint8Array([(t&4278190080)>>24,(t&16711680)>>16,(t&65280)>>8,t&255])}function BS(t){if(!Uint32Array.from){for(var e=new Uint32Array(t.length),n=0;n<t.length;)e[n]=t[n],n+=1;return e}return Uint32Array.from(t)}var YP=function(){function t(){this.crc32c=new D0}return t.prototype.update=function(e){cl(e)||this.crc32c.update(Gs(e))},t.prototype.digest=function(){return Ep(this,void 0,void 0,function(){return xp(this,function(e){return[2,NS(this.crc32c.digest())]})})},t.prototype.reset=function(){this.crc32c=new D0},t}(),D0=function(){function t(){this.checksum=4294967295}return t.prototype.update=function(e){var n,i;try{for(var s=kS(e),r=s.next();!r.done;r=s.next()){var o=r.value;this.checksum=this.checksum>>>8^ZP[(this.checksum^o)&255]}}catch(a){n={error:a}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return this},t.prototype.digest=function(){return(this.checksum^4294967295)>>>0},t}(),qP=[0,4067132163,3778769143,324072436,3348797215,904991772,648144872,3570033899,2329499855,2024987596,1809983544,2575936315,1296289744,3207089363,2893594407,1578318884,274646895,3795141740,4049975192,51262619,3619967088,632279923,922689671,3298075524,2592579488,1760304291,2075979607,2312596564,1562183871,2943781820,3156637768,1313733451,549293790,3537243613,3246849577,871202090,3878099393,357341890,102525238,4101499445,2858735121,1477399826,1264559846,3107202533,1845379342,2677391885,2361733625,2125378298,820201905,3263744690,3520608582,598981189,4151959214,85089709,373468761,3827903834,3124367742,1213305469,1526817161,2842354314,2107672161,2412447074,2627466902,1861252501,1098587580,3004210879,2688576843,1378610760,2262928035,1955203488,1742404180,2511436119,3416409459,969524848,714683780,3639785095,205050476,4266873199,3976438427,526918040,1361435347,2739821008,2954799652,1114974503,2529119692,1691668175,2005155131,2247081528,3690758684,697762079,986182379,3366744552,476452099,3993867776,4250756596,255256311,1640403810,2477592673,2164122517,1922457750,2791048317,1412925310,1197962378,3037525897,3944729517,427051182,170179418,4165941337,746937522,3740196785,3451792453,1070968646,1905808397,2213795598,2426610938,1657317369,3053634322,1147748369,1463399397,2773627110,4215344322,153784257,444234805,3893493558,1021025245,3467647198,3722505002,797665321,2197175160,1889384571,1674398607,2443626636,1164749927,3070701412,2757221520,1446797203,137323447,4198817972,3910406976,461344835,3484808360,1037989803,781091935,3705997148,2460548119,1623424788,1939049696,2180517859,1429367560,2807687179,3020495871,1180866812,410100952,3927582683,4182430767,186734380,3756733383,763408580,1053836080,3434856499,2722870694,1344288421,1131464017,2971354706,1708204729,2545590714,2229949006,1988219213,680717673,3673779818,3383336350,1002577565,4010310262,493091189,238226049,4233660802,2987750089,1082061258,1395524158,2705686845,1972364758,2279892693,2494862625,1725896226,952904198,3399985413,3656866545,731699698,4283874585,222117402,510512622,3959836397,3280807620,837199303,582374963,3504198960,68661723,4135334616,3844915500,390545967,1230274059,3141532936,2825850620,1510247935,2395924756,2091215383,1878366691,2644384480,3553878443,565732008,854102364,3229815391,340358836,3861050807,4117890627,119113024,1493875044,2875275879,3090270611,1247431312,2660249211,1828433272,2141937292,2378227087,3811616794,291187481,34330861,4032846830,615137029,3603020806,3314634738,939183345,1776939221,2609017814,2295496738,2058945313,2926798794,1545135305,1330124605,3173225534,4084100981,17165430,307568514,3762199681,888469610,3332340585,3587147933,665062302,2042050490,2346497209,2559330125,1793573966,3190661285,1279665062,1595330642,2910671697],ZP=BS(qP),JP=function(){function t(){this.crc32=new uh}return t.prototype.update=function(e){cl(e)||this.crc32.update(Gs(e))},t.prototype.digest=function(){return Ep(this,void 0,void 0,function(){return xp(this,function(e){return[2,NS(this.crc32.digest())]})})},t.prototype.reset=function(){this.crc32=new uh},t}(),uh=function(){function t(){this.checksum=4294967295}return t.prototype.update=function(e){var n,i;try{for(var s=kS(e),r=s.next();!r.done;r=s.next()){var o=r.value;this.checksum=this.checksum>>>8^eM[(this.checksum^o)&255]}}catch(a){n={error:a}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return this},t.prototype.digest=function(){return(this.checksum^4294967295)>>>0},t}(),QP=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],eM=BS(QP);const tM=()=>JP,US=(t,e)=>{switch(t){case ot.MD5:return e.md5;case ot.CRC32:return tM();case ot.CRC32C:return YP;case ot.CRC64NVME:throw new Error(`Please check whether you have installed the "@aws-sdk/crc64-nvme-crt" package explicitly. 
You must also register the package by calling [require("@aws-sdk/crc64-nvme-crt");] or an ESM equivalent such as [import "@aws-sdk/crc64-nvme-crt";]. 
For more information please go to https://github.com/aws/aws-sdk-js-v3#functionality-requiring-aws-common-runtime-crt`);case ot.SHA1:return e.sha1;case ot.SHA256:return e.sha256;default:throw new Error(`Unsupported checksum algorithm: ${t}`)}},GS=(t,e)=>{const n=new t;return n.update(Mo(e||"")),n.digest()},nM={name:"flexibleChecksumsMiddleware",step:"build",tags:["BODY_CHECKSUM"],override:!0},iM=(t,e)=>(n,i)=>async s=>{if(!Ft.isInstance(s.request)||VP("x-amz-checksum-",s.request.headers))return n(s);const{request:r,input:o}=s,{body:a,headers:l}=r,{base64Encoder:c,streamHasher:h}=t,{requestChecksumRequired:u,requestAlgorithmMember:d}=e,f=await t.requestChecksumCalculation(),g=d?.name,m=d?.httpHeader;g&&!o[g]&&(f===Po.WHEN_SUPPORTED||u)&&(o[g]=Xf,m&&(l[m]=Xf));const p=HP(o,{requestChecksumRequired:u,requestAlgorithmMember:d?.name,requestChecksumCalculation:f});let y=a,_=l;if(p){switch(p){case ot.CRC32:Rt(i,"FLEXIBLE_CHECKSUMS_REQ_CRC32","U");break;case ot.CRC32C:Rt(i,"FLEXIBLE_CHECKSUMS_REQ_CRC32C","V");break;case ot.CRC64NVME:Rt(i,"FLEXIBLE_CHECKSUMS_REQ_CRC64","W");break;case ot.SHA1:Rt(i,"FLEXIBLE_CHECKSUMS_REQ_SHA1","X");break;case ot.SHA256:Rt(i,"FLEXIBLE_CHECKSUMS_REQ_SHA256","Y");break}const E=yp(p),w=US(p,t);if(LS(a)){const{getAwsChunkedEncodingStream:b,bodyLengthChecker:v}=t;y=b(typeof t.requestStreamBufferSize=="number"&&t.requestStreamBufferSize>=8*1024?lA(a,t.requestStreamBufferSize,i.logger):a,{base64Encoder:c,bodyLengthChecker:v,checksumLocationName:E,checksumAlgorithmFn:w,streamHasher:h}),_={...l,"content-encoding":l["content-encoding"]?`${l["content-encoding"]},aws-chunked`:"aws-chunked","transfer-encoding":"chunked","x-amz-decoded-content-length":l["content-length"],"x-amz-content-sha256":"STREAMING-UNSIGNED-PAYLOAD-TRAILER","x-amz-trailer":E},delete _["content-length"]}else if(!XP(E,l)){const b=await GS(w,a);_={...l,[E]:c(b)}}}return await n({...s,request:{...r,headers:_,body:y}})},sM={name:"flexibleChecksumsInputMiddleware",toMiddleware:"serializerMiddleware",relation:"before",tags:["BODY_CHECKSUM"],override:!0},rM=(t,e)=>(n,i)=>async s=>{const r=s.input,{requestValidationModeMember:o}=e,a=await t.requestChecksumCalculation(),l=await t.responseChecksumValidation();switch(a){case Po.WHEN_REQUIRED:Rt(i,"FLEXIBLE_CHECKSUMS_REQ_WHEN_REQUIRED","a");break;case Po.WHEN_SUPPORTED:Rt(i,"FLEXIBLE_CHECKSUMS_REQ_WHEN_SUPPORTED","Z");break}switch(l){case Yu.WHEN_REQUIRED:Rt(i,"FLEXIBLE_CHECKSUMS_RES_WHEN_REQUIRED","c");break;case Yu.WHEN_SUPPORTED:Rt(i,"FLEXIBLE_CHECKSUMS_RES_WHEN_SUPPORTED","b");break}return o&&!r[o]&&l===Yu.WHEN_SUPPORTED&&(r[o]="ENABLED"),n(s)},$S=(t=[])=>{const e=[];for(const n of zP)!t.includes(n)||!ng.includes(n)||e.push(n);return e},oM=t=>{const e=t.lastIndexOf("-");if(e!==-1){const n=t.slice(e+1);if(!n.startsWith("0")){const i=parseInt(n,10);if(!isNaN(i)&&i>=1&&i<=1e4)return!0}}return!1},aM=async(t,{checksumAlgorithmFn:e,base64Encoder:n})=>n(await GS(e,t)),lM=async(t,{config:e,responseAlgorithms:n,logger:i})=>{const s=$S(n),{body:r,headers:o}=t;for(const a of s){const l=yp(a),c=o[l];if(c){let h;try{h=US(a,e)}catch(f){if(a===ot.CRC64NVME){i?.warn(`Skipping ${ot.CRC64NVME} checksum validation: ${f.message}`);continue}throw f}const{base64Encoder:u}=e;if(LS(r)){t.body=rA({expectedChecksum:c,checksumSourceLocation:l,checksum:new h,source:r,base64Encoder:u});return}const d=await aM(r,{checksumAlgorithmFn:h,base64Encoder:u});if(d===c)break;throw new Error(`Checksum mismatch: expected "${d}" but received "${c}" in response header "${l}".`)}}},cM={name:"flexibleChecksumsResponseMiddleware",toMiddleware:"deserializerMiddleware",relation:"after",tags:["BODY_CHECKSUM"],override:!0},hM=(t,e)=>(n,i)=>async s=>{if(!Ft.isInstance(s.request))return n(s);const r=s.input,o=await n(s),a=o.response,{requestValidationModeMember:l,responseAlgorithms:c}=e;if(l&&r[l]==="ENABLED"){const{clientName:h,commandName:u}=i;if(h==="S3Client"&&u==="GetObjectCommand"&&$S(c).every(f=>{const g=yp(f),m=a.headers[g];return!m||oM(m)}))return o;await lM(a,{config:t,responseAlgorithms:c,logger:i.logger})}return o},jS=(t,e)=>({applyToStack:n=>{n.add(iM(t,e),nM),n.addRelativeTo(rM(t,e),sM),n.addRelativeTo(hM(t,e),cM)}}),uM=t=>{const{requestChecksumCalculation:e,responseChecksumValidation:n,requestStreamBufferSize:i}=t;return Object.assign(t,{requestChecksumCalculation:pi(e??Nv),responseChecksumValidation:pi(n??Bv),requestStreamBufferSize:Number(i??0)})};function P8(t){return t}const dM=t=>e=>async n=>{if(!Ft.isInstance(n.request))return e(n);const{request:i}=n,{handlerProtocol:s=""}=t.requestHandler.metadata||{};if(s.indexOf("h2")>=0&&!i.headers[":authority"])delete i.headers.host,i.headers[":authority"]=i.hostname+(i.port?":"+i.port:"");else if(!i.headers.host){let r=i.hostname;i.port!=null&&(r+=`:${i.port}`),i.headers.host=r}return e(n)},fM={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},gM=t=>({applyToStack:e=>{e.add(dM(t),fM)}}),pM=()=>(t,e)=>async n=>{try{const i=await t(n),{clientName:s,commandName:r,logger:o,dynamoDbDocumentClientOptions:a={}}=e,{overrideInputFilterSensitiveLog:l,overrideOutputFilterSensitiveLog:c}=a,h=l??e.inputFilterSensitiveLog,u=c??e.outputFilterSensitiveLog,{$metadata:d,...f}=i.output;return o?.info?.({clientName:s,commandName:r,input:h(n.input),output:u(f),metadata:d}),i}catch(i){const{clientName:s,commandName:r,logger:o,dynamoDbDocumentClientOptions:a={}}=e,{overrideInputFilterSensitiveLog:l}=a,c=l??e.inputFilterSensitiveLog;throw o?.error?.({clientName:s,commandName:r,input:c(n.input),error:i,metadata:i.$metadata}),i}},mM={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},_M=t=>({applyToStack:e=>{e.add(pM(),mM)}});var O0={};const rd="X-Amzn-Trace-Id",yM="AWS_LAMBDA_FUNCTION_NAME",EM="_X_AMZN_TRACE_ID",xM=t=>e=>async n=>{const{request:i}=n;if(!Ft.isInstance(i)||t.runtime!=="node")return e(n);const s=Object.keys(i.headers??{}).find(l=>l.toLowerCase()===rd.toLowerCase())??rd;if(i.headers.hasOwnProperty(s))return e(n);const r=O0[yM],o=O0[EM],a=l=>typeof l=="string"&&l.length>0;return a(r)&&a(o)&&(i.headers[rd]=o),e({...n,request:i})},wM={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},SM=t=>({applyToStack:e=>{e.add(xM(t),wM)}}),CM="content-length",bM="x-amz-decoded-content-length";function TM(){return(t,e)=>async n=>{const{request:i}=n;if(Ft.isInstance(i)&&!(CM in i.headers)&&!(bM in i.headers)){const s="Are you using a Stream of unknown length as the Body of a PutObject request? Consider using Upload instead from @aws-sdk/lib-storage.";typeof e?.logger?.warn=="function"&&!(e.logger instanceof gp)?e.logger.warn(s):console.warn(s)}return t({...n})}}const RM={step:"finalizeRequest",tags:["CHECK_CONTENT_LENGTH_HEADER"],name:"getCheckContentLengthHeaderPlugin",override:!0},vM=t=>({applyToStack:e=>{e.add(TM(),RM)}}),AM=t=>(e,n)=>async i=>{const s=await t.region(),r=t.region;let o=()=>{};n.__s3RegionRedirect&&(Object.defineProperty(t,"region",{writable:!1,value:async()=>n.__s3RegionRedirect}),o=()=>Object.defineProperty(t,"region",{writable:!0,value:r}));try{const a=await e(i);if(n.__s3RegionRedirect){o();const l=await t.region();if(s!==l)throw new Error("Region was not restored following S3 region redirect.")}return a}catch(a){throw o(),a}},IM={tags:["REGION_REDIRECT","S3"],name:"regionRedirectEndpointMiddleware",override:!0,relation:"before",toMiddleware:"endpointV2Middleware"};function PM(t){return(e,n)=>async i=>{try{return await e(i)}catch(s){if(t.followRegionRedirects&&(s?.$metadata?.httpStatusCode===301||s?.$metadata?.httpStatusCode===400&&s?.name==="IllegalLocationConstraintException")){try{const r=s.$response.headers["x-amz-bucket-region"];n.logger?.debug(`Redirecting from ${await t.region()} to ${r}`),n.__s3RegionRedirect=r}catch(r){throw new Error("Region redirect failed: "+r)}return e(i)}throw s}}}const MM={step:"initialize",tags:["REGION_REDIRECT","S3"],name:"regionRedirectMiddleware",override:!0},FM=t=>({applyToStack:e=>{e.add(PM(t),MM),e.addRelativeTo(AM(t),IM)}}),DM=t=>(e,n)=>async i=>{const s=await e(i),{response:r}=s;if(Rr.isInstance(r)&&r.headers.expires){r.headers.expiresstring=r.headers.expires;try{qf(r.headers.expires)}catch(o){n.logger?.warn(`AWS SDK Warning for ${n.clientName}::${n.commandName} response parsing (${r.headers.expires}): ${o}`),delete r.headers.expires}}return s},OM={tags:["S3"],name:"s3ExpiresMiddleware",override:!0,relation:"after",toMiddleware:"deserializerMiddleware"},LM=t=>({applyToStack:e=>{e.addRelativeTo(DM(),OM)}});class wp{data;lastPurgeTime=Date.now();static EXPIRED_CREDENTIAL_PURGE_INTERVAL_MS=3e4;constructor(e={}){this.data=e}get(e){const n=this.data[e];if(n)return n}set(e,n){return this.data[e]=n,n}delete(e){delete this.data[e]}async purgeExpired(){const e=Date.now();if(!(this.lastPurgeTime+wp.EXPIRED_CREDENTIAL_PURGE_INTERVAL_MS>e))for(const n in this.data){const i=this.data[n];if(!i.isRefreshing){const s=await i.identity;s.expiration&&s.expiration.getTime()<e&&delete this.data[n]}}}}class od{_identity;isRefreshing;accessed;constructor(e,n=!1,i=Date.now()){this._identity=e,this.isRefreshing=n,this.accessed=i}get identity(){return this.accessed=Date.now(),this._identity}}class Sp{createSessionFn;cache;static REFRESH_WINDOW_MS=6e4;constructor(e,n=new wp){this.createSessionFn=e,this.cache=n}async getS3ExpressIdentity(e,n){const i=n.Bucket,{cache:s}=this,r=s.get(i);return r?r.identity.then(o=>(o.expiration?.getTime()??0)<Date.now()?s.set(i,new od(this.getIdentity(i))).identity:((o.expiration?.getTime()??0)<Date.now()+Sp.REFRESH_WINDOW_MS&&!r.isRefreshing&&(r.isRefreshing=!0,this.getIdentity(i).then(c=>{s.set(i,new od(Promise.resolve(c)))})),o)):s.set(i,new od(this.getIdentity(i))).identity}async getIdentity(e){await this.cache.purgeExpired().catch(s=>{console.warn(`Error while clearing expired entries in S3ExpressIdentityCache: 
`+s)});const n=await this.createSessionFn(e);if(!n.Credentials?.AccessKeyId||!n.Credentials?.SecretAccessKey)throw new Error("s3#createSession response credential missing AccessKeyId or SecretAccessKey.");return{accessKeyId:n.Credentials.AccessKeyId,secretAccessKey:n.Credentials.SecretAccessKey,sessionToken:n.Credentials.SessionToken,expiration:n.Credentials.Expiration?new Date(n.Credentials.Expiration):void 0}}}var L0;(function(t){t.ENV="env",t.CONFIG="shared config entry"})(L0||(L0={}));const kM="Directory",NM="S3Express",BM="sigv4-s3express",ig="X-Amz-S3session-Token",sg=ig.toLowerCase();class UM extends Jf{async signWithCredentials(e,n,i){const s=k0(n);e.headers[sg]=n.sessionToken;const r=this;return N0(r,s),r.signRequest(e,i??{})}async presignWithCredentials(e,n,i){const s=k0(n);return delete e.headers[sg],e.headers[ig]=n.sessionToken,e.query=e.query??{},e.query[ig]=n.sessionToken,N0(this,s),this.presign(e,i)}}function k0(t){return{accessKeyId:t.accessKeyId,secretAccessKey:t.secretAccessKey,expiration:t.expiration}}function N0(t,e){const n=setTimeout(()=>{throw new Error("SignatureV4S3Express credential override was created but not called.")},10),i=t.credentialProvider,s=()=>(clearTimeout(n),t.credentialProvider=i,Promise.resolve(e));t.credentialProvider=s}const GM=t=>(e,n)=>async i=>{if(n.endpointV2){const s=n.endpointV2,r=s.properties?.authSchemes?.[0]?.name===BM;if((s.properties?.backend===NM||s.properties?.bucketType===kM)&&(Rt(n,"S3_EXPRESS_BUCKET","J"),n.isS3ExpressBucket=!0),r){const a=i.input.Bucket;if(a){const l=await t.s3ExpressIdentityProvider.getS3ExpressIdentity(await t.credentials(),{Bucket:a});n.s3ExpressIdentity=l,Ft.isInstance(i.request)&&l.sessionToken&&(i.request.headers[sg]=l.sessionToken)}}}return e(i)},$M={name:"s3ExpressMiddleware",step:"build",tags:["S3","S3_EXPRESS"],override:!0},jM=t=>({applyToStack:e=>{e.add(GM(t),$M)}}),zM=async(t,e,n,i)=>{const s=await i.signWithCredentials(n,t,{});if(s.headers["X-Amz-Security-Token"]||s.headers["x-amz-security-token"])throw new Error("X-Amz-Security-Token must not be set for s3-express requests.");return s},HM=t=>e=>{throw e},XM=(t,e)=>{},VM=t=>(e,n)=>async i=>{if(!Ft.isInstance(i.request))return e(i);const r=Wo(n).selectedHttpAuthScheme;if(!r)throw new Error("No HttpAuthScheme was selected: unable to sign request");const{httpAuthOption:{signingProperties:o={}},identity:a,signer:l}=r;let c;n.s3ExpressIdentity?c=await zM(n.s3ExpressIdentity,o,i.request,await t.signer()):c=await l.sign(i.request,a,o);const h=await e({...i,request:c}).catch((l.errorHandler||HM)(o));return(l.successHandler||XM)(h.response,o),h},WM=t=>({applyToStack:e=>{e.addRelativeTo(VM(t),fS)}}),KM=(t,{session:e})=>{const[n,i]=e,{forcePathStyle:s,useAccelerateEndpoint:r,disableMultiregionAccessPoints:o,followRegionRedirects:a,s3ExpressIdentityProvider:l,bucketEndpoint:c}=t;return Object.assign(t,{forcePathStyle:s??!1,useAccelerateEndpoint:r??!1,disableMultiregionAccessPoints:o??!1,followRegionRedirects:a??!1,s3ExpressIdentityProvider:l??new Sp(async h=>n().send(new i({Bucket:h}))),bucketEndpoint:c??!1})},YM={CopyObjectCommand:!0,UploadPartCopyCommand:!0,CompleteMultipartUploadCommand:!0},qM=3e3,ZM=t=>(e,n)=>async i=>{const s=await e(i),{response:r}=s;if(!Rr.isInstance(r))return s;const{statusCode:o,body:a}=r;if(o<200||o>=300||!(typeof a?.stream=="function"||typeof a?.pipe=="function"||typeof a?.tee=="function"))return s;let c=a,h=a;a&&typeof a=="object"&&!(a instanceof Uint8Array)&&([c,h]=await xA(a)),r.body=h;const u=await JM(c,{streamCollector:async f=>dA(f,qM)});typeof c?.destroy=="function"&&c.destroy();const d=t.utf8Encoder(u.subarray(u.length-16));if(u.length===0&&YM[n.commandName]){const f=new Error("S3 aborted request");throw f.name="InternalError",f}return d&&d.endsWith("</Error>")&&(r.statusCode=400),s},JM=(t=new Uint8Array,e)=>t instanceof Uint8Array?Promise.resolve(t):e.streamCollector(t)||Promise.resolve(new Uint8Array),QM={relation:"after",toMiddleware:"deserializerMiddleware",tags:["THROW_200_EXCEPTIONS","S3"],name:"throw200ExceptionsMiddleware",override:!0},Cp=t=>({applyToStack:e=>{e.addRelativeTo(ZM(t),QM)}}),eF=t=>typeof t=="string"&&t.indexOf("arn:")===0&&t.split(":").length>=6;function tF(t){return(e,n)=>async i=>{if(t.bucketEndpoint){const s=n.endpointV2;if(s){const r=i.input.Bucket;if(typeof r=="string")try{const o=new URL(r);n.endpointV2={...s,url:o}}catch(o){const a=`@aws-sdk/middleware-sdk-s3: bucketEndpoint=true was set but Bucket=${r} could not be parsed as URL.`;throw n.logger?.constructor?.name==="NoOpLogger"?console.warn(a):n.logger?.warn?.(a),o}}}return e(i)}}const nF={name:"bucketEndpointMiddleware",override:!0,relation:"after",toMiddleware:"endpointV2Middleware"};function iF({bucketEndpoint:t}){return e=>async n=>{const{input:{Bucket:i}}=n;if(!t&&typeof i=="string"&&!eF(i)&&i.indexOf("/")>=0){const s=new Error(`Bucket name shouldn't contain '/', received '${i}'`);throw s.name="InvalidBucketName",s}return e({...n})}}const sF={step:"initialize",tags:["VALIDATE_BUCKET_NAME"],name:"validateBucketNameMiddleware",override:!0},rF=t=>({applyToStack:e=>{e.add(iF(t),sF),e.addRelativeTo(tF(t),nF)}}),oF=void 0;function aF(t){return t===void 0?!0:typeof t=="string"&&t.length<=50}function lF(t){const e=xo(t.userAgentAppId??oF),{customUserAgent:n}=t;return Object.assign(t,{customUserAgent:typeof n=="string"?[[n]]:n,userAgentAppId:async()=>{const i=await e();if(!aF(i)){const s=t.logger?.constructor?.name==="NoOpLogger"||!t.logger?console:t.logger;typeof i!="string"?s?.warn("userAgentAppId must be a string or undefined."):i.length>50&&s?.warn("The provided userAgentAppId exceeds the maximum length of 50 characters.")}return i}})}class cF{constructor({size:e,params:n}){this.data=new Map,this.parameters=[],this.capacity=e??50,n&&(this.parameters=n)}get(e,n){const i=this.hash(e);if(i===!1)return n();if(!this.data.has(i)){if(this.data.size>this.capacity+10){const s=this.data.keys();let r=0;for(;;){const{value:o,done:a}=s.next();if(this.data.delete(o),a||++r>10)break}}this.data.set(i,n())}return this.data.get(i)}size(){return this.data.size}hash(e){let n="";const{parameters:i}=this;if(i.length===0)return!1;for(const s of i){const r=String(e[s]??"");if(r.includes("|;"))return!1;n+=r+"|;"}return n}}const hF=new RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),zS=t=>hF.test(t)||t.startsWith("[")&&t.endsWith("]"),uF=new RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),bp=(t,e=!1)=>{if(!e)return uF.test(t);const n=t.split(".");for(const i of n)if(!bp(i))return!1;return!0},dh={},hl="endpoints";function $s(t){return typeof t!="object"||t==null?t:"ref"in t?`$${$s(t.ref)}`:"fn"in t?`${t.fn}(${(t.argv||[]).map($s).join(", ")})`:JSON.stringify(t,null,2)}class Kn extends Error{constructor(e){super(e),this.name="EndpointError"}}const dF=(t,e)=>t===e,fF=t=>{const e=t.split("."),n=[];for(const i of e){const s=i.indexOf("[");if(s!==-1){if(i.indexOf("]")!==i.length-1)throw new Kn(`Path: '${t}' does not end with ']'`);const r=i.slice(s+1,-1);if(Number.isNaN(parseInt(r)))throw new Kn(`Invalid array index: '${r}' in path: '${t}'`);s!==0&&n.push(i.slice(0,s)),n.push(r)}else n.push(i)}return n},HS=(t,e)=>fF(e).reduce((n,i)=>{if(typeof n!="object")throw new Kn(`Index '${i}' in '${e}' not found in '${JSON.stringify(t)}'`);return Array.isArray(n)?n[parseInt(i)]:n[i]},t),gF=t=>t!=null,pF=t=>!t,ad={[al.HTTP]:80,[al.HTTPS]:443},mF=t=>{const e=(()=>{try{if(t instanceof URL)return t;if(typeof t=="object"&&"hostname"in t){const{hostname:d,port:f,protocol:g="",path:m="",query:p={}}=t,y=new URL(`${g}//${d}${f?`:${f}`:""}${m}`);return y.search=Object.entries(p).map(([_,x])=>`${_}=${x}`).join("&"),y}return new URL(t)}catch{return null}})();if(!e)return console.error(`Unable to parse ${JSON.stringify(t)} as a whatwg URL.`),null;const n=e.href,{host:i,hostname:s,pathname:r,protocol:o,search:a}=e;if(a)return null;const l=o.slice(0,-1);if(!Object.values(al).includes(l))return null;const c=zS(s),h=n.includes(`${i}:${ad[l]}`)||typeof t=="string"&&t.includes(`${i}:${ad[l]}`),u=`${i}${h?`:${ad[l]}`:""}`;return{scheme:l,authority:u,path:r,normalizedPath:r.endsWith("/")?r:`${r}/`,isIp:c}},_F=(t,e)=>t===e,yF=(t,e,n,i)=>e>=n||t.length<n?null:i?t.substring(t.length-n,t.length-e):t.substring(e,n),EF=t=>encodeURIComponent(t).replace(/[!*'()]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),xF={booleanEquals:dF,getAttr:HS,isSet:gF,isValidHostLabel:bp,not:pF,parseURL:mF,stringEquals:_F,substring:yF,uriEncode:EF},XS=(t,e)=>{const n=[],i={...e.endpointParams,...e.referenceRecord};let s=0;for(;s<t.length;){const r=t.indexOf("{",s);if(r===-1){n.push(t.slice(s));break}n.push(t.slice(s,r));const o=t.indexOf("}",r);if(o===-1){n.push(t.slice(r));break}t[r+1]==="{"&&t[o+1]==="}"&&(n.push(t.slice(r+1,o)),s=o+2);const a=t.substring(r+1,o);if(a.includes("#")){const[l,c]=a.split("#");n.push(HS(i[l],c))}else n.push(i[a]);s=o+1}return n.join("")},wF=({ref:t},e)=>({...e.endpointParams,...e.referenceRecord})[t],Jh=(t,e,n)=>{if(typeof t=="string")return XS(t,n);if(t.fn)return VS(t,n);if(t.ref)return wF(t,n);throw new Kn(`'${e}': ${String(t)} is not a string, function or reference.`)},VS=({fn:t,argv:e},n)=>{const i=e.map(r=>["boolean","number"].includes(typeof r)?r:Jh(r,"arg",n)),s=t.split(".");return s[0]in dh&&s[1]!=null?dh[s[0]][s[1]](...i):xF[t](...i)},SF=({assign:t,...e},n)=>{if(t&&t in n.referenceRecord)throw new Kn(`'${t}' is already defined in Reference Record.`);const i=VS(e,n);return n.logger?.debug?.(`${hl} evaluateCondition: ${$s(e)} = ${$s(i)}`),{result:i===""?!0:!!i,...t!=null&&{toAssign:{name:t,value:i}}}},Tp=(t=[],e)=>{const n={};for(const i of t){const{result:s,toAssign:r}=SF(i,{...e,referenceRecord:{...e.referenceRecord,...n}});if(!s)return{result:s};r&&(n[r.name]=r.value,e.logger?.debug?.(`${hl} assign: ${r.name} := ${$s(r.value)}`))}return{result:!0,referenceRecord:n}},CF=(t,e)=>Object.entries(t).reduce((n,[i,s])=>({...n,[i]:s.map(r=>{const o=Jh(r,"Header value entry",e);if(typeof o!="string")throw new Kn(`Header '${i}' value '${o}' is not a string`);return o})}),{}),WS=(t,e)=>{if(Array.isArray(t))return t.map(n=>WS(n,e));switch(typeof t){case"string":return XS(t,e);case"object":if(t===null)throw new Kn(`Unexpected endpoint property: ${t}`);return KS(t,e);case"boolean":return t;default:throw new Kn(`Unexpected endpoint property type: ${typeof t}`)}},KS=(t,e)=>Object.entries(t).reduce((n,[i,s])=>({...n,[i]:WS(s,e)}),{}),bF=(t,e)=>{const n=Jh(t,"Endpoint URL",e);if(typeof n=="string")try{return new URL(n)}catch(i){throw console.error(`Failed to construct URL with ${n}`,i),i}throw new Kn(`Endpoint URL must be a string, got ${typeof n}`)},TF=(t,e)=>{const{conditions:n,endpoint:i}=t,{result:s,referenceRecord:r}=Tp(n,e);if(!s)return;const o={...e,referenceRecord:{...e.referenceRecord,...r}},{url:a,properties:l,headers:c}=i;return e.logger?.debug?.(`${hl} Resolving endpoint from template: ${$s(i)}`),{...c!=null&&{headers:CF(c,o)},...l!=null&&{properties:KS(l,o)},url:bF(a,o)}},RF=(t,e)=>{const{conditions:n,error:i}=t,{result:s,referenceRecord:r}=Tp(n,e);if(s)throw new Kn(Jh(i,"Error",{...e,referenceRecord:{...e.referenceRecord,...r}}))},vF=(t,e)=>{const{conditions:n,rules:i}=t,{result:s,referenceRecord:r}=Tp(n,e);if(s)return YS(i,{...e,referenceRecord:{...e.referenceRecord,...r}})},YS=(t,e)=>{for(const n of t)if(n.type==="endpoint"){const i=TF(n,e);if(i)return i}else if(n.type==="error")RF(n,e);else if(n.type==="tree"){const i=vF(n,e);if(i)return i}else throw new Kn(`Unknown endpoint rule: ${n}`);throw new Kn("Rules evaluation failed")},AF=(t,e)=>{const{endpointParams:n,logger:i}=e,{parameters:s,rules:r}=t;e.logger?.debug?.(`${hl} Initial EndpointParams: ${$s(n)}`);const o=Object.entries(s).filter(([,c])=>c.default!=null).map(([c,h])=>[c,h.default]);if(o.length>0)for(const[c,h]of o)n[c]=n[c]??h;const a=Object.entries(s).filter(([,c])=>c.required).map(([c])=>c);for(const c of a)if(n[c]==null)throw new Kn(`Missing required parameter: '${c}'`);const l=YS(r,{endpointParams:n,logger:i,referenceRecord:{}});return e.logger?.debug?.(`${hl} Resolved endpoint: ${$s(l)}`),l},qS=(t,e=!1)=>{if(e){for(const n of t.split("."))if(!qS(n))return!1;return!0}return!(!bp(t)||t.length<3||t.length>63||t!==t.toLowerCase()||zS(t))},B0=":",IF="/",PF=t=>{const e=t.split(B0);if(e.length<6)return null;const[n,i,s,r,o,...a]=e;if(n!=="arn"||i===""||s===""||a.join(B0)==="")return null;const l=a.map(c=>c.split(IF)).flat();return{partition:i,service:s,region:r,accountId:o,resourceId:l}},MF=[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il|mx)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-east-2":{description:"Asia Pacific (Taipei)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"ap-southeast-5":{description:"Asia Pacific (Malaysia)"},"ap-southeast-7":{description:"Asia Pacific (Thailand)"},"aws-global":{description:"aws global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"mx-central-1":{description:"Mexico (Central)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"aws-cn global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-eusc",outputs:{dnsSuffix:"amazonaws.eu",dualStackDnsSuffix:"api.amazonwebservices.eu",implicitGlobalRegion:"eusc-de-east-1",name:"aws-eusc",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^eusc\\-(de)\\-\\w+\\-\\d+$",regions:{"eusc-de-east-1":{description:"EU (Germany)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"api.aws.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"aws-iso global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"api.aws.scloud",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"aws-iso-b global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"api.cloud-aws.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{"aws-iso-e-global":{description:"aws-iso-e global region"},"eu-isoe-west-1":{description:"EU ISOE West"}}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"api.aws.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{"aws-iso-f-global":{description:"aws-iso-f global region"},"us-isof-east-1":{description:"US ISOF EAST"},"us-isof-south-1":{description:"US ISOF SOUTH"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"aws-us-gov global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}}],FF={partitions:MF};let DF=FF;const OF=t=>{const{partitions:e}=DF;for(const i of e){const{regions:s,outputs:r}=i;for(const[o,a]of Object.entries(s))if(o===t)return{...r,...a}}for(const i of e){const{regionRegex:s,outputs:r}=i;if(new RegExp(s).test(t))return{...r}}const n=e.find(i=>i.id==="aws");if(!n)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...n.outputs}},ZS={isVirtualHostableS3Bucket:qS,parseArn:PF,partition:OF};dh.aws=ZS;function LF(t){const e={};if(t=t.replace(/^\?/,""),t)for(const n of t.split("&")){let[i,s=null]=n.split("=");i=decodeURIComponent(i),s&&(s=decodeURIComponent(s)),i in e?Array.isArray(e[i])?e[i].push(s):e[i]=[e[i],s]:e[i]=s}return e}const fh=t=>{if(typeof t=="string")return fh(new URL(t));const{hostname:e,pathname:n,port:i,protocol:s,search:r}=t;let o;return r&&(o=LF(r)),{hostname:e,port:i?parseInt(i):void 0,protocol:s,path:n,query:o}},kF=/\d{12}\.ddb/;async function NF(t,e,n){if(n.request?.headers?.["smithy-protocol"]==="rpc-v2-cbor"&&Rt(t,"PROTOCOL_RPC_V2_CBOR","M"),typeof e.retryStrategy=="function"){const r=await e.retryStrategy();typeof r.acquireInitialRetryToken=="function"?r.constructor?.name?.includes("Adaptive")?Rt(t,"RETRY_MODE_ADAPTIVE","F"):Rt(t,"RETRY_MODE_STANDARD","E"):Rt(t,"RETRY_MODE_LEGACY","D")}if(typeof e.accountIdEndpointMode=="function"){const r=t.endpointV2;switch(String(r?.url?.hostname).match(kF)&&Rt(t,"ACCOUNT_ID_ENDPOINT","O"),await e.accountIdEndpointMode?.()){case"disabled":Rt(t,"ACCOUNT_ID_MODE_DISABLED","Q");break;case"preferred":Rt(t,"ACCOUNT_ID_MODE_PREFERRED","P");break;case"required":Rt(t,"ACCOUNT_ID_MODE_REQUIRED","R");break}}const s=t.__smithy_context?.selectedHttpAuthScheme?.identity;if(s?.$source){const r=s;r.accountId&&Rt(t,"RESOLVED_ACCOUNT_ID","T");for(const[o,a]of Object.entries(r.$source??{}))Rt(t,o,a)}}const U0="user-agent",ld="x-amz-user-agent",G0=" ",cd="/",BF=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w]/g,UF=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w\#]/g,$0="-",GF=1024;function $F(t){let e="";for(const n in t){const i=t[n];if(e.length+i.length+1<=GF){e.length?e+=","+i:e+=i;continue}break}return e}const jF=t=>(e,n)=>async i=>{const{request:s}=i;if(!Ft.isInstance(s))return e(i);const{headers:r}=s,o=n?.userAgent?.map(nc)||[],a=(await t.defaultUserAgentProvider()).map(nc);await NF(n,t,i);const l=n;a.push(`m/${$F(Object.assign({},n.__smithy_context?.features,l.__aws_sdk_context?.features))}`);const c=t?.customUserAgent?.map(nc)||[],h=await t.userAgentAppId();h&&a.push(nc([`app/${h}`]));const u=[].concat([...a,...o,...c]).join(G0),d=[...a.filter(f=>f.startsWith("aws-sdk-")),...c].join(G0);return t.runtime!=="browser"?(d&&(r[ld]=r[ld]?`${r[U0]} ${d}`:d),r[U0]=u):r[ld]=u,e({...i,request:s})},nc=t=>{const e=t[0].split(cd).map(o=>o.replace(BF,$0)).join(cd),n=t[1]?.replace(UF,$0),i=e.indexOf(cd),s=e.substring(0,i);let r=e.substring(i+1);return s==="api"&&(r=r.toLowerCase()),[s,r,n].filter(o=>o&&o.length>0).reduce((o,a,l)=>{switch(l){case 0:return a;case 1:return`${o}/${a}`;default:return`${o}#${a}`}},"")},zF={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},HF=t=>({applyToStack:e=>{e.add(jF(t),zF)}}),XF=!1,VF=!1,JS=t=>typeof t=="string"&&(t.startsWith("fips-")||t.endsWith("-fips")),j0=t=>JS(t)?["fips-aws-global","aws-fips"].includes(t)?"us-east-1":t.replace(/fips-(dkr-|prod-)?|-fips/,""):t,WF=t=>{const{region:e,useFipsEndpoint:n}=t;if(!e)throw new Error("Region is missing");return Object.assign(t,{region:async()=>{if(typeof e=="string")return j0(e);const i=await e();return j0(i)},useFipsEndpoint:async()=>{const i=typeof e=="string"?e:await e();return JS(i)?!0:typeof n!="function"?Promise.resolve(!!n):n()}})},KF=t=>Object.assign(t,{eventStreamMarshaller:t.eventStreamSerdeProvider(t)}),z0="content-length";function YF(t){return e=>async n=>{const i=n.request;if(Ft.isInstance(i)){const{body:s,headers:r}=i;if(s&&Object.keys(r).map(o=>o.toLowerCase()).indexOf(z0)===-1)try{const o=t(s);i.headers={...i.headers,[z0]:String(o)}}catch{}}return e({...n,request:i})}}const qF={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},ZF=t=>({applyToStack:e=>{e.add(YF(t.bodyLengthChecker),qF)}}),JF=async t=>{const e=t?.Bucket||"";if(typeof t.Bucket=="string"&&(t.Bucket=e.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),i2(e)){if(t.ForcePathStyle===!0)throw new Error("Path-style addressing cannot be used with ARN buckets")}else(!n2(e)||e.indexOf(".")!==-1&&!String(t.Endpoint).startsWith("http:")||e.toLowerCase()!==e||e.length<3)&&(t.ForcePathStyle=!0);return t.DisableMultiRegionAccessPoints&&(t.disableMultiRegionAccessPoints=!0,t.DisableMRAP=!0),t},QF=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,e2=/(\d+\.){3}\d+/,t2=/\.\./,n2=t=>QF.test(t)&&!e2.test(t)&&!t2.test(t),i2=t=>{const[e,n,i,,,s]=t.split(":"),r=e==="arn"&&t.split(":").length>=6,o=!!(r&&n&&i&&s);if(r&&!o)throw new Error(`Invalid ARN: ${t} was an invalid ARN.`);return o},s2=(t,e,n)=>{const i=async()=>{const s=n[t]??n[e];return typeof s=="function"?s():s};return t==="credentialScope"||e==="CredentialScope"?async()=>{const s=typeof n.credentials=="function"?await n.credentials():n.credentials;return s?.credentialScope??s?.CredentialScope}:t==="accountId"||e==="AccountId"?async()=>{const s=typeof n.credentials=="function"?await n.credentials():n.credentials;return s?.accountId??s?.AccountId}:t==="endpoint"||e==="endpoint"?async()=>{if(n.isCustomEndpoint===!1)return;const s=await i();if(s&&typeof s=="object"){if("url"in s)return s.url.href;if("hostname"in s){const{protocol:r,hostname:o,port:a,path:l}=s;return`${r}//${o}${a?":"+a:""}${l}`}}return s}:i},QS=async t=>{},eC=t=>typeof t=="object"?"url"in t?fh(t.url):t:fh(t),r2=async(t,e,n,i)=>{if(!n.isCustomEndpoint){let o;n.serviceConfiguredEndpoint?o=await n.serviceConfiguredEndpoint():o=await QS(n.serviceId),o&&(n.endpoint=()=>Promise.resolve(eC(o)),n.isCustomEndpoint=!0)}const s=await tC(t,e,n);if(typeof n.endpointProvider!="function")throw new Error("config.endpointProvider is not set.");return n.endpointProvider(s,i)},tC=async(t,e,n)=>{const i={},s=e?.getEndpointParameterInstructions?.()||{};for(const[r,o]of Object.entries(s))switch(o.type){case"staticContextParams":i[r]=o.value;break;case"contextParams":i[r]=t[o.name];break;case"clientContextParams":case"builtInParams":i[r]=await s2(o.name,r,n)();break;case"operationContextParams":i[r]=o.get(t);break;default:throw new Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(o))}return Object.keys(s).length===0&&Object.assign(i,n),String(n.serviceId).toLowerCase()==="s3"&&await JF(i),i},o2=({config:t,instructions:e})=>(n,i)=>async s=>{t.isCustomEndpoint&&KA(i,"ENDPOINT_OVERRIDE","N");const r=await r2(s.input,{getEndpointParameterInstructions(){return e}},{...t},i);i.endpointV2=r,i.authSchemes=r.properties?.authSchemes;const o=i.authSchemes?.[0];if(o){i.signing_region=o.signingRegion,i.signing_service=o.signingName;const l=Wo(i)?.selectedHttpAuthScheme?.httpAuthOption;l&&(l.signingProperties=Object.assign(l.signingProperties||{},{signing_region:o.signingRegion,signingRegion:o.signingRegion,signing_service:o.signingName,signingName:o.signingName,signingRegionSet:o.signingRegionSet},o.properties))}return n({...s})},a2={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:dS.name},Qh=(t,e)=>({applyToStack:n=>{n.addRelativeTo(o2({config:t,instructions:e}),a2)}}),l2=t=>{const e=t.tls??!0,{endpoint:n,useDualstackEndpoint:i,useFipsEndpoint:s}=t,r=n!=null?async()=>eC(await pi(n)()):void 0,a=Object.assign(t,{endpoint:r,tls:e,isCustomEndpoint:!!n,useDualstackEndpoint:pi(i??!1),useFipsEndpoint:pi(s??!1)});let l;return a.serviceConfiguredEndpoint=async()=>(t.serviceId&&!l&&(l=QS(t.serviceId)),l),a};var Do;(function(t){t.STANDARD="standard",t.ADAPTIVE="adaptive"})(Do||(Do={}));const gh=3,c2=Do.STANDARD,h2=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],u2=["TimeoutError","RequestTimeout","RequestTimeoutException"],d2=[500,502,503,504],f2=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"],g2=["EHOSTUNREACH","ENETUNREACH","ENOTFOUND"],p2=t=>t.$metadata?.clockSkewCorrected,m2=t=>{const e=new Set(["Failed to fetch","NetworkError when attempting to fetch resource","The Internet connection appears to be offline","Load failed","Network request failed"]);return t&&t instanceof TypeError?e.has(t.message):!1},nC=t=>t.$metadata?.httpStatusCode===429||h2.includes(t.name)||t.$retryable?.throttling==!0,Rp=(t,e=0)=>p2(t)||u2.includes(t.name)||f2.includes(t?.code||"")||g2.includes(t?.code||"")||d2.includes(t.$metadata?.httpStatusCode||0)||m2(t)||t.cause!==void 0&&e<=10&&Rp(t.cause,e+1),_2=t=>{if(t.$metadata?.httpStatusCode!==void 0){const e=t.$metadata.httpStatusCode;return 500<=e&&e<=599&&!Rp(t)}return!1};class eu{constructor(e){this.currentCapacity=0,this.enabled=!1,this.lastMaxRate=0,this.measuredTxRate=0,this.requestCount=0,this.lastTimestamp=0,this.timeWindow=0,this.beta=e?.beta??.7,this.minCapacity=e?.minCapacity??1,this.minFillRate=e?.minFillRate??.5,this.scaleConstant=e?.scaleConstant??.4,this.smooth=e?.smooth??.8;const n=this.getCurrentTimeInSeconds();this.lastThrottleTime=n,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(e){if(this.enabled){if(this.refillTokenBucket(),e>this.currentCapacity){const n=(e-this.currentCapacity)/this.fillRate*1e3;await new Promise(i=>eu.setTimeoutFn(i,n))}this.currentCapacity=this.currentCapacity-e}}refillTokenBucket(){const e=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=e;return}const n=(e-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+n),this.lastTimestamp=e}updateClientSendingRate(e){let n;if(this.updateMeasuredRate(),nC(e)){const s=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=s,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),n=this.cubicThrottle(s),this.enableTokenBucket()}else this.calculateTimeWindow(),n=this.cubicSuccess(this.getCurrentTimeInSeconds());const i=Math.min(n,2*this.measuredTxRate);this.updateTokenBucketRate(i)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(e){return this.getPrecise(e*this.beta)}cubicSuccess(e){return this.getPrecise(this.scaleConstant*Math.pow(e-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(e){this.refillTokenBucket(),this.fillRate=Math.max(e,this.minFillRate),this.maxCapacity=Math.max(e,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){const e=this.getCurrentTimeInSeconds(),n=Math.floor(e*2)/2;if(this.requestCount++,n>this.lastTxRateBucket){const i=this.requestCount/(n-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(i*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=n}}getPrecise(e){return parseFloat(e.toFixed(8))}}eu.setTimeoutFn=setTimeout;const rg=100,iC=20*1e3,y2=500,H0=500,E2=5,x2=10,w2=1,S2="amz-sdk-invocation-id",C2="amz-sdk-request",b2=()=>{let t=rg;return{computeNextBackoffDelay:i=>Math.floor(Math.min(iC,Math.random()*2**i*t)),setDelayBase:i=>{t=i}}},X0=({retryDelay:t,retryCount:e,retryCost:n})=>({getRetryCount:()=>e,getRetryDelay:()=>Math.min(iC,t),getRetryCost:()=>n});class sC{constructor(e){this.maxAttempts=e,this.mode=Do.STANDARD,this.capacity=H0,this.retryBackoffStrategy=b2(),this.maxAttemptsProvider=typeof e=="function"?e:async()=>e}async acquireInitialRetryToken(e){return X0({retryDelay:rg,retryCount:0})}async refreshRetryTokenForRetry(e,n){const i=await this.getMaxAttempts();if(this.shouldRetry(e,n,i)){const s=n.errorType;this.retryBackoffStrategy.setDelayBase(s==="THROTTLING"?y2:rg);const r=this.retryBackoffStrategy.computeNextBackoffDelay(e.getRetryCount()),o=n.retryAfterHint?Math.max(n.retryAfterHint.getTime()-Date.now()||0,r):r,a=this.getCapacityCost(s);return this.capacity-=a,X0({retryDelay:o,retryCount:e.getRetryCount()+1,retryCost:a})}throw new Error("No retry token available")}recordSuccess(e){this.capacity=Math.max(H0,this.capacity+(e.getRetryCost()??w2))}getCapacity(){return this.capacity}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch{return console.warn(`Max attempts provider could not resolve. Using default of ${gh}`),gh}}shouldRetry(e,n,i){return e.getRetryCount()+1<i&&this.capacity>=this.getCapacityCost(n.errorType)&&this.isRetryableError(n.errorType)}getCapacityCost(e){return e==="TRANSIENT"?x2:E2}isRetryableError(e){return e==="THROTTLING"||e==="TRANSIENT"}}class T2{constructor(e,n){this.maxAttemptsProvider=e,this.mode=Do.ADAPTIVE;const{rateLimiter:i}=n??{};this.rateLimiter=i??new eu,this.standardRetryStrategy=new sC(e)}async acquireInitialRetryToken(e){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(e)}async refreshRetryTokenForRetry(e,n){return this.rateLimiter.updateClientSendingRate(n),this.standardRetryStrategy.refreshRetryTokenForRetry(e,n)}recordSuccess(e){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(e)}}const R2=t=>t instanceof Error?t:t instanceof Object?Object.assign(new Error,t):typeof t=="string"?new Error(t):new Error(`AWS SDK error wrapper for ${t}`),v2=t=>{const{retryStrategy:e,retryMode:n,maxAttempts:i}=t,s=pi(i??gh);return Object.assign(t,{maxAttempts:s,retryStrategy:async()=>e||(await pi(n)()===Do.ADAPTIVE?new T2(s):new sC(s))})},A2=t=>t?.body instanceof ReadableStream,I2=t=>(e,n)=>async i=>{let s=await t.retryStrategy();const r=await t.maxAttempts();if(P2(s)){s=s;let o=await s.acquireInitialRetryToken(n.partition_id),a=new Error,l=0,c=0;const{request:h}=i,u=Ft.isInstance(h);for(u&&(h.headers[S2]=HA());;)try{u&&(h.headers[C2]=`attempt=${l+1}; max=${r}`);const{response:d,output:f}=await e(i);return s.recordSuccess(o),f.$metadata.attempts=l+1,f.$metadata.totalRetryDelay=c,{response:d,output:f}}catch(d){const f=M2(d);if(a=R2(d),u&&A2(h))throw(n.logger instanceof gp?console:n.logger)?.warn("An error was encountered in a non-retryable streaming request."),a;try{o=await s.refreshRetryTokenForRetry(o,f)}catch{throw a.$metadata||(a.$metadata={}),a.$metadata.attempts=l+1,a.$metadata.totalRetryDelay=c,a}l=o.getRetryCount();const g=o.getRetryDelay();c+=g,await new Promise(m=>setTimeout(m,g))}}else return s=s,s?.mode&&(n.userAgent=[...n.userAgent||[],["cfg/retry-mode",s.mode]]),s.retry(e,i)},P2=t=>typeof t.acquireInitialRetryToken<"u"&&typeof t.refreshRetryTokenForRetry<"u"&&typeof t.recordSuccess<"u",M2=t=>{const e={error:t,errorType:F2(t)},n=L2(t.$response);return n&&(e.retryAfterHint=n),e},F2=t=>nC(t)?"THROTTLING":Rp(t)?"TRANSIENT":_2(t)?"SERVER_ERROR":"CLIENT_ERROR",D2={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},O2=t=>({applyToStack:e=>{e.add(I2(t),D2)}}),L2=t=>{if(!Rr.isInstance(t))return;const e=Object.keys(t.headers).find(r=>r.toLowerCase()==="retry-after");if(!e)return;const n=t.headers[e],i=Number(n);return Number.isNaN(i)?new Date(n):new Date(i*1e3)};class rC{sigv4aSigner;sigv4Signer;signerOptions;static sigv4aDependency(){return"none"}constructor(e){this.sigv4Signer=new UM(e),this.signerOptions=e}async sign(e,n={}){return n.signingRegion==="*"?this.getSigv4aSigner().sign(e,n):this.sigv4Signer.sign(e,n)}async signWithCredentials(e,n,i={}){if(i.signingRegion==="*")throw this.getSigv4aSigner(),new Error(`signWithCredentials with signingRegion '*' is only supported when using the CRT dependency @aws-sdk/signature-v4-crt. Please check whether you have installed the "@aws-sdk/signature-v4-crt" package explicitly. You must also register the package by calling [require("@aws-sdk/signature-v4-crt");] or an ESM equivalent such as [import "@aws-sdk/signature-v4-crt";]. For more information please go to https://github.com/aws/aws-sdk-js-v3#functionality-requiring-aws-common-runtime-crt`);return this.sigv4Signer.signWithCredentials(e,n,i)}async presign(e,n={}){if(n.signingRegion==="*")throw this.getSigv4aSigner(),new Error(`presign with signingRegion '*' is only supported when using the CRT dependency @aws-sdk/signature-v4-crt. Please check whether you have installed the "@aws-sdk/signature-v4-crt" package explicitly. You must also register the package by calling [require("@aws-sdk/signature-v4-crt");] or an ESM equivalent such as [import "@aws-sdk/signature-v4-crt";]. For more information please go to https://github.com/aws/aws-sdk-js-v3#functionality-requiring-aws-common-runtime-crt`);return this.sigv4Signer.presign(e,n)}async presignWithCredentials(e,n,i={}){if(i.signingRegion==="*")throw new Error("Method presignWithCredentials is not supported for [signingRegion=*].");return this.sigv4Signer.presignWithCredentials(e,n,i)}getSigv4aSigner(){if(!this.sigv4aSigner)throw this.signerOptions.runtime==="node"?new Error("Neither CRT nor JS SigV4a implementation is available. Please load either @aws-sdk/signature-v4-crt or @aws-sdk/signature-v4a. For more information please go to https://github.com/aws/aws-sdk-js-v3#functionality-requiring-aws-common-runtime-crt"):new Error("JS SigV4a implementation is not available or not a valid constructor. Please check whether you have installed the @aws-sdk/signature-v4a package explicitly. The CRT implementation is not available for browsers. You must also register the package by calling [require('@aws-sdk/signature-v4a');] or an ESM equivalent such as [import '@aws-sdk/signature-v4a';]. For more information please go to https://github.com/aws/aws-sdk-js-v3#using-javascript-non-crt-implementation-of-sigv4a");return this.sigv4aSigner}}const vp="required",S="type",L="rules",T="conditions",F="fn",D="argv",fe="ref",Me="assign",le="url",ce="properties",pr="backend",ln="authSchemes",Gt="disableDoubleEncoding",$t="signingName",Sn="signingRegion",he="headers",Ap="signingRegionSet",k2=6,N2=!1,xi=!0,zn="isSet",bt="booleanEquals",ae="error",ph="aws.partition",ze="stringEquals",pt="getAttr",St="name",rt="substring",V0="bucketSuffix",Ip="parseURL",X="endpoint",k="tree",mh="aws.isVirtualHostableS3Bucket",_h="{url#scheme}://{Bucket}.{url#authority}{url#path}",Di="not",W0="accessPointSuffix",Hc="{url#scheme}://{url#authority}{url#path}",oC="hardwareType",aC="regionPrefix",K0="bucketAliasSuffix",og="outpostId",Mr="isValidHostLabel",Pp="sigv4a",ul="s3-outposts",Oo="s3",lC="{url#scheme}://{url#authority}{url#normalizedPath}{Bucket}",cC="https://{Bucket}.s3-accelerate.{partitionResult#dnsSuffix}",Y0="https://{Bucket}.s3.{partitionResult#dnsSuffix}",hC="aws.parseArn",uC="bucketArn",dC="arnType",yh="",Mp="s3-object-lambda",fC="accesspoint",Fp="accessPointName",q0="{url#scheme}://{accessPointName}-{bucketArn#accountId}.{url#authority}{url#path}",Z0="mrapPartition",J0="outpostType",Q0="arnPrefix",gC="{url#scheme}://{url#authority}{url#normalizedPath}{uri_encoded_bucket}",ey="https://s3.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",ty="https://s3.{partitionResult#dnsSuffix}",Br={[vp]:!1,[S]:"String"},Ur={[vp]:!0,default:!1,[S]:"Boolean"},ma={[vp]:!1,[S]:"Boolean"},ti={[F]:bt,[D]:[{[fe]:"Accelerate"},!0]},ht={[F]:bt,[D]:[{[fe]:"UseFIPS"},!0]},nt={[F]:bt,[D]:[{[fe]:"UseDualStack"},!0]},xt={[F]:zn,[D]:[{[fe]:"Endpoint"}]},pC={[F]:ph,[D]:[{[fe]:"Region"}],[Me]:"partitionResult"},ny={[F]:ze,[D]:[{[F]:pt,[D]:[{[fe]:"partitionResult"},St]},"aws-cn"]},Xa={[F]:zn,[D]:[{[fe]:"Bucket"}]},$e={[fe]:"Bucket"},iy={[T]:[nt],[ae]:"S3Express does not support Dual-stack.",[S]:ae},sy={[T]:[ti],[ae]:"S3Express does not support S3 Accelerate.",[S]:ae},ry={[T]:[xt,{[F]:Ip,[D]:[{[fe]:"Endpoint"}],[Me]:"url"}],[L]:[{[T]:[{[F]:zn,[D]:[{[fe]:"DisableS3ExpressSessionAuth"}]},{[F]:bt,[D]:[{[fe]:"DisableS3ExpressSessionAuth"},!0]}],[L]:[{[T]:[{[F]:bt,[D]:[{[F]:pt,[D]:[{[fe]:"url"},"isIp"]},!0]}],[L]:[{[T]:[{[F]:"uriEncode",[D]:[$e],[Me]:"uri_encoded_bucket"}],[L]:[{[X]:{[le]:"{url#scheme}://{url#authority}/{uri_encoded_bucket}{url#path}",[ce]:{[pr]:"S3Express",[ln]:[{[Gt]:!0,[St]:"sigv4",[$t]:"s3express",[Sn]:"{Region}"}]},[he]:{}},[S]:X}],[S]:k}],[S]:k},{[T]:[{[F]:mh,[D]:[$e,!1]}],[L]:[{[X]:{[le]:_h,[ce]:{[pr]:"S3Express",[ln]:[{[Gt]:!0,[St]:"sigv4",[$t]:"s3express",[Sn]:"{Region}"}]},[he]:{}},[S]:X}],[S]:k},{[ae]:"S3Express bucket name is not a valid virtual hostable name.",[S]:ae}],[S]:k},{[T]:[{[F]:bt,[D]:[{[F]:pt,[D]:[{[fe]:"url"},"isIp"]},!0]}],[L]:[{[T]:[{[F]:"uriEncode",[D]:[$e],[Me]:"uri_encoded_bucket"}],[L]:[{[X]:{[le]:"{url#scheme}://{url#authority}/{uri_encoded_bucket}{url#path}",[ce]:{[pr]:"S3Express",[ln]:[{[Gt]:!0,[St]:"sigv4-s3express",[$t]:"s3express",[Sn]:"{Region}"}]},[he]:{}},[S]:X}],[S]:k}],[S]:k},{[T]:[{[F]:mh,[D]:[$e,!1]}],[L]:[{[X]:{[le]:_h,[ce]:{[pr]:"S3Express",[ln]:[{[Gt]:!0,[St]:"sigv4-s3express",[$t]:"s3express",[Sn]:"{Region}"}]},[he]:{}},[S]:X}],[S]:k},{[ae]:"S3Express bucket name is not a valid virtual hostable name.",[S]:ae}],[S]:k},gn={[F]:Ip,[D]:[{[fe]:"Endpoint"}],[Me]:"url"},hd={[F]:bt,[D]:[{[F]:pt,[D]:[{[fe]:"url"},"isIp"]},!0]},mC={[fe]:"url"},_C={[F]:"uriEncode",[D]:[$e],[Me]:"uri_encoded_bucket"},dr={[pr]:"S3Express",[ln]:[{[Gt]:!0,[St]:"sigv4",[$t]:"s3express",[Sn]:"{Region}"}]},Te={},yC={[F]:mh,[D]:[$e,!1]},oy={[ae]:"S3Express bucket name is not a valid virtual hostable name.",[S]:ae},ay={[F]:zn,[D]:[{[fe]:"UseS3ExpressControlEndpoint"}]},ly={[F]:bt,[D]:[{[fe]:"UseS3ExpressControlEndpoint"},!0]},Re={[F]:Di,[D]:[xt]},ic={[ae]:"Unrecognized S3Express bucket name format.",[S]:ae},cy={[F]:Di,[D]:[Xa]},hy={[fe]:oC},uy={[T]:[Re],[ae]:"Expected a endpoint to be specified but no endpoint was found",[S]:ae},sc={[ln]:[{[Gt]:!0,[St]:Pp,[$t]:ul,[Ap]:["*"]},{[Gt]:!0,[St]:"sigv4",[$t]:ul,[Sn]:"{Region}"}]},ud={[F]:bt,[D]:[{[fe]:"ForcePathStyle"},!1]},B2={[fe]:"ForcePathStyle"},Tt={[F]:bt,[D]:[{[fe]:"Accelerate"},!1]},Dt={[F]:ze,[D]:[{[fe]:"Region"},"aws-global"]},Lt={[ln]:[{[Gt]:!0,[St]:"sigv4",[$t]:Oo,[Sn]:"us-east-1"}]},Ue={[F]:Di,[D]:[Dt]},kt={[F]:bt,[D]:[{[fe]:"UseGlobalEndpoint"},!0]},dy={[le]:"https://{Bucket}.s3-fips.dualstack.{Region}.{partitionResult#dnsSuffix}",[ce]:{[ln]:[{[Gt]:!0,[St]:"sigv4",[$t]:Oo,[Sn]:"{Region}"}]},[he]:{}},Pt={[ln]:[{[Gt]:!0,[St]:"sigv4",[$t]:Oo,[Sn]:"{Region}"}]},Nt={[F]:bt,[D]:[{[fe]:"UseGlobalEndpoint"},!1]},Be={[F]:bt,[D]:[{[fe]:"UseDualStack"},!1]},fy={[le]:"https://{Bucket}.s3-fips.{Region}.{partitionResult#dnsSuffix}",[ce]:Pt,[he]:{}},Le={[F]:bt,[D]:[{[fe]:"UseFIPS"},!1]},gy={[le]:"https://{Bucket}.s3-accelerate.dualstack.{partitionResult#dnsSuffix}",[ce]:Pt,[he]:{}},py={[le]:"https://{Bucket}.s3.dualstack.{Region}.{partitionResult#dnsSuffix}",[ce]:Pt,[he]:{}},dd={[F]:bt,[D]:[{[F]:pt,[D]:[mC,"isIp"]},!1]},fd={[le]:lC,[ce]:Pt,[he]:{}},ag={[le]:_h,[ce]:Pt,[he]:{}},my={[X]:ag,[S]:X},gd={[le]:cC,[ce]:Pt,[he]:{}},_y={[le]:"https://{Bucket}.s3.{Region}.{partitionResult#dnsSuffix}",[ce]:Pt,[he]:{}},rc={[ae]:"Invalid region: region was not a valid DNS name.",[S]:ae},kn={[fe]:uC},EC={[fe]:dC},pd={[F]:pt,[D]:[kn,"service"]},Dp={[fe]:Fp},yy={[T]:[nt],[ae]:"S3 Object Lambda does not support Dual-stack",[S]:ae},Ey={[T]:[ti],[ae]:"S3 Object Lambda does not support S3 Accelerate",[S]:ae},xy={[T]:[{[F]:zn,[D]:[{[fe]:"DisableAccessPoints"}]},{[F]:bt,[D]:[{[fe]:"DisableAccessPoints"},!0]}],[ae]:"Access points are not supported for this operation",[S]:ae},md={[T]:[{[F]:zn,[D]:[{[fe]:"UseArnRegion"}]},{[F]:bt,[D]:[{[fe]:"UseArnRegion"},!1]},{[F]:Di,[D]:[{[F]:ze,[D]:[{[F]:pt,[D]:[kn,"region"]},"{Region}"]}]}],[ae]:"Invalid configuration: region from ARN `{bucketArn#region}` does not match client region `{Region}` and UseArnRegion is `false`",[S]:ae},xC={[F]:pt,[D]:[{[fe]:"bucketPartition"},St]},wC={[F]:pt,[D]:[kn,"accountId"]},_d={[ln]:[{[Gt]:!0,[St]:"sigv4",[$t]:Mp,[Sn]:"{bucketArn#region}"}]},wy={[ae]:"Invalid ARN: The access point name may only contain a-z, A-Z, 0-9 and `-`. Found: `{accessPointName}`",[S]:ae},yd={[ae]:"Invalid ARN: The account id may only contain a-z, A-Z, 0-9 and `-`. Found: `{bucketArn#accountId}`",[S]:ae},Ed={[ae]:"Invalid region in ARN: `{bucketArn#region}` (invalid DNS name)",[S]:ae},xd={[ae]:"Client was configured for partition `{partitionResult#name}` but ARN (`{Bucket}`) has `{bucketPartition#name}`",[S]:ae},Sy={[ae]:"Invalid ARN: The ARN may only contain a single resource component after `accesspoint`.",[S]:ae},Cy={[ae]:"Invalid ARN: Expected a resource of the format `accesspoint:<accesspoint name>` but no name was provided",[S]:ae},_a={[ln]:[{[Gt]:!0,[St]:"sigv4",[$t]:Oo,[Sn]:"{bucketArn#region}"}]},by={[ln]:[{[Gt]:!0,[St]:Pp,[$t]:ul,[Ap]:["*"]},{[Gt]:!0,[St]:"sigv4",[$t]:ul,[Sn]:"{bucketArn#region}"}]},Ty={[F]:hC,[D]:[$e]},Ry={[le]:"https://s3-fips.dualstack.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[ce]:Pt,[he]:{}},vy={[le]:"https://s3-fips.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[ce]:Pt,[he]:{}},Ay={[le]:"https://s3.dualstack.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[ce]:Pt,[he]:{}},wd={[le]:gC,[ce]:Pt,[he]:{}},Iy={[le]:"https://s3.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[ce]:Pt,[he]:{}},Py={[fe]:"UseObjectLambdaEndpoint"},Sd={[ln]:[{[Gt]:!0,[St]:"sigv4",[$t]:Mp,[Sn]:"{Region}"}]},My={[le]:"https://s3-fips.dualstack.{Region}.{partitionResult#dnsSuffix}",[ce]:Pt,[he]:{}},Fy={[le]:"https://s3-fips.{Region}.{partitionResult#dnsSuffix}",[ce]:Pt,[he]:{}},Dy={[le]:"https://s3.dualstack.{Region}.{partitionResult#dnsSuffix}",[ce]:Pt,[he]:{}},Cd={[le]:Hc,[ce]:Pt,[he]:{}},Oy={[le]:"https://s3.{Region}.{partitionResult#dnsSuffix}",[ce]:Pt,[he]:{}},bd=[{[fe]:"Region"}],U2=[{[fe]:"Endpoint"}],G2=[$e],Ly=[nt],Td=[ti],Gr=[xt,gn],ky=[{[F]:zn,[D]:[{[fe]:"DisableS3ExpressSessionAuth"}]},{[F]:bt,[D]:[{[fe]:"DisableS3ExpressSessionAuth"},!0]}],$2=[_C],Ny=[yC],ei=[pC],$r=[ht],By=[{[F]:rt,[D]:[$e,6,14,!0],[Me]:"s3expressAvailabilityZoneId"},{[F]:rt,[D]:[$e,14,16,!0],[Me]:"s3expressAvailabilityZoneDelim"},{[F]:ze,[D]:[{[fe]:"s3expressAvailabilityZoneDelim"},"--"]}],wi=[{[T]:[ht],[X]:{[le]:"https://{Bucket}.s3express-fips-{s3expressAvailabilityZoneId}.{Region}.{partitionResult#dnsSuffix}",[ce]:dr,[he]:{}},[S]:X},{[X]:{[le]:"https://{Bucket}.s3express-{s3expressAvailabilityZoneId}.{Region}.{partitionResult#dnsSuffix}",[ce]:dr,[he]:{}},[S]:X}],Uy=[{[F]:rt,[D]:[$e,6,15,!0],[Me]:"s3expressAvailabilityZoneId"},{[F]:rt,[D]:[$e,15,17,!0],[Me]:"s3expressAvailabilityZoneDelim"},{[F]:ze,[D]:[{[fe]:"s3expressAvailabilityZoneDelim"},"--"]}],Gy=[{[F]:rt,[D]:[$e,6,19,!0],[Me]:"s3expressAvailabilityZoneId"},{[F]:rt,[D]:[$e,19,21,!0],[Me]:"s3expressAvailabilityZoneDelim"},{[F]:ze,[D]:[{[fe]:"s3expressAvailabilityZoneDelim"},"--"]}],$y=[{[F]:rt,[D]:[$e,6,20,!0],[Me]:"s3expressAvailabilityZoneId"},{[F]:rt,[D]:[$e,20,22,!0],[Me]:"s3expressAvailabilityZoneDelim"},{[F]:ze,[D]:[{[fe]:"s3expressAvailabilityZoneDelim"},"--"]}],jy=[{[F]:rt,[D]:[$e,6,26,!0],[Me]:"s3expressAvailabilityZoneId"},{[F]:rt,[D]:[$e,26,28,!0],[Me]:"s3expressAvailabilityZoneDelim"},{[F]:ze,[D]:[{[fe]:"s3expressAvailabilityZoneDelim"},"--"]}],Si=[{[T]:[ht],[X]:{[le]:"https://{Bucket}.s3express-fips-{s3expressAvailabilityZoneId}.{Region}.{partitionResult#dnsSuffix}",[ce]:{[pr]:"S3Express",[ln]:[{[Gt]:!0,[St]:"sigv4-s3express",[$t]:"s3express",[Sn]:"{Region}"}]},[he]:{}},[S]:X},{[X]:{[le]:"https://{Bucket}.s3express-{s3expressAvailabilityZoneId}.{Region}.{partitionResult#dnsSuffix}",[ce]:{[pr]:"S3Express",[ln]:[{[Gt]:!0,[St]:"sigv4-s3express",[$t]:"s3express",[Sn]:"{Region}"}]},[he]:{}},[S]:X}],zy=[$e,0,7,!0],Hy=[{[F]:rt,[D]:[$e,7,15,!0],[Me]:"s3expressAvailabilityZoneId"},{[F]:rt,[D]:[$e,15,17,!0],[Me]:"s3expressAvailabilityZoneDelim"},{[F]:ze,[D]:[{[fe]:"s3expressAvailabilityZoneDelim"},"--"]}],Xy=[{[F]:rt,[D]:[$e,7,16,!0],[Me]:"s3expressAvailabilityZoneId"},{[F]:rt,[D]:[$e,16,18,!0],[Me]:"s3expressAvailabilityZoneDelim"},{[F]:ze,[D]:[{[fe]:"s3expressAvailabilityZoneDelim"},"--"]}],Vy=[{[F]:rt,[D]:[$e,7,20,!0],[Me]:"s3expressAvailabilityZoneId"},{[F]:rt,[D]:[$e,20,22,!0],[Me]:"s3expressAvailabilityZoneDelim"},{[F]:ze,[D]:[{[fe]:"s3expressAvailabilityZoneDelim"},"--"]}],Wy=[{[F]:rt,[D]:[$e,7,21,!0],[Me]:"s3expressAvailabilityZoneId"},{[F]:rt,[D]:[$e,21,23,!0],[Me]:"s3expressAvailabilityZoneDelim"},{[F]:ze,[D]:[{[fe]:"s3expressAvailabilityZoneDelim"},"--"]}],Ky=[{[F]:rt,[D]:[$e,7,27,!0],[Me]:"s3expressAvailabilityZoneId"},{[F]:rt,[D]:[$e,27,29,!0],[Me]:"s3expressAvailabilityZoneDelim"},{[F]:ze,[D]:[{[fe]:"s3expressAvailabilityZoneDelim"},"--"]}],j2=[Xa],Yy=[{[F]:Mr,[D]:[{[fe]:og},!1]}],qy=[{[F]:ze,[D]:[{[fe]:aC},"beta"]}],z2=["*"],Zy=[{[F]:Mr,[D]:[{[fe]:"Region"},!1]}],ds=[{[F]:ze,[D]:[{[fe]:"Region"},"us-east-1"]}],Rd=[{[F]:ze,[D]:[EC,fC]}],Jy=[{[F]:pt,[D]:[kn,"resourceId[1]"],[Me]:Fp},{[F]:Di,[D]:[{[F]:ze,[D]:[Dp,yh]}]}],H2=[kn,"resourceId[1]"],vd=[{[F]:Di,[D]:[{[F]:ze,[D]:[{[F]:pt,[D]:[kn,"region"]},yh]}]}],Qy=[{[F]:Di,[D]:[{[F]:zn,[D]:[{[F]:pt,[D]:[kn,"resourceId[2]"]}]}]}],X2=[kn,"resourceId[2]"],Ad=[{[F]:ph,[D]:[{[F]:pt,[D]:[kn,"region"]}],[Me]:"bucketPartition"}],eE=[{[F]:ze,[D]:[xC,{[F]:pt,[D]:[{[fe]:"partitionResult"},St]}]}],Id=[{[F]:Mr,[D]:[{[F]:pt,[D]:[kn,"region"]},!0]}],Pd=[{[F]:Mr,[D]:[wC,!1]}],tE=[{[F]:Mr,[D]:[Dp,!1]}],nE=[{[F]:Mr,[D]:[{[fe]:"Region"},!0]}],V2={parameters:{Bucket:Br,Region:Br,UseFIPS:Ur,UseDualStack:Ur,Endpoint:Br,ForcePathStyle:Ur,Accelerate:Ur,UseGlobalEndpoint:Ur,UseObjectLambdaEndpoint:ma,Key:Br,Prefix:Br,CopySource:Br,DisableAccessPoints:ma,DisableMultiRegionAccessPoints:Ur,UseArnRegion:ma,UseS3ExpressControlEndpoint:ma,DisableS3ExpressSessionAuth:ma},[L]:[{[T]:[{[F]:zn,[D]:bd}],[L]:[{[T]:[ti,ht],error:"Accelerate cannot be used with FIPS",[S]:ae},{[T]:[nt,xt],error:"Cannot set dual-stack in combination with a custom endpoint.",[S]:ae},{[T]:[xt,ht],error:"A custom endpoint cannot be combined with FIPS",[S]:ae},{[T]:[xt,ti],error:"A custom endpoint cannot be combined with S3 Accelerate",[S]:ae},{[T]:[ht,pC,ny],error:"Partition does not support FIPS",[S]:ae},{[T]:[Xa,{[F]:rt,[D]:[$e,0,k2,xi],[Me]:V0},{[F]:ze,[D]:[{[fe]:V0},"--x-s3"]}],[L]:[iy,sy,ry,{[T]:[ay,ly],[L]:[{[T]:ei,[L]:[{[T]:[_C,Re],[L]:[{[T]:$r,endpoint:{[le]:"https://s3express-control-fips.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[ce]:dr,[he]:Te},[S]:X},{endpoint:{[le]:"https://s3express-control.{Region}.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[ce]:dr,[he]:Te},[S]:X}],[S]:k}],[S]:k}],[S]:k},{[T]:Ny,[L]:[{[T]:ei,[L]:[{[T]:ky,[L]:[{[T]:By,[L]:wi,[S]:k},{[T]:Uy,[L]:wi,[S]:k},{[T]:Gy,[L]:wi,[S]:k},{[T]:$y,[L]:wi,[S]:k},{[T]:jy,[L]:wi,[S]:k},ic],[S]:k},{[T]:By,[L]:Si,[S]:k},{[T]:Uy,[L]:Si,[S]:k},{[T]:Gy,[L]:Si,[S]:k},{[T]:$y,[L]:Si,[S]:k},{[T]:jy,[L]:Si,[S]:k},ic],[S]:k}],[S]:k},oy],[S]:k},{[T]:[Xa,{[F]:rt,[D]:zy,[Me]:W0},{[F]:ze,[D]:[{[fe]:W0},"--xa-s3"]}],[L]:[iy,sy,ry,{[T]:Ny,[L]:[{[T]:ei,[L]:[{[T]:ky,[L]:[{[T]:Hy,[L]:wi,[S]:k},{[T]:Xy,[L]:wi,[S]:k},{[T]:Vy,[L]:wi,[S]:k},{[T]:Wy,[L]:wi,[S]:k},{[T]:Ky,[L]:wi,[S]:k},ic],[S]:k},{[T]:Hy,[L]:Si,[S]:k},{[T]:Xy,[L]:Si,[S]:k},{[T]:Vy,[L]:Si,[S]:k},{[T]:Wy,[L]:Si,[S]:k},{[T]:Ky,[L]:Si,[S]:k},ic],[S]:k}],[S]:k},oy],[S]:k},{[T]:[cy,ay,ly],[L]:[{[T]:ei,[L]:[{[T]:Gr,endpoint:{[le]:Hc,[ce]:dr,[he]:Te},[S]:X},{[T]:$r,endpoint:{[le]:"https://s3express-control-fips.{Region}.{partitionResult#dnsSuffix}",[ce]:dr,[he]:Te},[S]:X},{endpoint:{[le]:"https://s3express-control.{Region}.{partitionResult#dnsSuffix}",[ce]:dr,[he]:Te},[S]:X}],[S]:k}],[S]:k},{[T]:[Xa,{[F]:rt,[D]:[$e,49,50,xi],[Me]:oC},{[F]:rt,[D]:[$e,8,12,xi],[Me]:aC},{[F]:rt,[D]:zy,[Me]:K0},{[F]:rt,[D]:[$e,32,49,xi],[Me]:og},{[F]:ph,[D]:bd,[Me]:"regionPartition"},{[F]:ze,[D]:[{[fe]:K0},"--op-s3"]}],[L]:[{[T]:Yy,[L]:[{[T]:[{[F]:ze,[D]:[hy,"e"]}],[L]:[{[T]:qy,[L]:[uy,{[T]:Gr,endpoint:{[le]:"https://{Bucket}.ec2.{url#authority}",[ce]:sc,[he]:Te},[S]:X}],[S]:k},{endpoint:{[le]:"https://{Bucket}.ec2.s3-outposts.{Region}.{regionPartition#dnsSuffix}",[ce]:sc,[he]:Te},[S]:X}],[S]:k},{[T]:[{[F]:ze,[D]:[hy,"o"]}],[L]:[{[T]:qy,[L]:[uy,{[T]:Gr,endpoint:{[le]:"https://{Bucket}.op-{outpostId}.{url#authority}",[ce]:sc,[he]:Te},[S]:X}],[S]:k},{endpoint:{[le]:"https://{Bucket}.op-{outpostId}.s3-outposts.{Region}.{regionPartition#dnsSuffix}",[ce]:sc,[he]:Te},[S]:X}],[S]:k},{error:'Unrecognized hardware type: "Expected hardware type o or e but got {hardwareType}"',[S]:ae}],[S]:k},{error:"Invalid ARN: The outpost Id must only contain a-z, A-Z, 0-9 and `-`.",[S]:ae}],[S]:k},{[T]:j2,[L]:[{[T]:[xt,{[F]:Di,[D]:[{[F]:zn,[D]:[{[F]:Ip,[D]:U2}]}]}],error:"Custom endpoint `{Endpoint}` was not a valid URI",[S]:ae},{[T]:[ud,yC],[L]:[{[T]:ei,[L]:[{[T]:Zy,[L]:[{[T]:[ti,ny],error:"S3 Accelerate cannot be used in this region",[S]:ae},{[T]:[nt,ht,Tt,Re,Dt],endpoint:{[le]:"https://{Bucket}.s3-fips.dualstack.us-east-1.{partitionResult#dnsSuffix}",[ce]:Lt,[he]:Te},[S]:X},{[T]:[nt,ht,Tt,Re,Ue,kt],[L]:[{endpoint:dy,[S]:X}],[S]:k},{[T]:[nt,ht,Tt,Re,Ue,Nt],endpoint:dy,[S]:X},{[T]:[Be,ht,Tt,Re,Dt],endpoint:{[le]:"https://{Bucket}.s3-fips.us-east-1.{partitionResult#dnsSuffix}",[ce]:Lt,[he]:Te},[S]:X},{[T]:[Be,ht,Tt,Re,Ue,kt],[L]:[{endpoint:fy,[S]:X}],[S]:k},{[T]:[Be,ht,Tt,Re,Ue,Nt],endpoint:fy,[S]:X},{[T]:[nt,Le,ti,Re,Dt],endpoint:{[le]:"https://{Bucket}.s3-accelerate.dualstack.us-east-1.{partitionResult#dnsSuffix}",[ce]:Lt,[he]:Te},[S]:X},{[T]:[nt,Le,ti,Re,Ue,kt],[L]:[{endpoint:gy,[S]:X}],[S]:k},{[T]:[nt,Le,ti,Re,Ue,Nt],endpoint:gy,[S]:X},{[T]:[nt,Le,Tt,Re,Dt],endpoint:{[le]:"https://{Bucket}.s3.dualstack.us-east-1.{partitionResult#dnsSuffix}",[ce]:Lt,[he]:Te},[S]:X},{[T]:[nt,Le,Tt,Re,Ue,kt],[L]:[{endpoint:py,[S]:X}],[S]:k},{[T]:[nt,Le,Tt,Re,Ue,Nt],endpoint:py,[S]:X},{[T]:[Be,Le,Tt,xt,gn,hd,Dt],endpoint:{[le]:lC,[ce]:Lt,[he]:Te},[S]:X},{[T]:[Be,Le,Tt,xt,gn,dd,Dt],endpoint:{[le]:_h,[ce]:Lt,[he]:Te},[S]:X},{[T]:[Be,Le,Tt,xt,gn,hd,Ue,kt],[L]:[{[T]:ds,endpoint:fd,[S]:X},{endpoint:fd,[S]:X}],[S]:k},{[T]:[Be,Le,Tt,xt,gn,dd,Ue,kt],[L]:[{[T]:ds,endpoint:ag,[S]:X},my],[S]:k},{[T]:[Be,Le,Tt,xt,gn,hd,Ue,Nt],endpoint:fd,[S]:X},{[T]:[Be,Le,Tt,xt,gn,dd,Ue,Nt],endpoint:ag,[S]:X},{[T]:[Be,Le,ti,Re,Dt],endpoint:{[le]:cC,[ce]:Lt,[he]:Te},[S]:X},{[T]:[Be,Le,ti,Re,Ue,kt],[L]:[{[T]:ds,endpoint:gd,[S]:X},{endpoint:gd,[S]:X}],[S]:k},{[T]:[Be,Le,ti,Re,Ue,Nt],endpoint:gd,[S]:X},{[T]:[Be,Le,Tt,Re,Dt],endpoint:{[le]:Y0,[ce]:Lt,[he]:Te},[S]:X},{[T]:[Be,Le,Tt,Re,Ue,kt],[L]:[{[T]:ds,endpoint:{[le]:Y0,[ce]:Pt,[he]:Te},[S]:X},{endpoint:_y,[S]:X}],[S]:k},{[T]:[Be,Le,Tt,Re,Ue,Nt],endpoint:_y,[S]:X}],[S]:k},rc],[S]:k}],[S]:k},{[T]:[xt,gn,{[F]:ze,[D]:[{[F]:pt,[D]:[mC,"scheme"]},"http"]},{[F]:mh,[D]:[$e,xi]},ud,Le,Be,Tt],[L]:[{[T]:ei,[L]:[{[T]:Zy,[L]:[my],[S]:k},rc],[S]:k}],[S]:k},{[T]:[ud,{[F]:hC,[D]:G2,[Me]:uC}],[L]:[{[T]:[{[F]:pt,[D]:[kn,"resourceId[0]"],[Me]:dC},{[F]:Di,[D]:[{[F]:ze,[D]:[EC,yh]}]}],[L]:[{[T]:[{[F]:ze,[D]:[pd,Mp]}],[L]:[{[T]:Rd,[L]:[{[T]:Jy,[L]:[yy,Ey,{[T]:vd,[L]:[xy,{[T]:Qy,[L]:[md,{[T]:Ad,[L]:[{[T]:ei,[L]:[{[T]:eE,[L]:[{[T]:Id,[L]:[{[T]:[{[F]:ze,[D]:[wC,yh]}],error:"Invalid ARN: Missing account id",[S]:ae},{[T]:Pd,[L]:[{[T]:tE,[L]:[{[T]:Gr,endpoint:{[le]:q0,[ce]:_d,[he]:Te},[S]:X},{[T]:$r,endpoint:{[le]:"https://{accessPointName}-{bucketArn#accountId}.s3-object-lambda-fips.{bucketArn#region}.{bucketPartition#dnsSuffix}",[ce]:_d,[he]:Te},[S]:X},{endpoint:{[le]:"https://{accessPointName}-{bucketArn#accountId}.s3-object-lambda.{bucketArn#region}.{bucketPartition#dnsSuffix}",[ce]:_d,[he]:Te},[S]:X}],[S]:k},wy],[S]:k},yd],[S]:k},Ed],[S]:k},xd],[S]:k}],[S]:k}],[S]:k},Sy],[S]:k},{error:"Invalid ARN: bucket ARN is missing a region",[S]:ae}],[S]:k},Cy],[S]:k},{error:"Invalid ARN: Object Lambda ARNs only support `accesspoint` arn types, but found: `{arnType}`",[S]:ae}],[S]:k},{[T]:Rd,[L]:[{[T]:Jy,[L]:[{[T]:vd,[L]:[{[T]:Rd,[L]:[{[T]:vd,[L]:[xy,{[T]:Qy,[L]:[md,{[T]:Ad,[L]:[{[T]:ei,[L]:[{[T]:[{[F]:ze,[D]:[xC,"{partitionResult#name}"]}],[L]:[{[T]:Id,[L]:[{[T]:[{[F]:ze,[D]:[pd,Oo]}],[L]:[{[T]:Pd,[L]:[{[T]:tE,[L]:[{[T]:Td,error:"Access Points do not support S3 Accelerate",[S]:ae},{[T]:[ht,nt],endpoint:{[le]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint-fips.dualstack.{bucketArn#region}.{bucketPartition#dnsSuffix}",[ce]:_a,[he]:Te},[S]:X},{[T]:[ht,Be],endpoint:{[le]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint-fips.{bucketArn#region}.{bucketPartition#dnsSuffix}",[ce]:_a,[he]:Te},[S]:X},{[T]:[Le,nt],endpoint:{[le]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint.dualstack.{bucketArn#region}.{bucketPartition#dnsSuffix}",[ce]:_a,[he]:Te},[S]:X},{[T]:[Le,Be,xt,gn],endpoint:{[le]:q0,[ce]:_a,[he]:Te},[S]:X},{[T]:[Le,Be],endpoint:{[le]:"https://{accessPointName}-{bucketArn#accountId}.s3-accesspoint.{bucketArn#region}.{bucketPartition#dnsSuffix}",[ce]:_a,[he]:Te},[S]:X}],[S]:k},wy],[S]:k},yd],[S]:k},{error:"Invalid ARN: The ARN was not for the S3 service, found: {bucketArn#service}",[S]:ae}],[S]:k},Ed],[S]:k},xd],[S]:k}],[S]:k}],[S]:k},Sy],[S]:k}],[S]:k}],[S]:k},{[T]:[{[F]:Mr,[D]:[Dp,xi]}],[L]:[{[T]:Ly,error:"S3 MRAP does not support dual-stack",[S]:ae},{[T]:$r,error:"S3 MRAP does not support FIPS",[S]:ae},{[T]:Td,error:"S3 MRAP does not support S3 Accelerate",[S]:ae},{[T]:[{[F]:bt,[D]:[{[fe]:"DisableMultiRegionAccessPoints"},xi]}],error:"Invalid configuration: Multi-Region Access Point ARNs are disabled.",[S]:ae},{[T]:[{[F]:ph,[D]:bd,[Me]:Z0}],[L]:[{[T]:[{[F]:ze,[D]:[{[F]:pt,[D]:[{[fe]:Z0},St]},{[F]:pt,[D]:[kn,"partition"]}]}],[L]:[{endpoint:{[le]:"https://{accessPointName}.accesspoint.s3-global.{mrapPartition#dnsSuffix}",[ce]:{[ln]:[{[Gt]:xi,name:Pp,[$t]:Oo,[Ap]:z2}]},[he]:Te},[S]:X}],[S]:k},{error:"Client was configured for partition `{mrapPartition#name}` but bucket referred to partition `{bucketArn#partition}`",[S]:ae}],[S]:k}],[S]:k},{error:"Invalid Access Point Name",[S]:ae}],[S]:k},Cy],[S]:k},{[T]:[{[F]:ze,[D]:[pd,ul]}],[L]:[{[T]:Ly,error:"S3 Outposts does not support Dual-stack",[S]:ae},{[T]:$r,error:"S3 Outposts does not support FIPS",[S]:ae},{[T]:Td,error:"S3 Outposts does not support S3 Accelerate",[S]:ae},{[T]:[{[F]:zn,[D]:[{[F]:pt,[D]:[kn,"resourceId[4]"]}]}],error:"Invalid Arn: Outpost Access Point ARN contains sub resources",[S]:ae},{[T]:[{[F]:pt,[D]:H2,[Me]:og}],[L]:[{[T]:Yy,[L]:[md,{[T]:Ad,[L]:[{[T]:ei,[L]:[{[T]:eE,[L]:[{[T]:Id,[L]:[{[T]:Pd,[L]:[{[T]:[{[F]:pt,[D]:X2,[Me]:J0}],[L]:[{[T]:[{[F]:pt,[D]:[kn,"resourceId[3]"],[Me]:Fp}],[L]:[{[T]:[{[F]:ze,[D]:[{[fe]:J0},fC]}],[L]:[{[T]:Gr,endpoint:{[le]:"https://{accessPointName}-{bucketArn#accountId}.{outpostId}.{url#authority}",[ce]:by,[he]:Te},[S]:X},{endpoint:{[le]:"https://{accessPointName}-{bucketArn#accountId}.{outpostId}.s3-outposts.{bucketArn#region}.{bucketPartition#dnsSuffix}",[ce]:by,[he]:Te},[S]:X}],[S]:k},{error:"Expected an outpost type `accesspoint`, found {outpostType}",[S]:ae}],[S]:k},{error:"Invalid ARN: expected an access point name",[S]:ae}],[S]:k},{error:"Invalid ARN: Expected a 4-component resource",[S]:ae}],[S]:k},yd],[S]:k},Ed],[S]:k},xd],[S]:k}],[S]:k}],[S]:k},{error:"Invalid ARN: The outpost Id may only contain a-z, A-Z, 0-9 and `-`. Found: `{outpostId}`",[S]:ae}],[S]:k},{error:"Invalid ARN: The Outpost Id was not set",[S]:ae}],[S]:k},{error:"Invalid ARN: Unrecognized format: {Bucket} (type: {arnType})",[S]:ae}],[S]:k},{error:"Invalid ARN: No ARN type specified",[S]:ae}],[S]:k},{[T]:[{[F]:rt,[D]:[$e,0,4,N2],[Me]:Q0},{[F]:ze,[D]:[{[fe]:Q0},"arn:"]},{[F]:Di,[D]:[{[F]:zn,[D]:[Ty]}]}],error:"Invalid ARN: `{Bucket}` was not a valid ARN",[S]:ae},{[T]:[{[F]:bt,[D]:[B2,xi]},Ty],error:"Path-style addressing cannot be used with ARN buckets",[S]:ae},{[T]:$2,[L]:[{[T]:ei,[L]:[{[T]:[Tt],[L]:[{[T]:[nt,Re,ht,Dt],endpoint:{[le]:"https://s3-fips.dualstack.us-east-1.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[ce]:Lt,[he]:Te},[S]:X},{[T]:[nt,Re,ht,Ue,kt],[L]:[{endpoint:Ry,[S]:X}],[S]:k},{[T]:[nt,Re,ht,Ue,Nt],endpoint:Ry,[S]:X},{[T]:[Be,Re,ht,Dt],endpoint:{[le]:"https://s3-fips.us-east-1.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[ce]:Lt,[he]:Te},[S]:X},{[T]:[Be,Re,ht,Ue,kt],[L]:[{endpoint:vy,[S]:X}],[S]:k},{[T]:[Be,Re,ht,Ue,Nt],endpoint:vy,[S]:X},{[T]:[nt,Re,Le,Dt],endpoint:{[le]:"https://s3.dualstack.us-east-1.{partitionResult#dnsSuffix}/{uri_encoded_bucket}",[ce]:Lt,[he]:Te},[S]:X},{[T]:[nt,Re,Le,Ue,kt],[L]:[{endpoint:Ay,[S]:X}],[S]:k},{[T]:[nt,Re,Le,Ue,Nt],endpoint:Ay,[S]:X},{[T]:[Be,xt,gn,Le,Dt],endpoint:{[le]:gC,[ce]:Lt,[he]:Te},[S]:X},{[T]:[Be,xt,gn,Le,Ue,kt],[L]:[{[T]:ds,endpoint:wd,[S]:X},{endpoint:wd,[S]:X}],[S]:k},{[T]:[Be,xt,gn,Le,Ue,Nt],endpoint:wd,[S]:X},{[T]:[Be,Re,Le,Dt],endpoint:{[le]:ey,[ce]:Lt,[he]:Te},[S]:X},{[T]:[Be,Re,Le,Ue,kt],[L]:[{[T]:ds,endpoint:{[le]:ey,[ce]:Pt,[he]:Te},[S]:X},{endpoint:Iy,[S]:X}],[S]:k},{[T]:[Be,Re,Le,Ue,Nt],endpoint:Iy,[S]:X}],[S]:k},{error:"Path-style addressing cannot be used with S3 Accelerate",[S]:ae}],[S]:k}],[S]:k}],[S]:k},{[T]:[{[F]:zn,[D]:[Py]},{[F]:bt,[D]:[Py,xi]}],[L]:[{[T]:ei,[L]:[{[T]:nE,[L]:[yy,Ey,{[T]:Gr,endpoint:{[le]:Hc,[ce]:Sd,[he]:Te},[S]:X},{[T]:$r,endpoint:{[le]:"https://s3-object-lambda-fips.{Region}.{partitionResult#dnsSuffix}",[ce]:Sd,[he]:Te},[S]:X},{endpoint:{[le]:"https://s3-object-lambda.{Region}.{partitionResult#dnsSuffix}",[ce]:Sd,[he]:Te},[S]:X}],[S]:k},rc],[S]:k}],[S]:k},{[T]:[cy],[L]:[{[T]:ei,[L]:[{[T]:nE,[L]:[{[T]:[ht,nt,Re,Dt],endpoint:{[le]:"https://s3-fips.dualstack.us-east-1.{partitionResult#dnsSuffix}",[ce]:Lt,[he]:Te},[S]:X},{[T]:[ht,nt,Re,Ue,kt],[L]:[{endpoint:My,[S]:X}],[S]:k},{[T]:[ht,nt,Re,Ue,Nt],endpoint:My,[S]:X},{[T]:[ht,Be,Re,Dt],endpoint:{[le]:"https://s3-fips.us-east-1.{partitionResult#dnsSuffix}",[ce]:Lt,[he]:Te},[S]:X},{[T]:[ht,Be,Re,Ue,kt],[L]:[{endpoint:Fy,[S]:X}],[S]:k},{[T]:[ht,Be,Re,Ue,Nt],endpoint:Fy,[S]:X},{[T]:[Le,nt,Re,Dt],endpoint:{[le]:"https://s3.dualstack.us-east-1.{partitionResult#dnsSuffix}",[ce]:Lt,[he]:Te},[S]:X},{[T]:[Le,nt,Re,Ue,kt],[L]:[{endpoint:Dy,[S]:X}],[S]:k},{[T]:[Le,nt,Re,Ue,Nt],endpoint:Dy,[S]:X},{[T]:[Le,Be,xt,gn,Dt],endpoint:{[le]:Hc,[ce]:Lt,[he]:Te},[S]:X},{[T]:[Le,Be,xt,gn,Ue,kt],[L]:[{[T]:ds,endpoint:Cd,[S]:X},{endpoint:Cd,[S]:X}],[S]:k},{[T]:[Le,Be,xt,gn,Ue,Nt],endpoint:Cd,[S]:X},{[T]:[Le,Be,Re,Dt],endpoint:{[le]:ty,[ce]:Lt,[he]:Te},[S]:X},{[T]:[Le,Be,Re,Ue,kt],[L]:[{[T]:ds,endpoint:{[le]:ty,[ce]:Pt,[he]:Te},[S]:X},{endpoint:Oy,[S]:X}],[S]:k},{[T]:[Le,Be,Re,Ue,Nt],endpoint:Oy,[S]:X}],[S]:k},rc],[S]:k}],[S]:k}],[S]:k},{error:"A region must be set when sending requests to S3.",[S]:ae}]},W2=V2,K2=new cF({size:50,params:["Accelerate","Bucket","DisableAccessPoints","DisableMultiRegionAccessPoints","DisableS3ExpressSessionAuth","Endpoint","ForcePathStyle","Region","UseArnRegion","UseDualStack","UseFIPS","UseGlobalEndpoint","UseObjectLambdaEndpoint","UseS3ExpressControlEndpoint"]}),SC=(t,e={})=>K2.get(t,()=>AF(W2,{endpointParams:t,logger:e.logger}));dh.aws=ZS;const Y2=t=>async(e,n,i)=>{if(!i)throw new Error("Could not find `input` for `defaultEndpointRuleSetHttpAuthSchemeParametersProvider`");const s=await t(e,n,i),r=Wo(n)?.commandInstance?.constructor?.getEndpointParameterInstructions;if(!r)throw new Error(`getEndpointParameterInstructions() is not defined on \`${n.commandName}\``);const o=await tC(i,{getEndpointParameterInstructions:r},e);return Object.assign(s,o)},q2=async(t,e,n)=>({operation:Wo(e).operation,region:await pi(t.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()}),Z2=Y2(q2);function CC(t){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"s3",region:t.region},propertiesExtractor:(e,n)=>({signingProperties:{config:e,context:n}})}}function bC(t){return{schemeId:"aws.auth#sigv4a",signingProperties:{name:"s3",region:t.region},propertiesExtractor:(e,n)=>({signingProperties:{config:e,context:n}})}}const J2=(t,e,n)=>s=>{const o=t(s).properties?.authSchemes;if(!o)return e(s);const a=[];for(const l of o){const{name:c,properties:h={},...u}=l,d=c.toLowerCase();c!==d&&console.warn(`HttpAuthScheme has been normalized with lowercasing: \`${c}\` to \`${d}\``);let f;if(d==="sigv4a"){f="aws.auth#sigv4a";const p=o.find(y=>{const _=y.name.toLowerCase();return _!=="sigv4a"&&_.startsWith("sigv4")});if(rC.sigv4aDependency()==="none"&&p)continue}else if(d.startsWith("sigv4"))f="aws.auth#sigv4";else throw new Error(`Unknown HttpAuthScheme found in \`@smithy.rules#endpointRuleSet\`: \`${d}\``);const g=n[f];if(!g)throw new Error(`Could not find HttpAuthOption create function for \`${f}\``);const m=g(s);m.schemeId=f,m.signingProperties={...m.signingProperties||{},...u,...h},a.push(m)}return a},Q2=t=>{const e=[];switch(t.operation){default:e.push(CC(t)),e.push(bC(t))}return e},eD=J2(SC,Q2,{"aws.auth#sigv4":CC,"aws.auth#sigv4a":bC}),tD=t=>{const e=vI(t),n=tI(e);return Object.assign(n,{authSchemePreference:pi(t.authSchemePreference??[])})},nD=t=>Object.assign(t,{useFipsEndpoint:t.useFipsEndpoint??!1,useDualstackEndpoint:t.useDualstackEndpoint??!1,forcePathStyle:t.forcePathStyle??!1,useAccelerateEndpoint:t.useAccelerateEndpoint??!1,useGlobalEndpoint:t.useGlobalEndpoint??!1,disableMultiregionAccessPoints:t.disableMultiregionAccessPoints??!1,defaultSigningName:"s3"}),tu={ForcePathStyle:{type:"clientContextParams",name:"forcePathStyle"},UseArnRegion:{type:"clientContextParams",name:"useArnRegion"},DisableMultiRegionAccessPoints:{type:"clientContextParams",name:"disableMultiregionAccessPoints"},Accelerate:{type:"clientContextParams",name:"useAccelerateEndpoint"},DisableS3ExpressSessionAuth:{type:"clientContextParams",name:"disableS3ExpressSessionAuth"},UseGlobalEndpoint:{type:"builtInParams",name:"useGlobalEndpoint"},UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}};class Yt extends ao{constructor(e){super(e),Object.setPrototypeOf(this,Yt.prototype)}}class Op extends Yt{name="NoSuchUpload";$fault="client";constructor(e){super({name:"NoSuchUpload",$fault:"client",...e}),Object.setPrototypeOf(this,Op.prototype)}}class Lp extends Yt{name="ObjectNotInActiveTierError";$fault="client";constructor(e){super({name:"ObjectNotInActiveTierError",$fault:"client",...e}),Object.setPrototypeOf(this,Lp.prototype)}}class kp extends Yt{name="BucketAlreadyExists";$fault="client";constructor(e){super({name:"BucketAlreadyExists",$fault:"client",...e}),Object.setPrototypeOf(this,kp.prototype)}}class Np extends Yt{name="BucketAlreadyOwnedByYou";$fault="client";constructor(e){super({name:"BucketAlreadyOwnedByYou",$fault:"client",...e}),Object.setPrototypeOf(this,Np.prototype)}}class Bp extends Yt{name="NoSuchBucket";$fault="client";constructor(e){super({name:"NoSuchBucket",$fault:"client",...e}),Object.setPrototypeOf(this,Bp.prototype)}}var iE;(function(t){t.visit=(e,n)=>e.Prefix!==void 0?n.Prefix(e.Prefix):e.Tag!==void 0?n.Tag(e.Tag):e.And!==void 0?n.And(e.And):n._(e.$unknown[0],e.$unknown[1])})(iE||(iE={}));var sE;(function(t){t.visit=(e,n)=>e.Prefix!==void 0?n.Prefix(e.Prefix):e.Tag!==void 0?n.Tag(e.Tag):e.AccessPointArn!==void 0?n.AccessPointArn(e.AccessPointArn):e.And!==void 0?n.And(e.And):n._(e.$unknown[0],e.$unknown[1])})(sE||(sE={}));class Up extends Yt{name="InvalidObjectState";$fault="client";StorageClass;AccessTier;constructor(e){super({name:"InvalidObjectState",$fault:"client",...e}),Object.setPrototypeOf(this,Up.prototype),this.StorageClass=e.StorageClass,this.AccessTier=e.AccessTier}}class Gp extends Yt{name="NoSuchKey";$fault="client";constructor(e){super({name:"NoSuchKey",$fault:"client",...e}),Object.setPrototypeOf(this,Gp.prototype)}}class $p extends Yt{name="NotFound";$fault="client";constructor(e){super({name:"NotFound",$fault:"client",...e}),Object.setPrototypeOf(this,$p.prototype)}}const iD=t=>({...t,...t.SecretAccessKey&&{SecretAccessKey:Wn},...t.SessionToken&&{SessionToken:Wn}}),sD=t=>({...t,...t.SSEKMSKeyId&&{SSEKMSKeyId:Wn},...t.SSEKMSEncryptionContext&&{SSEKMSEncryptionContext:Wn},...t.Credentials&&{Credentials:iD(t.Credentials)}}),rD=t=>({...t,...t.SSEKMSKeyId&&{SSEKMSKeyId:Wn},...t.SSEKMSEncryptionContext&&{SSEKMSEncryptionContext:Wn}}),oD=t=>({...t,...t.SSEKMSKeyId&&{SSEKMSKeyId:Wn}}),aD=t=>({...t,...t.SSECustomerKey&&{SSECustomerKey:Wn}});class jp extends Yt{name="EncryptionTypeMismatch";$fault="client";constructor(e){super({name:"EncryptionTypeMismatch",$fault:"client",...e}),Object.setPrototypeOf(this,jp.prototype)}}class zp extends Yt{name="InvalidRequest";$fault="client";constructor(e){super({name:"InvalidRequest",$fault:"client",...e}),Object.setPrototypeOf(this,zp.prototype)}}class Hp extends Yt{name="InvalidWriteOffset";$fault="client";constructor(e){super({name:"InvalidWriteOffset",$fault:"client",...e}),Object.setPrototypeOf(this,Hp.prototype)}}class Xp extends Yt{name="TooManyParts";$fault="client";constructor(e){super({name:"TooManyParts",$fault:"client",...e}),Object.setPrototypeOf(this,Xp.prototype)}}class Vp extends Yt{name="IdempotencyParameterMismatch";$fault="client";constructor(e){super({name:"IdempotencyParameterMismatch",$fault:"client",...e}),Object.setPrototypeOf(this,Vp.prototype)}}class Wp extends Yt{name="ObjectAlreadyInActiveTierError";$fault="client";constructor(e){super({name:"ObjectAlreadyInActiveTierError",$fault:"client",...e}),Object.setPrototypeOf(this,Wp.prototype)}}var rE;(function(t){t.visit=(e,n)=>e.Records!==void 0?n.Records(e.Records):e.Stats!==void 0?n.Stats(e.Stats):e.Progress!==void 0?n.Progress(e.Progress):e.Cont!==void 0?n.Cont(e.Cont):e.End!==void 0?n.End(e.End):n._(e.$unknown[0],e.$unknown[1])})(rE||(rE={}));const lD=t=>({...t,...t.SSEKMSKeyId&&{SSEKMSKeyId:Wn},...t.SSEKMSEncryptionContext&&{SSEKMSEncryptionContext:Wn}}),cD=t=>({...t,...t.SSECustomerKey&&{SSECustomerKey:Wn},...t.SSEKMSKeyId&&{SSEKMSKeyId:Wn},...t.SSEKMSEncryptionContext&&{SSEKMSEncryptionContext:Wn}}),hD=async(t,e)=>{const n=Zh(t,e),i=ct({},Gn,{[GO]:t[uO],[Nl]:t[Ll],[Bl]:t[kl],[ou]:t[ru],[js]:[()=>Gn(t[Ar]),()=>t[Ar].toString()]});n.bp("/"),n.p("Bucket",()=>t.Bucket,"{Bucket}",!1);const s=ct({[LO]:[,""]});return n.m("GET").h(i).q(s).b(void 0),n.build()},uD=async(t,e)=>{const n=Zh(t,e),i=ct({},Gn,{[jC]:t[PC],[SO]:[()=>Gn(t[oE]),()=>$c(t[oE]).toString()],[zC]:t[MC],[CO]:[()=>Gn(t[aE]),()=>$c(t[aE]).toString()],[AO]:t[nO],[au]:t[iu],[YC]:t[OC],[lu]:t[su],[hm]:t[tm],[lm]:t[Qp],[UO]:t[zD]});n.bp("/{Key+}"),n.p("Bucket",()=>t.Bucket,"{Bucket}",!1),n.p("Key",()=>t.Key,"{Key+}",!0);const s=ct({[JC]:[,"GetObject"],[IO]:[,t[iO]],[PO]:[,t[sO]],[MO]:[,t[rO]],[FO]:[,t[oO]],[DO]:[,t[aO]],[OO]:[()=>t.ResponseExpires!==void 0,()=>$c(t[lO]).toString()],[NO]:[,t[nm]],[RO]:[()=>t.PartNumber!==void 0,()=>t[tO].toString()]});return n.m("GET").h(i).q(s).b(void 0),n.build()},dD=async(t,e)=>{const n=Zh(t,e),i=ct({},Gn,{[hm]:t[tm],[lm]:t[Qp],[XO]:[()=>Gn(t[lE]),()=>(t[lE]||[]).map(XA).join(", ")]});n.bp("/"),n.p("Bucket",()=>t.Bucket,"{Bucket}",!1);const s=ct({[bO]:[,"2"],[yO]:[,t[Vc]],[EO]:[,t[Wc]],[TO]:[()=>t.MaxKeys!==void 0,()=>t[Yc].toString()],[vO]:[,t[Cr]],[_O]:[,t[Xc]],[wO]:[()=>t.FetchOwner!==void 0,()=>t[KD].toString()],[kO]:[,t[qc]]});return n.m("GET").h(i).q(s).b(void 0),n.build()},fD=async(t,e)=>{const n=Zh(t,e),i=ct({},Gn,{...t.Metadata!==void 0&&Object.keys(t.Metadata).reduce((a,l)=>(a[`x-amz-meta-${l.toLowerCase()}`]=t.Metadata[l],a),{}),[GC]:t[IC]||"application/octet-stream",[BO]:t[$D],[kC]:t[TC],[NC]:t[RC],[BC]:t[vC],[UC]:t[AC],[ug]:[()=>Gn(t[lg]),()=>t[lg].toString()],[pO]:t[HD],[KO]:t[Ta],[im]:t[Kp],[sm]:t[Yp],[rm]:t[qp],[om]:t[Zp],[am]:t[Jp],[dg]:[()=>Gn(t[cg]),()=>$c(t[cg]).toString()],[jC]:t[PC],[zC]:t[MC],[$O]:t[YD],[jO]:t[qD],[zO]:t[ZD],[HO]:t[JD],[qO]:[()=>Gn(t[cE]),()=>t[cE].toString()],[Nl]:t[Ll],[KC]:t[Fs],[ZC]:t[LC],[au]:t[iu],[YC]:t[OC],[lu]:t[su],[Bl]:t[kl],[ou]:t[ru],[js]:[()=>Gn(t[Ar]),()=>t[Ar].toString()],[hm]:t[tm],[YO]:t[dO],[WC]:t[DC],[fg]:[()=>Gn(t[hg]),()=>VI(t[hg]).toString()],[VC]:t[FC],[lm]:t[Qp]});n.bp("/{Key+}"),n.p("Bucket",()=>t.Bucket,"{Bucket}",!1),n.p("Key",()=>t.Key,"{Key+}",!0);const s=ct({[JC]:[,"PutObject"]});let r,o;return t.Body!==void 0&&(o=t.Body,r=o),n.m("PUT").h(i).q(s).b(r),n.build()},gD=async(t,e)=>{if(t.statusCode!==200&&t.statusCode>=300)return nu(t,e);const n=ct({$metadata:Ht(t),[Ll]:[,t.headers[Nl]],[kl]:[,t.headers[Bl]],[ru]:[,t.headers[ou]],[Ar]:[()=>t.headers[js]!==void 0,()=>Fo(t.headers[js])]}),i=Ps(yS(await _p(t.body,e)),"body");return i[Dd]!=null&&(n[Dd]=GD(i[Dd])),n},pD=async(t,e)=>{if(t.statusCode!==200&&t.statusCode>=300)return nu(t,e);const n=ct({$metadata:Ht(t),[VD]:[()=>t.headers[uE]!==void 0,()=>Fo(t.headers[uE])],[jD]:[,t.headers[gO]],[Ka]:[,t.headers[XC]],[hO]:[,t.headers[VO]],[Kc]:[()=>t.headers[hE]!==void 0,()=>Ps(qf(t.headers[hE]))],[lg]:[()=>t.headers[ug]!==void 0,()=>up(t.headers[ug])],[Wa]:[,t.headers[$C]],[Kp]:[,t.headers[im]],[Yp]:[,t.headers[sm]],[qp]:[,t.headers[rm]],[Zp]:[,t.headers[om]],[Jp]:[,t.headers[am]],[Va]:[,t.headers[HC]],[QD]:[()=>t.headers[dE]!==void 0,()=>Ha(t.headers[dE])],[nm]:[,t.headers[qC]],[TC]:[,t.headers[kC]],[RC]:[,t.headers[NC]],[vC]:[,t.headers[BC]],[AC]:[,t.headers[UC]],[XD]:[,t.headers[mO]],[IC]:[,t.headers[GC]],[cg]:[()=>t.headers[dg]!==void 0,()=>Ps(qf(t.headers[dg]))],[WD]:[,t.headers[xO]],[LC]:[,t.headers[ZC]],[Ll]:[,t.headers[Nl]],[iu]:[,t.headers[au]],[su]:[,t.headers[lu]],[kl]:[,t.headers[Bl]],[Ar]:[()=>t.headers[js]!==void 0,()=>Fo(t.headers[js])],[Fs]:[,t.headers[KC]],[em]:[,t.headers[cm]],[cO]:[,t.headers[WO]],[eO]:[()=>t.headers[fE]!==void 0,()=>Ha(t.headers[fE])],[fO]:[()=>t.headers[pE]!==void 0,()=>Ha(t.headers[pE])],[DC]:[,t.headers[WC]],[hg]:[()=>t.headers[fg]!==void 0,()=>Ps(qh(t.headers[fg]))],[FC]:[,t.headers[VC]],Metadata:[,Object.keys(t.headers).filter(s=>s.startsWith("x-amz-meta-")).reduce((s,r)=>(s[r.substring(11)]=t.headers[r],s),{})]}),i=t.body;return e.sdkStreamMixin(i),n.Body=i,n},mD=async(t,e)=>{if(t.statusCode!==200&&t.statusCode>=300)return nu(t,e);const n=ct({$metadata:Ht(t),[em]:[,t.headers[cm]]}),i=Ps(yS(await _p(t.body,e)),"body");return i.CommonPrefixes===""?n[oc]=[]:i[oc]!=null&&(n[oc]=LD(Qf(i[oc]))),i.Contents===""?n[ac]=[]:i[ac]!=null&&(n[ac]=ND(Qf(i[ac]))),i[Xc]!=null&&(n[Xc]=At(i[Xc])),i[Vc]!=null&&(n[Vc]=At(i[Vc])),i[Wc]!=null&&(n[Wc]=At(i[Wc])),i[Nd]!=null&&(n[Nd]=Fo(i[Nd])),i[Ud]!=null&&(n[Ud]=Ha(i[Ud])),i[Yc]!=null&&(n[Yc]=Ha(i[Yc])),i[Gd]!=null&&(n[Gd]=At(i[Gd])),i[$d]!=null&&(n[$d]=At(i[$d])),i[Cr]!=null&&(n[Cr]=At(i[Cr])),i[qc]!=null&&(n[qc]=At(i[qc])),n},_D=async(t,e)=>{if(t.statusCode!==200&&t.statusCode>=300)return nu(t,e);const n=ct({$metadata:Ht(t),[Ka]:[,t.headers[XC]],[Wa]:[,t.headers[$C]],[Kp]:[,t.headers[im]],[Yp]:[,t.headers[sm]],[qp]:[,t.headers[rm]],[Zp]:[,t.headers[om]],[Jp]:[,t.headers[am]],[Va]:[,t.headers[HC]],[Ll]:[,t.headers[Nl]],[nm]:[,t.headers[qC]],[iu]:[,t.headers[au]],[su]:[,t.headers[lu]],[kl]:[,t.headers[Bl]],[ru]:[,t.headers[ou]],[Ar]:[()=>t.headers[js]!==void 0,()=>Fo(t.headers[js])],[Zc]:[()=>t.headers[gE]!==void 0,()=>up(t.headers[gE])],[em]:[,t.headers[cm]]});return await _S(t.body,e),n},nu=async(t,e)=>{const n={...t,body:await $P(t.body,e)},i=jP(t,n.body);switch(i){case"NoSuchUpload":case"com.amazonaws.s3#NoSuchUpload":throw await AD(n);case"ObjectNotInActiveTierError":case"com.amazonaws.s3#ObjectNotInActiveTierError":throw await MD(n);case"BucketAlreadyExists":case"com.amazonaws.s3#BucketAlreadyExists":throw await ED(n);case"BucketAlreadyOwnedByYou":case"com.amazonaws.s3#BucketAlreadyOwnedByYou":throw await xD(n);case"NoSuchBucket":case"com.amazonaws.s3#NoSuchBucket":throw await RD(n);case"InvalidObjectState":case"com.amazonaws.s3#InvalidObjectState":throw await CD(n);case"NoSuchKey":case"com.amazonaws.s3#NoSuchKey":throw await vD(n);case"NotFound":case"com.amazonaws.s3#NotFound":throw await ID(n);case"EncryptionTypeMismatch":case"com.amazonaws.s3#EncryptionTypeMismatch":throw await wD(n);case"InvalidRequest":case"com.amazonaws.s3#InvalidRequest":throw await bD(n);case"InvalidWriteOffset":case"com.amazonaws.s3#InvalidWriteOffset":throw await TD(n);case"TooManyParts":case"com.amazonaws.s3#TooManyParts":throw await FD(n);case"IdempotencyParameterMismatch":case"com.amazonaws.s3#IdempotencyParameterMismatch":throw await SD(n);case"ObjectAlreadyInActiveTierError":case"com.amazonaws.s3#ObjectAlreadyInActiveTierError":throw await PD(n);default:const s=n.body;return yD({output:t,parsedBody:s,errorCode:i})}},yD=OI(Yt),ED=async(t,e)=>{const n=ct({});t.body;const i=new kp({$metadata:Ht(t),...n});return Tn(i,t.body)},xD=async(t,e)=>{const n=ct({});t.body;const i=new Np({$metadata:Ht(t),...n});return Tn(i,t.body)},wD=async(t,e)=>{const n=ct({});t.body;const i=new jp({$metadata:Ht(t),...n});return Tn(i,t.body)},SD=async(t,e)=>{const n=ct({});t.body;const i=new Vp({$metadata:Ht(t),...n});return Tn(i,t.body)},CD=async(t,e)=>{const n=ct({}),i=t.body;i[Fd]!=null&&(n[Fd]=At(i[Fd])),i[Fs]!=null&&(n[Fs]=At(i[Fs]));const s=new Up({$metadata:Ht(t),...n});return Tn(s,t.body)},bD=async(t,e)=>{const n=ct({});t.body;const i=new zp({$metadata:Ht(t),...n});return Tn(i,t.body)},TD=async(t,e)=>{const n=ct({});t.body;const i=new Hp({$metadata:Ht(t),...n});return Tn(i,t.body)},RD=async(t,e)=>{const n=ct({});t.body;const i=new Bp({$metadata:Ht(t),...n});return Tn(i,t.body)},vD=async(t,e)=>{const n=ct({});t.body;const i=new Gp({$metadata:Ht(t),...n});return Tn(i,t.body)},AD=async(t,e)=>{const n=ct({});t.body;const i=new Op({$metadata:Ht(t),...n});return Tn(i,t.body)},ID=async(t,e)=>{const n=ct({});t.body;const i=new $p({$metadata:Ht(t),...n});return Tn(i,t.body)},PD=async(t,e)=>{const n=ct({});t.body;const i=new Wp({$metadata:Ht(t),...n});return Tn(i,t.body)},MD=async(t,e)=>{const n=ct({});t.body;const i=new Lp({$metadata:Ht(t),...n});return Tn(i,t.body)},FD=async(t,e)=>{const n=ct({});t.body;const i=new Xp({$metadata:Ht(t),...n});return Tn(i,t.body)},DD=(t,e)=>(t||[]).filter(n=>n!=null).map(n=>At(n)),OD=(t,e)=>{const n={};return t[Cr]!=null&&(n[Cr]=At(t[Cr])),n},LD=(t,e)=>(t||[]).filter(n=>n!=null).map(n=>OD(n)),kD=(t,e)=>{const n={};return t[Bd]!=null&&(n[Bd]=At(t[Bd])),t[Kc]!=null&&(n[Kc]=Ps(qh(t[Kc]))),t[Wa]!=null&&(n[Wa]=At(t[Wa])),t.ChecksumAlgorithm===""?n[Ta]=[]:t[Ta]!=null&&(n[Ta]=DD(Qf(t[Ta]))),t[Va]!=null&&(n[Va]=At(t[Va])),t[Zc]!=null&&(n[Zc]=up(t[Zc])),t[Fs]!=null&&(n[Fs]=At(t[Fs])),t[jd]!=null&&(n[jd]=BD(t[jd])),t[Hd]!=null&&(n[Hd]=UD(t[Hd])),n},ND=(t,e)=>(t||[]).filter(n=>n!=null).map(n=>kD(n)),BD=(t,e)=>{const n={};return t[Od]!=null&&(n[Od]=At(t[Od])),t[Ld]!=null&&(n[Ld]=At(t[Ld])),n},UD=(t,e)=>{const n={};return t[kd]!=null&&(n[kd]=Fo(t[kd])),t[zd]!=null&&(n[zd]=Ps(qh(t[zd]))),n},GD=(t,e)=>{const n={};return t[Md]!=null&&(n[Md]=At(t[Md])),t[Xd]!=null&&(n[Xd]=At(t[Xd])),t[Vd]!=null&&(n[Vd]=At(t[Vd])),t[Ka]!=null&&(n[Ka]=Ps(qh(t[Ka]))),n},Ht=t=>({httpStatusCode:t.statusCode,requestId:t.headers["x-amzn-requestid"]??t.headers["x-amzn-request-id"]??t.headers["x-amz-request-id"],extendedRequestId:t.headers["x-amz-id-2"],cfId:t.headers["x-amz-cf-id"]}),$D="ACL",Md="AccessKeyId",jD="AcceptRanges",Fd="AccessTier",Ar="BucketKeyEnabled",Dd="Credentials",Ta="ChecksumAlgorithm",TC="CacheControl",Kp="ChecksumCRC32",Yp="ChecksumCRC32C",qp="ChecksumCRC64NVME",RC="ContentDisposition",vC="ContentEncoding",AC="ContentLanguage",lg="ContentLength",zD="ChecksumMode",HD="ContentMD5",oc="CommonPrefixes",XD="ContentRange",Zp="ChecksumSHA1",Jp="ChecksumSHA256",Va="ChecksumType",IC="ContentType",Xc="ContinuationToken",ac="Contents",Vc="Delimiter",VD="DeleteMarker",Od="DisplayName",cg="Expires",Qp="ExpectedBucketOwner",WD="ExpiresString",Wc="EncodingType",Wa="ETag",Ka="Expiration",KD="FetchOwner",YD="GrantFullControl",qD="GrantRead",ZD="GrantReadACP",JD="GrantWriteACP",Ld="ID",PC="IfMatch",oE="IfModifiedSince",MC="IfNoneMatch",kd="IsRestoreInProgress",Nd="IsTruncated",aE="IfUnmodifiedSince",Bd="Key",Ud="KeyCount",Kc="LastModified",Yc="MaxKeys",QD="MissingMeta",Gd="Name",$d="NextContinuationToken",jd="Owner",FC="ObjectLockLegalHoldStatus",DC="ObjectLockMode",hg="ObjectLockRetainUntilDate",lE="OptionalObjectAttributes",Cr="Prefix",eO="PartsCount",tO="PartNumber",nO="Range",em="RequestCharged",iO="ResponseCacheControl",sO="ResponseContentDisposition",rO="ResponseContentEncoding",oO="ResponseContentLanguage",aO="ResponseContentType",lO="ResponseExpires",zd="RestoreExpiryDate",tm="RequestPayer",cO="ReplicationStatus",Hd="RestoreStatus",hO="Restore",qc="StartAfter",Xd="SecretAccessKey",Fs="StorageClass",uO="SessionMode",Ll="ServerSideEncryption",iu="SSECustomerAlgorithm",OC="SSECustomerKey",su="SSECustomerKeyMD5",ru="SSEKMSEncryptionContext",kl="SSEKMSKeyId",Vd="SessionToken",Zc="Size",dO="Tagging",fO="TagCount",nm="VersionId",cE="WriteOffsetBytes",LC="WebsiteRedirectLocation",gO="accept-ranges",kC="cache-control",NC="content-disposition",BC="content-encoding",UC="content-language",ug="content-length",pO="content-md5",mO="content-range",GC="content-type",_O="continuation-token",yO="delimiter",dg="expires",EO="encoding-type",$C="etag",xO="expiresstring",wO="fetch-owner",jC="if-match",SO="if-modified-since",zC="if-none-match",CO="if-unmodified-since",hE="last-modified",bO="list-type",TO="max-keys",RO="partNumber",vO="prefix",AO="range",IO="response-cache-control",PO="response-content-disposition",MO="response-content-encoding",FO="response-content-language",DO="response-content-type",OO="response-expires",LO="session",kO="start-after",NO="versionId",BO="x-amz-acl",im="x-amz-checksum-crc32",sm="x-amz-checksum-crc32c",rm="x-amz-checksum-crc64nvme",UO="x-amz-checksum-mode",om="x-amz-checksum-sha1",am="x-amz-checksum-sha256",GO="x-amz-create-session-mode",HC="x-amz-checksum-type",uE="x-amz-delete-marker",XC="x-amz-expiration",lm="x-amz-expected-bucket-owner",$O="x-amz-grant-full-control",jO="x-amz-grant-read",zO="x-amz-grant-read-acp",HO="x-amz-grant-write-acp",dE="x-amz-missing-meta",fE="x-amz-mp-parts-count",VC="x-amz-object-lock-legal-hold",WC="x-amz-object-lock-mode",fg="x-amz-object-lock-retain-until-date",XO="x-amz-optional-object-attributes",gE="x-amz-object-size",VO="x-amz-restore",cm="x-amz-request-charged",hm="x-amz-request-payer",WO="x-amz-replication-status",KC="x-amz-storage-class",KO="x-amz-sdk-checksum-algorithm",Nl="x-amz-server-side-encryption",Bl="x-amz-server-side-encryption-aws-kms-key-id",js="x-amz-server-side-encryption-bucket-key-enabled",ou="x-amz-server-side-encryption-context",au="x-amz-server-side-encryption-customer-algorithm",YC="x-amz-server-side-encryption-customer-key",lu="x-amz-server-side-encryption-customer-key-md5",YO="x-amz-tagging",pE="x-amz-tagging-count",qC="x-amz-version-id",qO="x-amz-write-offset-bytes",ZC="x-amz-website-redirect-location",JC="x-id";class ZO extends Ol.classBuilder().ep({...tu,DisableS3ExpressSessionAuth:{type:"staticContextParams",value:!0},Bucket:{type:"contextParams",name:"Bucket"}}).m(function(e,n,i,s){return[Kh(i,this.serialize,this.deserialize),Qh(i,e.getEndpointParameterInstructions()),Cp(i)]}).s("AmazonS3","CreateSession",{}).n("S3Client","CreateSessionCommand").f(rD,sD).ser(hD).de(gD).build(){}const JO="3.876.0",QO={version:JO},eL=t=>new TextEncoder().encode(t);function mE(t){return typeof t=="string"?t.length===0:t.byteLength===0}var QC={name:"SHA-1"},_E={name:"HMAC",hash:QC},tL=new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]);const nL={};function Ds(){return typeof window<"u"?window:typeof self<"u"?self:nL}var iL=function(){function t(e){this.toHash=new Uint8Array(0),e!==void 0&&(this.key=new Promise(function(n,i){Ds().crypto.subtle.importKey("raw",yE(e),_E,!1,["sign"]).then(n,i)}),this.key.catch(function(){}))}return t.prototype.update=function(e){if(!mE(e)){var n=yE(e),i=new Uint8Array(this.toHash.byteLength+n.byteLength);i.set(this.toHash,0),i.set(n,this.toHash.byteLength),this.toHash=i}},t.prototype.digest=function(){var e=this;return this.key?this.key.then(function(n){return Ds().crypto.subtle.sign(_E,n,e.toHash).then(function(i){return new Uint8Array(i)})}):mE(this.toHash)?Promise.resolve(tL):Promise.resolve().then(function(){return Ds().crypto.subtle.digest(QC,e.toHash)}).then(function(n){return Promise.resolve(new Uint8Array(n))})},t.prototype.reset=function(){this.toHash=new Uint8Array(0)},t}();function yE(t){return typeof t=="string"?eL(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t)}var sL=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function eb(t){if(rL(t)&&typeof t.crypto.subtle=="object"){var e=t.crypto.subtle;return oL(e)}return!1}function rL(t){if(typeof t=="object"&&typeof t.crypto=="object"){var e=t.crypto.getRandomValues;return typeof e=="function"}return!1}function oL(t){return t&&sL.every(function(e){return typeof t[e]=="function"})}var aL=function(){function t(e){if(eb(Ds()))this.hash=new iL(e);else throw new Error("SHA1 not supported")}return t.prototype.update=function(e,n){this.hash.update(Gs(e))},t.prototype.digest=function(){return this.hash.digest()},t.prototype.reset=function(){this.hash.reset()},t}(),tb={name:"SHA-256"},EE={name:"HMAC",hash:tb},lL=new Uint8Array([227,176,196,66,152,252,28,20,154,251,244,200,153,111,185,36,39,174,65,228,100,155,147,76,164,149,153,27,120,82,184,85]),cL=function(){function t(e){this.toHash=new Uint8Array(0),this.secret=e,this.reset()}return t.prototype.update=function(e){if(!cl(e)){var n=Gs(e),i=new Uint8Array(this.toHash.byteLength+n.byteLength);i.set(this.toHash,0),i.set(n,this.toHash.byteLength),this.toHash=i}},t.prototype.digest=function(){var e=this;return this.key?this.key.then(function(n){return Ds().crypto.subtle.sign(EE,n,e.toHash).then(function(i){return new Uint8Array(i)})}):cl(this.toHash)?Promise.resolve(lL):Promise.resolve().then(function(){return Ds().crypto.subtle.digest(tb,e.toHash)}).then(function(n){return Promise.resolve(new Uint8Array(n))})},t.prototype.reset=function(){var e=this;this.toHash=new Uint8Array(0),this.secret&&this.secret!==void 0&&(this.key=new Promise(function(n,i){Ds().crypto.subtle.importKey("raw",Gs(e.secret),EE,!1,["sign"]).then(n,i)}),this.key.catch(function(){}))},t}(),ni=64,hL=32,uL=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),dL=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],fL=Math.pow(2,53)-1,Jc=function(){function t(){this.state=Int32Array.from(dL),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return t.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");var n=0,i=e.byteLength;if(this.bytesHashed+=i,this.bytesHashed*8>fL)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;i>0;)this.buffer[this.bufferLength++]=e[n++],i--,this.bufferLength===ni&&(this.hashBuffer(),this.bufferLength=0)},t.prototype.digest=function(){if(!this.finished){var e=this.bytesHashed*8,n=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),i=this.bufferLength;if(n.setUint8(this.bufferLength++,128),i%ni>=ni-8){for(var s=this.bufferLength;s<ni;s++)n.setUint8(s,0);this.hashBuffer(),this.bufferLength=0}for(var s=this.bufferLength;s<ni-8;s++)n.setUint8(s,0);n.setUint32(ni-8,Math.floor(e/4294967296),!0),n.setUint32(ni-4,e),this.hashBuffer(),this.finished=!0}for(var r=new Uint8Array(hL),s=0;s<8;s++)r[s*4]=this.state[s]>>>24&255,r[s*4+1]=this.state[s]>>>16&255,r[s*4+2]=this.state[s]>>>8&255,r[s*4+3]=this.state[s]>>>0&255;return r},t.prototype.hashBuffer=function(){for(var e=this,n=e.buffer,i=e.state,s=i[0],r=i[1],o=i[2],a=i[3],l=i[4],c=i[5],h=i[6],u=i[7],d=0;d<ni;d++){if(d<16)this.temp[d]=(n[d*4]&255)<<24|(n[d*4+1]&255)<<16|(n[d*4+2]&255)<<8|n[d*4+3]&255;else{var f=this.temp[d-2],g=(f>>>17|f<<15)^(f>>>19|f<<13)^f>>>10;f=this.temp[d-15];var m=(f>>>7|f<<25)^(f>>>18|f<<14)^f>>>3;this.temp[d]=(g+this.temp[d-7]|0)+(m+this.temp[d-16]|0)}var p=(((l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7))+(l&c^~l&h)|0)+(u+(uL[d]+this.temp[d]|0)|0)|0,y=((s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10))+(s&r^s&o^r&o)|0;u=h,h=c,c=l,l=a+p|0,a=o,o=r,r=s,s=p+y|0}i[0]+=s,i[1]+=r,i[2]+=o,i[3]+=a,i[4]+=l,i[5]+=c,i[6]+=h,i[7]+=u},t}(),gL=function(){function t(e){this.secret=e,this.hash=new Jc,this.reset()}return t.prototype.update=function(e){if(!(cl(e)||this.error))try{this.hash.update(Gs(e))}catch(n){this.error=n}},t.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},t.prototype.digest=function(){return Ep(this,void 0,void 0,function(){return xp(this,function(e){return[2,this.digestSync()]})})},t.prototype.reset=function(){if(this.hash=new Jc,this.secret){this.outer=new Jc;var e=pL(this.secret),n=new Uint8Array(ni);n.set(e);for(var i=0;i<ni;i++)e[i]^=54,n[i]^=92;this.hash.update(e),this.outer.update(n);for(var i=0;i<e.byteLength;i++)e[i]=0}},t}();function pL(t){var e=Gs(t);if(e.byteLength>ni){var n=new Jc;n.update(e),e=n.digest()}var i=new Uint8Array(ni);return i.set(e),i}var mL=function(){function t(e){eb(Ds())?this.hash=new cL(e):this.hash=new gL(e)}return t.prototype.update=function(e,n){this.hash.update(Gs(e))},t.prototype.digest=function(){return this.hash.digest()},t.prototype.reset=function(){this.hash.reset()},t}();const _L={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast","Pale Moon":"pale_moon",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},nb={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",pale_moon:"Pale Moon",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},gt={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv",bot:"bot"},pn={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},xs={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class U{static getFirstMatch(e,n){const i=n.match(e);return i&&i.length>0&&i[1]||""}static getSecondMatch(e,n){const i=n.match(e);return i&&i.length>1&&i[2]||""}static matchAndReturnConst(e,n,i){if(e.test(n))return i}static getWindowsVersionName(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(e){const n=e.split(".").splice(0,2).map(i=>parseInt(i,10)||0);if(n.push(0),n[0]===10)switch(n[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(e){const n=e.split(".").splice(0,2).map(i=>parseInt(i,10)||0);if(n.push(0),!(n[0]===1&&n[1]<5)){if(n[0]===1&&n[1]<6)return"Cupcake";if(n[0]===1&&n[1]>=6)return"Donut";if(n[0]===2&&n[1]<2)return"Eclair";if(n[0]===2&&n[1]===2)return"Froyo";if(n[0]===2&&n[1]>2)return"Gingerbread";if(n[0]===3)return"Honeycomb";if(n[0]===4&&n[1]<1)return"Ice Cream Sandwich";if(n[0]===4&&n[1]<4)return"Jelly Bean";if(n[0]===4&&n[1]>=4)return"KitKat";if(n[0]===5)return"Lollipop";if(n[0]===6)return"Marshmallow";if(n[0]===7)return"Nougat";if(n[0]===8)return"Oreo";if(n[0]===9)return"Pie"}}static getVersionPrecision(e){return e.split(".").length}static compareVersions(e,n,i=!1){const s=U.getVersionPrecision(e),r=U.getVersionPrecision(n);let o=Math.max(s,r),a=0;const l=U.map([e,n],c=>{const h=o-U.getVersionPrecision(c),u=c+new Array(h+1).join(".0");return U.map(u.split("."),d=>new Array(20-d.length).join("0")+d).reverse()});for(i&&(a=o-Math.min(s,r)),o-=1;o>=a;){if(l[0][o]>l[1][o])return 1;if(l[0][o]===l[1][o]){if(o===a)return 0;o-=1}else if(l[0][o]<l[1][o])return-1}}static map(e,n){const i=[];let s;if(Array.prototype.map)return Array.prototype.map.call(e,n);for(s=0;s<e.length;s+=1)i.push(n(e[s]));return i}static find(e,n){let i,s;if(Array.prototype.find)return Array.prototype.find.call(e,n);for(i=0,s=e.length;i<s;i+=1){const r=e[i];if(n(r,i))return r}}static assign(e,...n){const i=e;let s,r;if(Object.assign)return Object.assign(e,...n);for(s=0,r=n.length;s<r;s+=1){const o=n[s];typeof o=="object"&&o!==null&&Object.keys(o).forEach(l=>{i[l]=o[l]})}return e}static getBrowserAlias(e){return _L[e]}static getBrowserTypeByAlias(e){return nb[e]||""}}const tt=/version\/(\d+(\.?_?\d+)+)/i,yL=[{test:[/googlebot/i],describe(t){const e={name:"Googlebot"},n=U.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,t)||U.getFirstMatch(tt,t);return n&&(e.version=n),e}},{test:[/opera/i],describe(t){const e={name:"Opera"},n=U.getFirstMatch(tt,t)||U.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/opr\/|opios/i],describe(t){const e={name:"Opera"},n=U.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,t)||U.getFirstMatch(tt,t);return n&&(e.version=n),e}},{test:[/SamsungBrowser/i],describe(t){const e={name:"Samsung Internet for Android"},n=U.getFirstMatch(tt,t)||U.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/Whale/i],describe(t){const e={name:"NAVER Whale Browser"},n=U.getFirstMatch(tt,t)||U.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/PaleMoon/i],describe(t){const e={name:"Pale Moon"},n=U.getFirstMatch(tt,t)||U.getFirstMatch(/(?:PaleMoon)[\s/](\d+(?:\.\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/MZBrowser/i],describe(t){const e={name:"MZ Browser"},n=U.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,t)||U.getFirstMatch(tt,t);return n&&(e.version=n),e}},{test:[/focus/i],describe(t){const e={name:"Focus"},n=U.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,t)||U.getFirstMatch(tt,t);return n&&(e.version=n),e}},{test:[/swing/i],describe(t){const e={name:"Swing"},n=U.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,t)||U.getFirstMatch(tt,t);return n&&(e.version=n),e}},{test:[/coast/i],describe(t){const e={name:"Opera Coast"},n=U.getFirstMatch(tt,t)||U.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(t){const e={name:"Opera Touch"},n=U.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,t)||U.getFirstMatch(tt,t);return n&&(e.version=n),e}},{test:[/yabrowser/i],describe(t){const e={name:"Yandex Browser"},n=U.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,t)||U.getFirstMatch(tt,t);return n&&(e.version=n),e}},{test:[/ucbrowser/i],describe(t){const e={name:"UC Browser"},n=U.getFirstMatch(tt,t)||U.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/Maxthon|mxios/i],describe(t){const e={name:"Maxthon"},n=U.getFirstMatch(tt,t)||U.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/epiphany/i],describe(t){const e={name:"Epiphany"},n=U.getFirstMatch(tt,t)||U.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/puffin/i],describe(t){const e={name:"Puffin"},n=U.getFirstMatch(tt,t)||U.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/sleipnir/i],describe(t){const e={name:"Sleipnir"},n=U.getFirstMatch(tt,t)||U.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/k-meleon/i],describe(t){const e={name:"K-Meleon"},n=U.getFirstMatch(tt,t)||U.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/micromessenger/i],describe(t){const e={name:"WeChat"},n=U.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,t)||U.getFirstMatch(tt,t);return n&&(e.version=n),e}},{test:[/qqbrowser/i],describe(t){const e={name:/qqbrowserlite/i.test(t)?"QQ Browser Lite":"QQ Browser"},n=U.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,t)||U.getFirstMatch(tt,t);return n&&(e.version=n),e}},{test:[/msie|trident/i],describe(t){const e={name:"Internet Explorer"},n=U.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/\sedg\//i],describe(t){const e={name:"Microsoft Edge"},n=U.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/edg([ea]|ios)/i],describe(t){const e={name:"Microsoft Edge"},n=U.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/vivaldi/i],describe(t){const e={name:"Vivaldi"},n=U.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/seamonkey/i],describe(t){const e={name:"SeaMonkey"},n=U.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/sailfish/i],describe(t){const e={name:"Sailfish"},n=U.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,t);return n&&(e.version=n),e}},{test:[/silk/i],describe(t){const e={name:"Amazon Silk"},n=U.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/phantom/i],describe(t){const e={name:"PhantomJS"},n=U.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/slimerjs/i],describe(t){const e={name:"SlimerJS"},n=U.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(t){const e={name:"BlackBerry"},n=U.getFirstMatch(tt,t)||U.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/(web|hpw)[o0]s/i],describe(t){const e={name:"WebOS Browser"},n=U.getFirstMatch(tt,t)||U.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/bada/i],describe(t){const e={name:"Bada"},n=U.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/tizen/i],describe(t){const e={name:"Tizen"},n=U.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,t)||U.getFirstMatch(tt,t);return n&&(e.version=n),e}},{test:[/qupzilla/i],describe(t){const e={name:"QupZilla"},n=U.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,t)||U.getFirstMatch(tt,t);return n&&(e.version=n),e}},{test:[/firefox|iceweasel|fxios/i],describe(t){const e={name:"Firefox"},n=U.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/electron/i],describe(t){const e={name:"Electron"},n=U.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/MiuiBrowser/i],describe(t){const e={name:"Miui"},n=U.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/chromium/i],describe(t){const e={name:"Chromium"},n=U.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,t)||U.getFirstMatch(tt,t);return n&&(e.version=n),e}},{test:[/chrome|crios|crmo/i],describe(t){const e={name:"Chrome"},n=U.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/GSA/i],describe(t){const e={name:"Google Search"},n=U.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test(t){const e=!t.test(/like android/i),n=t.test(/android/i);return e&&n},describe(t){const e={name:"Android Browser"},n=U.getFirstMatch(tt,t);return n&&(e.version=n),e}},{test:[/playstation 4/i],describe(t){const e={name:"PlayStation 4"},n=U.getFirstMatch(tt,t);return n&&(e.version=n),e}},{test:[/safari|applewebkit/i],describe(t){const e={name:"Safari"},n=U.getFirstMatch(tt,t);return n&&(e.version=n),e}},{test:[/.*/i],describe(t){const e=/^(.*)\/(.*) /,n=/^(.*)\/(.*)[ \t]\((.*)/,s=t.search("\\(")!==-1?n:e;return{name:U.getFirstMatch(s,t),version:U.getSecondMatch(s,t)}}}],EL=[{test:[/Roku\/DVP/],describe(t){const e=U.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,t);return{name:pn.Roku,version:e}}},{test:[/windows phone/i],describe(t){const e=U.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,t);return{name:pn.WindowsPhone,version:e}}},{test:[/windows /i],describe(t){const e=U.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,t),n=U.getWindowsVersionName(e);return{name:pn.Windows,version:e,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(t){const e={name:pn.iOS},n=U.getSecondMatch(/(Version\/)(\d[\d.]+)/,t);return n&&(e.version=n),e}},{test:[/macintosh/i],describe(t){const e=U.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,t).replace(/[_\s]/g,"."),n=U.getMacOSVersionName(e),i={name:pn.MacOS,version:e};return n&&(i.versionName=n),i}},{test:[/(ipod|iphone|ipad)/i],describe(t){const e=U.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,t).replace(/[_\s]/g,".");return{name:pn.iOS,version:e}}},{test(t){const e=!t.test(/like android/i),n=t.test(/android/i);return e&&n},describe(t){const e=U.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,t),n=U.getAndroidVersionName(e),i={name:pn.Android,version:e};return n&&(i.versionName=n),i}},{test:[/(web|hpw)[o0]s/i],describe(t){const e=U.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,t),n={name:pn.WebOS};return e&&e.length&&(n.version=e),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(t){const e=U.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,t)||U.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,t)||U.getFirstMatch(/\bbb(\d+)/i,t);return{name:pn.BlackBerry,version:e}}},{test:[/bada/i],describe(t){const e=U.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,t);return{name:pn.Bada,version:e}}},{test:[/tizen/i],describe(t){const e=U.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,t);return{name:pn.Tizen,version:e}}},{test:[/linux/i],describe(){return{name:pn.Linux}}},{test:[/CrOS/],describe(){return{name:pn.ChromeOS}}},{test:[/PlayStation 4/],describe(t){const e=U.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,t);return{name:pn.PlayStation4,version:e}}}],xL=[{test:[/googlebot/i],describe(){return{type:gt.bot,vendor:"Google"}}},{test:[/huawei/i],describe(t){const e=U.getFirstMatch(/(can-l01)/i,t)&&"Nova",n={type:gt.mobile,vendor:"Huawei"};return e&&(n.model=e),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe(){return{type:gt.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe(){return{type:gt.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(){return{type:gt.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe(){return{type:gt.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe(){return{type:gt.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe(){return{type:gt.tablet}}},{test(t){const e=t.test(/ipod|iphone/i),n=t.test(/like (ipod|iphone)/i);return e&&!n},describe(t){const e=U.getFirstMatch(/(ipod|iphone)/i,t);return{type:gt.mobile,vendor:"Apple",model:e}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe(){return{type:gt.mobile,vendor:"Nexus"}}},{test:[/Nokia/i],describe(t){const e=U.getFirstMatch(/Nokia\s+([0-9]+(\.[0-9]+)?)/i,t),n={type:gt.mobile,vendor:"Nokia"};return e&&(n.model=e),n}},{test:[/[^-]mobi/i],describe(){return{type:gt.mobile}}},{test(t){return t.getBrowserName(!0)==="blackberry"},describe(){return{type:gt.mobile,vendor:"BlackBerry"}}},{test(t){return t.getBrowserName(!0)==="bada"},describe(){return{type:gt.mobile}}},{test(t){return t.getBrowserName()==="windows phone"},describe(){return{type:gt.mobile,vendor:"Microsoft"}}},{test(t){const e=Number(String(t.getOSVersion()).split(".")[0]);return t.getOSName(!0)==="android"&&e>=3},describe(){return{type:gt.tablet}}},{test(t){return t.getOSName(!0)==="android"},describe(){return{type:gt.mobile}}},{test(t){return t.getOSName(!0)==="macos"},describe(){return{type:gt.desktop,vendor:"Apple"}}},{test(t){return t.getOSName(!0)==="windows"},describe(){return{type:gt.desktop}}},{test(t){return t.getOSName(!0)==="linux"},describe(){return{type:gt.desktop}}},{test(t){return t.getOSName(!0)==="playstation 4"},describe(){return{type:gt.tv}}},{test(t){return t.getOSName(!0)==="roku"},describe(){return{type:gt.tv}}}],wL=[{test(t){return t.getBrowserName(!0)==="microsoft edge"},describe(t){if(/\sedg\//i.test(t))return{name:xs.Blink};const n=U.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,t);return{name:xs.EdgeHTML,version:n}}},{test:[/trident/i],describe(t){const e={name:xs.Trident},n=U.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test(t){return t.test(/presto/i)},describe(t){const e={name:xs.Presto},n=U.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test(t){const e=t.test(/gecko/i),n=t.test(/like gecko/i);return e&&!n},describe(t){const e={name:xs.Gecko},n=U.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/(apple)?webkit\/537\.36/i],describe(){return{name:xs.Blink}}},{test:[/(apple)?webkit/i],describe(t){const e={name:xs.WebKit},n=U.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}}];class xE{constructor(e,n=!1){if(e==null||e==="")throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},n!==!0&&this.parse()}getUA(){return this._ua}test(e){return e.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const e=U.find(yL,n=>{if(typeof n.test=="function")return n.test(this);if(Array.isArray(n.test))return n.test.some(i=>this.test(i));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const e=U.find(EL,n=>{if(typeof n.test=="function")return n.test(this);if(Array.isArray(n.test))return n.test.some(i=>this.test(i));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os}getOSName(e){const{name:n}=this.getOS();return e?String(n).toLowerCase()||"":n||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(e=!1){const{type:n}=this.getPlatform();return e?String(n).toLowerCase()||"":n||""}parsePlatform(){this.parsedResult.platform={};const e=U.find(xL,n=>{if(typeof n.test=="function")return n.test(this);if(Array.isArray(n.test))return n.test.some(i=>this.test(i));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const e=U.find(wL,n=>{if(typeof n.test=="function")return n.test(this);if(Array.isArray(n.test))return n.test.some(i=>this.test(i));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return U.assign({},this.parsedResult)}satisfies(e){const n={};let i=0;const s={};let r=0;if(Object.keys(e).forEach(a=>{const l=e[a];typeof l=="string"?(s[a]=l,r+=1):typeof l=="object"&&(n[a]=l,i+=1)}),i>0){const a=Object.keys(n),l=U.find(a,h=>this.isOS(h));if(l){const h=this.satisfies(n[l]);if(h!==void 0)return h}const c=U.find(a,h=>this.isPlatform(h));if(c){const h=this.satisfies(n[c]);if(h!==void 0)return h}}if(r>0){const a=Object.keys(s),l=U.find(a,c=>this.isBrowser(c,!0));if(l!==void 0)return this.compareVersion(s[l])}}isBrowser(e,n=!1){const i=this.getBrowserName().toLowerCase();let s=e.toLowerCase();const r=U.getBrowserTypeByAlias(s);return n&&r&&(s=r.toLowerCase()),s===i}compareVersion(e){let n=[0],i=e,s=!1;const r=this.getBrowserVersion();if(typeof r=="string")return e[0]===">"||e[0]==="<"?(i=e.substr(1),e[1]==="="?(s=!0,i=e.substr(2)):n=[],e[0]===">"?n.push(1):n.push(-1)):e[0]==="="?i=e.substr(1):e[0]==="~"&&(s=!0,i=e.substr(1)),n.indexOf(U.compareVersions(r,i,s))>-1}isOS(e){return this.getOSName(!0)===String(e).toLowerCase()}isPlatform(e){return this.getPlatformType(!0)===String(e).toLowerCase()}isEngine(e){return this.getEngineName(!0)===String(e).toLowerCase()}is(e,n=!1){return this.isBrowser(e,n)||this.isOS(e)||this.isPlatform(e)}some(e=[]){return e.some(n=>this.is(n))}}/*!
 * Bowser - a browser detector
 * https://github.com/lancedikson/bowser
 * MIT License | (c) Dustin Diaz 2012-2015
 * MIT License | (c) Denis Demchenko 2015-2019
 */class ib{static getParser(e,n=!1){if(typeof e!="string")throw new Error("UserAgent should be a string");return new xE(e,n)}static parse(e){return new xE(e).getResult()}static get BROWSER_MAP(){return nb}static get ENGINE_MAP(){return xs}static get OS_MAP(){return pn}static get PLATFORMS_MAP(){return gt}}const SL=({serviceId:t,clientVersion:e})=>async n=>{const i=typeof window<"u"&&window?.navigator?.userAgent?ib.parse(window.navigator.userAgent):void 0,s=[["aws-sdk-js",e],["ua","2.1"],[`os/${i?.os?.name||"other"}`,i?.os?.version],["lang/js"],["md/browser",`${i?.browser?.name??"unknown"}_${i?.browser?.version??"unknown"}`]];t&&s.push([`api/${t}`,e]);const r=await n?.userAgentAppId?.();return r&&s.push([`app/${r}`]),s};class Ya{constructor(e){if(this.bytes=e,e.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>9223372036854776e3||e<-9223372036854776e3)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const n=new Uint8Array(8);for(let i=7,s=Math.abs(Math.round(e));i>-1&&s>0;i--,s/=256)n[i]=s;return e<0&&wE(n),new Ya(n)}valueOf(){const e=this.bytes.slice(0),n=e[0]&128;return n&&wE(e),parseInt(Dn(e),16)*(n?-1:1)}toString(){return String(this.valueOf())}}function wE(t){for(let e=0;e<8;e++)t[e]^=255;for(let e=7;e>-1&&(t[e]++,t[e]===0);e--);}class CL{constructor(e,n){this.toUtf8=e,this.fromUtf8=n}format(e){const n=[];for(const r of Object.keys(e)){const o=this.fromUtf8(r);n.push(Uint8Array.from([o.byteLength]),o,this.formatHeaderValue(e[r]))}const i=new Uint8Array(n.reduce((r,o)=>r+o.byteLength,0));let s=0;for(const r of n)i.set(r,s),s+=r.byteLength;return i}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const n=new DataView(new ArrayBuffer(3));return n.setUint8(0,3),n.setInt16(1,e.value,!1),new Uint8Array(n.buffer);case"integer":const i=new DataView(new ArrayBuffer(5));return i.setUint8(0,4),i.setInt32(1,e.value,!1),new Uint8Array(i.buffer);case"long":const s=new Uint8Array(9);return s[0]=5,s.set(e.value.bytes,1),s;case"binary":const r=new DataView(new ArrayBuffer(3+e.value.byteLength));r.setUint8(0,6),r.setUint16(1,e.value.byteLength,!1);const o=new Uint8Array(r.buffer);return o.set(e.value,3),o;case"string":const a=this.fromUtf8(e.value),l=new DataView(new ArrayBuffer(3+a.byteLength));l.setUint8(0,7),l.setUint16(1,a.byteLength,!1);const c=new Uint8Array(l.buffer);return c.set(a,3),c;case"timestamp":const h=new Uint8Array(9);return h[0]=8,h.set(Ya.fromNumber(e.value.valueOf()).bytes,1),h;case"uuid":if(!FL.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const u=new Uint8Array(17);return u[0]=9,u.set(mS(e.value.replace(/\-/g,"")),1),u}}parse(e){const n={};let i=0;for(;i<e.byteLength;){const s=e.getUint8(i++),r=this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+i,s));switch(i+=s,e.getUint8(i++)){case 0:n[r]={type:CE,value:!0};break;case 1:n[r]={type:CE,value:!1};break;case 2:n[r]={type:bL,value:e.getInt8(i++)};break;case 3:n[r]={type:TL,value:e.getInt16(i,!1)},i+=2;break;case 4:n[r]={type:RL,value:e.getInt32(i,!1)},i+=4;break;case 5:n[r]={type:vL,value:new Ya(new Uint8Array(e.buffer,e.byteOffset+i,8))},i+=8;break;case 6:const o=e.getUint16(i,!1);i+=2,n[r]={type:AL,value:new Uint8Array(e.buffer,e.byteOffset+i,o)},i+=o;break;case 7:const a=e.getUint16(i,!1);i+=2,n[r]={type:IL,value:this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+i,a))},i+=a;break;case 8:n[r]={type:PL,value:new Date(new Ya(new Uint8Array(e.buffer,e.byteOffset+i,8)).valueOf())},i+=8;break;case 9:const l=new Uint8Array(e.buffer,e.byteOffset+i,16);i+=16,n[r]={type:ML,value:`${Dn(l.subarray(0,4))}-${Dn(l.subarray(4,6))}-${Dn(l.subarray(6,8))}-${Dn(l.subarray(8,10))}-${Dn(l.subarray(10))}`};break;default:throw new Error("Unrecognized header type tag")}}return n}}var SE;(function(t){t[t.boolTrue=0]="boolTrue",t[t.boolFalse=1]="boolFalse",t[t.byte=2]="byte",t[t.short=3]="short",t[t.integer=4]="integer",t[t.long=5]="long",t[t.byteArray=6]="byteArray",t[t.string=7]="string",t[t.timestamp=8]="timestamp",t[t.uuid=9]="uuid"})(SE||(SE={}));const CE="boolean",bL="byte",TL="short",RL="integer",vL="long",AL="binary",IL="string",PL="timestamp",ML="uuid",FL=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/,sb=4,ws=sb*2,ar=4,DL=ws+ar*2;function OL({byteLength:t,byteOffset:e,buffer:n}){if(t<DL)throw new Error("Provided message too short to accommodate event stream message overhead");const i=new DataView(n,e,t),s=i.getUint32(0,!1);if(t!==s)throw new Error("Reported message length does not match received message length");const r=i.getUint32(sb,!1),o=i.getUint32(ws,!1),a=i.getUint32(t-ar,!1),l=new uh().update(new Uint8Array(n,e,ws));if(o!==l.digest())throw new Error(`The prelude checksum specified in the message (${o}) does not match the calculated CRC32 checksum (${l.digest()})`);if(l.update(new Uint8Array(n,e+ws,t-(ws+ar))),a!==l.digest())throw new Error(`The message checksum (${l.digest()}) did not match the expected value of ${a}`);return{headers:new DataView(n,e+ws+ar,r),body:new Uint8Array(n,e+ws+ar+r,s-r-(ws+ar+ar))}}class LL{constructor(e,n){this.headerMarshaller=new CL(e,n),this.messageBuffer=[],this.isEndOfStream=!1}feed(e){this.messageBuffer.push(this.decode(e))}endOfStream(){this.isEndOfStream=!0}getMessage(){const e=this.messageBuffer.pop(),n=this.isEndOfStream;return{getMessage(){return e},isEndOfStream(){return n}}}getAvailableMessages(){const e=this.messageBuffer;this.messageBuffer=[];const n=this.isEndOfStream;return{getMessages(){return e},isEndOfStream(){return n}}}encode({headers:e,body:n}){const i=this.headerMarshaller.format(e),s=i.byteLength+n.byteLength+16,r=new Uint8Array(s),o=new DataView(r.buffer,r.byteOffset,r.byteLength),a=new uh;return o.setUint32(0,s,!1),o.setUint32(4,i.byteLength,!1),o.setUint32(8,a.update(r.subarray(0,8)).digest(),!1),r.set(i,12),r.set(n,i.byteLength+12),o.setUint32(s-4,a.update(r.subarray(8,s-4)).digest(),!1),r}decode(e){const{headers:n,body:i}=OL(e);return{headers:this.headerMarshaller.parse(n),body:i}}formatHeaders(e){return this.headerMarshaller.format(e)}}class kL{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.inputStream)yield this.options.decoder.decode(e)}}class NL{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.messageStream)yield this.options.encoder.encode(e);this.options.includeEndFrame&&(yield new Uint8Array(0))}}class BL{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.messageStream){const n=await this.options.deserializer(e);n!==void 0&&(yield n)}}}class UL{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.inputStream)yield this.options.serializer(e)}}function GL(t){let e=0,n=0,i=null,s=null;const r=a=>{if(typeof a!="number")throw new Error("Attempted to allocate an event message where size was not a number: "+a);e=a,n=4,i=new Uint8Array(a),new DataView(i.buffer).setUint32(0,a,!1)},o=async function*(){const a=t[Symbol.asyncIterator]();for(;;){const{value:l,done:c}=await a.next();if(c){if(e)if(e===n)yield i;else throw new Error("Truncated event message received.");else return;return}const h=l.length;let u=0;for(;u<h;){if(!i){const f=h-u;s||(s=new Uint8Array(4));const g=Math.min(4-n,f);if(s.set(l.slice(u,u+g),n),n+=g,u+=g,n<4)break;r(new DataView(s.buffer).getUint32(0,!1)),s=null}const d=Math.min(e-n,h-u);i.set(l.slice(u,u+d),n),n+=d,u+=d,e&&e===n&&(yield i,i=null,e=0,n=0)}}};return{[Symbol.asyncIterator]:o}}function $L(t,e){return async function(n){const{value:i}=n.headers[":message-type"];if(i==="error"){const s=new Error(n.headers[":error-message"].value||"UnknownError");throw s.name=n.headers[":error-code"].value,s}else if(i==="exception"){const s=n.headers[":exception-type"].value,r={[s]:n},o=await t(r);if(o.$unknown){const a=new Error(e(n.body));throw a.name=s,a}throw o[s]}else if(i==="event"){const s={[n.headers[":event-type"].value]:n},r=await t(s);return r.$unknown?void 0:r}else throw Error(`Unrecognizable event type: ${n.headers[":event-type"].value}`)}}let jL=class{constructor({utf8Encoder:e,utf8Decoder:n}){this.eventStreamCodec=new LL(e,n),this.utfEncoder=e}deserialize(e,n){const i=GL(e);return new BL({messageStream:new kL({inputStream:i,decoder:this.eventStreamCodec}),deserializer:$L(n,this.utfEncoder)})}serialize(e,n){return new NL({messageStream:new UL({inputStream:e,serializer:n}),encoder:this.eventStreamCodec,includeEndFrame:!0})}};const zL=t=>({[Symbol.asyncIterator]:async function*(){const e=t.getReader();try{for(;;){const{done:n,value:i}=await e.read();if(n)return;yield i}}finally{e.releaseLock()}}}),HL=t=>{const e=t[Symbol.asyncIterator]();return new ReadableStream({async pull(n){const{done:i,value:s}=await e.next();if(i)return n.close();n.enqueue(s)}})};class XL{constructor({utf8Encoder:e,utf8Decoder:n}){this.universalMarshaller=new jL({utf8Decoder:n,utf8Encoder:e})}deserialize(e,n){const i=VL(e)?zL(e):e;return this.universalMarshaller.deserialize(i,n)}serialize(e,n){const i=this.universalMarshaller.serialize(e,n);return typeof ReadableStream=="function"?HL(i):i}}const VL=t=>typeof ReadableStream=="function"&&t instanceof ReadableStream,WL=t=>new XL(t);async function KL(t,e,n=1024*1024){const i=t.size;let s=0;for(;s<i;){const r=t.slice(s,Math.min(i,s+n));e(new Uint8Array(await r.arrayBuffer())),s+=r.size}}const YL=async function(e,n){const i=new e;return await KL(n,s=>{i.update(s)}),i.digest()},qL=t=>()=>Promise.reject(t),fs=64,ZL=16,JL=[1732584193,4023233417,2562383102,271733878];class QL{constructor(){this.reset()}update(e){if(ek(e))return;if(this.finished)throw new Error("Attempted to update an already finished hash.");const n=tk(e);let i=0,{byteLength:s}=n;for(this.bytesHashed+=s;s>0;)this.buffer.setUint8(this.bufferLength++,n[i++]),s--,this.bufferLength===fs&&(this.hashBuffer(),this.bufferLength=0)}async digest(){if(!this.finished){const{buffer:n,bufferLength:i,bytesHashed:s}=this,r=s*8;if(n.setUint8(this.bufferLength++,128),i%fs>=fs-8){for(let o=this.bufferLength;o<fs;o++)n.setUint8(o,0);this.hashBuffer(),this.bufferLength=0}for(let o=this.bufferLength;o<fs-8;o++)n.setUint8(o,0);n.setUint32(fs-8,r>>>0,!0),n.setUint32(fs-4,Math.floor(r/4294967296),!0),this.hashBuffer(),this.finished=!0}const e=new DataView(new ArrayBuffer(ZL));for(let n=0;n<4;n++)e.setUint32(n*4,this.state[n],!0);return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}hashBuffer(){const{buffer:e,state:n}=this;let i=n[0],s=n[1],r=n[2],o=n[3];i=Jt(i,s,r,o,e.getUint32(0,!0),7,3614090360),o=Jt(o,i,s,r,e.getUint32(4,!0),12,3905402710),r=Jt(r,o,i,s,e.getUint32(8,!0),17,606105819),s=Jt(s,r,o,i,e.getUint32(12,!0),22,3250441966),i=Jt(i,s,r,o,e.getUint32(16,!0),7,4118548399),o=Jt(o,i,s,r,e.getUint32(20,!0),12,1200080426),r=Jt(r,o,i,s,e.getUint32(24,!0),17,2821735955),s=Jt(s,r,o,i,e.getUint32(28,!0),22,4249261313),i=Jt(i,s,r,o,e.getUint32(32,!0),7,1770035416),o=Jt(o,i,s,r,e.getUint32(36,!0),12,2336552879),r=Jt(r,o,i,s,e.getUint32(40,!0),17,4294925233),s=Jt(s,r,o,i,e.getUint32(44,!0),22,2304563134),i=Jt(i,s,r,o,e.getUint32(48,!0),7,1804603682),o=Jt(o,i,s,r,e.getUint32(52,!0),12,4254626195),r=Jt(r,o,i,s,e.getUint32(56,!0),17,2792965006),s=Jt(s,r,o,i,e.getUint32(60,!0),22,1236535329),i=Qt(i,s,r,o,e.getUint32(4,!0),5,4129170786),o=Qt(o,i,s,r,e.getUint32(24,!0),9,3225465664),r=Qt(r,o,i,s,e.getUint32(44,!0),14,643717713),s=Qt(s,r,o,i,e.getUint32(0,!0),20,3921069994),i=Qt(i,s,r,o,e.getUint32(20,!0),5,3593408605),o=Qt(o,i,s,r,e.getUint32(40,!0),9,38016083),r=Qt(r,o,i,s,e.getUint32(60,!0),14,3634488961),s=Qt(s,r,o,i,e.getUint32(16,!0),20,3889429448),i=Qt(i,s,r,o,e.getUint32(36,!0),5,568446438),o=Qt(o,i,s,r,e.getUint32(56,!0),9,3275163606),r=Qt(r,o,i,s,e.getUint32(12,!0),14,4107603335),s=Qt(s,r,o,i,e.getUint32(32,!0),20,1163531501),i=Qt(i,s,r,o,e.getUint32(52,!0),5,2850285829),o=Qt(o,i,s,r,e.getUint32(8,!0),9,4243563512),r=Qt(r,o,i,s,e.getUint32(28,!0),14,1735328473),s=Qt(s,r,o,i,e.getUint32(48,!0),20,2368359562),i=en(i,s,r,o,e.getUint32(20,!0),4,4294588738),o=en(o,i,s,r,e.getUint32(32,!0),11,2272392833),r=en(r,o,i,s,e.getUint32(44,!0),16,1839030562),s=en(s,r,o,i,e.getUint32(56,!0),23,4259657740),i=en(i,s,r,o,e.getUint32(4,!0),4,2763975236),o=en(o,i,s,r,e.getUint32(16,!0),11,1272893353),r=en(r,o,i,s,e.getUint32(28,!0),16,4139469664),s=en(s,r,o,i,e.getUint32(40,!0),23,3200236656),i=en(i,s,r,o,e.getUint32(52,!0),4,681279174),o=en(o,i,s,r,e.getUint32(0,!0),11,3936430074),r=en(r,o,i,s,e.getUint32(12,!0),16,3572445317),s=en(s,r,o,i,e.getUint32(24,!0),23,76029189),i=en(i,s,r,o,e.getUint32(36,!0),4,3654602809),o=en(o,i,s,r,e.getUint32(48,!0),11,3873151461),r=en(r,o,i,s,e.getUint32(60,!0),16,530742520),s=en(s,r,o,i,e.getUint32(8,!0),23,3299628645),i=tn(i,s,r,o,e.getUint32(0,!0),6,4096336452),o=tn(o,i,s,r,e.getUint32(28,!0),10,1126891415),r=tn(r,o,i,s,e.getUint32(56,!0),15,2878612391),s=tn(s,r,o,i,e.getUint32(20,!0),21,4237533241),i=tn(i,s,r,o,e.getUint32(48,!0),6,1700485571),o=tn(o,i,s,r,e.getUint32(12,!0),10,2399980690),r=tn(r,o,i,s,e.getUint32(40,!0),15,4293915773),s=tn(s,r,o,i,e.getUint32(4,!0),21,2240044497),i=tn(i,s,r,o,e.getUint32(32,!0),6,1873313359),o=tn(o,i,s,r,e.getUint32(60,!0),10,4264355552),r=tn(r,o,i,s,e.getUint32(24,!0),15,2734768916),s=tn(s,r,o,i,e.getUint32(52,!0),21,1309151649),i=tn(i,s,r,o,e.getUint32(16,!0),6,4149444226),o=tn(o,i,s,r,e.getUint32(44,!0),10,3174756917),r=tn(r,o,i,s,e.getUint32(8,!0),15,718787259),s=tn(s,r,o,i,e.getUint32(36,!0),21,3951481745),n[0]=i+n[0]&4294967295,n[1]=s+n[1]&4294967295,n[2]=r+n[2]&4294967295,n[3]=o+n[3]&4294967295}reset(){this.state=Uint32Array.from(JL),this.buffer=new DataView(new ArrayBuffer(fs)),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}}function cu(t,e,n,i,s,r){return e=(e+t&4294967295)+(i+r&4294967295)&4294967295,(e<<s|e>>>32-s)+n&4294967295}function Jt(t,e,n,i,s,r,o){return cu(e&n|~e&i,t,e,s,r,o)}function Qt(t,e,n,i,s,r,o){return cu(e&i|n&~i,t,e,s,r,o)}function en(t,e,n,i,s,r,o){return cu(e^n^i,t,e,s,r,o)}function tn(t,e,n,i,s,r,o){return cu(n^(e|~i),t,e,s,r,o)}function ek(t){return typeof t=="string"?t.length===0:t.byteLength===0}function tk(t){return typeof t=="string"?vr(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t)}const nk=t=>({apiVersion:"2006-03-01",base64Decoder:t?.base64Decoder??ap,base64Encoder:t?.base64Encoder??Yh,disableHostPrefix:t?.disableHostPrefix??!1,endpointProvider:t?.endpointProvider??SC,extensions:t?.extensions??[],getAwsChunkedEncodingStream:t?.getAwsChunkedEncodingStream??uA,httpAuthSchemeProvider:t?.httpAuthSchemeProvider??eD,httpAuthSchemes:t?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4"),signer:new uS},{schemeId:"aws.auth#sigv4a",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4a"),signer:new $v}],logger:t?.logger??new gp,sdkStreamMixin:t?.sdkStreamMixin??EA,serviceId:t?.serviceId??"S3",signerConstructor:t?.signerConstructor??rC,signingEscapePath:t?.signingEscapePath??!1,urlParser:t?.urlParser??fh,useArnRegion:t?.useArnRegion??void 0,utf8Decoder:t?.utf8Decoder??vr,utf8Encoder:t?.utf8Encoder??lp}),ik=["in-region","cross-region","mobile","standard","legacy"],sk=({defaultsMode:t}={})=>eI(async()=>{const e=typeof t=="function"?await t():t;switch(e?.toLowerCase()){case"auto":return Promise.resolve(rk()?"mobile":"standard");case"mobile":case"in-region":case"cross-region":case"standard":case"legacy":return Promise.resolve(e?.toLocaleLowerCase());case void 0:return Promise.resolve("legacy");default:throw new Error(`Invalid parameter for "defaultsMode", expect ${ik.join(", ")}, got ${e}`)}}),rk=()=>{const e=(typeof window<"u"&&window?.navigator?.userAgent?ib.parse(window.navigator.userAgent):void 0)?.platform?.type;return e==="tablet"||e==="mobile"},ok=t=>{const e=sk(t),n=()=>e().then(kI),i=nk(t);return{...i,...t,runtime:"browser",defaultsMode:e,bodyLengthChecker:t?.bodyLengthChecker??PI,credentialDefaultProvider:t?.credentialDefaultProvider??(s=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:t?.defaultUserAgentProvider??SL({serviceId:i.serviceId,clientVersion:QO.version}),eventStreamSerdeProvider:t?.eventStreamSerdeProvider??WL,maxAttempts:t?.maxAttempts??gh,md5:t?.md5??QL,region:t?.region??qL("Region is missing"),requestHandler:cp.create(t?.requestHandler??n),retryMode:t?.retryMode??(async()=>(await n()).retryMode||c2),sha1:t?.sha1??aL,sha256:t?.sha256??mL,streamCollector:t?.streamCollector??gS,streamHasher:t?.streamHasher??YL,useDualstackEndpoint:t?.useDualstackEndpoint??(()=>Promise.resolve(XF)),useFipsEndpoint:t?.useFipsEndpoint??(()=>Promise.resolve(VF))}},ak=t=>({setRegion(e){t.region=e},region(){return t.region}}),lk=t=>({region:t.region()}),ck=t=>{const e=t.httpAuthSchemes;let n=t.httpAuthSchemeProvider,i=t.credentials;return{setHttpAuthScheme(s){const r=e.findIndex(o=>o.schemeId===s.schemeId);r===-1?e.push(s):e.splice(r,1,s)},httpAuthSchemes(){return e},setHttpAuthSchemeProvider(s){n=s},httpAuthSchemeProvider(){return n},setCredentials(s){i=s},credentials(){return i}}},hk=t=>({httpAuthSchemes:t.httpAuthSchemes(),httpAuthSchemeProvider:t.httpAuthSchemeProvider(),credentials:t.credentials()}),uk=(t,e)=>{const n=Object.assign(ak(t),$I(t),Mv(t),ck(t));return e.forEach(i=>i.configure(n)),Object.assign(t,lk(n),jI(n),Fv(n),hk(n))};class dk extends MI{config;constructor(...[e]){const n=ok(e||{});super(n),this.initConfig=n;const i=nD(n),s=lF(i),r=uM(s),o=v2(r),a=WF(o),l=a,c=l2(l),h=KF(c),u=tD(h),d=KM(u,{session:[()=>this,ZO]}),f=uk(d,e?.extensions||[]);this.config=f,this.middlewareStack.use(HF(this.config)),this.middlewareStack.use(O2(this.config)),this.middlewareStack.use(ZF(this.config)),this.middlewareStack.use(gM(this.config)),this.middlewareStack.use(_M(this.config)),this.middlewareStack.use(SM(this.config)),this.middlewareStack.use(Vv(this.config,{httpAuthSchemeParametersProvider:Z2,identityProviderConfigProvider:async g=>new YA({"aws.auth#sigv4":g.credentials,"aws.auth#sigv4a":g.credentials})})),this.middlewareStack.use(Qv(this.config)),this.middlewareStack.use(rF(this.config)),this.middlewareStack.use(kv(this.config)),this.middlewareStack.use(FM(this.config)),this.middlewareStack.use(jM(this.config)),this.middlewareStack.use(WM(this.config))}destroy(){super.destroy()}}function fk(t){return e=>async n=>{const i={...n.input},s=[{target:"SSECustomerKey",hash:"SSECustomerKeyMD5"},{target:"CopySourceSSECustomerKey",hash:"CopySourceSSECustomerKeyMD5"}];for(const r of s){const o=i[r.target];if(o){let a;typeof o=="string"?pk(o,t)?a=t.base64Decoder(o):(a=t.utf8Decoder(o),i[r.target]=t.base64Encoder(a)):(a=ArrayBuffer.isView(o)?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):new Uint8Array(o),i[r.target]=t.base64Encoder(a));const l=new t.md5;l.update(a),i[r.hash]=t.base64Encoder(await l.digest())}}return e({...n,input:i})}}const gk={name:"ssecMiddleware",step:"initialize",tags:["SSE"],override:!0},rb=t=>({applyToStack:e=>{e.add(fk(t),gk)}});function pk(t,e){if(!/^(?:[A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t))return!1;try{return e.base64Decoder(t).length===32}catch{return!1}}class mk extends Ol.classBuilder().ep({...tu,Bucket:{type:"contextParams",name:"Bucket"},Key:{type:"contextParams",name:"Key"}}).m(function(e,n,i,s){return[Kh(i,this.serialize,this.deserialize),Qh(i,e.getEndpointParameterInstructions()),jS(i,{requestChecksumRequired:!1,requestValidationModeMember:"ChecksumMode",responseAlgorithms:["CRC64NVME","CRC32","CRC32C","SHA256","SHA1"]}),rb(i),LM()]}).s("AmazonS3","GetObject",{}).n("S3Client","GetObjectCommand").f(aD,oD).ser(uD).de(pD).build(){}class _k extends Ol.classBuilder().ep({...tu,Bucket:{type:"contextParams",name:"Bucket"},Prefix:{type:"contextParams",name:"Prefix"}}).m(function(e,n,i,s){return[Kh(i,this.serialize,this.deserialize),Qh(i,e.getEndpointParameterInstructions()),Cp(i)]}).s("AmazonS3","ListObjectsV2",{}).n("S3Client","ListObjectsV2Command").f(void 0,void 0).ser(dD).de(mD).build(){}class yk extends Ol.classBuilder().ep({...tu,Bucket:{type:"contextParams",name:"Bucket"},Key:{type:"contextParams",name:"Key"}}).m(function(e,n,i,s){return[Kh(i,this.serialize,this.deserialize),Qh(i,e.getEndpointParameterInstructions()),jS(i,{requestAlgorithmMember:{httpHeader:"x-amz-sdk-checksum-algorithm",name:"ChecksumAlgorithm"},requestChecksumRequired:!1}),vM(),Cp(i),rb(i)]}).s("AmazonS3","PutObject",{}).n("S3Client","PutObjectCommand").f(cD,lD).ser(fD).de(_D).build(){}const Ek="modulepreload",xk=function(t){return"/dinamap-les/"+t},bE={},$i=function(e,n,i){let s=Promise.resolve();if(n&&n.length>0){let l=function(c){return Promise.all(c.map(h=>Promise.resolve(h).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");s=l(n.map(c=>{if(c=xk(c),c in bE)return;bE[c]=!0;const h=c.endsWith(".css"),u=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const d=document.createElement("link");if(d.rel=h?"stylesheet":Ek,h||(d.as="script"),d.crossOrigin="",d.href=c,a&&d.setAttribute("nonce",a),document.head.appendChild(d),h)return new Promise((f,g)=>{d.addEventListener("load",f),d.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&r(a.reason);return e().catch(r)})};function ob(t){return Promise.all(Object.keys(t).reduce((e,n)=>{const i=t[n];return typeof i=="string"?e.push([n,i]):e.push(i().then(s=>[n,s])),e},[])).then(e=>e.reduce((n,[i,s])=>(n[i]=s,n),{}))}function wk(t){return async e=>{t.logger?.debug("@aws-sdk/credential-provider-cognito-identity - fromCognitoIdentity");const{GetCredentialsForIdentityCommand:n,CognitoIdentityClient:i}=await $i(async()=>{const{GetCredentialsForIdentityCommand:c,CognitoIdentityClient:h}=await import("./loadCognitoIdentity-CcXtJ5kr.js");return{GetCredentialsForIdentityCommand:c,CognitoIdentityClient:h}},[]),s=c=>t.clientConfig?.[c]??t.parentClientConfig?.[c]??e?.callerClientConfig?.[c],{Credentials:{AccessKeyId:r=Sk(t.logger),Expiration:o,SecretKey:a=bk(t.logger),SessionToken:l}=Ck(t.logger)}=await(t.client??new i(Object.assign({},t.clientConfig??{},{region:s("region"),profile:s("profile")}))).send(new n({CustomRoleArn:t.customRoleArn,IdentityId:t.identityId,Logins:t.logins?await ob(t.logins):void 0}));return{identityId:t.identityId,accessKeyId:r,secretAccessKey:a,sessionToken:l,expiration:o}}}function Sk(t){throw new qo("Response from Amazon Cognito contained no access key ID",{logger:t})}function Ck(t){throw new qo("Response from Amazon Cognito contained no credentials",{logger:t})}function bk(t){throw new qo("Response from Amazon Cognito contained no secret key",{logger:t})}const Wd="IdentityIds";class Tk{dbName;constructor(e="aws:cognito-identity-ids"){this.dbName=e}getItem(e){return this.withObjectStore("readonly",n=>{const i=n.get(e);return new Promise(s=>{i.onerror=()=>s(null),i.onsuccess=()=>s(i.result?i.result.value:null)})}).catch(()=>null)}removeItem(e){return this.withObjectStore("readwrite",n=>{const i=n.delete(e);return new Promise((s,r)=>{i.onerror=()=>r(i.error),i.onsuccess=()=>s()})})}setItem(e,n){return this.withObjectStore("readwrite",i=>{const s=i.put({id:e,value:n});return new Promise((r,o)=>{s.onerror=()=>o(s.error),s.onsuccess=()=>r()})})}getDb(){const e=self.indexedDB.open(this.dbName,1);return new Promise((n,i)=>{e.onsuccess=()=>{n(e.result)},e.onerror=()=>{i(e.error)},e.onblocked=()=>{i(new Error("Unable to access DB"))},e.onupgradeneeded=()=>{const s=e.result;s.onerror=()=>{i(new Error("Failed to create object store"))},s.createObjectStore(Wd,{keyPath:"id"})}})}withObjectStore(e,n){return this.getDb().then(i=>{const s=i.transaction(Wd,e);return s.oncomplete=()=>i.close(),new Promise((r,o)=>{s.onerror=()=>o(s.error),r(n(s.objectStore(Wd)))}).catch(r=>{throw i.close(),r})})}}class Rk{store;constructor(e={}){this.store=e}getItem(e){return e in this.store?this.store[e]:null}removeItem(e){delete this.store[e]}setItem(e,n){this.store[e]=n}}const vk=new Rk;function Ak(){return typeof self=="object"&&self.indexedDB?new Tk:typeof window=="object"&&window.localStorage?window.localStorage:vk}function Ik({accountId:t,cache:e=Ak(),client:n,clientConfig:i,customRoleArn:s,identityPoolId:r,logins:o,userIdentifier:a=!o||Object.keys(o).length===0?"ANONYMOUS":void 0,logger:l,parentClientConfig:c}){l?.debug("@aws-sdk/credential-provider-cognito-identity - fromCognitoIdentity");const h=a?`aws:cognito-identity-credentials:${r}:${a}`:void 0;let u=async d=>{const{GetIdCommand:f,CognitoIdentityClient:g}=await $i(async()=>{const{GetIdCommand:_,CognitoIdentityClient:x}=await import("./loadCognitoIdentity-CcXtJ5kr.js");return{GetIdCommand:_,CognitoIdentityClient:x}},[]),m=_=>i?.[_]??c?.[_]??d?.callerClientConfig?.[_],p=n??new g(Object.assign({},i??{},{region:m("region"),profile:m("profile")}));let y=h&&await e.getItem(h);if(!y){const{IdentityId:_=Pk(l)}=await p.send(new f({AccountId:t,IdentityPoolId:r,Logins:o?await ob(o):void 0}));y=_,h&&Promise.resolve(e.setItem(h,y)).catch(()=>{})}return u=wk({client:p,customRoleArn:s,logins:o,identityId:y}),u(d)};return d=>u(d).catch(async f=>{throw h&&Promise.resolve(e.removeItem(h)).catch(()=>{}),f})}function Pk(t){throw new qo("Response from Amazon Cognito contained no identity ID",{logger:t})}const Mk=t=>Ik({...t}),Kd={},gg="ap-southeast-1",Fk="ap-southeast-1:d2ff3dad-683a-4374-b889-0180981b6cbf",Eh="dinamap-les",Dk="public/",Ra=`${Dk}geojson/`,um=new dk({region:gg,credentials:Mk({clientConfig:{region:gg},identityPoolId:Fk}),requestChecksumCalculation:"WHEN_REQUIRED"});async function Ok(t,e){const n=new Blob([JSON.stringify(e,null,2)],{type:"application/geo+json"}),i=t;return await um.send(new yk({Bucket:Eh,Key:i.startsWith(Ra)?i:`${Ra}${i}`,Body:await n.arrayBuffer(),ContentType:"application/geo+json",CacheControl:"no-cache"})),`https://${Eh}.s3.${gg}.amazonaws.com/${encodeURIComponent(i.startsWith(Ra)?i:Ra+i)}`}async function Lk(){return((await um.send(new _k({Bucket:Eh,Prefix:Ra}))).Contents??[]).map(e=>e!=null&&e.Key).filter(e=>e.endsWith(".geojson"))}async function kk(t){const n=await(await um.send(new mk({Bucket:Eh,Key:t}))).Body.transformToString();return JSON.parse(n)}const It={ADD:"add",REMOVE:"remove"},Lo={PROPERTYCHANGE:"propertychange"},xe={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class Ul{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function Nk(t,e,n){let i,s;n=n||ts;let r=0,o=t.length,a=!1;for(;r<o;)i=r+(o-r>>1),s=+n(t[i],e),s<0?r=i+1:(o=i,a=!s);return a?r:~r}function ts(t,e){return t>e?1:t<e?-1:0}function ab(t,e){return t<e?1:t>e?-1:0}function dm(t,e,n){if(t[0]<=e)return 0;const i=t.length;if(e<=t[i-1])return i-1;if(typeof n=="function"){for(let s=1;s<i;++s){const r=t[s];if(r===e)return s;if(r<e)return n(e,t[s-1],r)>0?s-1:s}return i-1}if(n>0){for(let s=1;s<i;++s)if(t[s]<e)return s-1;return i-1}if(n<0){for(let s=1;s<i;++s)if(t[s]<=e)return s;return i-1}for(let s=1;s<i;++s){if(t[s]==e)return s;if(t[s]<e)return t[s-1]-e<e-t[s]?s-1:s}return i-1}function Bk(t,e,n){for(;e<n;){const i=t[e];t[e]=t[n],t[n]=i,++e,--n}}function ai(t,e){const n=Array.isArray(e)?e:[e],i=n.length;for(let s=0;s<i;s++)t[t.length]=n[s]}function cs(t,e){const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}function Uk(t,e,n){const i=e||ts;return t.every(function(s,r){if(r===0)return!0;const o=i(t[r-1],s);return!(o>0||o===0)})}function zs(){return!0}function Zo(){return!1}function dl(){}function lb(t){let e,n,i;return function(){const s=Array.prototype.slice.call(arguments);return(!n||this!==i||!cs(s,n))&&(i=this,n=s,e=t.apply(this,arguments)),e}}function cb(t){function e(){let n;try{n=t()}catch(i){return Promise.reject(i)}return n instanceof Promise?n:Promise.resolve(n)}return e()}function Fr(t){for(const e in t)delete t[e]}function Ir(t){let e;for(e in t)return!1;return!e}class hi{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class Gl extends Ul{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,n){if(!e||!n)return;const i=this.listeners_||(this.listeners_={}),s=i[e]||(i[e]=[]);s.includes(n)||s.push(n)}dispatchEvent(e){const n=typeof e=="string",i=n?e:e.type,s=this.listeners_&&this.listeners_[i];if(!s)return;const r=n?new hi(e):e;r.target||(r.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,a[i]=0),++o[i];let l;for(let c=0,h=s.length;c<h;++c)if("handleEvent"in s[c]?l=s[c].handleEvent(r):l=s[c].call(this,r),l===!1||r.propagationStopped){l=!1;break}if(--o[i]===0){let c=a[i];for(delete a[i];c--;)this.removeEventListener(i,dl);delete o[i]}return l}disposeInternal(){this.listeners_&&Fr(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,n){if(!this.listeners_)return;const i=this.listeners_[e];if(!i)return;const s=i.indexOf(n);s!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(i[s]=dl,++this.pendingRemovals_[e]):(i.splice(s,1),i.length===0&&delete this.listeners_[e]))}}function He(t,e,n,i,s){if(s){const o=n;n=function(a){return t.removeEventListener(e,n),o.call(i??this,a)}}else i&&i!==t&&(n=n.bind(i));const r={target:t,type:e,listener:n};return t.addEventListener(e,n),r}function xh(t,e,n,i){return He(t,e,n,i,!0)}function at(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),Fr(t))}class $l extends Gl{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(xe.CHANGE)}getRevision(){return this.revision_}onInternal(e,n){if(Array.isArray(e)){const i=e.length,s=new Array(i);for(let r=0;r<i;++r)s[r]=He(this,e[r],n);return s}return He(this,e,n)}onceInternal(e,n){let i;if(Array.isArray(e)){const s=e.length;i=new Array(s);for(let r=0;r<s;++r)i[r]=xh(this,e[r],n)}else i=xh(this,e,n);return n.ol_key=i,i}unInternal(e,n){const i=n.ol_key;if(i)Gk(i);else if(Array.isArray(e))for(let s=0,r=e.length;s<r;++s)this.removeEventListener(e[s],n);else this.removeEventListener(e,n)}}$l.prototype.on;$l.prototype.once;$l.prototype.un;function Gk(t){if(Array.isArray(t))for(let e=0,n=t.length;e<n;++e)at(t[e]);else at(t)}function Se(){throw new Error("Unimplemented abstract method.")}let $k=0;function me(t){return t.ol_uid||(t.ol_uid=String(++$k))}class TE extends hi{constructor(e,n,i){super(e),this.key=n,this.oldValue=i}}class ji extends $l{constructor(e){super(),this.on,this.once,this.un,me(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let n;return this.values_&&this.values_.hasOwnProperty(e)&&(n=this.values_[e]),n}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,n){let i;i=`change:${e}`,this.hasListener(i)&&this.dispatchEvent(new TE(i,e,n)),i=Lo.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new TE(i,e,n))}addChangeListener(e,n){this.addEventListener(`change:${e}`,n)}removeChangeListener(e,n){this.removeEventListener(`change:${e}`,n)}set(e,n,i){const s=this.values_||(this.values_={});if(i)s[e]=n;else{const r=s[e];s[e]=n,r!==n&&this.notify(e,r)}}setProperties(e,n){for(const i in e)this.set(i,e[i],n)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,n){if(this.values_&&e in this.values_){const i=this.values_[e];delete this.values_[e],Ir(this.values_)&&(this.values_=null),n||this.notify(e,i)}}}const RE={LENGTH:"length"};class lc extends hi{constructor(e,n,i){super(e),this.element=n,this.index=i}}class Vn extends ji{constructor(e,n){if(super(),this.on,this.once,this.un,n=n||{},this.unique_=!!n.unique,this.array_=e||[],this.unique_)for(let i=0,s=this.array_.length;i<s;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let n=0,i=e.length;n<i;++n)this.push(e[n]);return this}forEach(e){const n=this.array_;for(let i=0,s=n.length;i<s;++i)e(n[i],i,n)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(RE.LENGTH)}insertAt(e,n){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(n),this.array_.splice(e,0,n),this.updateLength_(),this.dispatchEvent(new lc(It.ADD,n,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){this.unique_&&this.assertUnique_(e);const n=this.getLength();return this.insertAt(n,e),this.getLength()}remove(e){const n=this.array_;for(let i=0,s=n.length;i<s;++i)if(n[i]===e)return this.removeAt(i)}removeAt(e){if(e<0||e>=this.getLength())return;const n=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new lc(It.REMOVE,n,e)),n}setAt(e,n){const i=this.getLength();if(e>=i){this.insertAt(e,n);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(n,e);const s=this.array_[e];this.array_[e]=n,this.dispatchEvent(new lc(It.REMOVE,s,e)),this.dispatchEvent(new lc(It.ADD,n,e))}updateLength_(){this.set(RE.LENGTH,this.array_.length)}assertUnique_(e,n){for(let i=0,s=this.array_.length;i<s;++i)if(this.array_[i]===e&&i!==n)throw new Error("Duplicate item added to a unique collection")}}class to extends hi{constructor(e,n,i){super(e),this.map=n,this.frameState=i!==void 0?i:null}}class qi extends to{constructor(e,n,i,s,r,o){super(e,n,r),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=s!==void 0?s:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Ge={SINGLECLICK:"singleclick",CLICK:xe.CLICK,DBLCLICK:xe.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Pr=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",jk=Pr.includes("safari")&&!Pr.includes("chrom"),zk=jk&&(Pr.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(Pr)),Hk=Pr.includes("webkit")&&!Pr.includes("edge"),hb=Pr.includes("macintosh"),Xk=typeof devicePixelRatio<"u"?devicePixelRatio:1,hu=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,ub=typeof Image<"u"&&Image.prototype.decode,db=function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return t}(),pg={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class Vk extends Gl{constructor(e,n){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=n===void 0?1:n,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=He(i,pg.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=He(i,pg.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(xe.TOUCHMOVE,this.boundHandleTouchMove_,db?{passive:!1}:!1)}emulateClick_(e){let n=new qi(Ge.CLICK,this.map_,e);this.dispatchEvent(n),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,n=new qi(Ge.DBLCLICK,this.map_,e),this.dispatchEvent(n)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new qi(Ge.SINGLECLICK,this.map_,e);this.dispatchEvent(i)},250)}updateActivePointers_(e){const n=e,i=n.pointerId;if(n.type==Ge.POINTERUP||n.type==Ge.POINTERCANCEL){delete this.trackedTouches_[i];for(const s in this.trackedTouches_)if(this.trackedTouches_[s].target!==n.target){delete this.trackedTouches_[s];break}}else(n.type==Ge.POINTERDOWN||n.type==Ge.POINTERMOVE)&&(this.trackedTouches_[i]=n);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const n=new qi(Ge.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(n),this.emulateClicks_&&!n.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(at),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const n=new qi(Ge.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(n),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(He(i,Ge.POINTERMOVE,this.handlePointerMove_,this),He(i,Ge.POINTERUP,this.handlePointerUp_,this),He(this.element_,Ge.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(He(this.element_.getRootNode(),Ge.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const n=new qi(Ge.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(n)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const n=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new qi(Ge.POINTERMOVE,this.map_,e,n))}handleTouchMove_(e){const n=this.originalPointerMoveEvent_;(!n||n.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(at(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(xe.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(at(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(at),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Ss={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},nn={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},se={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function Je(t,e){if(!t)throw new Error(e)}const wh=1/0;class Wk{constructor(e,n){this.priorityFunction_=e,this.keyFunction_=n,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,Fr(this.queuedElements_)}dequeue(){const e=this.elements_,n=this.priorities_,i=e[0];e.length==1?(e.length=0,n.length=0):(e[0]=e.pop(),n[0]=n.pop(),this.siftUp_(0));const s=this.keyFunction_(i);return delete this.queuedElements_[s],i}enqueue(e){Je(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const n=this.priorityFunction_(e);return n!=wh?(this.elements_.push(e),this.priorities_.push(n),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const n=this.elements_,i=this.priorities_,s=n.length,r=n[e],o=i[e],a=e;for(;e<s>>1;){const l=this.getLeftChildIndex_(e),c=this.getRightChildIndex_(e),h=c<s&&i[c]<i[l]?c:l;n[e]=n[h],i[e]=i[h],e=h}n[e]=r,i[e]=o,this.siftDown_(a,e)}siftDown_(e,n){const i=this.elements_,s=this.priorities_,r=i[n],o=s[n];for(;n>e;){const a=this.getParentIndex_(n);if(s[a]>o)i[n]=i[a],s[n]=s[a],n=a;else break}i[n]=r,s[n]=o}reprioritize(){const e=this.priorityFunction_,n=this.elements_,i=this.priorities_;let s=0;const r=n.length;let o,a,l;for(a=0;a<r;++a)o=n[a],l=e(o),l==wh?delete this.queuedElements_[this.keyFunction_(o)]:(i[s]=l,n[s++]=o);n.length=s,i.length=s,this.heapify_()}}class Kk extends Wk{constructor(e,n){super(i=>e.apply(null,i),i=>i[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=n,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const n=super.enqueue(e);return n&&e[0].addEventListener(xe.CHANGE,this.boundHandleTileChange_),n}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const n=e.target,i=n.getState();if(i===se.LOADED||i===se.ERROR||i===se.EMPTY){i!==se.ERROR&&n.removeEventListener(xe.CHANGE,this.boundHandleTileChange_);const s=n.getKey();s in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[s],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,n){let i=0;for(;this.tilesLoading_<e&&i<n&&this.getCount()>0;){const s=this.dequeue()[0],r=s.getKey();s.getState()===se.IDLE&&!(r in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++i,s.load())}}}function Yk(t,e,n,i,s){if(!t||!(n in t.wantedTiles)||!t.wantedTiles[n][e.getKey()])return wh;const r=t.viewState.center,o=i[0]-r[0],a=i[1]-r[1];return 65536*Math.log(s)+Math.sqrt(o*o+a*a)/s}const sn={ANIMATING:0,INTERACTING:1},di={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function lt(t,e,n){return Math.min(Math.max(t,e),n)}function qk(t,e,n,i,s,r){const o=s-n,a=r-i;if(o!==0||a!==0){const l=((t-n)*o+(e-i)*a)/(o*o+a*a);l>1?(n=s,i=r):l>0&&(n+=o*l,i+=a*l)}return ns(t,e,n,i)}function ns(t,e,n,i){const s=n-t,r=i-e;return s*s+r*r}function Zk(t){const e=t.length;for(let i=0;i<e;i++){let s=i,r=Math.abs(t[i][i]);for(let a=i+1;a<e;a++){const l=Math.abs(t[a][i]);l>r&&(r=l,s=a)}if(r===0)return null;const o=t[s];t[s]=t[i],t[i]=o;for(let a=i+1;a<e;a++){const l=-t[a][i]/t[i][i];for(let c=i;c<e+1;c++)i==c?t[a][c]=0:t[a][c]+=l*t[i][c]}}const n=new Array(e);for(let i=e-1;i>=0;i--){n[i]=t[i][e]/t[i][i];for(let s=i-1;s>=0;s--)t[s][e]-=t[s][i]*n[i]}return n}function vE(t){return t*180/Math.PI}function Os(t){return t*Math.PI/180}function br(t,e){const n=t%e;return n*e<0?n+e:n}function $n(t,e,n){return t+n*(e-t)}function jl(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}function cc(t,e){return Math.floor(jl(t,e))}function hc(t,e){return Math.ceil(jl(t,e))}function mg(t,e,n){if(t>=e&&t<n)return t;const i=n-e;return((t-e)%i+i)%i+e}function AE(t,e,n){return function(i,s,r,o,a){if(!i)return;if(!s&&!e)return i;const l=e?0:r[0]*s,c=e?0:r[1]*s,h=a?a[0]:0,u=a?a[1]:0;let d=t[0]+l/2+h,f=t[2]-l/2+h,g=t[1]+c/2+u,m=t[3]-c/2+u;d>f&&(d=(f+d)/2,f=d),g>m&&(g=(m+g)/2,m=g);let p=lt(i[0],d,f),y=lt(i[1],g,m);if(o&&n&&s){const _=30*s;p+=-_*Math.log(1+Math.max(0,d-i[0])/_)+_*Math.log(1+Math.max(0,i[0]-f)/_),y+=-_*Math.log(1+Math.max(0,g-i[1])/_)+_*Math.log(1+Math.max(0,i[1]-m)/_)}return[p,y]}}function Jk(t){return t}const Bt={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function mn(t){const e=Yn();for(let n=0,i=t.length;n<i;++n)Za(e,t[n]);return e}function Qk(t,e,n){const i=Math.min.apply(null,t),s=Math.min.apply(null,e),r=Math.max.apply(null,t),o=Math.max.apply(null,e);return Bi(i,s,r,o,n)}function uu(t,e,n){return n?(n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function fb(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function Dr(t,e,n){let i,s;return e<t[0]?i=t[0]-e:t[2]<e?i=e-t[2]:i=0,n<t[1]?s=t[1]-n:t[3]<n?s=n-t[3]:s=0,i*i+s*s}function Hs(t,e){return fm(t,e[0],e[1])}function va(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function fm(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function _g(t,e){const n=t[0],i=t[1],s=t[2],r=t[3],o=e[0],a=e[1];let l=Bt.UNKNOWN;return o<n?l=l|Bt.LEFT:o>s&&(l=l|Bt.RIGHT),a<i?l=l|Bt.BELOW:a>r&&(l=l|Bt.ABOVE),l===Bt.UNKNOWN&&(l=Bt.INTERSECTING),l}function Yn(){return[1/0,1/0,-1/0,-1/0]}function Bi(t,e,n,i,s){return s?(s[0]=t,s[1]=e,s[2]=n,s[3]=i,s):[t,e,n,i]}function Jo(t){return Bi(1/0,1/0,-1/0,-1/0,t)}function qa(t,e){const n=t[0],i=t[1];return Bi(n,i,n,i,e)}function gm(t,e,n,i,s){const r=Jo(s);return gb(r,t,e,n,i)}function fl(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function pm(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function Za(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function gb(t,e,n,i,s){for(;n<i;n+=s)eN(t,e[n],e[n+1]);return t}function eN(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function mm(t,e){let n;return n=e(du(t)),n||(n=e(fu(t)),n)||(n=e(gu(t)),n)||(n=e(as(t)),n)?n:!1}function gl(t){let e=0;return Qo(t)||(e=Ve(t)*jt(t)),e}function du(t){return[t[0],t[1]]}function fu(t){return[t[2],t[1]]}function Ui(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function tN(t,e){let n;if(e==="bottom-left")n=du(t);else if(e==="bottom-right")n=fu(t);else if(e==="top-left")n=as(t);else if(e==="top-right")n=gu(t);else throw new Error("Invalid corner");return n}function yg(t,e,n,i,s){const[r,o,a,l,c,h,u,d]=_m(t,e,n,i);return Bi(Math.min(r,a,c,u),Math.min(o,l,h,d),Math.max(r,a,c,u),Math.max(o,l,h,d),s)}function _m(t,e,n,i){const s=e*i[0]/2,r=e*i[1]/2,o=Math.cos(n),a=Math.sin(n),l=s*o,c=s*a,h=r*o,u=r*a,d=t[0],f=t[1];return[d-l+u,f-c-h,d-l-u,f-c+h,d+l-u,f+c+h,d+l+u,f+c-h,d-l+u,f-c-h]}function jt(t){return t[3]-t[1]}function Cn(t,e,n){const i=n||Yn();return wn(t,e)?(t[0]>e[0]?i[0]=t[0]:i[0]=e[0],t[1]>e[1]?i[1]=t[1]:i[1]=e[1],t[2]<e[2]?i[2]=t[2]:i[2]=e[2],t[3]<e[3]?i[3]=t[3]:i[3]=e[3]):Jo(i),i}function as(t){return[t[0],t[3]]}function gu(t){return[t[2],t[3]]}function Ve(t){return t[2]-t[0]}function wn(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function Qo(t){return t[2]<t[0]||t[3]<t[1]}function nN(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}function iN(t,e,n){let i=!1;const s=_g(t,e),r=_g(t,n);if(s===Bt.INTERSECTING||r===Bt.INTERSECTING)i=!0;else{const o=t[0],a=t[1],l=t[2],c=t[3],h=e[0],u=e[1],d=n[0],f=n[1],g=(f-u)/(d-h);let m,p;r&Bt.ABOVE&&!(s&Bt.ABOVE)&&(m=d-(f-c)/g,i=m>=o&&m<=l),!i&&r&Bt.RIGHT&&!(s&Bt.RIGHT)&&(p=f-(d-l)*g,i=p>=a&&p<=c),!i&&r&Bt.BELOW&&!(s&Bt.BELOW)&&(m=d-(f-a)/g,i=m>=o&&m<=l),!i&&r&Bt.LEFT&&!(s&Bt.LEFT)&&(p=f-(d-o)*g,i=p>=a&&p<=c)}return i}function sN(t,e,n,i){if(Qo(t))return Jo(n);let s=[];s=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]],e(s,s,2);const r=[],o=[];for(let a=0,l=s.length;a<l;a+=2)r.push(s[a]),o.push(s[a+1]);return Qk(r,o,n)}function pb(t,e){const n=e.getExtent(),i=Ui(t);if(e.canWrapX()&&(i[0]<n[0]||i[0]>=n[2])){const s=Ve(n),o=Math.floor((i[0]-n[0])/s)*s;t[0]-=o,t[2]-=o}return t}function ym(t,e,n){if(e.canWrapX()){const i=e.getExtent();if(!isFinite(t[0])||!isFinite(t[2]))return[[i[0],t[1],i[2],t[3]]];pb(t,e);const s=Ve(i);if(Ve(t)>s&&!n)return[[i[0],t[1],i[2],t[3]]];if(t[0]<i[0])return[[t[0]+s,t[1],i[2],t[3]],[i[0],t[1],t[2],t[3]]];if(t[2]>i[2])return[[t[0],t[1],i[2],t[3]],[i[0],t[1],t[2]-s,t[3]]]}return[t]}function rN(t,e){return t[0]+=+e[0],t[1]+=+e[1],t}function mb(t,e){const n=t[0],i=t[1],s=e[0],r=e[1],o=s[0],a=s[1],l=r[0],c=r[1],h=l-o,u=c-a,d=h===0&&u===0?0:(h*(n-o)+u*(i-a))/(h*h+u*u||0);let f,g;return d<=0?(f=o,g=a):d>=1?(f=l,g=c):(f=o+d*h,g=a+d*u),[f,g]}function _n(t,e){let n=!0;for(let i=t.length-1;i>=0;--i)if(t[i]!=e[i]){n=!1;break}return n}function Em(t,e){const n=Math.cos(e),i=Math.sin(e),s=t[0]*n-t[1]*i,r=t[1]*n+t[0]*i;return t[0]=s,t[1]=r,t}function oN(t,e){return t[0]*=e,t[1]*=e,t}function ko(t,e){const n=t[0]-e[0],i=t[1]-e[1];return n*n+i*i}function Sh(t,e){return Math.sqrt(ko(t,e))}function aN(t,e){return ko(t,mb(t,e))}function _b(t,e){if(e.canWrapX()){const n=Ve(e.getExtent()),i=lN(t,e,n);i&&(t[0]-=i*n)}return t}function lN(t,e,n){const i=e.getExtent();let s=0;return e.canWrapX()&&(t[0]<i[0]||t[0]>i[2])&&(n=n||Ve(i),s=Math.floor((t[0]-i[0])/n)),s}function yb(t){return Math.pow(t,3)}function ea(t){return 1-yb(1-t)}function cN(t){return 3*t*t-2*t*t*t}function hN(t){return t}const uN=63710088e-1;function IE(t,e,n){n=n||uN;const i=Os(t[1]),s=Os(e[1]),r=(s-i)/2,o=Os(e[0]-t[0])/2,a=Math.sin(r)*Math.sin(r)+Math.sin(o)*Math.sin(o)*Math.cos(i)*Math.cos(s);return 2*n*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function Eb(...t){console.warn(...t)}function PE(...t){console.error(...t)}const dN={9001:"m",9002:"ft",9003:"us-ft",9101:"radians",9102:"degrees"};function ME(t){return dN[t]}const No={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class pl{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||No[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const zl=6378137,lo=Math.PI*zl,fN=[-lo,-lo,lo,lo],gN=[-180,-85,180,85],uc=zl*Math.log(Math.tan(Math.PI/2));class jr extends pl{constructor(e){super({code:e,units:"m",extent:fN,global:!0,worldExtent:gN,getPointResolution:function(n,i){return n/Math.cosh(i[1]/zl)}})}}const FE=[new jr("EPSG:3857"),new jr("EPSG:102100"),new jr("EPSG:102113"),new jr("EPSG:900913"),new jr("http://www.opengis.net/def/crs/EPSG/0/3857"),new jr("http://www.opengis.net/gml/srs/epsg.xml#3857")];function pN(t,e,n,i){const s=t.length;n=n>1?n:2,i=i??n,e===void 0&&(n>2?e=t.slice():e=new Array(s));for(let r=0;r<s;r+=i){e[r]=lo*t[r]/180;let o=zl*Math.log(Math.tan(Math.PI*(+t[r+1]+90)/360));o>uc?o=uc:o<-uc&&(o=-uc),e[r+1]=o}return e}function mN(t,e,n,i){const s=t.length;n=n>1?n:2,i=i??n,e===void 0&&(n>2?e=t.slice():e=new Array(s));for(let r=0;r<s;r+=i)e[r]=180*t[r]/lo,e[r+1]=360*Math.atan(Math.exp(t[r+1]/zl))/Math.PI-90;return e}const _N=6378137,DE=[-180,-90,180,90],yN=Math.PI*_N/180;class ir extends pl{constructor(e,n){super({code:e,units:"degrees",extent:DE,axisOrientation:n,global:!0,metersPerUnit:yN,worldExtent:DE})}}const OE=[new ir("CRS:84"),new ir("EPSG:4326","neu"),new ir("urn:ogc:def:crs:OGC:1.3:CRS84"),new ir("urn:ogc:def:crs:OGC:2:84"),new ir("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new ir("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new ir("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Eg={};function EN(t){return Eg[t]||Eg[t.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function xN(t,e){Eg[t]=e}let So={};function ml(t,e,n){const i=t.getCode(),s=e.getCode();i in So||(So[i]={}),So[i][s]=n}function Yd(t,e){return t in So&&e in So[t]?So[t][e]:null}const Ch=.9996,li=.00669438,pu=li*li,mu=pu*li,mr=li/(1-li),LE=Math.sqrt(1-li),Bo=(1-LE)/(1+LE),xb=Bo*Bo,xm=xb*Bo,wm=xm*Bo,wb=wm*Bo,Sb=1-li/4-3*pu/64-5*mu/256,wN=3*li/8+3*pu/32+45*mu/1024,SN=15*pu/256+45*mu/1024,CN=35*mu/3072,bN=3/2*Bo-27/32*xm+269/512*wb,TN=21/16*xb-55/32*wm,RN=151/96*xm-417/128*wb,vN=1097/512*wm,bh=6378137;function AN(t,e,n){const i=t-5e5,o=(n.north?e:e-1e7)/Ch/(bh*Sb),a=o+bN*Math.sin(2*o)+TN*Math.sin(4*o)+RN*Math.sin(6*o)+vN*Math.sin(8*o),l=Math.sin(a),c=l*l,h=Math.cos(a),u=l/h,d=u*u,f=d*d,g=1-li*c,m=Math.sqrt(1-li*c),p=bh/m,y=(1-li)/g,_=mr*h**2,x=_*_,E=i/(p*Ch),w=E*E,b=w*E,v=b*E,A=v*E,P=A*E,M=a-u/y*(w/2-v/24*(5+3*d+10*_-4*x-9*mr))+P/720*(61+90*d+298*_+45*f-252*mr-3*x);let Y=(E-b/6*(1+2*d+_)+A/120*(5-2*_+28*d-3*x+8*mr+24*f))/h;return Y=mg(Y+Os(Cb(n.number)),-Math.PI,Math.PI),[vE(Y),vE(M)]}const kE=-80,NE=84,IN=-180,PN=180;function MN(t,e,n){t=mg(t,IN,PN),e<kE?e=kE:e>NE&&(e=NE);const i=Os(e),s=Math.sin(i),r=Math.cos(i),o=s/r,a=o*o,l=a*a,c=Os(t),h=Cb(n.number),u=Os(h),d=bh/Math.sqrt(1-li*s**2),f=mr*r**2,g=r*mg(c-u,-Math.PI,Math.PI),m=g*g,p=m*g,y=p*g,_=y*g,x=_*g,E=bh*(Sb*i-wN*Math.sin(2*i)+SN*Math.sin(4*i)-CN*Math.sin(6*i)),w=Ch*d*(g+p/6*(1-a+f)+_/120*(5-18*a+l+72*f-58*mr))+5e5;let b=Ch*(E+d*o*(m/2+y/24*(5-a+9*f+4*f**2)+x/720*(61-58*a+l+600*f-330*mr)));return n.north||(b+=1e7),[w,b]}function Cb(t){return(t-1)*6-180+3}const FN=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function bb(t){let e=0;for(const s of FN){const r=t.match(s);if(r){e=parseInt(r[1]);break}}if(!e)return null;let n=0,i=!1;return e>32700&&e<32761?n=e-32700:e>32600&&e<32661&&(i=!0,n=e-32600),n?{number:n,north:i}:null}function BE(t,e){return function(n,i,s,r){const o=n.length;s=s>1?s:2,r=r??s,i||(s>2?i=n.slice():i=new Array(o));for(let a=0;a<o;a+=r){const l=n[a],c=n[a+1],h=t(l,c,e);i[a]=h[0],i[a+1]=h[1]}return i}}function DN(t){return bb(t)?new pl({code:t,units:"m"}):null}function ON(t){const e=bb(t.getCode());return e?{forward:BE(MN,e),inverse:BE(AN,e)}:null}const LN=[ON],kN=[DN];let xg=!0;function Tb(t){xg=!1}function Sm(t,e){if(e!==void 0){for(let n=0,i=t.length;n<i;++n)e[n]=t[n];e=e}else e=t.slice();return e}function wg(t){xN(t.getCode(),t),ml(t,t,Sm)}function NN(t){t.forEach(wg)}function ft(t){if(typeof t!="string")return t;const e=EN(t);if(e)return e;for(const n of kN){const i=n(t);if(i)return i}return null}function Th(t,e,n,i){t=ft(t);let s;const r=t.getPointResolutionFunc();if(r){if(s=r(e,n),i&&i!==t.getUnits()){const o=t.getMetersPerUnit();o&&(s=s*o/No[i])}}else{const o=t.getUnits();if(o=="degrees"&&!i||i=="degrees")s=e;else{const a=bm(t,ft("EPSG:4326"));if(!a&&o!=="degrees")s=e*t.getMetersPerUnit();else{let c=[n[0]-e/2,n[1],n[0]+e/2,n[1],n[0],n[1]-e/2,n[0],n[1]+e/2];c=a(c,c,2);const h=IE(c.slice(0,2),c.slice(2,4)),u=IE(c.slice(4,6),c.slice(6,8));s=(h+u)/2}const l=i?No[i]:t.getMetersPerUnit();l!==void 0&&(s/=l)}}return s}function UE(t){NN(t),t.forEach(function(e){t.forEach(function(n){e!==n&&ml(e,n,Sm)})})}function BN(t,e,n,i){t.forEach(function(s){e.forEach(function(r){ml(s,r,n),ml(r,s,i)})})}function Cm(t,e){return t?typeof t=="string"?ft(t):t:ft(e)}function Rb(t){return function(e,n,i,s){const r=e.length;i=i!==void 0?i:2,s=s??i,n=n!==void 0?n:new Array(r);for(let o=0;o<r;o+=s){const a=t(e.slice(o,o+i)),l=a.length;for(let c=0,h=s;c<h;++c)n[o+c]=c>=l?e[o+c]:a[c]}return n}}function GE(t,e){return Tb(),_u(t,"EPSG:4326","EPSG:3857")}function $E(t,e){const n=_u(t,"EPSG:3857","EPSG:4326"),i=n[0];return(i<-180||i>180)&&(n[0]=br(i+180,360)-180),n}function Tr(t,e){if(t===e)return!0;const n=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||bm(t,e)===Sm)&&n}function bm(t,e){const n=t.getCode(),i=e.getCode();let s=Yd(n,i);if(s)return s;let r=null,o=null;for(const l of LN)r||(r=l(t)),o||(o=l(e));if(!r&&!o)return null;const a="EPSG:4326";if(o)if(r)s=qd(r.inverse,o.forward);else{const l=Yd(n,a);l&&(s=qd(l,o.forward))}else{const l=Yd(a,i);l&&(s=qd(r.inverse,l))}return s&&(wg(t),wg(e),ml(t,e,s)),s}function qd(t,e){return function(n,i,s,r){return i=t(n,i,s,r),e(i,i,s,r)}}function _l(t,e){const n=ft(t),i=ft(e);return bm(n,i)}function _u(t,e,n){const i=_l(e,n);if(!i){const s=ft(e).getCode(),r=ft(n).getCode();throw new Error(`No transform available between ${s} and ${r}`)}return i(t,void 0,t.length)}function Xs(t,e){return t}function mt(t,e){return xg&&!_n(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(xg=!1,Eb("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t}function yu(t,e){return t}function fi(t,e){return t}function UN(){UE(FE),UE(OE),BN(OE,FE,pN,mN)}UN();const Tm=new Array(6);function hn(){return[1,0,0,1,0,0]}function GN(t){return Eu(t,1,0,0,1,0,0)}function yl(t,e){const n=t[0],i=t[1],s=t[2],r=t[3],o=t[4],a=t[5],l=e[0],c=e[1],h=e[2],u=e[3],d=e[4],f=e[5];return t[0]=n*l+s*c,t[1]=i*l+r*c,t[2]=n*h+s*u,t[3]=i*h+r*u,t[4]=n*d+s*f+o,t[5]=i*d+r*f+a,t}function Eu(t,e,n,i,s,r,o){return t[0]=e,t[1]=n,t[2]=i,t[3]=s,t[4]=r,t[5]=o,t}function $N(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function vt(t,e){const n=e[0],i=e[1];return e[0]=t[0]*n+t[2]*i+t[4],e[1]=t[1]*n+t[3]*i+t[5],e}function jN(t,e){const n=Math.cos(e),i=Math.sin(e);return yl(t,Eu(Tm,n,i,-i,n,0,0))}function jE(t,e,n){return yl(t,Eu(Tm,e,0,0,n,0,0))}function zN(t,e,n){return yl(t,Eu(Tm,1,0,0,1,e,n))}function mi(t,e,n,i,s,r,o,a){const l=Math.sin(r),c=Math.cos(r);return t[0]=i*c,t[1]=s*l,t[2]=-i*l,t[3]=s*c,t[4]=o*i*c-a*i*l+e,t[5]=o*s*l+a*s*c+n,t}function Rm(t,e){const n=HN(e);Je(n!==0,"Transformation matrix cannot be inverted");const i=e[0],s=e[1],r=e[2],o=e[3],a=e[4],l=e[5];return t[0]=o/n,t[1]=-s/n,t[2]=-r/n,t[3]=i/n,t[4]=(r*l-o*a)/n,t[5]=-(i*l-s*a)/n,t}function HN(t){return t[0]*t[3]-t[1]*t[2]}const XN=[1e5,1e5,1e5,1e5,2,2];function VN(t){return"matrix("+t.join(", ")+")"}function zE(t){return t.substring(7,t.length-1).split(",").map(parseFloat)}function WN(t,e){const n=zE(t),i=zE(e);for(let s=0;s<6;++s)if(Math.round((n[s]-i[s])*XN[s])!==0)return!1;return!0}function Ls(t,e,n,i,s,r,o){r=r||[],o=o||2;let a=0;for(let l=e;l<n;l+=i){const c=t[l],h=t[l+1];r[a++]=s[0]*c+s[2]*h+s[4],r[a++]=s[1]*c+s[3]*h+s[5];for(let u=2;u<o;u++)r[a++]=t[l+u]}return r&&r.length!=a&&(r.length=a),r}function vm(t,e,n,i,s,r,o){o=o||[];const a=Math.cos(s),l=Math.sin(s),c=r[0],h=r[1];let u=0;for(let d=e;d<n;d+=i){const f=t[d]-c,g=t[d+1]-h;o[u++]=c+f*a-g*l,o[u++]=h+f*l+g*a;for(let m=d+2;m<d+i;++m)o[u++]=t[m]}return o&&o.length!=u&&(o.length=u),o}function KN(t,e,n,i,s,r,o,a){a=a||[];const l=o[0],c=o[1];let h=0;for(let u=e;u<n;u+=i){const d=t[u]-l,f=t[u+1]-c;a[h++]=l+s*d,a[h++]=c+r*f;for(let g=u+2;g<u+i;++g)a[h++]=t[g]}return a&&a.length!=h&&(a.length=h),a}function YN(t,e,n,i,s,r,o){o=o||[];let a=0;for(let l=e;l<n;l+=i){o[a++]=t[l]+s,o[a++]=t[l+1]+r;for(let c=l+2;c<l+i;++c)o[a++]=t[c]}return o&&o.length!=a&&(o.length=a),o}const HE=hn(),qN=[NaN,NaN];class vb extends ji{constructor(){super(),this.extent_=Yn(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=lb((e,n,i)=>{if(!i)return this.getSimplifiedGeometry(n);const s=this.clone();return s.applyTransform(i),s.getSimplifiedGeometry(n)})}simplifyTransformed(e,n){return this.simplifyTransformedInternal(this.getRevision(),e,n)}clone(){return Se()}closestPointXY(e,n,i,s){return Se()}containsXY(e,n){return this.closestPointXY(e,n,qN,Number.MIN_VALUE)===0}getClosestPoint(e,n){return n=n||[NaN,NaN],this.closestPointXY(e[0],e[1],n,1/0),n}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return Se()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const n=this.computeExtent(this.extent_);(isNaN(n[0])||isNaN(n[1]))&&Jo(n),this.extentRevision_=this.getRevision()}return nN(this.extent_,e)}rotate(e,n){Se()}scale(e,n,i){Se()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return Se()}getType(){return Se()}applyTransform(e){Se()}intersectsExtent(e){return Se()}translate(e,n){Se()}transform(e,n){const i=ft(e),s=i.getUnits()=="tile-pixels"?function(r,o,a){const l=i.getExtent(),c=i.getWorldExtent(),h=jt(c)/jt(l);mi(HE,c[0],c[3],h,-h,0,0,0);const u=Ls(r,0,r.length,a,HE,o),d=_l(i,n);return d?d(u,u,a):u}:_l(i,n);return this.applyTransform(s),this}}class qs extends vb{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return gm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return Se()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const n=this.getSimplifiedGeometryInternal(e);return n.getFlatCoordinates().length<this.flatCoordinates.length?n:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,n){this.stride=Rh(e),this.layout=e,this.flatCoordinates=n}setCoordinates(e,n){Se()}setLayout(e,n,i){let s;if(e)s=Rh(e);else{for(let r=0;r<i;++r){if(n.length===0){this.layout="XY",this.stride=2;return}n=n[0]}s=n.length,e=Or(s)}this.layout=e,this.stride=s}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,n){const i=this.getFlatCoordinates();if(i){const s=this.getStride();vm(i,0,i.length,s,e,n,i),this.changed()}}scale(e,n,i){n===void 0&&(n=e),i||(i=Ui(this.getExtent()));const s=this.getFlatCoordinates();if(s){const r=this.getStride();KN(s,0,s.length,r,e,n,i,s),this.changed()}}translate(e,n){const i=this.getFlatCoordinates();if(i){const s=this.getStride();YN(i,0,i.length,s,e,n,i),this.changed()}}}function Or(t){let e;return t==2?e="XY":t==3?e="XYZ":t==4&&(e="XYZM"),e}function Rh(t){let e;return t=="XY"?e=2:t=="XYZ"||t=="XYM"?e=3:t=="XYZM"&&(e=4),e}function ZN(t,e,n){const i=t.getFlatCoordinates();if(!i)return null;const s=t.getStride();return Ls(i,0,i.length,s,e,n)}function Ab(t,e,n,i){let s=0;const r=t[n-i],o=t[n-i+1];let a=0,l=0;for(;e<n;e+=i){const c=t[e]-r,h=t[e+1]-o;s+=l*c-a*h,a=c,l=h}return s/2}function Ib(t,e,n,i){let s=0;for(let r=0,o=n.length;r<o;++r){const a=n[r];s+=Ab(t,e,a,i),e=a}return s}function JN(t,e,n,i){let s=0;for(let r=0,o=n.length;r<o;++r){const a=n[r];s+=Ib(t,e,a,i),e=a[a.length-1]}return s}function XE(t,e,n,i,s,r,o){const a=t[e],l=t[e+1],c=t[n]-a,h=t[n+1]-l;let u;if(c===0&&h===0)u=e;else{const d=((s-a)*c+(r-l)*h)/(c*c+h*h);if(d>1)u=n;else if(d>0){for(let f=0;f<i;++f)o[f]=$n(t[e+f],t[n+f],d);o.length=i;return}else u=e}for(let d=0;d<i;++d)o[d]=t[u+d];o.length=i}function Am(t,e,n,i,s){let r=t[e],o=t[e+1];for(e+=i;e<n;e+=i){const a=t[e],l=t[e+1],c=ns(r,o,a,l);c>s&&(s=c),r=a,o=l}return s}function Im(t,e,n,i,s){for(let r=0,o=n.length;r<o;++r){const a=n[r];s=Am(t,e,a,i,s),e=a}return s}function QN(t,e,n,i,s){for(let r=0,o=n.length;r<o;++r){const a=n[r];s=Im(t,e,a,i,s),e=a[a.length-1]}return s}function Pm(t,e,n,i,s,r,o,a,l,c,h){if(e==n)return c;let u,d;if(s===0){if(d=ns(o,a,t[e],t[e+1]),d<c){for(u=0;u<i;++u)l[u]=t[e+u];return l.length=i,d}return c}h=h||[NaN,NaN];let f=e+i;for(;f<n;)if(XE(t,f-i,f,i,o,a,h),d=ns(o,a,h[0],h[1]),d<c){for(c=d,u=0;u<i;++u)l[u]=h[u];l.length=i,f+=i}else f+=i*Math.max((Math.sqrt(d)-Math.sqrt(c))/s|0,1);if(r&&(XE(t,n-i,e,i,o,a,h),d=ns(o,a,h[0],h[1]),d<c)){for(c=d,u=0;u<i;++u)l[u]=h[u];l.length=i}return c}function Mm(t,e,n,i,s,r,o,a,l,c,h){h=h||[NaN,NaN];for(let u=0,d=n.length;u<d;++u){const f=n[u];c=Pm(t,e,f,i,s,r,o,a,l,c,h),e=f}return c}function e3(t,e,n,i,s,r,o,a,l,c,h){h=h||[NaN,NaN];for(let u=0,d=n.length;u<d;++u){const f=n[u];c=Mm(t,e,f,i,s,r,o,a,l,c,h),e=f[f.length-1]}return c}function Pb(t,e,n,i){for(let s=0,r=n.length;s<r;++s)t[e++]=n[s];return e}function xu(t,e,n,i){for(let s=0,r=n.length;s<r;++s){const o=n[s];for(let a=0;a<i;++a)t[e++]=o[a]}return e}function Hl(t,e,n,i,s){s=s||[];let r=0;for(let o=0,a=n.length;o<a;++o){const l=xu(t,e,n[o],i);s[r++]=l,e=l}return s.length=r,s}function Mb(t,e,n,i,s){s=s||[];let r=0;for(let o=0,a=n.length;o<a;++o){const l=Hl(t,e,n[o],i,s[r]);l.length===0&&(l[0]=e),s[r++]=l,e=l[l.length-1]}return s.length=r,s}function vs(t,e,n,i,s){s=s!==void 0?s:[];let r=0;for(let o=e;o<n;o+=i)s[r++]=t.slice(o,o+i);return s.length=r,s}function El(t,e,n,i,s){s=s!==void 0?s:[];let r=0;for(let o=0,a=n.length;o<a;++o){const l=n[o];s[r++]=vs(t,e,l,i,s[r]),e=l}return s.length=r,s}function Sg(t,e,n,i,s){s=s!==void 0?s:[];let r=0;for(let o=0,a=n.length;o<a;++o){const l=n[o];s[r++]=l.length===1&&l[0]===e?[]:El(t,e,l,i,s[r]),e=l[l.length-1]}return s.length=r,s}function wu(t,e,n,i,s,r,o){const a=(n-e)/i;if(a<3){for(;e<n;e+=i)r[o++]=t[e],r[o++]=t[e+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const c=[e,n-i];let h=0;for(;c.length>0;){const u=c.pop(),d=c.pop();let f=0;const g=t[d],m=t[d+1],p=t[u],y=t[u+1];for(let _=d+i;_<u;_+=i){const x=t[_],E=t[_+1],w=qk(x,E,g,m,p,y);w>f&&(h=_,f=w)}f>s&&(l[(h-e)/i]=1,d+i<h&&c.push(d,h),h+i<u&&c.push(h,u))}for(let u=0;u<a;++u)l[u]&&(r[o++]=t[e+u*i],r[o++]=t[e+u*i+1]);return o}function Fb(t,e,n,i,s,r,o,a){for(let l=0,c=n.length;l<c;++l){const h=n[l];o=wu(t,e,h,i,s,r,o),a.push(o),e=h}return o}function lr(t,e){return e*Math.round(t/e)}function t3(t,e,n,i,s,r,o){if(e==n)return o;let a=lr(t[e],s),l=lr(t[e+1],s);e+=i,r[o++]=a,r[o++]=l;let c,h;do if(c=lr(t[e],s),h=lr(t[e+1],s),e+=i,e==n)return r[o++]=c,r[o++]=h,o;while(c==a&&h==l);for(;e<n;){const u=lr(t[e],s),d=lr(t[e+1],s);if(e+=i,u==c&&d==h)continue;const f=c-a,g=h-l,m=u-a,p=d-l;if(f*p==g*m&&(f<0&&m<f||f==m||f>0&&m>f)&&(g<0&&p<g||g==p||g>0&&p>g)){c=u,h=d;continue}r[o++]=c,r[o++]=h,a=c,l=h,c=u,h=d}return r[o++]=c,r[o++]=h,o}function Fm(t,e,n,i,s,r,o,a){for(let l=0,c=n.length;l<c;++l){const h=n[l];o=t3(t,e,h,i,s,r,o),a.push(o),e=h}return o}function n3(t,e,n,i,s,r,o,a){for(let l=0,c=n.length;l<c;++l){const h=n[l],u=[];o=Fm(t,e,h,i,s,r,o,u),a.push(u),e=h[h.length-1]}return o}class xl extends qs{constructor(e,n){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,n!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(n,e):this.setCoordinates(e,n)}clone(){return new xl(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,n,i,s){return s<Dr(this.getExtent(),e,n)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Am(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Pm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,n,i,s))}getArea(){return Ab(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return vs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const n=[];return n.length=wu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n,0),new xl(n,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,n){this.setLayout(n,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=xu(this.flatCoordinates,0,e,this.stride),this.changed()}}class ci extends qs{constructor(e,n){super(),this.setCoordinates(e,n)}clone(){const e=new ci(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,n,i,s){const r=this.flatCoordinates,o=ns(e,n,r[0],r[1]);if(o<s){const a=this.stride;for(let l=0;l<a;++l)i[l]=r[l];return i.length=a,o}return s}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return qa(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return fm(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,n){this.setLayout(n,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Pb(this.flatCoordinates,0,e,this.stride),this.changed()}}function i3(t,e,n,i,s){return!mm(s,function(o){return!_r(t,e,n,i,o[0],o[1])})}function _r(t,e,n,i,s,r){let o=0,a=t[n-i],l=t[n-i+1];for(;e<n;e+=i){const c=t[e],h=t[e+1];l<=r?h>r&&(c-a)*(r-l)-(s-a)*(h-l)>0&&o++:h<=r&&(c-a)*(r-l)-(s-a)*(h-l)<0&&o--,a=c,l=h}return o!==0}function Dm(t,e,n,i,s,r){if(n.length===0||!_r(t,e,n[0],i,s,r))return!1;for(let o=1,a=n.length;o<a;++o)if(_r(t,n[o-1],n[o],i,s,r))return!1;return!0}function s3(t,e,n,i,s,r){if(n.length===0)return!1;for(let o=0,a=n.length;o<a;++o){const l=n[o];if(Dm(t,e,l,i,s,r))return!0;e=l[l.length-1]}return!1}function Om(t,e,n,i,s,r,o){let a,l,c,h,u,d,f;const g=s[r+1],m=[];for(let _=0,x=n.length;_<x;++_){const E=n[_];for(h=t[E-i],d=t[E-i+1],a=e;a<E;a+=i)u=t[a],f=t[a+1],(g<=d&&f<=g||d<=g&&g<=f)&&(c=(g-d)/(f-d)*(u-h)+h,m.push(c)),h=u,d=f}let p=NaN,y=-1/0;for(m.sort(ts),h=m[0],a=1,l=m.length;a<l;++a){u=m[a];const _=Math.abs(u-h);_>y&&(c=(h+u)/2,Dm(t,e,n,i,c,g)&&(p=c,y=_)),h=u}return isNaN(p)&&(p=s[r]),o?(o.push(p,g,y),o):[p,g,y]}function Db(t,e,n,i,s){let r=[];for(let o=0,a=n.length;o<a;++o){const l=n[o];r=Om(t,e,l,i,s,2*o,r),e=l[l.length-1]}return r}function Ob(t,e,n,i,s){let r;for(e+=i;e<n;e+=i)if(r=s(t.slice(e-i,e),t.slice(e,e+i)),r)return r;return!1}function Su(t,e,n,i,s,r){return r=r??gb(Yn(),t,e,n,i),wn(s,r)?r[0]>=s[0]&&r[2]<=s[2]||r[1]>=s[1]&&r[3]<=s[3]?!0:Ob(t,e,n,i,function(o,a){return iN(s,o,a)}):!1}function r3(t,e,n,i,s){for(let r=0,o=n.length;r<o;++r){if(Su(t,e,n[r],i,s))return!0;e=n[r]}return!1}function Lb(t,e,n,i,s){return!!(Su(t,e,n,i,s)||_r(t,e,n,i,s[0],s[1])||_r(t,e,n,i,s[0],s[3])||_r(t,e,n,i,s[2],s[1])||_r(t,e,n,i,s[2],s[3]))}function kb(t,e,n,i,s){if(!Lb(t,e,n[0],i,s))return!1;if(n.length===1)return!0;for(let r=1,o=n.length;r<o;++r)if(i3(t,n[r-1],n[r],i,s)&&!Su(t,n[r-1],n[r],i,s))return!1;return!0}function o3(t,e,n,i,s){for(let r=0,o=n.length;r<o;++r){const a=n[r];if(kb(t,e,a,i,s))return!0;e=a[a.length-1]}return!1}function a3(t,e,n,i){for(;e<n-i;){for(let s=0;s<i;++s){const r=t[e+s];t[e+s]=t[n-i+s],t[n-i+s]=r}e+=i,n-=i}}function Lm(t,e,n,i){let s=0,r=t[n-i],o=t[n-i+1];for(;e<n;e+=i){const a=t[e],l=t[e+1];s+=(a-r)*(l+o),r=a,o=l}return s===0?void 0:s>0}function km(t,e,n,i,s){s=s!==void 0?s:!1;for(let r=0,o=n.length;r<o;++r){const a=n[r],l=Lm(t,e,a,i);if(r===0){if(s&&l||!s&&!l)return!1}else if(s&&!l||!s&&l)return!1;e=a}return!0}function Nb(t,e,n,i,s){for(let r=0,o=n.length;r<o;++r){const a=n[r];if(!km(t,e,a,i,s))return!1;a.length&&(e=a[a.length-1])}return!0}function vh(t,e,n,i,s){s=s!==void 0?s:!1;for(let r=0,o=n.length;r<o;++r){const a=n[r],l=Lm(t,e,a,i);(r===0?s&&l||!s&&!l:s&&!l||!s&&l)&&a3(t,e,a,i),e=a}return e}function Cg(t,e,n,i,s){for(let r=0,o=n.length;r<o;++r)e=vh(t,e,n[r],i,s);return e}function l3(t,e){const n=[];let i=0,s=0,r;for(let o=0,a=e.length;o<a;++o){const l=e[o],c=Lm(t,i,l,2);if(r===void 0&&(r=c),c===r)n.push(e.slice(s,o+1));else{if(n.length===0)continue;n[n.length-1].push(e[s])}s=o+1,i=l}return n}class Gi extends qs{constructor(e,n,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,n!==void 0&&i?(this.setFlatCoordinates(n,e),this.ends_=i):this.setCoordinates(e,n)}appendLinearRing(e){this.flatCoordinates?ai(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Gi(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,n,i,s){return s<Dr(this.getExtent(),e,n)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Im(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Mm(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,n,i,s))}containsXY(e,n){return Dm(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,n)}getArea(){return Ib(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let n;return e!==void 0?(n=this.getOrientedFlatCoordinates().slice(),vh(n,0,this.ends_,this.stride,e)):n=this.flatCoordinates,El(n,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=Ui(this.getExtent());this.flatInteriorPoint_=Om(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new ci(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new xl(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,n=this.flatCoordinates,i=this.ends_,s=[];let r=0;for(let o=0,a=i.length;o<a;++o){const l=i[o],c=new xl(n.slice(r,l),e);s.push(c),r=l}return s}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;km(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=vh(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const n=[],i=[];return n.length=Fm(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),n,0,i),new Gi(n,"XY",i)}getType(){return"Polygon"}intersectsExtent(e){return kb(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,n){this.setLayout(n,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Hl(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function VE(t){if(Qo(t))throw new Error("Cannot create polygon from empty extent");const e=t[0],n=t[1],i=t[2],s=t[3],r=[e,n,e,s,i,s,i,n,e,n];return new Gi(r,"XY",[r.length])}function Nm(t,e,n,i){const s=Ve(e)/n[0],r=jt(e)/n[1];return i?Math.min(t,Math.max(s,r)):Math.min(t,Math.min(s,r))}function Bm(t,e,n){let i=Math.min(t,e);const s=50;return i*=Math.log(1+s*Math.max(0,t/e-1))/s+1,n&&(i=Math.max(i,n),i/=Math.log(1+s*Math.max(0,n/t-1))/s+1),lt(i,n/2,e*2)}function c3(t,e,n,i){return e=e!==void 0?e:!0,function(s,r,o,a){if(s!==void 0){const l=t[0],c=t[t.length-1],h=n?Nm(l,n,o,i):l;if(a)return e?Bm(s,h,c):lt(s,c,h);const u=Math.min(h,s),d=Math.floor(dm(t,u,r));return t[d]>h&&d<t.length-1?t[d+1]:t[d]}}}function h3(t,e,n,i,s,r){return i=i!==void 0?i:!0,n=n!==void 0?n:0,function(o,a,l,c){if(o!==void 0){const h=s?Nm(e,s,l,r):e;if(c)return i?Bm(o,h,n):lt(o,n,h);const u=1e-9,d=Math.ceil(Math.log(e/h)/Math.log(t)-u),f=-a*(.5-u)+.5,g=Math.min(h,o),m=Math.floor(Math.log(e/g)/Math.log(t)+f),p=Math.max(d,m),y=e/Math.pow(t,p);return lt(y,n,h)}}}function WE(t,e,n,i,s){return n=n!==void 0?n:!0,function(r,o,a,l){if(r!==void 0){const c=i?Nm(t,i,a,s):t;return!n||!l?lt(r,e,c):Bm(r,c,e)}}}function Um(t){if(t!==void 0)return 0}function KE(t){if(t!==void 0)return t}function u3(t){const e=2*Math.PI/t;return function(n,i){if(i)return n;if(n!==void 0)return n=Math.floor(n/e+.5)*e,n}}function d3(t){const e=Os(5);return function(n,i){return i||n===void 0?n:Math.abs(n)<=e?0:n}}const f3=42,Gm=256,Zd=0;class Ii extends ji{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Cm(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&Tb(),e.center&&(e.center=mt(e.center,this.projection_)),e.extent&&(e.extent=fi(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const n=Object.assign({},e);for(const a in di)delete n[a];this.setProperties(n,!0);const i=p3(e);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom;const s=g3(e),r=i.constraint,o=m3(e);this.constraints_={center:s,resolution:r,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let n=this.padding_;this.padding_=e;const i=this.getCenterInternal();if(i){const s=e||[0,0,0,0];n=n||[0,0,0,0];const r=this.getResolution(),o=r/2*(s[3]-n[3]+n[1]-s[1]),a=r/2*(s[0]-n[0]+n[2]-s[2]);this.setCenterInternal([i[0]+o,i[1]-a])}}getUpdatedOptions_(e){const n=this.getProperties();return n.resolution!==void 0?n.resolution=this.getResolution():n.zoom=this.getZoom(),n.center=this.getCenterInternal(),n.rotation=this.getRotation(),Object.assign({},n,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const n=new Array(arguments.length);for(let i=0;i<n.length;++i){let s=arguments[i];s.center&&(s=Object.assign({},s),s.center=mt(s.center,this.getProjection())),s.anchor&&(s=Object.assign({},s),s.anchor=mt(s.anchor,this.getProjection())),n[i]=s}this.animateInternal.apply(this,n)}animateInternal(e){let n=arguments.length,i;n>1&&typeof arguments[n-1]=="function"&&(i=arguments[n-1],--n);let s=0;for(;s<n&&!this.isDef();++s){const h=arguments[s];h.center&&this.setCenterInternal(h.center),h.zoom!==void 0?this.setZoom(h.zoom):h.resolution&&this.setResolution(h.resolution),h.rotation!==void 0&&this.setRotation(h.rotation)}if(s===n){i&&dc(i,!0);return}let r=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_;const c=[];for(;s<n;++s){const h=arguments[s],u={start:r,complete:!1,anchor:h.anchor,duration:h.duration!==void 0?h.duration:1e3,easing:h.easing||cN,callback:i};if(h.center&&(u.sourceCenter=o,u.targetCenter=h.center.slice(),o=u.targetCenter),h.zoom!==void 0?(u.sourceResolution=a,u.targetResolution=this.getResolutionForZoom(h.zoom),a=u.targetResolution):h.resolution&&(u.sourceResolution=a,u.targetResolution=h.resolution,a=u.targetResolution),h.rotation!==void 0){u.sourceRotation=l;const d=br(h.rotation-l+Math.PI,2*Math.PI)-Math.PI;u.targetRotation=l+d,l=u.targetRotation}_3(u)?u.complete=!0:r+=u.duration,c.push(u)}this.animations_.push(c),this.setHint(sn.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[sn.ANIMATING]>0}getInteracting(){return this.hints_[sn.INTERACTING]>0}cancelAnimations(){this.setHint(sn.ANIMATING,-this.hints_[sn.ANIMATING]);let e;for(let n=0,i=this.animations_.length;n<i;++n){const s=this.animations_[n];if(s[0].callback&&dc(s[0].callback,!1),!e)for(let r=0,o=s.length;r<o;++r){const a=s[r];if(!a.complete){e=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let n=!1;for(let i=this.animations_.length-1;i>=0;--i){const s=this.animations_[i];let r=!0;for(let o=0,a=s.length;o<a;++o){const l=s[o];if(l.complete)continue;const c=e-l.start;let h=l.duration>0?c/l.duration:1;h>=1?(l.complete=!0,h=1):r=!1;const u=l.easing(h);if(l.sourceCenter){const d=l.sourceCenter[0],f=l.sourceCenter[1],g=l.targetCenter[0],m=l.targetCenter[1];this.nextCenter_=l.targetCenter;const p=d+u*(g-d),y=f+u*(m-f);this.targetCenter_=[p,y]}if(l.sourceResolution&&l.targetResolution){const d=u===1?l.targetResolution:l.sourceResolution+u*(l.targetResolution-l.sourceResolution);if(l.anchor){const f=this.getViewportSize_(this.getRotation()),g=this.constraints_.resolution(d,0,f,!0);this.targetCenter_=this.calculateCenterZoom(g,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=d,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const d=u===1?br(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+u*(l.targetRotation-l.sourceRotation);if(l.anchor){const f=this.constraints_.rotation(d,!0);this.targetCenter_=this.calculateCenterRotate(f,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=d}if(this.applyTargetState_(!0),n=!0,!l.complete)break}if(r){this.animations_[i]=null,this.setHint(sn.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=s[0].callback;o&&dc(o,!0)}}this.animations_=this.animations_.filter(Boolean),n&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,n){let i;const s=this.getCenterInternal();return s!==void 0&&(i=[s[0]-n[0],s[1]-n[1]],Em(i,e-this.getRotation()),rN(i,n)),i}calculateCenterZoom(e,n){let i;const s=this.getCenterInternal(),r=this.getResolution();if(s!==void 0&&r!==void 0){const o=n[0]-e*(n[0]-s[0])/r,a=n[1]-e*(n[1]-s[1])/r;i=[o,a]}return i}getViewportSize_(e){const n=this.viewportSize_;if(e){const i=n[0],s=n[1];return[Math.abs(i*Math.cos(e))+Math.abs(s*Math.sin(e)),Math.abs(i*Math.sin(e))+Math.abs(s*Math.cos(e))]}return n}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&Xs(e,this.getProjection())}getCenterInternal(){return this.get(di.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const n=this.calculateExtentInternal(e);return yu(n,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const n=this.getCenterInternal();Je(n,"The view center is not defined");const i=this.getResolution();Je(i!==void 0,"The view resolution is not defined");const s=this.getRotation();return Je(s!==void 0,"The view rotation is not defined"),yg(n,i,s,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(di.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,n){return this.getResolutionForExtentInternal(fi(e,this.getProjection()),n)}getResolutionForExtentInternal(e,n){n=n||this.getViewportSizeMinusPadding_();const i=Ve(e)/n[0],s=jt(e)/n[1];return Math.max(i,s)}getResolutionForValueFunction(e){e=e||2;const n=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,s=Math.log(n/i)/Math.log(e);return function(r){return n/Math.pow(e,r*s)}}getRotation(){return this.get(di.ROTATION)}getValueForResolutionFunction(e){const n=Math.log(e||2),i=this.getConstrainedResolution(this.maxResolution_),s=this.minResolution_,r=Math.log(i/s)/n;return function(o){return Math.log(i/o)/n/r}}getViewportSizeMinusPadding_(e){let n=this.getViewportSize_(e);const i=this.padding_;return i&&(n=[n[0]-i[1]-i[3],n[1]-i[0]-i[2]]),n}getState(){const e=this.getProjection(),n=this.getResolution(),i=this.getRotation();let s=this.getCenterInternal();const r=this.padding_;if(r){const o=this.getViewportSizeMinusPadding_();s=Jd(s,this.getViewportSize_(),[o[0]/2+r[3],o[1]/2+r[0]],n,i)}return{center:s.slice(0),projection:e!==void 0?e:null,resolution:n,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const n=this.getResolution();return n!==void 0&&(e=this.getZoomForResolution(n)),e}getZoomForResolution(e){let n=this.minZoom_||0,i,s;if(this.resolutions_){const r=dm(this.resolutions_,e,1);n=r,i=this.resolutions_[r],r==this.resolutions_.length-1?s=2:s=i/this.resolutions_[r+1]}else i=this.maxResolution_,s=this.zoomFactor_;return n+Math.log(i/e)/Math.log(s)}getResolutionForZoom(e){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const n=lt(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[n]/this.resolutions_[n+1];return this.resolutions_[n]/Math.pow(i,lt(e-n,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,n){let i;if(Je(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){Je(!Qo(e),"Cannot fit empty extent provided as `geometry`");const s=fi(e,this.getProjection());i=VE(s)}else if(e.getType()==="Circle"){const s=fi(e.getExtent(),this.getProjection());i=VE(s),i.rotate(this.getRotation(),Ui(s))}else i=e;this.fitInternal(i,n)}rotatedExtentForGeometry(e){const n=this.getRotation(),i=Math.cos(n),s=Math.sin(-n),r=e.getFlatCoordinates(),o=e.getStride();let a=1/0,l=1/0,c=-1/0,h=-1/0;for(let u=0,d=r.length;u<d;u+=o){const f=r[u]*i-r[u+1]*s,g=r[u]*s+r[u+1]*i;a=Math.min(a,f),l=Math.min(l,g),c=Math.max(c,f),h=Math.max(h,g)}return[a,l,c,h]}fitInternal(e,n){n=n||{};let i=n.size;i||(i=this.getViewportSizeMinusPadding_());const s=n.padding!==void 0?n.padding:[0,0,0,0],r=n.nearest!==void 0?n.nearest:!1;let o;n.minResolution!==void 0?o=n.minResolution:n.maxZoom!==void 0?o=this.getResolutionForZoom(n.maxZoom):o=0;const a=this.rotatedExtentForGeometry(e);let l=this.getResolutionForExtentInternal(a,[i[0]-s[1]-s[3],i[1]-s[0]-s[2]]);l=isNaN(l)?o:Math.max(l,o),l=this.getConstrainedResolution(l,r?0:1);const c=this.getRotation(),h=Math.sin(c),u=Math.cos(c),d=Ui(a);d[0]+=(s[1]-s[3])/2*l,d[1]+=(s[0]-s[2])/2*l;const f=d[0]*u-d[1]*h,g=d[1]*u+d[0]*h,m=this.getConstrainedCenter([f,g],l),p=n.callback?n.callback:dl;n.duration!==void 0?this.animateInternal({resolution:l,center:m,duration:n.duration,easing:n.easing},p):(this.targetResolution_=l,this.targetCenter_=m,this.applyTargetState_(!1,!0),dc(p,!0))}centerOn(e,n,i){this.centerOnInternal(mt(e,this.getProjection()),n,i)}centerOnInternal(e,n,i){this.setCenterInternal(Jd(e,n,i,this.getResolution(),this.getRotation()))}calculateCenterShift(e,n,i,s){let r;const o=this.padding_;if(o&&e){const a=this.getViewportSizeMinusPadding_(-i),l=Jd(e,s,[a[0]/2+o[3],a[1]/2+o[0]],n,i);r=[e[0]-l[0],e[1]-l[1]]}return r}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const n=Xs(this.targetCenter_,this.getProjection());this.setCenter([n[0]+e[0],n[1]+e[1]])}adjustCenterInternal(e){const n=this.targetCenter_;this.setCenterInternal([n[0]+e[0],n[1]+e[1]])}adjustResolution(e,n){n=n&&mt(n,this.getProjection()),this.adjustResolutionInternal(e,n)}adjustResolutionInternal(e,n){const i=this.getAnimating()||this.getInteracting(),s=this.getViewportSize_(this.getRotation()),r=this.constraints_.resolution(this.targetResolution_*e,0,s,i);n&&(this.targetCenter_=this.calculateCenterZoom(r,n)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,n){this.adjustResolution(Math.pow(this.zoomFactor_,-e),n)}adjustRotation(e,n){n&&(n=mt(n,this.getProjection())),this.adjustRotationInternal(e,n)}adjustRotationInternal(e,n){const i=this.getAnimating()||this.getInteracting(),s=this.constraints_.rotation(this.targetRotation_+e,i);n&&(this.targetCenter_=this.calculateCenterRotate(s,n)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&mt(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,n){return this.hints_[e]+=n,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,n){const i=this.getAnimating()||this.getInteracting()||n,s=this.constraints_.rotation(this.targetRotation_,i),r=this.getViewportSize_(s),o=this.constraints_.resolution(this.targetResolution_,0,r,i),a=this.constraints_.center(this.targetCenter_,o,r,i,this.calculateCenterShift(this.targetCenter_,o,s,r));this.get(di.ROTATION)!==s&&this.set(di.ROTATION,s),this.get(di.RESOLUTION)!==o&&(this.set(di.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(di.CENTER)||!_n(this.get(di.CENTER),a))&&this.set(di.CENTER,a),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,n,i){e=e!==void 0?e:200;const s=n||0,r=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(r),a=this.constraints_.resolution(this.targetResolution_,s,o),l=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,r,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=r,this.targetCenter_=l,this.applyTargetState_();return}i=i||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==r||!this.getCenterInternal()||!_n(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:r,center:l,resolution:a,duration:e,easing:ea,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(sn.INTERACTING,1)}endInteraction(e,n,i){i=i&&mt(i,this.getProjection()),this.endInteractionInternal(e,n,i)}endInteractionInternal(e,n,i){this.getInteracting()&&(this.setHint(sn.INTERACTING,-1),this.resolveConstraints(e,n,i))}getConstrainedCenter(e,n){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,n||this.getResolution(),i)}getConstrainedZoom(e,n){const i=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(i,n))}getConstrainedResolution(e,n){n=n||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,n,i)}}function dc(t,e){setTimeout(function(){t(e)},0)}function g3(t){if(t.extent!==void 0){const n=t.smoothExtentConstraint!==void 0?t.smoothExtentConstraint:!0;return AE(t.extent,t.constrainOnlyCenter,n)}const e=Cm(t.projection,"EPSG:3857");if(t.multiWorld!==!0&&e.isGlobal()){const n=e.getExtent().slice();return n[0]=-1/0,n[2]=1/0,AE(n,!1,!1)}return Jk}function p3(t){let e,n,i,o=t.minZoom!==void 0?t.minZoom:Zd,a=t.maxZoom!==void 0?t.maxZoom:28;const l=t.zoomFactor!==void 0?t.zoomFactor:2,c=t.multiWorld!==void 0?t.multiWorld:!1,h=t.smoothResolutionConstraint!==void 0?t.smoothResolutionConstraint:!0,u=t.showFullExtent!==void 0?t.showFullExtent:!1,d=Cm(t.projection,"EPSG:3857"),f=d.getExtent();let g=t.constrainOnlyCenter,m=t.extent;if(!c&&!m&&d.isGlobal()&&(g=!1,m=f),t.resolutions!==void 0){const p=t.resolutions;n=p[o],i=p[a]!==void 0?p[a]:p[p.length-1],t.constrainResolution?e=c3(p,h,!g&&m,u):e=WE(n,i,h,!g&&m,u)}else{const y=(f?Math.max(Ve(f),jt(f)):360*No.degrees/d.getMetersPerUnit())/Gm/Math.pow(2,Zd),_=y/Math.pow(2,28-Zd);n=t.maxResolution,n!==void 0?o=0:n=y/Math.pow(l,o),i=t.minResolution,i===void 0&&(t.maxZoom!==void 0?t.maxResolution!==void 0?i=n/Math.pow(l,a):i=y/Math.pow(l,a):i=_),a=o+Math.floor(Math.log(n/i)/Math.log(l)),i=n/Math.pow(l,a-o),t.constrainResolution?e=h3(l,n,i,h,!g&&m,u):e=WE(n,i,h,!g&&m,u)}return{constraint:e,maxResolution:n,minResolution:i,minZoom:o,zoomFactor:l}}function m3(t){if(t.enableRotation!==void 0?t.enableRotation:!0){const n=t.constrainRotation;return n===void 0||n===!0?d3():n===!1?KE:typeof n=="number"?u3(n):KE}return Um}function _3(t){return!(t.sourceCenter&&t.targetCenter&&!_n(t.sourceCenter,t.targetCenter)||t.sourceResolution!==t.targetResolution||t.sourceRotation!==t.targetRotation)}function Jd(t,e,n,i,s){const r=Math.cos(-s);let o=Math.sin(-s),a=t[0]*r-t[1]*o,l=t[1]*r+t[0]*o;a+=(e[0]/2-n[0])*i,l+=(n[1]-e[1]/2)*i,o=-o;const c=a*r-l*o,h=l*r+a*o;return[c,h]}const fc="ol-hidden",Xl="ol-unselectable",$m="ol-control",YE="ol-collapsed",y3=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),qE=["style","variant","weight","size","lineHeight","family"],bg={normal:400,bold:700},Tg=function(t){const e=t.match(y3);if(!e)return null;const n={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let i=0,s=qE.length;i<s;++i){const r=e[i+1];r!==void 0&&(n[qE[i]]=typeof r=="string"?r.trim():r)}return isNaN(Number(n.weight))&&n.weight in bg&&(n.weight=bg[n.weight]),n.families=n.family.split(/,\s?/).map(i=>i.trim().replace(/^['"]|['"]$/g,"")),n};function Et(t,e,n,i){let s;return n&&n.length?s=n.shift():hu?s=new OffscreenCanvas(t||300,e||300):s=document.createElement("canvas"),t&&(s.width=t),e&&(s.height=e),s.getContext("2d",i)}let Qd;function Ah(){return Qd||(Qd=Et(1,1)),Qd}function Cu(t){const e=t.canvas;e.width=1,e.height=1,t.clearRect(0,0,1,1)}function ZE(t,e){const n=e.parentNode;n&&n.replaceChild(t,e)}function E3(t){for(;t.lastChild;)t.lastChild.remove()}function x3(t,e){const n=t.childNodes;for(let i=0;;++i){const s=n[i],r=e[i];if(!s&&!r)break;if(s!==r){if(!s){t.appendChild(r);continue}if(!r){t.removeChild(s),--i;continue}t.insertBefore(r,s)}}}class bu extends ji{constructor(e){super();const n=e.element;n&&!e.target&&!n.style.pointerEvents&&(n.style.pointerEvents="auto"),this.element=n||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){this.element?.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){this.map_&&this.element?.remove();for(let n=0,i=this.listenerKeys.length;n<i;++n)at(this.listenerKeys[n]);if(this.listenerKeys.length=0,this.map_=e,e){const n=this.target_??e.getOverlayContainerStopEvent();this.element&&n.appendChild(this.element),this.render!==dl&&this.listenerKeys.push(He(e,Ss.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class w3 extends bu{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const n=e.className!==void 0?e.className:"ol-attribution",i=e.tipLabel!==void 0?e.tipLabel:"Attributions",s=e.expandClassName!==void 0?e.expandClassName:n+"-expand",r=e.collapseLabel!==void 0?e.collapseLabel:"›",o=e.collapseClassName!==void 0?e.collapseClassName:n+"-collapse";typeof r=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=r,this.collapseLabel_.className=o):this.collapseLabel_=r;const a=e.label!==void 0?e.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=s):this.label_=a;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(xe.CLICK,this.handleClick_.bind(this),!1);const c=n+" "+Xl+" "+$m+(this.collapsed_&&this.collapsible_?" "+YE:"")+(this.collapsible_?"":" ol-uncollapsible"),h=this.element;h.className=c,h.appendChild(this.toggleButton_),h.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const n=this.getMap().getAllLayers(),i=new Set(n.flatMap(s=>s.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(s=>i.add(s)):i.add(this.attributions_)),!this.overrideCollapsible_){const s=!n.some(r=>r.getSource()?.getAttributionsCollapsible()===!1);this.setCollapsible(s)}return Array.from(i)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const n=await Promise.all(this.collectSourceAttributions_(e).map(s=>cb(()=>s))),i=n.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!cs(n,this.renderedAttributions_)){E3(this.ulElement_);for(let s=0,r=n.length;s<r;++s){const o=document.createElement("li");o.innerHTML=n[s],this.ulElement_.appendChild(o)}this.renderedAttributions_=n}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(YE),this.collapsed_?ZE(this.collapseLabel_,this.label_):ZE(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class S3 extends bu{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const n=e.className!==void 0?e.className:"ol-rotate",i=e.label!==void 0?e.label:"⇧",s=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=s,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(s));const r=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=n+"-reset",o.setAttribute("type","button"),o.title=r,o.appendChild(this.label_),o.addEventListener(xe.CLICK,this.handleClick_.bind(this),!1);const a=n+" "+Xl+" "+$m,l=this.element;l.className=a,l.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(fc)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const n=this.getMap().getView();if(!n)return;const i=n.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?n.animate({rotation:0,duration:this.duration_,easing:ea}):n.setRotation(0))}render(e){const n=e.frameState;if(!n)return;const i=n.viewState.rotation;if(i!=this.rotation_){const s="rotate("+i+"rad)";if(this.autoHide_){const r=this.element.classList.contains(fc);!r&&i===0?this.element.classList.add(fc):r&&i!==0&&this.element.classList.remove(fc)}this.label_.style.transform=s}this.rotation_=i}}class C3 extends bu{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const n=e.className!==void 0?e.className:"ol-zoom",i=e.delta!==void 0?e.delta:1,s=e.zoomInClassName!==void 0?e.zoomInClassName:n+"-in",r=e.zoomOutClassName!==void 0?e.zoomOutClassName:n+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",a=e.zoomOutLabel!==void 0?e.zoomOutLabel:"–",l=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",c=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=s,h.setAttribute("type","button"),h.title=l,h.appendChild(typeof o=="string"?document.createTextNode(o):o),h.addEventListener(xe.CLICK,this.handleClick_.bind(this,i),!1);const u=document.createElement("button");u.className=r,u.setAttribute("type","button"),u.title=c,u.appendChild(typeof a=="string"?document.createTextNode(a):a),u.addEventListener(xe.CLICK,this.handleClick_.bind(this,-i),!1);const d=n+" "+Xl+" "+$m,f=this.element;f.className=d,f.appendChild(h),f.appendChild(u),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,n){n.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const i=this.getMap().getView();if(!i)return;const s=i.getZoom();if(s!==void 0){const r=i.getConstrainedZoom(s+e);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:r,duration:this.duration_,easing:ea})):i.setZoom(r)}}}function Bb(t){t=t||{};const e=new Vn;return(t.zoom!==void 0?t.zoom:!0)&&e.push(new C3(t.zoomOptions)),(t.rotate!==void 0?t.rotate:!0)&&e.push(new S3(t.rotateOptions)),(t.attribution!==void 0?t.attribution:!0)&&e.push(new w3(t.attributionOptions)),e}class b3{constructor(e,n,i){this.decay_=e,this.minVelocity_=n,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,n){this.points_.push(e,n,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,n=this.points_.length-3;if(this.points_[n+2]<e)return!1;let i=n-3;for(;i>0&&this.points_[i+2]>e;)i-=3;const s=this.points_[n+2]-this.points_[i+2];if(s<1e3/60)return!1;const r=this.points_[n]-this.points_[i],o=this.points_[n+1]-this.points_[i+1];return this.angle_=Math.atan2(o,r),this.initialVelocity_=Math.sqrt(r*r+o*o)/s,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const Rg={ACTIVE:"active"};class ta extends ji{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(Rg.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(Rg.ACTIVE,e)}setMap(e){this.map_=e}}function T3(t,e,n){const i=t.getCenterInternal();if(i){const s=[i[0]+e[0],i[1]+e[1]];t.animateInternal({duration:n!==void 0?n:250,easing:hN,center:t.getConstrainedCenter(s)})}}function jm(t,e,n,i){const s=t.getZoom();if(s===void 0)return;const r=t.getConstrainedZoom(s+e),o=t.getResolutionForZoom(r);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:o,anchor:n,duration:i!==void 0?i:250,easing:ea})}class R3 extends ta{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let n=!1;if(e.type==Ge.DBLCLICK){const i=e.originalEvent,s=e.map,r=e.coordinate,o=i.shiftKey?-this.delta_:this.delta_,a=s.getView();jm(a,o,r,this.duration_),i.preventDefault(),n=!0}return!n}}function vg(t){const e=arguments;return function(n){let i=!0;for(let s=0,r=e.length;s<r&&(i=i&&e[s](n),!!i);++s);return i}}const v3=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},A3=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},I3=function(t){const e=t.map.getTargetElement(),n=e.getRootNode(),i=t.map.getOwnerDocument().activeElement;return n instanceof ShadowRoot?n.host.contains(i):e.contains(i)},Ub=function(t){const e=t.map.getTargetElement(),n=e.getRootNode();return(n instanceof ShadowRoot?n.host:e).hasAttribute("tabindex")?I3(t):!0},Ih=zs,Gb=function(t){const e=t.originalEvent;return"pointerId"in e&&e.button==0&&!(Hk&&hb&&e.ctrlKey)},Ag=Zo,$b=function(t){return t.type==Ge.SINGLECLICK},zm=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},P3=function(t){const e=t.originalEvent;return hb?e.metaKey:e.ctrlKey},Hm=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},jb=function(t){const e=t.originalEvent,n=e.target.tagName;return n!=="INPUT"&&n!=="SELECT"&&n!=="TEXTAREA"&&!e.target.isContentEditable},ef=function(t){const e=t.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},zb=function(t){const e=t.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class Lr extends ta{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let n=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Ge.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Ge.POINTERUP){const i=this.handleUpEvent(e);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(e.type==Ge.POINTERDOWN){const i=this.handleDownEvent(e);this.handlingDownUpSequence=i,n=this.stopDown(i)}else e.type==Ge.POINTERMOVE&&this.handleMoveEvent(e);return!n}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function Xm(t){const e=t.length;let n=0,i=0;for(let s=0;s<e;s++)n+=t[s].clientX,i+=t[s].clientY;return{clientX:n/e,clientY:i/e}}class M3 extends Lr{constructor(e){super({stopDown:Zo}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const n=e.condition?e.condition:vg(zm,zb);this.condition_=e.onFocusOnly?vg(Ub,n):n,this.noKinetic_=!1}handleDragEvent(e){const n=e.map;this.panning_||(this.panning_=!0,n.getView().beginInteraction());const i=this.targetPointers,s=n.getEventPixel(Xm(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(s[0],s[1]),this.lastCentroid){const r=[this.lastCentroid[0]-s[0],s[1]-this.lastCentroid[1]],a=e.map.getView();oN(r,a.getResolution()),Em(r,a.getRotation()),a.adjustCenterInternal(r)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=s,this.lastPointersCount_=i.length,e.originalEvent.preventDefault()}handleUpEvent(e){const n=e.map,i=n.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const s=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),o=i.getCenterInternal(),a=n.getPixelFromCoordinateInternal(o),l=n.getCoordinateFromPixelInternal([a[0]-s*Math.cos(r),a[1]-s*Math.sin(r)]);i.animateInternal({center:i.getConstrainedCenter(l),duration:500,easing:ea})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const i=e.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class F3 extends Lr{constructor(e){e=e||{},super({stopDown:Zo}),this.condition_=e.condition?e.condition:A3,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!ef(e))return;const n=e.map,i=n.getView();if(i.getConstraints().rotation===Um)return;const s=n.getSize(),r=e.pixel,o=Math.atan2(s[1]/2-r[1],r[0]-s[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;i.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(e){return ef(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return ef(e)&&Gb(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class D3 extends Ul{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,n=this.endPixel_,i="px",s=this.element_.style;s.left=Math.min(e[0],n[0])+i,s.top=Math.min(e[1],n[1])+i,s.width=Math.abs(n[0]-e[0])+i,s.height=Math.abs(n[1]-e[1])+i}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const n=this.element_.style;n.left="inherit",n.top="inherit",n.width="inherit",n.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,n){this.startPixel_=e,this.endPixel_=n,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,n=this.endPixel_,s=[e,[e[0],n[1]],n,[n[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);s[4]=s[0].slice(),this.geometry_?this.geometry_.setCoordinates([s]):this.geometry_=new Gi([s])}getGeometry(){return this.geometry_}}const zr={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class ya extends hi{constructor(e,n,i){super(e),this.coordinate=n,this.mapBrowserEvent=i}}class O3 extends Lr{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new D3(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??Gb,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,n,i){const s=i[0]-n[0],r=i[1]-n[1];return s*s+r*r>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new ya(zr.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const n=this.boxEndCondition_(e,this.startPixel_,e.pixel);return n&&this.onBoxEnd(e),this.dispatchEvent(new ya(n?zr.BOXEND:zr.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new ya(zr.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new ya(zr.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new ya(zr.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class L3 extends O3{constructor(e){e=e||{};const n=e.condition?e.condition:Hm;super({condition:n,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const i=this.getMap().getView();let s=this.getGeometry();if(this.out_){const r=i.rotatedExtentForGeometry(s),o=i.getResolutionForExtentInternal(r),a=i.getResolution()/o;s=s.clone(),s.scale(a*a)}i.fitInternal(s,{duration:this.duration_,easing:ea})}}const sr={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class k3 extends ta{constructor(e){super(),e=e||{},this.defaultCondition_=function(n){return zm(n)&&jb(n)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let n=!1;if(e.type==xe.KEYDOWN){const i=e.originalEvent,s=i.key;if(this.condition_(e)&&(s==sr.DOWN||s==sr.LEFT||s==sr.RIGHT||s==sr.UP)){const o=e.map.getView(),a=o.getResolution()*this.pixelDelta_;let l=0,c=0;s==sr.DOWN?c=-a:s==sr.LEFT?l=-a:s==sr.RIGHT?l=a:c=a;const h=[l,c];Em(h,o.getRotation()),T3(o,h,this.duration_),i.preventDefault(),n=!0}}return!n}}class N3 extends ta{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(n){return!P3(n)&&jb(n)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let n=!1;if(e.type==xe.KEYDOWN||e.type==xe.KEYPRESS){const i=e.originalEvent,s=i.key;if(this.condition_(e)&&(s==="+"||s==="-")){const r=e.map,o=s==="+"?this.delta_:-this.delta_,a=r.getView();jm(a,o,void 0,this.duration_),i.preventDefault(),n=!0}}return!n}}const B3=40,U3=300;class G3 extends ta{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const n=e.condition?e.condition:Ih;this.condition_=e.onFocusOnly?vg(Ub,n):n,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==xe.WHEEL)return!0;const i=e.map,s=e.originalEvent;s.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let r=s.deltaY;switch(s.deltaMode){case WheelEvent.DOM_DELTA_LINE:r*=B3;break;case WheelEvent.DOM_DELTA_PAGE:r*=U3;break}if(r===0)return!1;this.lastDelta_=r;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(r)<4?"trackpad":"wheel");const a=i.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-r/this.deltaPerZoom_,this.lastAnchor_?i.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=r;const l=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),l),!1}handleWheelZoom_(e){const n=e.getView();n.getAnimating()&&n.cancelAnimations();let i=-lt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(n.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),jm(n,i,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class $3 extends Lr{constructor(e){e=e||{};const n=e;n.stopDown||(n.stopDown=Zo),super(n),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let n=0;const i=this.targetPointers[0],s=this.targetPointers[1],r=Math.atan2(s.clientY-i.clientY,s.clientX-i.clientX);if(this.lastAngle_!==void 0){const l=r-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),n=l}this.lastAngle_=r;const o=e.map,a=o.getView();a.getConstraints().rotation!==Um&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(Xm(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(n,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const n=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}return!1}}class j3 extends Lr{constructor(e){e=e||{};const n=e;n.stopDown||(n.stopDown=Zo),super(n),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let n=1;const i=this.targetPointers[0],s=this.targetPointers[1],r=i.clientX-s.clientX,o=i.clientY-s.clientY,a=Math.sqrt(r*r+o*o);this.lastDistance_!==void 0&&(n=this.lastDistance_/a),this.lastDistance_=a;const l=e.map,c=l.getView();n!=1&&(this.lastScaleDelta_=n),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(Xm(this.targetPointers))),l.render(),c.adjustResolutionInternal(n,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const i=e.map.getView(),s=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,s),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const n=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}return!1}}function z3(t){t=t||{};const e=new Vn,n=new b3(-.005,.05,100);return(t.altShiftDragRotate!==void 0?t.altShiftDragRotate:!0)&&e.push(new F3),(t.doubleClickZoom!==void 0?t.doubleClickZoom:!0)&&e.push(new R3({delta:t.zoomDelta,duration:t.zoomDuration})),(t.dragPan!==void 0?t.dragPan:!0)&&e.push(new M3({onFocusOnly:t.onFocusOnly,kinetic:n})),(t.pinchRotate!==void 0?t.pinchRotate:!0)&&e.push(new $3),(t.pinchZoom!==void 0?t.pinchZoom:!0)&&e.push(new j3({duration:t.zoomDuration})),(t.keyboard!==void 0?t.keyboard:!0)&&(e.push(new k3),e.push(new N3({delta:t.zoomDelta,duration:t.zoomDuration}))),(t.mouseWheelZoom!==void 0?t.mouseWheelZoom:!0)&&e.push(new G3({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration})),(t.shiftDragZoom!==void 0?t.shiftDragZoom:!0)&&e.push(new L3({duration:t.zoomDuration})),e}const Ke={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class Hb extends ji{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const n=Object.assign({},e);typeof e.properties=="object"&&(delete n.properties,Object.assign(n,e.properties)),n[Ke.OPACITY]=e.opacity!==void 0?e.opacity:1,Je(typeof n[Ke.OPACITY]=="number","Layer opacity must be a number"),n[Ke.VISIBLE]=e.visible!==void 0?e.visible:!0,n[Ke.Z_INDEX]=e.zIndex,n[Ke.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,n[Ke.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,n[Ke.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,n[Ke.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=n.className!==void 0?n.className:"ol-layer",delete n.className,this.setProperties(n),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const n=this.state_||{layer:this,managed:e===void 0?!0:e},i=this.getZIndex();return n.opacity=lt(Math.round(this.getOpacity()*100)/100,0,1),n.visible=this.getVisible(),n.extent=this.getExtent(),n.zIndex=i===void 0&&!n.managed?1/0:i,n.maxResolution=this.getMaxResolution(),n.minResolution=Math.max(this.getMinResolution(),0),n.minZoom=this.getMinZoom(),n.maxZoom=this.getMaxZoom(),this.state_=n,n}getLayersArray(e){return Se()}getLayerStatesArray(e){return Se()}getExtent(){return this.get(Ke.EXTENT)}getMaxResolution(){return this.get(Ke.MAX_RESOLUTION)}getMinResolution(){return this.get(Ke.MIN_RESOLUTION)}getMinZoom(){return this.get(Ke.MIN_ZOOM)}getMaxZoom(){return this.get(Ke.MAX_ZOOM)}getOpacity(){return this.get(Ke.OPACITY)}getSourceState(){return Se()}getVisible(){return this.get(Ke.VISIBLE)}getZIndex(){return this.get(Ke.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(Ke.EXTENT,e)}setMaxResolution(e){this.set(Ke.MAX_RESOLUTION,e)}setMinResolution(e){this.set(Ke.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(Ke.MAX_ZOOM,e)}setMinZoom(e){this.set(Ke.MIN_ZOOM,e)}setOpacity(e){Je(typeof e=="number","Layer opacity must be a number"),this.set(Ke.OPACITY,e)}setVisible(e){this.set(Ke.VISIBLE,e)}setZIndex(e){this.set(Ke.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class Ts extends hi{constructor(e,n){super(e),this.layer=n}}const tf={LAYERS:"layers"};class na extends Hb{constructor(e){e=e||{};const n=Object.assign({},e);delete n.layers;let i=e.layers;super(n),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(tf.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new Vn(i.slice(),{unique:!0}):Je(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new Vn(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(at),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(He(e,It.ADD,this.handleLayersAdd_,this),He(e,It.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(at);Fr(this.listenerKeys_);const n=e.getArray();for(let i=0,s=n.length;i<s;i++){const r=n[i];this.registerLayerListeners_(r),this.dispatchEvent(new Ts("addlayer",r))}this.changed()}registerLayerListeners_(e){const n=[He(e,Lo.PROPERTYCHANGE,this.handleLayerChange_,this),He(e,xe.CHANGE,this.handleLayerChange_,this)];e instanceof na&&n.push(He(e,"addlayer",this.handleLayerGroupAdd_,this),He(e,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[me(e)]=n}handleLayerGroupAdd_(e){this.dispatchEvent(new Ts("addlayer",e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new Ts("removelayer",e.layer))}handleLayersAdd_(e){const n=e.element;this.registerLayerListeners_(n),this.dispatchEvent(new Ts("addlayer",n)),this.changed()}handleLayersRemove_(e){const n=e.element,i=me(n);this.listenerKeys_[i].forEach(at),delete this.listenerKeys_[i],this.dispatchEvent(new Ts("removelayer",n)),this.changed()}getLayers(){return this.get(tf.LAYERS)}setLayers(e){const n=this.getLayers();if(n){const i=n.getArray();for(let s=0,r=i.length;s<r;++s)this.dispatchEvent(new Ts("removelayer",i[s]))}this.set(tf.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(n){n.getLayersArray(e)}),e}getLayerStatesArray(e){const n=e!==void 0?e:[],i=n.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(n)});const s=this.getLayerState();let r=s.zIndex;!e&&s.zIndex===void 0&&(r=0);for(let o=i,a=n.length;o<a;o++){const l=n[o];l.opacity*=s.opacity,l.visible=l.visible&&s.visible,l.maxResolution=Math.min(l.maxResolution,s.maxResolution),l.minResolution=Math.max(l.minResolution,s.minResolution),l.minZoom=Math.max(l.minZoom,s.minZoom),l.maxZoom=Math.min(l.maxZoom,s.maxZoom),s.extent!==void 0&&(l.extent!==void 0?l.extent=Cn(l.extent,s.extent):l.extent=s.extent),l.zIndex===void 0&&(l.zIndex=r)}return n}getSourceState(){return"ready"}}const Ut={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};class Tu extends Hb{constructor(e){const n=Object.assign({},e);delete n.source,super(n),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(Ke.SOURCE,this.handleSourcePropertyChange_);const i=e.source?e.source:null;this.setSource(i)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(Ke.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(at(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=He(e,xe.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let n;const i=this.getMapInternal();!e&&i&&(e=i.getView()),e instanceof Ii?n={viewState:e.getState(),extent:e.calculateExtent()}:n=e,!n.layerStatesArray&&i&&(n.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let s;if(n.layerStatesArray){if(s=n.layerStatesArray.find(o=>o.layer===this),!s)return!1}else s=this.getLayerState();const r=this.getExtent();return Vm(s,n.viewState)&&(!r||wn(r,n.extent))}getAttributions(e){if(!this.isVisible(e))return[];const n=this.getSource()?.getAttributions();if(!n)return[];const i=e instanceof Ii?e.getViewStateAndExtent():e;let s=n(i);return Array.isArray(s)||(s=[s]),s}render(e,n){const i=this.getRenderer();return i.prepareFrame(e)?(this.rendered=!0,i.renderFrame(e,n)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,n){}renderDeferred(e){const n=this.getRenderer();n&&n.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(Ke.MAP,e)}getMapInternal(){return this.get(Ke.MAP)}setMap(e){this.mapPrecomposeKey_&&(at(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(at(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=He(e,Ut.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=He(this,xe.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const n=e.frameState.layerStatesArray,i=this.getLayerState(!1);Je(!n.some(s=>s.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),n.push(i)}setSource(e){this.set(Ke.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function Vm(t,e){if(!t.visible)return!1;const n=e.resolution;if(n<t.minResolution||n>=t.maxResolution)return!1;const i=e.zoom;return i>t.minZoom&&i<=t.maxZoom}function Xb(t,e,n=0,i=t.length-1,s=H3){for(;i>n;){if(i-n>600){const l=i-n+1,c=e-n+1,h=Math.log(l),u=.5*Math.exp(2*h/3),d=.5*Math.sqrt(h*u*(l-u)/l)*(c-l/2<0?-1:1),f=Math.max(n,Math.floor(e-c*u/l+d)),g=Math.min(i,Math.floor(e+(l-c)*u/l+d));Xb(t,e,f,g,s)}const r=t[e];let o=n,a=i;for(Ea(t,n,e),s(t[i],r)>0&&Ea(t,n,i);o<a;){for(Ea(t,o,a),o++,a--;s(t[o],r)<0;)o++;for(;s(t[a],r)>0;)a--}s(t[n],r)===0?Ea(t,n,a):(a++,Ea(t,a,i)),a<=e&&(n=a+1),e<=a&&(i=a-1)}}function Ea(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function H3(t,e){return t<e?-1:t>e?1:0}let Vb=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let n=this.data;const i=[];if(!pc(e,n))return i;const s=this.toBBox,r=[];for(;n;){for(let o=0;o<n.children.length;o++){const a=n.children[o],l=n.leaf?s(a):a;pc(e,l)&&(n.leaf?i.push(a):sf(e,l)?this._all(a,i):r.push(a))}n=r.pop()}return i}collides(e){let n=this.data;if(!pc(e,n))return!1;const i=[];for(;n;){for(let s=0;s<n.children.length;s++){const r=n.children[s],o=n.leaf?this.toBBox(r):r;if(pc(e,o)){if(n.leaf||sf(e,o))return!0;i.push(r)}}n=i.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let i=0;i<e.length;i++)this.insert(e[i]);return this}let n=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=n;else if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const i=this.data;this.data=n,n=i}this._insert(n,this.data.height-n.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=no([]),this}remove(e,n){if(!e)return this;let i=this.data;const s=this.toBBox(e),r=[],o=[];let a,l,c;for(;i||r.length;){if(i||(i=r.pop(),l=r[r.length-1],a=o.pop(),c=!0),i.leaf){const h=X3(e,i.children,n);if(h!==-1)return i.children.splice(h,1),r.push(i),this._condense(r),this}!c&&!i.leaf&&sf(i,s)?(r.push(i),o.push(a),a=0,l=i,i=i.children[0]):l?(a++,i=l.children[a],c=!1):i=null}return this}toBBox(e){return e}compareMinX(e,n){return e.minX-n.minX}compareMinY(e,n){return e.minY-n.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,n){const i=[];for(;e;)e.leaf?n.push(...e.children):i.push(...e.children),e=i.pop();return n}_build(e,n,i,s){const r=i-n+1;let o=this._maxEntries,a;if(r<=o)return a=no(e.slice(n,i+1)),Hr(a,this.toBBox),a;s||(s=Math.ceil(Math.log(r)/Math.log(o)),o=Math.ceil(r/Math.pow(o,s-1))),a=no([]),a.leaf=!1,a.height=s;const l=Math.ceil(r/o),c=l*Math.ceil(Math.sqrt(o));JE(e,n,i,c,this.compareMinX);for(let h=n;h<=i;h+=c){const u=Math.min(h+c-1,i);JE(e,h,u,l,this.compareMinY);for(let d=h;d<=u;d+=l){const f=Math.min(d+l-1,u);a.children.push(this._build(e,d,f,s-1))}}return Hr(a,this.toBBox),a}_chooseSubtree(e,n,i,s){for(;s.push(n),!(n.leaf||s.length-1===i);){let r=1/0,o=1/0,a;for(let l=0;l<n.children.length;l++){const c=n.children[l],h=nf(c),u=K3(e,c)-h;u<o?(o=u,r=h<r?h:r,a=c):u===o&&h<r&&(r=h,a=c)}n=a||n.children[0]}return n}_insert(e,n,i){const s=i?e:this.toBBox(e),r=[],o=this._chooseSubtree(s,this.data,n,r);for(o.children.push(e),Ia(o,s);n>=0&&r[n].children.length>this._maxEntries;)this._split(r,n),n--;this._adjustParentBBoxes(s,r,n)}_split(e,n){const i=e[n],s=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,s);const o=this._chooseSplitIndex(i,r,s),a=no(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,Hr(i,this.toBBox),Hr(a,this.toBBox),n?e[n-1].children.push(a):this._splitRoot(i,a)}_splitRoot(e,n){this.data=no([e,n]),this.data.height=e.height+1,this.data.leaf=!1,Hr(this.data,this.toBBox)}_chooseSplitIndex(e,n,i){let s,r=1/0,o=1/0;for(let a=n;a<=i-n;a++){const l=Aa(e,0,a,this.toBBox),c=Aa(e,a,i,this.toBBox),h=Y3(l,c),u=nf(l)+nf(c);h<r?(r=h,s=a,o=u<o?u:o):h===r&&u<o&&(o=u,s=a)}return s||i-n}_chooseSplitAxis(e,n,i){const s=e.leaf?this.compareMinX:V3,r=e.leaf?this.compareMinY:W3,o=this._allDistMargin(e,n,i,s),a=this._allDistMargin(e,n,i,r);o<a&&e.children.sort(s)}_allDistMargin(e,n,i,s){e.children.sort(s);const r=this.toBBox,o=Aa(e,0,n,r),a=Aa(e,i-n,i,r);let l=gc(o)+gc(a);for(let c=n;c<i-n;c++){const h=e.children[c];Ia(o,e.leaf?r(h):h),l+=gc(o)}for(let c=i-n-1;c>=n;c--){const h=e.children[c];Ia(a,e.leaf?r(h):h),l+=gc(a)}return l}_adjustParentBBoxes(e,n,i){for(let s=i;s>=0;s--)Ia(n[s],e)}_condense(e){for(let n=e.length-1,i;n>=0;n--)e[n].children.length===0?n>0?(i=e[n-1].children,i.splice(i.indexOf(e[n]),1)):this.clear():Hr(e[n],this.toBBox)}};function X3(t,e,n){if(!n)return e.indexOf(t);for(let i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function Hr(t,e){Aa(t,0,t.children.length,e,t)}function Aa(t,e,n,i,s){s||(s=no(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let r=e;r<n;r++){const o=t.children[r];Ia(s,t.leaf?i(o):o)}return s}function Ia(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function V3(t,e){return t.minX-e.minX}function W3(t,e){return t.minY-e.minY}function nf(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function gc(t){return t.maxX-t.minX+(t.maxY-t.minY)}function K3(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function Y3(t,e){const n=Math.max(t.minX,e.minX),i=Math.max(t.minY,e.minY),s=Math.min(t.maxX,e.maxX),r=Math.min(t.maxY,e.maxY);return Math.max(0,s-n)*Math.max(0,r-i)}function sf(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function pc(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function no(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function JE(t,e,n,i,s){const r=[e,n];for(;r.length;){if(n=r.pop(),e=r.pop(),n-e<=i)continue;const o=e+Math.ceil((n-e)/i/2)*i;Xb(t,o,e,n,s),r.push(e,o,o,n)}}const Wm=[NaN,NaN,NaN,0];let rf;function q3(){return rf||(rf=Et(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),rf}const Z3=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,J3=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,Q3=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,eB=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function mc(t,e){return t.endsWith("%")?Number(t.substring(0,t.length-1))/e:Number(t)}function Ja(t){throw new Error('failed to parse "'+t+'" as color')}function Wb(t){if(t.toLowerCase().startsWith("rgb")){const r=t.match(J3)||t.match(Z3)||t.match(Q3);if(r){const o=r[4],a=100/255;return[lt(mc(r[1],a)+.5|0,0,255),lt(mc(r[2],a)+.5|0,0,255),lt(mc(r[3],a)+.5|0,0,255),o!==void 0?lt(mc(o,100),0,1):1]}Ja(t)}if(t.startsWith("#")){if(eB.test(t)){const r=t.substring(1),o=r.length<=4?1:2,a=[0,0,0,255];for(let l=0,c=r.length;l<c;l+=o){let h=parseInt(r.substring(l,l+o),16);o===1&&(h+=h<<4),a[l/o]=h}return a[3]=a[3]/255,a}Ja(t)}const e=q3();e.fillStyle="#abcdef";let n=e.fillStyle;e.fillStyle=t,e.fillStyle===n&&(e.fillStyle="#fedcba",n=e.fillStyle,e.fillStyle=t,e.fillStyle===n&&Ja(t));const i=e.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return Wb(i);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const s=Array.from(e.getImageData(0,0,1,1).data);return s[3]=jl(s[3]/255,3),s}function tB(t){return typeof t=="string"?t:Ym(t)}const nB=1024,xa={};let of=0;function iB(t){if(t.length===4)return t;const e=t.slice();return e[3]=1,e}function af(t){return t>.0031308?Math.pow(t,1/2.4)*269.025-14.025:t*3294.6}function lf(t){return t>.2068965?Math.pow(t,3):(t-4/29)*(108/841)}function cf(t){return t>10.314724?Math.pow((t+14.025)/269.025,2.4):t/3294.6}function hf(t){return t>.0088564?Math.pow(t,1/3):t/(108/841)+4/29}function QE(t){const e=cf(t[0]),n=cf(t[1]),i=cf(t[2]),s=hf(e*.222488403+n*.716873169+i*.06060791),r=500*(hf(e*.452247074+n*.399439023+i*.148375274)-s),o=200*(s-hf(e*.016863605+n*.117638439+i*.865350722)),a=Math.atan2(o,r)*(180/Math.PI);return[116*s-16,Math.sqrt(r*r+o*o),a<0?a+360:a,t[3]]}function sB(t){const e=(t[0]+16)/116,n=t[1],i=t[2]*Math.PI/180,s=lf(e),r=lf(e+n/500*Math.cos(i)),o=lf(e-n/200*Math.sin(i)),a=af(r*3.021973625-s*1.617392459-o*.404875592),l=af(r*-.943766287+s*1.916279586+o*.027607165),c=af(r*.069407491-s*.22898585+o*1.159737864);return[lt(a+.5|0,0,255),lt(l+.5|0,0,255),lt(c+.5|0,0,255),t[3]]}function Km(t){if(t==="none")return Wm;if(xa.hasOwnProperty(t))return xa[t];if(of>=nB){let n=0;for(const i in xa)(n++&3)===0&&(delete xa[i],--of)}const e=Wb(t);e.length!==4&&Ja(t);for(const n of e)isNaN(n)&&Ja(t);return xa[t]=e,++of,e}function Vs(t){return Array.isArray(t)?t:Km(t)}function Ym(t){let e=t[0];e!=(e|0)&&(e=e+.5|0);let n=t[1];n!=(n|0)&&(n=n+.5|0);let i=t[2];i!=(i|0)&&(i=i+.5|0);const s=t[3]===void 0?1:Math.round(t[3]*1e3)/1e3;return"rgba("+e+","+n+","+i+","+s+")"}function ex(t){return t[0]>0&&t[1]>0}function rB(t,e,n){return n===void 0&&(n=[0,0]),n[0]=t[0]*e+.5|0,n[1]=t[1]*e+.5|0,n}function Ct(t,e){return Array.isArray(t)?t:(e===void 0?e=[t,t]:(e[0]=t,e[1]=t),e)}let kr=0;const an=1<<kr++,Pe=1<<kr++,En=1<<kr++,Hn=1<<kr++,Ws=1<<kr++,co=1<<kr++,_c=Math.pow(2,kr)-1,qm={[an]:"boolean",[Pe]:"number",[En]:"string",[Hn]:"color",[Ws]:"number[]",[co]:"size"},oB=Object.keys(qm).map(Number).sort(ts);function aB(t){return t in qm}function ho(t){const e=[];for(const n of oB)Pa(t,n)&&e.push(qm[n]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function Pa(t,e){return(t&e)===e}function gs(t,e){return t===e}class Ot{constructor(e,n){if(!aB(e))throw new Error(`literal expressions must have a specific type, got ${ho(e)}`);this.type=e,this.value=n}}class Kb{constructor(e,n,...i){this.type=e,this.operator=n,this.args=i}}function Zm(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function zt(t,e,n){switch(typeof t){case"boolean":{if(gs(e,En))return new Ot(En,t?"true":"false");if(!Pa(e,an))throw new Error(`got a boolean, but expected ${ho(e)}`);return new Ot(an,t)}case"number":{if(gs(e,co))return new Ot(co,Ct(t));if(gs(e,an))return new Ot(an,!!t);if(gs(e,En))return new Ot(En,t.toString());if(!Pa(e,Pe))throw new Error(`got a number, but expected ${ho(e)}`);return new Ot(Pe,t)}case"string":{if(gs(e,Hn))return new Ot(Hn,Km(t));if(gs(e,an))return new Ot(an,!!t);if(!Pa(e,En))throw new Error(`got a string, but expected ${ho(e)}`);return new Ot(En,t)}}if(!Array.isArray(t))throw new Error("expression must be an array or a primitive value");if(t.length===0)throw new Error("empty expression");if(typeof t[0]=="string")return yB(t,e,n);for(const i of t)if(typeof i!="number")throw new Error("expected an array of numbers");if(gs(e,co)){if(t.length!==2)throw new Error(`expected an array of two values for a size, got ${t.length}`);return new Ot(co,t)}if(gs(e,Hn)){if(t.length===3)return new Ot(Hn,[...t,1]);if(t.length===4)return new Ot(Hn,t);throw new Error(`expected an array of 3 or 4 values for a color, got ${t.length}`)}if(!Pa(e,Ws))throw new Error(`got an array of numbers, but expected ${ho(e)}`);return new Ot(Ws,t)}const I={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},lB={[I.Get]:Ce(Fe(1,1/0),tx),[I.Var]:Ce(Fe(1,1),cB),[I.Has]:Ce(Fe(1,1/0),tx),[I.Id]:Ce(hB,Xr),[I.Concat]:Ce(Fe(2,1/0),Ze(En)),[I.GeometryType]:Ce(uB,Xr),[I.LineMetric]:Ce(Xr),[I.Resolution]:Ce(uf,Xr),[I.Zoom]:Ce(uf,Xr),[I.Time]:Ce(uf,Xr),[I.Any]:Ce(Fe(2,1/0),Ze(an)),[I.All]:Ce(Fe(2,1/0),Ze(an)),[I.Not]:Ce(Fe(1,1),Ze(an)),[I.Equal]:Ce(Fe(2,2),Ze(_c)),[I.NotEqual]:Ce(Fe(2,2),Ze(_c)),[I.GreaterThan]:Ce(Fe(2,2),Ze(Pe)),[I.GreaterThanOrEqualTo]:Ce(Fe(2,2),Ze(Pe)),[I.LessThan]:Ce(Fe(2,2),Ze(Pe)),[I.LessThanOrEqualTo]:Ce(Fe(2,2),Ze(Pe)),[I.Multiply]:Ce(Fe(2,1/0),nx),[I.Coalesce]:Ce(Fe(2,1/0),nx),[I.Divide]:Ce(Fe(2,2),Ze(Pe)),[I.Add]:Ce(Fe(2,1/0),Ze(Pe)),[I.Subtract]:Ce(Fe(2,2),Ze(Pe)),[I.Clamp]:Ce(Fe(3,3),Ze(Pe)),[I.Mod]:Ce(Fe(2,2),Ze(Pe)),[I.Pow]:Ce(Fe(2,2),Ze(Pe)),[I.Abs]:Ce(Fe(1,1),Ze(Pe)),[I.Floor]:Ce(Fe(1,1),Ze(Pe)),[I.Ceil]:Ce(Fe(1,1),Ze(Pe)),[I.Round]:Ce(Fe(1,1),Ze(Pe)),[I.Sin]:Ce(Fe(1,1),Ze(Pe)),[I.Cos]:Ce(Fe(1,1),Ze(Pe)),[I.Atan]:Ce(Fe(1,2),Ze(Pe)),[I.Sqrt]:Ce(Fe(1,1),Ze(Pe)),[I.Match]:Ce(Fe(4,1/0),ix,fB),[I.Between]:Ce(Fe(3,3),Ze(Pe)),[I.Interpolate]:Ce(Fe(6,1/0),ix,gB),[I.Case]:Ce(Fe(3,1/0),dB,pB),[I.In]:Ce(Fe(2,2),mB),[I.Number]:Ce(Fe(1,1/0),Ze(_c)),[I.String]:Ce(Fe(1,1/0),Ze(_c)),[I.Array]:Ce(Fe(1,1/0),Ze(Pe)),[I.Color]:Ce(Fe(1,4),Ze(Pe)),[I.Band]:Ce(Fe(1,3),Ze(Pe)),[I.Palette]:Ce(Fe(2,2),_B),[I.ToString]:Ce(Fe(1,1),Ze(an|Pe|En|Hn))};function tx(t,e,n){const i=t.length-1,s=new Array(i);for(let r=0;r<i;++r){const o=t[r+1];switch(typeof o){case"number":{s[r]=new Ot(Pe,o);break}case"string":{s[r]=new Ot(En,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}r===0&&n.properties.add(String(o))}return s}function cB(t,e,n){const i=t[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return n.variables.add(i),[new Ot(En,i)]}function hB(t,e,n){n.featureId=!0}function uB(t,e,n){n.geometryType=!0}function uf(t,e,n){n.mapState=!0}function Xr(t,e,n){const i=t[0];if(t.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function Fe(t,e){return function(n,i,s){const r=n[0],o=n.length-1;if(t===e){if(o!==t){const a=t===1?"":"s";throw new Error(`expected ${t} argument${a} for ${r}, got ${o}`)}}else if(o<t||o>e){const a=e===1/0?`${t} or more`:`${t} to ${e}`;throw new Error(`expected ${a} arguments for ${r}, got ${o}`)}}}function nx(t,e,n){const i=t.length-1,s=new Array(i);for(let r=0;r<i;++r){const o=zt(t[r+1],e,n);s[r]=o}return s}function Ze(t){return function(e,n,i){const s=e.length-1,r=new Array(s);for(let o=0;o<s;++o){const a=zt(e[o+1],t,i);r[o]=a}return r}}function dB(t,e,n){const i=t[0],s=t.length-1;if(s%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${s} instead`)}function ix(t,e,n){const i=t[0],s=t.length-1;if(s%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${s} instead`)}function fB(t,e,n){const i=t.length-1,s=En|Pe|an,r=zt(t[1],s,n),o=zt(t[t.length-1],e,n),a=new Array(i-2);for(let l=0;l<i-2;l+=2){try{const c=zt(t[l+2],r.type,n);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+1} of match expression: ${c.message}`)}try{const c=zt(t[l+3],o.type,n);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+2} of match expression: ${c.message}`)}}return[r,...a,o]}function gB(t,e,n){const i=t[1];let s;switch(i[0]){case"linear":s=1;break;case"exponential":const l=i[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);s=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const r=new Ot(Pe,s);let o;try{o=zt(t[2],Pe,n)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const a=new Array(t.length-3);for(let l=0;l<a.length;l+=2){try{const c=zt(t[l+3],Pe,n);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${c.message}`)}try{const c=zt(t[l+4],e,n);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${c.message}`)}}return[r,o,...a]}function pB(t,e,n){const i=zt(t[t.length-1],e,n),s=new Array(t.length-1);for(let r=0;r<s.length-1;r+=2){try{const o=zt(t[r+1],an,n);s[r]=o}catch(o){throw new Error(`failed to parse argument ${r} of case expression: ${o.message}`)}try{const o=zt(t[r+2],i.type,n);s[r+1]=o}catch(o){throw new Error(`failed to parse argument ${r+1} of case expression: ${o.message}`)}}return s[s.length-1]=i,s}function mB(t,e,n){let i=t[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let s;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],s=En}else s=Pe;const r=new Array(i.length);for(let a=0;a<r.length;a++)try{const l=zt(i[a],s,n);r[a]=l}catch(l){throw new Error(`failed to parse haystack item ${a} for "in" expression: ${l.message}`)}return[zt(t[1],s,n),...r]}function _B(t,e,n){let i;try{i=zt(t[1],Pe,n)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const s=t[2];if(!Array.isArray(s))throw new Error("the second argument of palette must be an array");const r=new Array(s.length);for(let o=0;o<r.length;o++){let a;try{a=zt(s[o],Hn,n)}catch(l){throw new Error(`failed to parse color at index ${o} in palette expression: ${l.message}`)}if(!(a instanceof Ot))throw new Error(`the palette color at index ${o} must be a literal value`);r[o]=a}return[i,...r]}function Ce(...t){return function(e,n,i){const s=e[0];let r;for(let o=0;o<t.length;o++){const a=t[o](e,n,i);if(o==t.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");r=a}}return new Kb(n,s,...r)}}function yB(t,e,n){const i=t[0],s=lB[i];if(!s)throw new Error(`unknown operator: ${i}`);return s(t,e,n)}function Yb(t){if(!t)return"";const e=t.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return Yb(t.getGeometries()[0]);default:return""}}function qb(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function hs(t,e,n){const i=zt(t,e,n);return _i(i)}function _i(t,e){if(t instanceof Ot){if(t.type===Hn&&typeof t.value=="string"){const i=Km(t.value);return function(){return i}}return function(){return t.value}}const n=t.operator;switch(n){case I.Number:case I.String:case I.Coalesce:return EB(t);case I.Get:case I.Var:case I.Has:return xB(t);case I.Id:return i=>i.featureId;case I.GeometryType:return i=>i.geometryType;case I.Concat:{const i=t.args.map(s=>_i(s));return s=>"".concat(...i.map(r=>r(s).toString()))}case I.Resolution:return i=>i.resolution;case I.Any:case I.All:case I.Between:case I.In:case I.Not:return SB(t);case I.Equal:case I.NotEqual:case I.LessThan:case I.LessThanOrEqualTo:case I.GreaterThan:case I.GreaterThanOrEqualTo:return wB(t);case I.Multiply:case I.Divide:case I.Add:case I.Subtract:case I.Clamp:case I.Mod:case I.Pow:case I.Abs:case I.Floor:case I.Ceil:case I.Round:case I.Sin:case I.Cos:case I.Atan:case I.Sqrt:return CB(t);case I.Case:return bB(t);case I.Match:return TB(t);case I.Interpolate:return RB(t);case I.ToString:return vB(t);default:throw new Error(`Unsupported operator ${n}`)}}function EB(t,e){const n=t.operator,i=t.args.length,s=new Array(i);for(let r=0;r<i;++r)s[r]=_i(t.args[r]);switch(n){case I.Coalesce:return r=>{for(let o=0;o<i;++o){const a=s[o](r);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case I.Number:case I.String:return r=>{for(let o=0;o<i;++o){const a=s[o](r);if(typeof a===n)return a}throw new Error(`Expected one of the values to be a ${n}`)};default:throw new Error(`Unsupported assertion operator ${n}`)}}function xB(t,e){const i=t.args[0].value;switch(t.operator){case I.Get:return s=>{const r=t.args;let o=s.properties[i];for(let a=1,l=r.length;a<l;++a){const h=r[a].value;o=o[h]}return o};case I.Var:return s=>s.variables[i];case I.Has:return s=>{const r=t.args;if(!(i in s.properties))return!1;let o=s.properties[i];for(let a=1,l=r.length;a<l;++a){const h=r[a].value;if(!o||!Object.hasOwn(o,h))return!1;o=o[h]}return!0};default:throw new Error(`Unsupported accessor operator ${t.operator}`)}}function wB(t,e){const n=t.operator,i=_i(t.args[0]),s=_i(t.args[1]);switch(n){case I.Equal:return r=>i(r)===s(r);case I.NotEqual:return r=>i(r)!==s(r);case I.LessThan:return r=>i(r)<s(r);case I.LessThanOrEqualTo:return r=>i(r)<=s(r);case I.GreaterThan:return r=>i(r)>s(r);case I.GreaterThanOrEqualTo:return r=>i(r)>=s(r);default:throw new Error(`Unsupported comparison operator ${n}`)}}function SB(t,e){const n=t.operator,i=t.args.length,s=new Array(i);for(let r=0;r<i;++r)s[r]=_i(t.args[r]);switch(n){case I.Any:return r=>{for(let o=0;o<i;++o)if(s[o](r))return!0;return!1};case I.All:return r=>{for(let o=0;o<i;++o)if(!s[o](r))return!1;return!0};case I.Between:return r=>{const o=s[0](r),a=s[1](r),l=s[2](r);return o>=a&&o<=l};case I.In:return r=>{const o=s[0](r);for(let a=1;a<i;++a)if(o===s[a](r))return!0;return!1};case I.Not:return r=>!s[0](r);default:throw new Error(`Unsupported logical operator ${n}`)}}function CB(t,e){const n=t.operator,i=t.args.length,s=new Array(i);for(let r=0;r<i;++r)s[r]=_i(t.args[r]);switch(n){case I.Multiply:return r=>{let o=1;for(let a=0;a<i;++a)o*=s[a](r);return o};case I.Divide:return r=>s[0](r)/s[1](r);case I.Add:return r=>{let o=0;for(let a=0;a<i;++a)o+=s[a](r);return o};case I.Subtract:return r=>s[0](r)-s[1](r);case I.Clamp:return r=>{const o=s[0](r),a=s[1](r);if(o<a)return a;const l=s[2](r);return o>l?l:o};case I.Mod:return r=>s[0](r)%s[1](r);case I.Pow:return r=>Math.pow(s[0](r),s[1](r));case I.Abs:return r=>Math.abs(s[0](r));case I.Floor:return r=>Math.floor(s[0](r));case I.Ceil:return r=>Math.ceil(s[0](r));case I.Round:return r=>Math.round(s[0](r));case I.Sin:return r=>Math.sin(s[0](r));case I.Cos:return r=>Math.cos(s[0](r));case I.Atan:return i===2?r=>Math.atan2(s[0](r),s[1](r)):r=>Math.atan(s[0](r));case I.Sqrt:return r=>Math.sqrt(s[0](r));default:throw new Error(`Unsupported numeric operator ${n}`)}}function bB(t,e){const n=t.args.length,i=new Array(n);for(let s=0;s<n;++s)i[s]=_i(t.args[s]);return s=>{for(let r=0;r<n-1;r+=2)if(i[r](s))return i[r+1](s);return i[n-1](s)}}function TB(t,e){const n=t.args.length,i=new Array(n);for(let s=0;s<n;++s)i[s]=_i(t.args[s]);return s=>{const r=i[0](s);for(let o=1;o<n-1;o+=2)if(r===i[o](s))return i[o+1](s);return i[n-1](s)}}function RB(t,e){const n=t.args.length,i=new Array(n);for(let s=0;s<n;++s)i[s]=_i(t.args[s]);return s=>{const r=i[0](s),o=i[1](s);let a,l;for(let c=2;c<n;c+=2){const h=i[c](s);let u=i[c+1](s);const d=Array.isArray(u);if(d&&(u=iB(u)),h>=o)return c===2?u:d?AB(r,o,a,l,h,u):Ma(r,o,a,l,h,u);a=h,l=u}return l}}function vB(t,e){const n=t.operator,i=t.args.length,s=new Array(i);for(let r=0;r<i;++r)s[r]=_i(t.args[r]);switch(n){case I.ToString:return r=>{const o=s[0](r);return t.args[0].type===Hn?Ym(o):o.toString()};default:throw new Error(`Unsupported convert operator ${n}`)}}function Ma(t,e,n,i,s,r){const o=s-n;if(o===0)return i;const a=e-n,l=t===1?a/o:(Math.pow(t,a)-1)/(Math.pow(t,o)-1);return i+l*(r-i)}function AB(t,e,n,i,s,r){if(s-n===0)return i;const a=QE(i),l=QE(r);let c=l[2]-a[2];c>180?c-=360:c<-180&&(c+=360);const h=[Ma(t,e,n,a[0],s,l[0]),Ma(t,e,n,a[1],s,l[1]),a[2]+Ma(t,e,n,0,s,c),Ma(t,e,n,i[3],s,r[3])];return sB(h)}const ke={IDLE:0,LOADING:1,LOADED:2,ERROR:3};function IB(t,e,n){const i=t;let s=!0,r=!1,o=!1;const a=[xh(i,xe.LOAD,function(){o=!0,r||e()})];return i.src&&ub?(r=!0,i.decode().then(function(){s&&e()}).catch(function(l){s&&(o?e():n())})):a.push(xh(i,xe.ERROR,n)),function(){s=!1,a.forEach(at)}}function PB(t,e){return new Promise((n,i)=>{function s(){o(),n(t)}function r(){o(),i(new Error("Image load error"))}function o(){t.removeEventListener("load",s),t.removeEventListener("error",r)}t.addEventListener("load",s),t.addEventListener("error",r)})}function MB(t,e){return e&&(t.src=e),t.src&&ub?new Promise((n,i)=>t.decode().then(()=>n(t)).catch(s=>t.complete&&t.width?n(t):i(s))):PB(t)}class FB{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const n in this.cache_){const i=this.cache_[n];(e++&3)===0&&!i.hasListener()&&(delete this.cache_[n],delete this.patternCache_[n],--this.cacheSize_)}}}get(e,n,i){const s=df(e,n,i);return s in this.cache_?this.cache_[s]:null}getPattern(e,n,i){const s=df(e,n,i);return s in this.patternCache_?this.patternCache_[s]:null}set(e,n,i,s,r){const o=df(e,n,i),a=o in this.cache_;this.cache_[o]=s,r&&(s.getImageState()===ke.IDLE&&s.load(),s.getImageState()===ke.LOADING?s.ready().then(()=>{this.patternCache_[o]=Ah().createPattern(s.getImage(1),"repeat")}):this.patternCache_[o]=Ah().createPattern(s.getImage(1),"repeat")),a||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function df(t,e,n){const i=n?Vs(n):"null";return e+":"+t+":"+i}const si=new FB;let wa=null;class Zb extends Gl{constructor(e,n,i,s,r){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=i,this.canvas_={},this.color_=r,this.imageState_=s===void 0?ke.IDLE:s,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=n,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===ke.LOADED){wa||(wa=Et(1,1,void 0,{willReadFrequently:!0})),wa.drawImage(this.image_,0,0);try{wa.getImageData(0,0,1,1),this.tainted_=!1}catch{wa=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(xe.CHANGE)}handleImageError_(){this.imageState_=ke.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=ke.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],n=this.size_[1],i=Et(e,n);i.fillRect(0,0,e,n),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===ke.IDLE){this.image_||this.initializeImage_(),this.imageState_=ke.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&MB(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==ke.LOADED)return;const n=this.image_,i=Et(Math.ceil(n.width*e),Math.ceil(n.height*e)),s=i.canvas;i.scale(e,e),i.drawImage(n,0,0),i.globalCompositeOperation="multiply",i.fillStyle=tB(this.color_),i.fillRect(0,0,s.width/e,s.height/e),i.globalCompositeOperation="destination-in",i.drawImage(n,0,0),this.canvas_[e]=s}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===ke.LOADED||this.imageState_===ke.ERROR)e();else{const n=()=>{(this.imageState_===ke.LOADED||this.imageState_===ke.ERROR)&&(this.removeEventListener(xe.CHANGE,n),e())};this.addEventListener(xe.CHANGE,n)}})),this.ready_}}function Jm(t,e,n,i,s,r){let o=e===void 0?void 0:si.get(e,n,s);return o||(o=new Zb(t,t&&"src"in t?t.src||void 0:e,n,i,s),si.set(e,n,s,o,r)),r&&o&&!si.getPattern(e,n,s)&&si.set(e,n,s,o,r),o}function Mi(t){return t?Array.isArray(t)?Ym(t):typeof t=="object"&&"src"in t?DB(t):t:null}function DB(t){if(!t.offset||!t.size)return si.getPattern(t.src,"anonymous",t.color);const e=t.src+":"+t.offset,n=si.getPattern(e,void 0,t.color);if(n)return n;const i=si.get(t.src,"anonymous",null);if(i.getImageState()!==ke.LOADED)return null;const s=Et(t.size[0],t.size[1]);return s.drawImage(i.getImage(1),t.offset[0],t.offset[1],t.size[0],t.size[1],0,0,t.size[0],t.size[1]),Jm(s.canvas,e,void 0,ke.LOADED,t.color,!0),si.getPattern(e,void 0,t.color)}const Jb="10px sans-serif",Fn="#000",Uo="round",is=[],ss=0,Go="round",wl=10,Sl="#000",Cl="center",Ph="middle",yr=[0,0,0,0],bl=1,io=new ji;let Sa=null,sx;const Ig={},OB=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function LB(t,e,n){return`${t} ${e} 16px "${n}"`}const kB=function(){let e,n;async function i(r){await n.ready;const o=await n.load(r);if(o.length===0)return!1;const a=Tg(r),l=a.families[0].toLowerCase(),c=a.weight;return o.some(h=>{const u=h.family.replace(/^['"]|['"]$/g,"").toLowerCase(),d=bg[h.weight]||h.weight;return u===l&&h.style===a.style&&d==c})}async function s(){await n.ready;let r=!0;const o=io.getProperties(),a=Object.keys(o).filter(l=>o[l]<100);for(let l=a.length-1;l>=0;--l){const c=a[l];let h=o[c];h<100&&(await i(c)?(Fr(Ig),io.set(c,100)):(h+=10,io.set(c,h,!0),h<100&&(r=!1)))}e=void 0,r||(e=setTimeout(s,100))}return async function(r){n||(n=hu?self.fonts:document.fonts);const o=Tg(r);if(!o)return;const a=o.families;let l=!1;for(const c of a){if(OB.has(c))continue;const h=LB(o.style,o.weight,c);io.get(h)===void 0&&(io.set(h,0,!0),l=!0)}l&&(clearTimeout(e),e=setTimeout(s,100))}}(),NB=function(){let t;return function(e){let n=Ig[e];if(n==null){if(hu){const i=Tg(e),s=Qb(e,"Žg");n=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(s.actualBoundingBoxAscent+s.actualBoundingBoxDescent)}else t||(t=document.createElement("div"),t.innerHTML="M",t.style.minHeight="0",t.style.maxHeight="none",t.style.height="auto",t.style.padding="0",t.style.border="none",t.style.position="absolute",t.style.display="block",t.style.left="-99999px"),t.style.font=e,document.body.appendChild(t),n=t.offsetHeight,document.body.removeChild(t);Ig[e]=n}return n}}();function Qb(t,e){return Sa||(Sa=Et(1,1)),t!=sx&&(Sa.font=t,sx=Sa.font),Sa.measureText(e)}function eT(t,e){return Qb(t,e).width}function rx(t,e,n){if(e in n)return n[e];const i=e.split(`
`).reduce((s,r)=>Math.max(s,eT(t,r)),0);return n[e]=i,i}function BB(t,e){const n=[],i=[],s=[];let r=0,o=0,a=0,l=0;for(let c=0,h=e.length;c<=h;c+=2){const u=e[c];if(u===`
`||c===h){r=Math.max(r,o),s.push(o),o=0,a+=l,l=0;continue}const d=e[c+1]||t.font,f=eT(d,u);n.push(f),o+=f;const g=NB(d);i.push(g),l=Math.max(l,g)}return{width:r,height:a,widths:n,heights:i,lineWidths:s}}function UB(t,e,n,i,s,r,o,a,l,c,h){t.save(),n!==1&&(t.globalAlpha===void 0?t.globalAlpha=u=>u.globalAlpha*=n:t.globalAlpha*=n),e&&t.transform.apply(t,e),i.contextInstructions?(t.translate(l,c),t.scale(h[0],h[1]),GB(i,t)):h[0]<0||h[1]<0?(t.translate(l,c),t.scale(h[0],h[1]),t.drawImage(i,s,r,o,a,0,0,o,a)):t.drawImage(i,s,r,o,a,l,c,o*h[0],a*h[1]),t.restore()}function GB(t,e){const n=t.contextInstructions;for(let i=0,s=n.length;i<s;i+=2)Array.isArray(n[i+1])?e[n[i]].apply(e,n[i+1]):e[n[i]]=n[i+1]}class Ru{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=Ct(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Ru({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return Se()}getImage(e){return Se()}getHitDetectionImage(){return Se()}getPixelRatio(e){return 1}getImageState(){return Se()}getImageSize(){return Se()}getOrigin(){return Se()}getSize(){return Se()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Ct(e)}listenImageChange(e){Se()}load(){Se()}unlistenImageChange(e){Se()}ready(){return Promise.resolve()}}class vu extends Ru{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?ke.LOADING:ke.LOADED,this.imageState_===ke.LOADING&&this.ready().then(()=>this.imageState_=ke.LOADED),this.render()}clone(){const e=this.getScale(),n=new vu({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return n.setOpacity(this.getOpacity()),n}getAnchor(){const e=this.size_,n=this.getDisplacement(),i=this.getScaleArray();return[e[0]/2-n[0]/i[0],e[1]/2+n[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){const n=this.fill_?.getKey(),i=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${n}`+Object.values(this.renderOptions_).join(",");let s=si.get(i,null,null)?.getImage(1);if(!s){const r=this.renderOptions_,o=Math.ceil(r.size*e),a=Et(o,o);this.draw_(r,a,e),s=a.canvas,si.set(i,null,null,new Zb(s,void 0,null,ke.LOADED,null))}return s}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,n,i){if(n===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return n;let s=this.radius,r=this.radius2_===void 0?s:this.radius2_;if(s<r){const b=s;s=r,r=b}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,l=r*Math.sin(a),c=Math.sqrt(r*r-l*l),h=s-c,u=Math.sqrt(l*l+h*h),d=u/l;if(e==="miter"&&d<=i)return d*n;const f=n/2/d,g=n/2*(h/u),p=Math.sqrt((s+f)*(s+f)+g*g)-s;if(this.radius2_===void 0||e==="bevel")return p*2;const y=s*Math.sin(a),_=Math.sqrt(s*s-y*y),x=r-_,w=Math.sqrt(y*y+x*x)/y;if(w<=i){const b=w*n/2-r-s;return 2*Math.max(p,b)}return p*2}createRenderOptions(){let e=Uo,n=Go,i=0,s=null,r=0,o,a=0;this.stroke_&&(o=Mi(this.stroke_.getColor()??Sl),a=this.stroke_.getWidth()??bl,s=this.stroke_.getLineDash(),r=this.stroke_.getLineDashOffset()??0,n=this.stroke_.getLineJoin()??Go,e=this.stroke_.getLineCap()??Uo,i=this.stroke_.getMiterLimit()??wl);const l=this.calculateLineJoinSize_(n,a,i),c=Math.max(this.radius,this.radius2_||0),h=Math.ceil(2*c+l);return{strokeStyle:o,strokeWidth:a,size:h,lineCap:e,lineDash:s,lineDashOffset:r,lineJoin:n,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,n,i){if(n.scale(i,i),n.translate(e.size/2,e.size/2),this.createPath_(n),this.fill_){let s=this.fill_.getColor();s===null&&(s=Fn),n.fillStyle=Mi(s),n.fill()}e.strokeStyle&&(n.strokeStyle=e.strokeStyle,n.lineWidth=e.strokeWidth,e.lineDash&&(n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset),n.lineCap=e.lineCap,n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit,n.stroke())}createHitDetectionCanvas_(e){let n;if(this.fill_){let i=this.fill_.getColor(),s=0;typeof i=="string"&&(i=Vs(i)),i===null?s=1:Array.isArray(i)&&(s=i.length===4?i[3]:1),s===0&&(n=Et(e.size,e.size),this.drawHitDetectionCanvas_(e,n))}return n?n.canvas:this.getImage(1)}createPath_(e){let n=this.points_;const i=this.radius;if(n===1/0)e.arc(0,0,i,0,2*Math.PI);else{const s=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(n*=2);const r=this.angle_-Math.PI/2,o=2*Math.PI/n;for(let a=0;a<n;a++){const l=r+a*o,c=a%2===0?i:s;e.lineTo(c*Math.cos(l),c*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,n){n.translate(e.size/2,e.size/2),this.createPath_(n),n.fillStyle=Fn,n.fill(),e.strokeStyle&&(n.strokeStyle=e.strokeStyle,n.lineWidth=e.strokeWidth,e.lineDash&&(n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset),n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit,n.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class ia extends vu{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),n=new ia({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return n.setOpacity(this.getOpacity()),n}setRadius(e){this.radius=e,this.render()}}class Oi{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Oi({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const n=Jm(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));n.ready().then(()=>{this.patternImage_=null}),n.getImageState()===ke.IDLE&&n.load(),n.getImageState()===ke.LOADING&&(this.patternImage_=n)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?me(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:Vs(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}function ox(t,e,n,i){return n!==void 0&&i!==void 0?[n/t,i/e]:n!==void 0?n/t:i!==void 0?i/e:1}class Au extends Ru{constructor(e){e=e||{};const n=e.opacity!==void 0?e.opacity:1,i=e.rotation!==void 0?e.rotation:0,s=e.scale!==void 0?e.scale:1,r=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:n,rotation:i,scale:s,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:r,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let a=e.src;Je(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||me(o)),Je(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),Je(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(e.src!==void 0?l=ke.IDLE:o!==void 0&&("complete"in o?o.complete?l=o.src?ke.LOADED:ke.IDLE:l=ke.LOADING:l=ke.LOADED),this.color_=e.color!==void 0?Vs(e.color):null,this.iconImage_=Jm(o,a,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let c,h;if(e.size)[c,h]=e.size;else{const u=this.getImage(1);if(u.width&&u.height)c=u.width,h=u.height;else if(u instanceof HTMLImageElement){this.initialOptions_=e;const d=()=>{if(this.unlistenImageChange(d),!this.initialOptions_)return;const f=this.iconImage_.getSize();this.setScale(ox(f[0],f[1],e.width,e.height))};this.listenImageChange(d);return}}c!==void 0&&this.setScale(ox(c,h,e.width,e.height))}}clone(){let e,n,i;return this.initialOptions_?(n=this.initialOptions_.width,i=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new Au({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:n,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const s=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!s)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=s[0]),this.anchorYUnits_=="fraction"&&(e[1]*=s[1])}if(this.anchorOrigin_!="top-left"){if(!s)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+s[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+s[1])}this.normalizedAnchor_=e}const n=this.getDisplacement(),i=this.getScaleArray();return[e[0]-n[0]/i[0],e[1]+n[1]/i[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const n=this.getSize(),i=this.iconImage_.getSize();if(!n||!i)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=i[0]-n[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=i[1]-n[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==ke.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==ke.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(xe.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(xe.CHANGE,e)}ready(){return this.iconImage_.ready()}}class Li{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new Li({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}class Nn{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=ax,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new Nn({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(n){return n.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=ax,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function $B(t){let e;if(typeof t=="function")e=t;else{let n;Array.isArray(t)?n=t:(Je(typeof t.getZIndex=="function","Expected an `Style` or an array of `Style`"),n=[t]),e=function(){return n}}return e}let ff=null;function tT(t,e){if(!ff){const n=new Oi({color:"rgba(255,255,255,0.4)"}),i=new Li({color:"#3399CC",width:1.25});ff=[new Nn({image:new ia({fill:n,stroke:i,radius:5}),fill:n,stroke:i})]}return ff}function Qm(){const t={},e=[255,255,255,1],n=[0,153,255,1],i=3;return t.Polygon=[new Nn({fill:new Oi({color:[255,255,255,.5]})})],t.MultiPolygon=t.Polygon,t.LineString=[new Nn({stroke:new Li({color:e,width:i+2})}),new Nn({stroke:new Li({color:n,width:i})})],t.MultiLineString=t.LineString,t.Circle=t.Polygon.concat(t.LineString),t.Point=[new Nn({image:new ia({radius:i*2,fill:new Oi({color:n}),stroke:new Li({color:e,width:i/2})}),zIndex:1/0})],t.MultiPoint=t.Point,t.GeometryCollection=t.Polygon.concat(t.LineString,t.Point),t}function ax(t){return t.getGeometry()}const jB="#333";class Iu{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=Ct(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Oi({color:jB}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Iu({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=Ct(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}function zB(t){return!0}function HB(t){const e=Zm(),n=XB(t,e),i=qb();return function(s,r){if(i.properties=s.getPropertiesInternal(),i.resolution=r,e.featureId){const o=s.getId();o!==void 0?i.featureId=o:i.featureId=null}return e.geometryType&&(i.geometryType=Yb(s.getGeometry())),n(i)}}function lx(t){const e=Zm(),n=t.length,i=new Array(n);for(let o=0;o<n;++o)i[o]=Pg(t[o],e);const s=qb(),r=new Array(n);return function(o,a){if(s.properties=o.getPropertiesInternal(),s.resolution=a,e.featureId){const c=o.getId();c!==void 0?s.featureId=c:s.featureId=null}let l=0;for(let c=0;c<n;++c){const h=i[c](s);h&&(r[l]=h,l+=1)}return r.length=l,r}}function XB(t,e){const n=t.length,i=new Array(n);for(let s=0;s<n;++s){const r=t[s],o="filter"in r?hs(r.filter,an,e):zB;let a;if(Array.isArray(r.style)){const l=r.style.length;a=new Array(l);for(let c=0;c<l;++c)a[c]=Pg(r.style[c],e)}else a=[Pg(r.style,e)];i[s]={filter:o,styles:a}}return function(s){const r=[];let o=!1;for(let a=0;a<n;++a){const l=i[a].filter;if(l(s)&&!(t[a].else&&o)){o=!0;for(const c of i[a].styles){const h=c(s);h&&r.push(h)}}}return r}}function Pg(t,e){const n=Tl(t,"",e),i=Rl(t,"",e),s=VB(t,e),r=WB(t,e),o=On(t,"z-index",e);if(!n&&!i&&!s&&!r&&!Ir(t))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(t));const a=new Nn;return function(l){let c=!0;if(n){const h=n(l);h&&(c=!1),a.setFill(h)}if(i){const h=i(l);h&&(c=!1),a.setStroke(h)}if(s){const h=s(l);h&&(c=!1),a.setText(h)}if(r){const h=r(l);h&&(c=!1),a.setImage(h)}return o&&a.setZIndex(o(l)),c?null:a}}function Tl(t,e,n){let i;if(e+"fill-pattern-src"in t)i=ZB(t,e+"fill-",n);else{if(t[e+"fill-color"]==="none")return r=>null;i=e_(t,e+"fill-color",n)}if(!i)return null;const s=new Oi;return function(r){const o=i(r);return o===Wm?null:(s.setColor(o),s)}}function Rl(t,e,n){const i=On(t,e+"stroke-width",n),s=e_(t,e+"stroke-color",n);if(!i&&!s)return null;const r=Zi(t,e+"stroke-line-cap",n),o=Zi(t,e+"stroke-line-join",n),a=nT(t,e+"stroke-line-dash",n),l=On(t,e+"stroke-line-dash-offset",n),c=On(t,e+"stroke-miter-limit",n),h=new Li;return function(u){if(s){const d=s(u);if(d===Wm)return null;h.setColor(d)}if(i&&h.setWidth(i(u)),r){const d=r(u);if(d!=="butt"&&d!=="round"&&d!=="square")throw new Error("Expected butt, round, or square line cap");h.setLineCap(d)}if(o){const d=o(u);if(d!=="bevel"&&d!=="round"&&d!=="miter")throw new Error("Expected bevel, round, or miter line join");h.setLineJoin(d)}return a&&h.setLineDash(a(u)),l&&h.setLineDashOffset(l(u)),c&&h.setMiterLimit(c(u)),h}}function VB(t,e){const n="text-",i=Zi(t,n+"value",e);if(!i)return null;const s=Tl(t,n,e),r=Tl(t,n+"background-",e),o=Rl(t,n,e),a=Rl(t,n+"background-",e),l=Zi(t,n+"font",e),c=On(t,n+"max-angle",e),h=On(t,n+"offset-x",e),u=On(t,n+"offset-y",e),d=Co(t,n+"overflow",e),f=Zi(t,n+"placement",e),g=On(t,n+"repeat",e),m=Pu(t,n+"scale",e),p=Co(t,n+"rotate-with-view",e),y=On(t,n+"rotation",e),_=Zi(t,n+"align",e),x=Zi(t,n+"justify",e),E=Zi(t,n+"baseline",e),w=Co(t,n+"keep-upright",e),b=nT(t,n+"padding",e),v=Mu(t,n+"declutter-mode"),A=new Iu({declutterMode:v});return function(P){if(A.setText(i(P)),s&&A.setFill(s(P)),r&&A.setBackgroundFill(r(P)),o&&A.setStroke(o(P)),a&&A.setBackgroundStroke(a(P)),l&&A.setFont(l(P)),c&&A.setMaxAngle(c(P)),h&&A.setOffsetX(h(P)),u&&A.setOffsetY(u(P)),d&&A.setOverflow(d(P)),f){const M=f(P);if(M!=="point"&&M!=="line")throw new Error("Expected point or line for text-placement");A.setPlacement(M)}if(g&&A.setRepeat(g(P)),m&&A.setScale(m(P)),p&&A.setRotateWithView(p(P)),y&&A.setRotation(y(P)),_){const M=_(P);if(M!=="left"&&M!=="center"&&M!=="right"&&M!=="end"&&M!=="start")throw new Error("Expected left, right, center, start, or end for text-align");A.setTextAlign(M)}if(x){const M=x(P);if(M!=="left"&&M!=="right"&&M!=="center")throw new Error("Expected left, right, or center for text-justify");A.setJustify(M)}if(E){const M=E(P);if(M!=="bottom"&&M!=="top"&&M!=="middle"&&M!=="alphabetic"&&M!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");A.setTextBaseline(M)}return b&&A.setPadding(b(P)),w&&A.setKeepUpright(w(P)),A}}function WB(t,e){return"icon-src"in t?KB(t,e):"shape-points"in t?YB(t,e):"circle-radius"in t?qB(t,e):null}function KB(t,e){const n="icon-",i=n+"src",s=iT(t[i],i),r=Mh(t,n+"anchor",e),o=Pu(t,n+"scale",e),a=On(t,n+"opacity",e),l=Mh(t,n+"displacement",e),c=On(t,n+"rotation",e),h=Co(t,n+"rotate-with-view",e),u=hx(t,n+"anchor-origin"),d=ux(t,n+"anchor-x-units"),f=ux(t,n+"anchor-y-units"),g=tU(t,n+"color"),m=QB(t,n+"cross-origin"),p=eU(t,n+"offset"),y=hx(t,n+"offset-origin"),_=Fh(t,n+"width"),x=Fh(t,n+"height"),E=JB(t,n+"size"),w=Mu(t,n+"declutter-mode"),b=new Au({src:s,anchorOrigin:u,anchorXUnits:d,anchorYUnits:f,color:g,crossOrigin:m,offset:p,offsetOrigin:y,height:x,width:_,size:E,declutterMode:w});return function(v){return a&&b.setOpacity(a(v)),l&&b.setDisplacement(l(v)),c&&b.setRotation(c(v)),h&&b.setRotateWithView(h(v)),o&&b.setScale(o(v)),r&&b.setAnchor(r(v)),b}}function YB(t,e){const n="shape-",i=n+"points",s=n+"radius",r=Mg(t[i],i),o=Mg(t[s],s),a=Tl(t,n,e),l=Rl(t,n,e),c=Pu(t,n+"scale",e),h=Mh(t,n+"displacement",e),u=On(t,n+"rotation",e),d=Co(t,n+"rotate-with-view",e),f=Fh(t,n+"radius2"),g=Fh(t,n+"angle"),m=Mu(t,n+"declutter-mode"),p=new vu({points:r,radius:o,radius2:f,angle:g,declutterMode:m});return function(y){return a&&p.setFill(a(y)),l&&p.setStroke(l(y)),h&&p.setDisplacement(h(y)),u&&p.setRotation(u(y)),d&&p.setRotateWithView(d(y)),c&&p.setScale(c(y)),p}}function qB(t,e){const n="circle-",i=Tl(t,n,e),s=Rl(t,n,e),r=On(t,n+"radius",e),o=Pu(t,n+"scale",e),a=Mh(t,n+"displacement",e),l=On(t,n+"rotation",e),c=Co(t,n+"rotate-with-view",e),h=Mu(t,n+"declutter-mode"),u=new ia({radius:5,declutterMode:h});return function(d){return r&&u.setRadius(r(d)),i&&u.setFill(i(d)),s&&u.setStroke(s(d)),a&&u.setDisplacement(a(d)),l&&u.setRotation(l(d)),c&&u.setRotateWithView(c(d)),o&&u.setScale(o(d)),u}}function On(t,e,n){if(!(e in t))return;const i=hs(t[e],Pe,n);return function(s){return Mg(i(s),e)}}function Zi(t,e,n){if(!(e in t))return null;const i=hs(t[e],En,n);return function(s){return iT(i(s),e)}}function ZB(t,e,n){const i=Zi(t,e+"pattern-src",n),s=cx(t,e+"pattern-offset",n),r=cx(t,e+"pattern-size",n),o=e_(t,e+"color",n);return function(a){return{src:i(a),offset:s&&s(a),size:r&&r(a),color:o&&o(a)}}}function Co(t,e,n){if(!(e in t))return null;const i=hs(t[e],an,n);return function(s){const r=i(s);if(typeof r!="boolean")throw new Error(`Expected a boolean for ${e}`);return r}}function e_(t,e,n){if(!(e in t))return null;const i=hs(t[e],Hn,n);return function(s){return sT(i(s),e)}}function nT(t,e,n){if(!(e in t))return null;const i=hs(t[e],Ws,n);return function(s){return Vl(i(s),e)}}function Mh(t,e,n){if(!(e in t))return null;const i=hs(t[e],Ws,n);return function(s){const r=Vl(i(s),e);if(r.length!==2)throw new Error(`Expected two numbers for ${e}`);return r}}function cx(t,e,n){if(!(e in t))return null;const i=hs(t[e],Ws,n);return function(s){return rT(i(s),e)}}function Pu(t,e,n){if(!(e in t))return null;const i=hs(t[e],Ws|Pe,n);return function(s){return nU(i(s),e)}}function Fh(t,e){const n=t[e];if(n!==void 0){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}}function JB(t,e){const n=t[e];if(n!==void 0){if(typeof n=="number")return Ct(n);if(!Array.isArray(n))throw new Error(`Expected a number or size array for ${e}`);if(n.length!==2||typeof n[0]!="number"||typeof n[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return n}}function QB(t,e){const n=t[e];if(n!==void 0){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}}function hx(t,e){const n=t[e];if(n!==void 0){if(n!=="bottom-left"&&n!=="bottom-right"&&n!=="top-left"&&n!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return n}}function ux(t,e){const n=t[e];if(n!==void 0){if(n!=="pixels"&&n!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return n}}function eU(t,e){const n=t[e];if(n!==void 0)return Vl(n,e)}function Mu(t,e){const n=t[e];if(n!==void 0){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);if(n!=="declutter"&&n!=="obstacle"&&n!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return n}}function tU(t,e){const n=t[e];if(n!==void 0)return sT(n,e)}function Vl(t,e){if(!Array.isArray(t))throw new Error(`Expected an array for ${e}`);const n=t.length;for(let i=0;i<n;++i)if(typeof t[i]!="number")throw new Error(`Expected an array of numbers for ${e}`);return t}function iT(t,e){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}function Mg(t,e){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}function sT(t,e){if(typeof t=="string")return t;const n=Vl(t,e),i=n.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return n}function rT(t,e){const n=Vl(t,e);if(n.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return n}function nU(t,e){return typeof t=="number"?t:rT(t,e)}const dx={RENDER_ORDER:"renderOrder"};class oT extends Tu{constructor(e){e=e||{};const n=Object.assign({},e);delete n.style,delete n.renderBuffer,delete n.updateWhileAnimating,delete n.updateWhileInteracting,super(n),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(dx.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,n){const i=this.getDeclutter();i in e.declutter||(e.declutter[i]=new Vb(9)),this.getRenderer().renderDeclutter(e,n)}setRenderOrder(e){this.set(dx.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?tT:e;const n=iU(e);this.styleFunction_=e===null?void 0:$B(n),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function iU(t){if(t===void 0)return tT;if(!t)return null;if(typeof t=="function"||t instanceof Nn)return t;if(!Array.isArray(t))return lx([t]);if(t.length===0)return[];const e=t.length,n=t[0];if(n instanceof Nn){const s=new Array(e);for(let r=0;r<e;++r){const o=t[r];if(!(o instanceof Nn))throw new Error("Expected a list of style instances");s[r]=o}return s}if("style"in n){const s=new Array(e);for(let r=0;r<e;++r){const o=t[r];if(!("style"in o))throw new Error("Expected a list of rules with a style property");s[r]=o}return HB(s)}return lx(t)}class Qa extends hi{constructor(e,n,i,s){super(e),this.inversePixelTransform=n,this.frameState=i,this.context=s}}class sU extends Ul{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,n){Se()}calculateMatrices2D(e){const n=e.viewState,i=e.coordinateToPixelTransform,s=e.pixelToCoordinateTransform;mi(i,e.size[0]/2,e.size[1]/2,1/n.resolution,-1/n.resolution,-n.rotation,-n.center[0],-n.center[1]),Rm(s,i)}forEachFeatureAtCoordinate(e,n,i,s,r,o,a,l){let c;const h=n.viewState;function u(E,w,b,v){return r.call(o,w,E?b:null,v)}const d=h.projection,f=_b(e.slice(),d),g=[[0,0]];if(d.canWrapX()&&s){const E=d.getExtent(),w=Ve(E);g.push([-w,0],[w,0])}const m=n.layerStatesArray,p=m.length,y=[],_=[];for(let E=0;E<g.length;E++)for(let w=p-1;w>=0;--w){const b=m[w],v=b.layer;if(v.hasRenderer()&&Vm(b,h)&&a.call(l,v)){const A=v.getRenderer(),P=v.getSource();if(A&&P){const M=P.getWrapX()?f:e,Y=u.bind(null,b.managed);_[0]=M[0]+g[E][0],_[1]=M[1]+g[E][1],c=A.forEachFeatureAtCoordinate(_,n,i,Y,y)}if(c)return c}}if(y.length===0)return;const x=1/y.length;return y.forEach((E,w)=>E.distanceSq+=w*x),y.sort((E,w)=>E.distanceSq-w.distanceSq),y.some(E=>c=E.callback(E.feature,E.layer,E.geometry)),c}hasFeatureAtCoordinate(e,n,i,s,r,o){return this.forEachFeatureAtCoordinate(e,n,i,s,zs,this,r,o)!==void 0}getMap(){return this.map_}renderFrame(e){Se()}scheduleExpireIconCache(e){si.canExpireCache()&&e.postRenderFunctions.push(rU)}}function rU(t,e){si.expire()}class oU extends sU{constructor(e){super(e),this.fontChangeListenerKey_=He(io,Lo.PROPERTYCHANGE,e.redrawText,e),this.element_=document.createElement("div");const n=this.element_.style;n.position="absolute",n.width="100%",n.height="100%",n.zIndex="0",this.element_.className=Xl+" ol-layers";const i=e.getViewport();i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,n){const i=this.getMap();if(i.hasListener(e)){const s=new Qa(e,void 0,n);i.dispatchEvent(s)}}disposeInternal(){at(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(Ut.PRECOMPOSE,e);const n=e.layerStatesArray.sort((a,l)=>a.zIndex-l.zIndex);n.some(a=>a.layer instanceof oT&&a.layer.getDeclutter())&&(e.declutter={});const s=e.viewState;this.children_.length=0;const r=[];let o=null;for(let a=0,l=n.length;a<l;++a){const c=n[a];e.layerIndex=a;const h=c.layer,u=h.getSourceState();if(!Vm(c,s)||u!="ready"&&u!="undefined"){h.unrender();continue}const d=h.render(e,o);d&&(d!==o&&(this.children_.push(d),o=d),r.push(c))}this.declutter(e,r),x3(this.element_,this.children_),this.dispatchRenderEvent(Ut.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,n){if(e.declutter){for(let i=n.length-1;i>=0;--i){const s=n[i],r=s.layer;r.getDeclutter()&&r.renderDeclutter(e,s)}n.forEach(i=>i.layer.renderDeferred(e))}}}function aT(t){if(t instanceof Tu){t.setMapInternal(null);return}t instanceof na&&t.getLayers().forEach(aT)}function lT(t,e){if(t instanceof Tu){t.setMapInternal(e);return}if(t instanceof na){const n=t.getLayers().getArray();for(let i=0,s=n.length;i<s;++i)lT(n[i],e)}}let aU=class extends ji{constructor(e){super(),e=e||{},this.on,this.once,this.un;const n=lU(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:Xk,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=hn(),this.pixelToCoordinateTransform_=hn(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=n.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=n.controls||Bb(),this.interactions=n.interactions||z3({onFocusOnly:!0}),this.overlays_=n.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new Kk(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(nn.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(nn.VIEW,this.handleViewChanged_),this.addChangeListener(nn.SIZE,this.handleSizeChanged_),this.addChangeListener(nn.TARGET,this.handleTargetChanged_),this.setProperties(n.values);const i=this;e.view&&!(e.view instanceof Ii)&&e.view.then(function(s){i.setView(new Ii(s))}),this.controls.addEventListener(It.ADD,s=>{s.element.setMap(this)}),this.controls.addEventListener(It.REMOVE,s=>{s.element.setMap(null)}),this.interactions.addEventListener(It.ADD,s=>{s.element.setMap(this)}),this.interactions.addEventListener(It.REMOVE,s=>{s.element.setMap(null)}),this.overlays_.addEventListener(It.ADD,s=>{this.addOverlayInternal_(s.element)}),this.overlays_.addEventListener(It.REMOVE,s=>{const r=s.element.getId();r!==void 0&&delete this.overlayIdIndex_[r.toString()],s.element.setMap(null)}),this.controls.forEach(s=>{s.setMap(this)}),this.interactions.forEach(s=>{s.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){lT(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const n=e.getId();n!==void 0&&(this.overlayIdIndex_[n.toString()]=e),e.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,n,i){if(!this.frameState_||!this.renderer_)return;const s=this.getCoordinateFromPixelInternal(e);i=i!==void 0?i:{};const r=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:zs,a=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(s,this.frameState_,r,a,n,null,o,null)}getFeaturesAtPixel(e,n){const i=[];return this.forEachFeatureAtPixel(e,function(s){i.push(s)},n),i}getAllLayers(){const e=[];function n(i){i.forEach(function(s){s instanceof na?n(s.getLayers()):e.push(s)})}return n(this.getLayers()),e}hasFeatureAtPixel(e,n){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(e);n=n!==void 0?n:{};const s=n.layerFilter!==void 0?n.layerFilter:zs,r=n.hitTolerance!==void 0?n.hitTolerance:0,o=n.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,r,o,s,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const i=this.viewport_.getBoundingClientRect(),s=this.getSize(),r=i.width/s[0],o=i.height/s[1],a="changedTouches"in e?e.changedTouches[0]:e;return[(a.clientX-i.left)/r,(a.clientY-i.top)/o]}getTarget(){return this.get(nn.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return Xs(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const n=this.frameState_;return n?vt(n.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const n=this.overlayIdIndex_[e.toString()];return n!==void 0?n:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(nn.LAYERGROUP)}setLayers(e){const n=this.getLayerGroup();if(e instanceof Vn){n.setLayers(e);return}const i=n.getLayers();i.clear(),i.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let n=0,i=e.length;n<i;++n){const s=e[n];if(!s.visible)continue;const r=s.layer.getRenderer();if(r&&!r.ready)return!0;const o=s.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const n=mt(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(n)}getPixelFromCoordinateInternal(e){const n=this.frameState_;return n?vt(n.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(nn.SIZE)}getView(){return this.get(nn.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,n,i,s){return Yk(this.frameState_,e,n,i,s)}handleBrowserEvent(e,n){n=n||e.type;const i=new qi(n,this,e);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(e){if(!this.frameState_)return;const n=e.originalEvent,i=n.type;if(i===pg.POINTERDOWN||i===xe.WHEEL||i===xe.KEYDOWN){const s=this.getOwnerDocument(),r=this.viewport_.getRootNode?this.viewport_.getRootNode():s,o=n.target,a=r instanceof ShadowRoot?r.host===o?r.host.ownerDocument:r:r===s?s.documentElement:r;if(this.overlayContainerStopEvent_.contains(o)||!a.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const s=this.getInteractions().getArray().slice();for(let r=s.length-1;r>=0;r--){const o=s[r];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,n=this.tileQueue_;if(!n.isEmpty()){let s=this.maxTilesLoading_,r=s;if(e){const o=e.viewHints;if(o[sn.ANIMATING]||o[sn.INTERACTING]){const a=Date.now()-e.time>8;s=a?0:8,r=a?0:2}}n.getTilesLoading()<s&&(n.reprioritize(),n.loadMoreTiles(s,r))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(Ut.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Ut.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new to(Ss.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new to(Ss.LOADSTART,this,e))));const i=this.postRenderFunctions_;if(e)for(let s=0,r=i.length;s<r;++s)i[s](this,e);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,s=this.targetChangeHandlerKeys_.length;i<s;++i)at(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(xe.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(xe.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const e=this.getTarget(),n=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=n,!n)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{n.appendChild(this.viewport_),this.renderer_||(this.renderer_=new oU(this)),this.mapBrowserEventHandler_=new Vk(this,this.moveTolerance_);for(const r in Ge)this.mapBrowserEventHandler_.addEventListener(Ge[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(xe.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(xe.WHEEL,this.boundHandleBrowserEvent_,db?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const r=n.getRootNode();i=r instanceof ShadowRoot?r.host:n}this.targetChangeHandlerKeys_=[He(i,xe.KEYDOWN,this.handleBrowserEvent,this),He(i,xe.KEYPRESS,this.handleBrowserEvent,this)];const s=n.getRootNode();s instanceof ShadowRoot&&this.resizeObserver_.observe(s.host),this.resizeObserver_.observe(n)}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(at(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(at(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=He(e,Lo.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=He(e,xe.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(at),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new Ts("addlayer",e)),this.layerGroupPropertyListenerKeys_=[He(e,Lo.PROPERTYCHANGE,this.render,this),He(e,xe.CHANGE,this.render,this),He(e,"addlayer",this.handleLayerAdd_,this),He(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let n=0,i=e.length;n<i;++n){const s=e[n].layer;s.hasRenderer()&&s.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){aT(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const n=this.getSize(),i=this.getView(),s=this.frameState_;let r=null;if(n!==void 0&&ex(n)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=i.getState();if(r={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:yg(a.center,a.resolution,a.rotation,n),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:n,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:me(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;r.nextExtent=yg(a.nextCenter,a.nextResolution,l,n)}}this.frameState_=r,this.renderer_.renderFrame(r),r&&(r.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,r.postRenderFunctions),s&&(!this.previousExtent_||!Qo(this.previousExtent_)&&!fl(r.extent,this.previousExtent_))&&(this.dispatchEvent(new to(Ss.MOVESTART,this,s)),this.previousExtent_=Jo(this.previousExtent_)),this.previousExtent_&&!r.viewHints[sn.ANIMATING]&&!r.viewHints[sn.INTERACTING]&&!fl(r.extent,this.previousExtent_)&&(this.dispatchEvent(new to(Ss.MOVEEND,this,r)),fb(r.extent,this.previousExtent_))),this.dispatchEvent(new to(Ss.POSTRENDER,this,r)),this.renderComplete_=(this.hasListener(Ss.LOADSTART)||this.hasListener(Ss.LOADEND)||this.hasListener(Ut.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const n=this.getLayerGroup();n&&this.handleLayerRemove_(new Ts("removelayer",n)),this.set(nn.LAYERGROUP,e)}setSize(e){this.set(nn.SIZE,e)}setTarget(e){this.set(nn.TARGET,e)}setView(e){if(!e||e instanceof Ii){this.set(nn.VIEW,e);return}this.set(nn.VIEW,new Ii);const n=this;e.then(function(i){n.setView(new Ii(i))})}updateSize(){const e=this.getTargetElement();let n;if(e){const s=getComputedStyle(e),r=e.offsetWidth-parseFloat(s.borderLeftWidth)-parseFloat(s.paddingLeft)-parseFloat(s.paddingRight)-parseFloat(s.borderRightWidth),o=e.offsetHeight-parseFloat(s.borderTopWidth)-parseFloat(s.paddingTop)-parseFloat(s.paddingBottom)-parseFloat(s.borderBottomWidth);!isNaN(r)&&!isNaN(o)&&(n=[Math.max(0,r),Math.max(0,o)],!ex(n)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&Eb("No map visible because the map container's width or height are 0."))}const i=this.getSize();n&&(!i||!cs(n,i))&&(this.setSize(n),this.updateViewportSize_(n))}updateViewportSize_(e){const n=this.getView();n&&n.setViewportSize(e)}};function lU(t){let e=null;t.keyboardEventTarget!==void 0&&(e=typeof t.keyboardEventTarget=="string"?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);const n={},i=t.layers&&typeof t.layers.getLayers=="function"?t.layers:new na({layers:t.layers});n[nn.LAYERGROUP]=i,n[nn.TARGET]=t.target,n[nn.VIEW]=t.view instanceof Ii?t.view:new Ii;let s;t.controls!==void 0&&(Array.isArray(t.controls)?s=new Vn(t.controls.slice()):(Je(typeof t.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),s=t.controls));let r;t.interactions!==void 0&&(Array.isArray(t.interactions)?r=new Vn(t.interactions.slice()):(Je(typeof t.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),r=t.interactions));let o;return t.overlays!==void 0?Array.isArray(t.overlays)?o=new Vn(t.overlays.slice()):(Je(typeof t.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=t.overlays):o=new Vn,{controls:s,interactions:r,keyboardEventTarget:e,overlays:o,values:n}}class t_ extends Gl{constructor(e,n,i){super(),i=i||{},this.tileCoord=e,this.state=n,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(xe.CHANGE)}release(){this.setState(se.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==se.EMPTY){if(this.state!==se.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){Se()}getAlpha(e,n){if(!this.transition_)return 1;let i=this.transitionStarts_[e];if(!i)i=n,this.transitionStarts_[e]=i;else if(i===-1)return 1;const s=n-i+1e3/60;return s>=this.transition_?1:yb(s/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function $o(t){return t instanceof Image||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageBitmap?t:null}function Fg(t){return t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t instanceof DataView?t:null}const cU=new Error("disposed");let Vr=null;function hU(t){Vr||(Vr=Et(t.width,t.height,void 0,{willReadFrequently:!0}));const e=Vr.canvas,n=t.width;e.width!==n&&(e.width=n);const i=t.height;return e.height!==i&&(e.height=i),Vr.clearRect(0,0,n,i),Vr.drawImage(t,0,0),Vr.getImageData(0,0,n,i).data}const uU=[256,256];class vl extends t_{constructor(e){const n=se.IDLE;super(e.tileCoord,n,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=$o(this.data_);return e?[e.width,e.height]:uU}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==se.IDLE&&this.state!==se.ERROR)return;this.state=se.LOADING,this.changed();const e=this;this.loader_().then(function(n){e.data_=n,e.state=se.LOADED,e.changed()}).catch(function(n){e.error_=n,e.state=se.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(cU),this.controller_=null),super.disposeInternal()}}class Fu extends t_{constructor(e,n,i,s,r,o){super(e,n,o),this.crossOrigin_=s,this.src_=i,this.key=i,this.image_=new Image,s!==null&&(this.image_.crossOrigin=s),this.unlisten_=null,this.tileLoadFunction_=r}getImage(){return this.image_}setImage(e){this.image_=e,this.state=se.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=se.ERROR,this.unlistenImage_(),this.image_=dU(),this.changed()}handleImageLoad_(){const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=se.LOADED:this.state=se.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==se.ERROR&&(this.state=se.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==se.IDLE&&(this.state=se.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=IB(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function dU(){const t=Et(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}class Du{constructor(e,n,i,s){this.minX=e,this.maxX=n,this.minY=i,this.maxY=s}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,n){return this.minX<=e&&e<=this.maxX&&this.minY<=n&&n<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function Wr(t,e,n,i,s){return s!==void 0?(s.minX=t,s.maxX=e,s.minY=n,s.maxY=i,s):new Du(t,e,n,i)}let gf;const bo=[];function fx(t,e,n,i,s){t.beginPath(),t.moveTo(0,0),t.lineTo(e,n),t.lineTo(i,s),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,i)+1,Math.max(n,s)),t.restore()}function pf(t,e){return Math.abs(t[e*4]-210)>2||Math.abs(t[e*4+3]-.75*255)>2}function fU(){if(gf===void 0){const t=Et(6,6,bo);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",fx(t,4,5,4,0),fx(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;gf=pf(e,0)||pf(e,4)||pf(e,8),Cu(t),bo.push(t.canvas)}return gf}function gx(t,e,n,i){const s=_u(n,e,t);let r=Th(e,i,n);const o=e.getMetersPerUnit();o!==void 0&&(r*=o);const a=t.getMetersPerUnit();a!==void 0&&(r/=a);const l=t.getExtent();if(!l||Hs(l,s)){const c=Th(t,r,s)/r;isFinite(c)&&c>0&&(r/=c)}return r}function cT(t,e,n,i){const s=Ui(n);let r=gx(t,e,s,i);return(!isFinite(r)||r<=0)&&mm(n,function(o){return r=gx(t,e,o,i),isFinite(r)&&r>0}),r}function gU(t,e,n,i,s,r,o,a,l,c,h,u,d,f){const g=Et(Math.round(n*t),Math.round(n*e),bo);if(u||(g.imageSmoothingEnabled=!1),l.length===0)return g.canvas;g.scale(n,n);function m(w){return Math.round(w*n)/n}g.globalCompositeOperation="lighter";const p=Yn();l.forEach(function(w,b,v){pm(p,w.extent)});let y;const _=n/i,x=(u?1:1+Math.pow(2,-24))/_;y=Et(Math.round(Ve(p)*_),Math.round(jt(p)*_),bo),u||(y.imageSmoothingEnabled=!1),l.forEach(function(w,b,v){if(w.image.width>0&&w.image.height>0){if(w.clipExtent){y.save();const j=(w.clipExtent[0]-p[0])*_,K=-(w.clipExtent[3]-p[3])*_,ee=Ve(w.clipExtent)*_,te=jt(w.clipExtent)*_;y.rect(u?j:Math.round(j),u?K:Math.round(K),u?ee:Math.round(j+ee)-Math.round(j),u?te:Math.round(K+te)-Math.round(K)),y.clip()}const A=(w.extent[0]-p[0])*_,P=-(w.extent[3]-p[3])*_,M=Ve(w.extent)*_,Y=jt(w.extent)*_;y.drawImage(w.image,c,c,w.image.width-2*c,w.image.height-2*c,u?A:Math.round(A),u?P:Math.round(P),u?M:Math.round(A+M)-Math.round(A),u?Y:Math.round(P+Y)-Math.round(P)),w.clipExtent&&y.restore()}});const E=as(o);return a.getTriangles().forEach(function(w,b,v){const A=w.source,P=w.target;let M=A[0][0],Y=A[0][1],j=A[1][0],K=A[1][1],ee=A[2][0],te=A[2][1];const Q=m((P[0][0]-E[0])/r),V=m(-(P[0][1]-E[1])/r),z=m((P[1][0]-E[0])/r),re=m(-(P[1][1]-E[1])/r),ue=m((P[2][0]-E[0])/r),ye=m(-(P[2][1]-E[1])/r),N=M,be=Y;M=0,Y=0,j-=N,K-=be,ee-=N,te-=be;const Z=[[j,K,0,0,z-Q],[ee,te,0,0,ue-Q],[0,0,j,K,re-V],[0,0,ee,te,ye-V]],H=Zk(Z);if(!H)return;if(g.save(),g.beginPath(),fU()||!u){g.moveTo(z,re);const ge=4,Ie=Q-z,je=V-re;for(let Xe=0;Xe<ge;Xe++)g.lineTo(z+m((Xe+1)*Ie/ge),re+m(Xe*je/(ge-1))),Xe!=ge-1&&g.lineTo(z+m((Xe+1)*Ie/ge),re+m((Xe+1)*je/(ge-1)));g.lineTo(ue,ye)}else g.moveTo(z,re),g.lineTo(Q,V),g.lineTo(ue,ye);g.clip(),g.transform(H[0],H[2],H[1],H[3],Q,V),g.translate(p[0]-N,p[3]-be);let oe;if(y)oe=y.canvas,g.scale(x,-x);else{const ge=l[0],Ie=ge.extent;oe=ge.image,g.scale(Ve(Ie)/oe.width,-jt(Ie)/oe.height)}g.drawImage(oe,0,0),g.restore()}),y&&(Cu(y),bo.push(y.canvas)),h&&(g.save(),g.globalCompositeOperation="source-over",g.strokeStyle="black",g.lineWidth=1,a.getTriangles().forEach(function(w,b,v){const A=w.target,P=(A[0][0]-E[0])/r,M=-(A[0][1]-E[1])/r,Y=(A[1][0]-E[0])/r,j=-(A[1][1]-E[1])/r,K=(A[2][0]-E[0])/r,ee=-(A[2][1]-E[1])/r;g.beginPath(),g.moveTo(Y,j),g.lineTo(P,M),g.lineTo(K,ee),g.closePath(),g.stroke()}),g.restore()),g.canvas}const pU=10,px=.25;class hT{constructor(e,n,i,s,r,o,a){this.sourceProj_=e,this.targetProj_=n;let l={};const c=a?Rb(x=>vt(a,_u(x,this.targetProj_,this.sourceProj_))):_l(this.targetProj_,this.sourceProj_);this.transformInv_=function(x){const E=x[0]+"/"+x[1];return l[E]||(l[E]=c(x)),l[E]},this.maxSourceExtent_=s,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!s&&!!this.sourceProj_.getExtent()&&Ve(s)>=Ve(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Ve(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Ve(this.targetProj_.getExtent()):null;const h=as(i),u=gu(i),d=fu(i),f=du(i),g=this.transformInv_(h),m=this.transformInv_(u),p=this.transformInv_(d),y=this.transformInv_(f),_=pU+(o?Math.max(0,Math.ceil(Math.log2(gl(i)/(o*o*256*256)))):0);if(this.addQuad_(h,u,d,f,g,m,p,y,_),this.wrapsXInSource_){let x=1/0;this.triangles_.forEach(function(E,w,b){x=Math.min(x,E.source[0][0],E.source[1][0],E.source[2][0])}),this.triangles_.forEach(E=>{if(Math.max(E.source[0][0],E.source[1][0],E.source[2][0])-x>this.sourceWorldWidth_/2){const w=[[E.source[0][0],E.source[0][1]],[E.source[1][0],E.source[1][1]],[E.source[2][0],E.source[2][1]]];w[0][0]-x>this.sourceWorldWidth_/2&&(w[0][0]-=this.sourceWorldWidth_),w[1][0]-x>this.sourceWorldWidth_/2&&(w[1][0]-=this.sourceWorldWidth_),w[2][0]-x>this.sourceWorldWidth_/2&&(w[2][0]-=this.sourceWorldWidth_);const b=Math.min(w[0][0],w[1][0],w[2][0]);Math.max(w[0][0],w[1][0],w[2][0])-b<this.sourceWorldWidth_/2&&(E.source=w)}})}l={}}addTriangle_(e,n,i,s,r,o){this.triangles_.push({source:[s,r,o],target:[e,n,i]})}addQuad_(e,n,i,s,r,o,a,l,c){const h=mn([r,o,a,l]),u=this.sourceWorldWidth_?Ve(h)/this.sourceWorldWidth_:null,d=this.sourceWorldWidth_,f=this.sourceProj_.canWrapX()&&u>.5&&u<1;let g=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const p=mn([e,n,i,s]);g=Ve(p)/this.targetWorldWidth_>px||g}!f&&this.sourceProj_.isGlobal()&&u&&(g=u>px||g)}if(!g&&this.maxSourceExtent_&&isFinite(h[0])&&isFinite(h[1])&&isFinite(h[2])&&isFinite(h[3])&&!wn(h,this.maxSourceExtent_))return;let m=0;if(!g&&(!isFinite(r[0])||!isFinite(r[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1]))){if(c>0)g=!0;else if(m=(!isFinite(r[0])||!isFinite(r[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),m!=1&&m!=2&&m!=4&&m!=8)return}if(c>0){if(!g){const p=[(e[0]+i[0])/2,(e[1]+i[1])/2],y=this.transformInv_(p);let _;f?_=(br(r[0],d)+br(a[0],d))/2-br(y[0],d):_=(r[0]+a[0])/2-y[0];const x=(r[1]+a[1])/2-y[1];g=_*_+x*x>this.errorThresholdSquared_}if(g){if(Math.abs(e[0]-i[0])<=Math.abs(e[1]-i[1])){const p=[(n[0]+i[0])/2,(n[1]+i[1])/2],y=this.transformInv_(p),_=[(s[0]+e[0])/2,(s[1]+e[1])/2],x=this.transformInv_(_);this.addQuad_(e,n,p,_,r,o,y,x,c-1),this.addQuad_(_,p,i,s,x,y,a,l,c-1)}else{const p=[(e[0]+n[0])/2,(e[1]+n[1])/2],y=this.transformInv_(p),_=[(i[0]+s[0])/2,(i[1]+s[1])/2],x=this.transformInv_(_);this.addQuad_(e,p,_,s,r,y,x,l,c-1),this.addQuad_(p,n,i,_,y,o,a,x,c-1)}return}}if(f){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(m&11)==0&&this.addTriangle_(e,i,s,r,a,l),(m&14)==0&&this.addTriangle_(e,i,n,r,a,o),m&&((m&13)==0&&this.addTriangle_(n,s,e,o,l,r),(m&7)==0&&this.addTriangle_(n,s,i,o,l,a))}calculateSourceExtent(){const e=Yn();return this.triangles_.forEach(function(n,i,s){const r=n.source;Za(e,r[0]),Za(e,r[1]),Za(e,r[2])}),e}getTriangles(){return this.triangles_}}const uT=.5;class n_ extends t_{constructor(e,n,i,s,r,o,a,l,c,h,u,d){super(r,se.IDLE,d),this.renderEdges_=u!==void 0?u:!1,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=n,this.targetTileGrid_=s,this.wrappedTileCoord_=o||r,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const f=s.getTileCoordExtent(this.wrappedTileCoord_),g=this.targetTileGrid_.getExtent();let m=this.sourceTileGrid_.getExtent();const p=g?Cn(f,g):f;if(gl(p)===0){this.state=se.EMPTY;return}const y=e.getExtent();y&&(m?m=Cn(m,y):m=y);const _=s.getResolution(this.wrappedTileCoord_[0]),x=cT(e,i,p,_);if(!isFinite(x)||x<=0){this.state=se.EMPTY;return}const E=h!==void 0?h:uT;if(this.triangulation_=new hT(e,i,p,m,x*E,_),this.triangulation_.getTriangles().length===0){this.state=se.EMPTY;return}this.sourceZ_=n.getZForResolution(x);let w=this.triangulation_.calculateSourceExtent();if(m&&(e.canWrapX()?(w[1]=lt(w[1],m[1],m[3]),w[3]=lt(w[3],m[1],m[3])):w=Cn(w,m)),!gl(w))this.state=se.EMPTY;else{let b=0,v=0;e.canWrapX()&&(b=Ve(y),v=Math.floor((w[0]-y[0])/b)),ym(w.slice(),e,!0).forEach(P=>{const M=n.getTileRangeForExtentAndZ(P,this.sourceZ_);for(let Y=M.minX;Y<=M.maxX;Y++)for(let j=M.minY;j<=M.maxY;j++){const K=c(this.sourceZ_,Y,j,a);if(K){const ee=v*b;this.sourceTiles_.push({tile:K,offset:ee})}}++v}),this.sourceTiles_.length===0&&(this.state=se.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(n=>{const i=n.tile;if(i&&i.getState()==se.LOADED){const s=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);s[0]+=n.offset,s[2]+=n.offset;const r=this.clipExtent_?.slice();r&&(r[0]+=n.offset,r[2]+=n.offset),e.push({extent:s,clipExtent:r,image:i.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=se.ERROR;else{const n=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(n),s=typeof i=="number"?i:i[0],r=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(n),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=gU(s,r,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=se.LOADED}this.changed()}load(){if(this.state==se.IDLE){this.state=se.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:n})=>{const i=n.getState();if(i==se.IDLE||i==se.LOADING){e++;const s=He(n,xe.CHANGE,r=>{const o=n.getState();(o==se.LOADED||o==se.ERROR||o==se.EMPTY)&&(at(s),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(s)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:n},i,s){n.getState()==se.IDLE&&n.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(at),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Cu(this.canvas_.getContext("2d")),bo.push(this.canvas_),this.canvas_=null),super.release()}}class dT{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof Ul&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let n=this.oldest_;for(;n;)e(n.value_,n.key_,this),n=n.newer}get(e,n){const i=this.entries_[e];return Je(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(e){const n=this.entries_[e];return Je(n!==void 0,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_?(this.newest_=n.older,this.newest_&&(this.newest_.newer=null)):n===this.oldest_?(this.oldest_=n.newer,this.oldest_&&(this.oldest_.older=null)):(n.newer.older=n.older,n.older.newer=n.newer),delete this.entries_[e],--this.count_,n.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let n=0,i;for(i=this.newest_;i;i=i.older)e[n++]=i.key_;return e}getValues(){const e=new Array(this.count_);let n=0,i;for(i=this.newest_;i;i=i.older)e[n++]=i.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){return this.entries_[e]?.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,n){this.get(e),this.entries_[e].value_=n}set(e,n){Je(!(e in this.entries_),"Tried to set a value for a key that is used already");const i={key_:e,newer:null,older:this.newest_,value_:n};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[e]=i,++this.count_}setSize(e){this.highWaterMark=e}}function jo(t,e,n,i){return i!==void 0?(i[0]=t,i[1]=e,i[2]=n,i):[t,e,n]}function fT(t,e,n){return t+"/"+e+"/"+n}function so(t){return fT(t[0],t[1],t[2])}function mU(t){return _U(t[0],t[1],t[2])}function _U(t,e,n){return(e<<t)+n}function yU(t,e){const n=t[0],i=t[1],s=t[2];if(e.getMinZoom()>n||n>e.getMaxZoom())return!1;const r=e.getFullTileRange(n);return r?r.containsXY(i,s):!0}class gT{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Ah(),{get:(e,n)=>{if(typeof Ah()[n]=="function")return this.push_(n),this.pushMethodArgs_},set:(e,n,i)=>(this.push_(n,i),!0)})}push_(...e){const n=this.instructions_,i=this.zIndex+this.offset_;n[i]||(n[i]=[]),n[i].push(...e)}pushMethodArgs_=(...e)=>(this.push_(e),this);pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(n=>{for(let i=0,s=n.length;i<s;++i){const r=n[i];if(typeof r=="function"){r(e);continue}const o=n[++i];if(typeof e[r]=="function")e[r](...o);else{if(typeof o=="function"){e[r]=o(e);continue}e[r]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const EU=5;class pT extends $l{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=EU}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return Se()}getData(e){return null}prepareFrame(e){return Se()}renderFrame(e,n){return Se()}forEachFeatureAtCoordinate(e,n,i,s,r){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const n=e.target;(n.getState()===ke.LOADED||n.getState()===ke.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let n=e.getState();return n!=ke.LOADED&&n!=ke.ERROR&&e.addEventListener(xe.CHANGE,this.boundHandleImageChange_),n==ke.IDLE&&(e.load(),n=e.getState()),n==ke.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const mx=[];let ro=null;function xU(){ro=Et(1,1,void 0,{willReadFrequently:!0})}class mT extends pT{constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=hn(),this.pixelTransform=hn(),this.inversePixelTransform=hn(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,n,i){ro||xU(),ro.clearRect(0,0,1,1);let s;try{ro.drawImage(e,n,i,1,1,0,0,1,1),s=ro.getImageData(0,0,1,1).data}catch{return ro=null,null}return s}getBackground(e){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(e.viewState.resolution)),i||void 0}useContainer(e,n,i){const s=this.getLayer().getClassName();let r,o;if(e&&e.className===s&&(!i||e&&e.style.backgroundColor&&cs(Vs(e.style.backgroundColor),Vs(i)))){const a=e.firstElementChild;a instanceof HTMLCanvasElement&&(o=a.getContext("2d"))}if(o&&WN(o.canvas.style.transform,n)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){r=document.createElement("div"),r.className=s;let a=r.style;a.position="absolute",a.width="100%",a.height="100%",o=Et();const l=o.canvas;r.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=r,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(e,n,i){const s=as(i),r=gu(i),o=fu(i),a=du(i);vt(n.coordinateToPixelTransform,s),vt(n.coordinateToPixelTransform,r),vt(n.coordinateToPixelTransform,o),vt(n.coordinateToPixelTransform,a);const l=this.inversePixelTransform;vt(l,s),vt(l,r),vt(l,o),vt(l,a),e.save(),e.beginPath(),e.moveTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(r[0]),Math.round(r[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.clip()}prepareContainer(e,n){const i=e.extent,s=e.viewState.resolution,r=e.viewState.rotation,o=e.pixelRatio,a=Math.round(Ve(i)/s*o),l=Math.round(jt(i)/s*o);mi(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,r,-a/2,-l/2),Rm(this.inversePixelTransform,this.pixelTransform);const c=VN(this.pixelTransform);if(this.useContainer(n,c,this.getBackground(e)),!this.containerReused){const h=this.context.canvas;h.width!=a||h.height!=l?(h.width=a,h.height=l):this.context.clearRect(0,0,a,l),c!==h.style.transform&&(h.style.transform=c)}}dispatchRenderEvent_(e,n,i){const s=this.getLayer();if(s.hasListener(e)){const r=new Qa(e,this.inversePixelTransform,i,n);s.dispatchEvent(r)}}preRender(e,n){this.frameState=n,!n.declutter&&this.dispatchRenderEvent_(Ut.PRERENDER,e,n)}postRender(e,n){n.declutter||this.dispatchRenderEvent_(Ut.POSTRENDER,e,n)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new gT),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(Ut.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(Ut.POSTRENDER,this.context,e))}getRenderTransform(e,n,i,s,r,o,a){const l=r/2,c=o/2,h=s/n,u=-h,d=-e[0]+a,f=-e[1];return mi(this.tempTransform,l,c,h,u,-i,d,f)}disposeInternal(){delete this.frameState,super.disposeInternal()}}function mf(t,e,n,i,s){return`${me(t)},${e},${fT(n,i,s)}`}function _f(t,e,n){if(!(n in t))return t[n]=new Set([e]),!0;const i=t[n],s=i.has(e);return s||i.add(e),!s}function wU(t,e,n){const i=t[n];return i?i.delete(e):!1}function _x(t,e){const n=t.layerStatesArray[t.layerIndex];n.extent&&(e=Cn(e,fi(n.extent,t.viewState.projection)));const i=n.layer.getRenderSource();if(!i.getWrapX()){const s=i.getTileGridForProjection(t.viewState.projection).getExtent();s&&(e=Cn(e,s))}return e}class SU extends mT{constructor(e,n){super(e),n=n||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Yn(),this.tempTileRange_=new Du(0,0,0,0),this.tempTileCoord_=jo(0,0,0);const i=n.cacheSize!==void 0?n.cacheSize:512;this.tileCache_=new dT(i),this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getOrCreateTile(e,n,i,s){const r=this.tileCache_,a=this.getLayer().getSource(),l=mf(a,a.getKey(),e,n,i);let c;if(r.containsKey(l))c=r.get(l);else{if(c=a.getTile(e,n,i,s.pixelRatio,s.viewState.projection),!c)return null;r.set(l,c)}return c}getTile(e,n,i,s){const r=this.getOrCreateTile(e,n,i,s);return r||null}getData(e){const n=this.frameState;if(!n)return null;const i=this.getLayer(),s=vt(n.pixelToCoordinateTransform,e.slice()),r=i.getExtent();if(r&&!Hs(r,s))return null;const o=n.viewState,a=i.getRenderSource(),l=a.getTileGridForProjection(o.projection),c=a.getTilePixelRatio(n.pixelRatio);for(let h=l.getZForResolution(o.resolution);h>=l.getMinZoom();--h){const u=l.getTileCoordForCoordAndZ(s,h),d=this.getTile(h,u[1],u[2],n);if(!d||d.getState()!==se.LOADED)continue;const f=l.getOrigin(h),g=Ct(l.getTileSize(h)),m=l.getResolution(h);let p;if(d instanceof Fu||d instanceof n_)p=d.getImage();else if(d instanceof vl){if(p=$o(d.getData()),!p)continue}else continue;const y=Math.floor(c*((s[0]-f[0])/m-u[1]*g[0])),_=Math.floor(c*((f[1]-s[1])/m-u[2]*g[1])),x=Math.round(c*a.getGutterForProjection(o.projection));return this.getImageData(p,y+x,_+x)}return null}prepareFrame(e){this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const n=this.getLayer().getSource();if(!n)return!1;const i=n.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==i&&(this.renderedSourceRevision_=i,this.renderedSourceKey_===n.getKey()&&this.tileCache_.clear()):this.renderedSourceRevision_=i,!0}enqueueTiles(e,n,i,s,r){const o=e.viewState,a=this.getLayer(),l=a.getRenderSource(),c=l.getTileGridForProjection(o.projection),h=me(l);h in e.wantedTiles||(e.wantedTiles[h]={});const u=e.wantedTiles[h],d=a.getMapInternal(),f=Math.max(i-r,c.getMinZoom(),c.getZForResolution(Math.min(a.getMaxResolution(),d?d.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):c.getResolution(0)),l.zDirection)),g=o.rotation,m=g?_m(o.center,o.resolution,g,e.size):void 0;for(let p=i;p>=f;--p){const y=c.getTileRangeForExtentAndZ(n,p,this.tempTileRange_),_=c.getResolution(p);for(let x=y.minX;x<=y.maxX;++x)for(let E=y.minY;E<=y.maxY;++E){if(g&&!c.tileCoordIntersectsViewport([p,x,E],m))continue;const w=this.getTile(p,x,E,e);if(!w||!_f(s,w,p))continue;const v=w.getKey();if(u[v]=!0,w.getState()===se.IDLE&&!e.tileQueue.isKeyQueued(v)){const A=jo(p,x,E,this.tempTileCoord_);e.tileQueue.enqueue([w,h,c.getTileCoordCenter(A),_])}}}}findStaleTile_(e,n){const i=this.tileCache_,s=e[0],r=e[1],o=e[2],a=this.getStaleKeys();for(let l=0;l<a.length;++l){const c=mf(this.getLayer().getSource(),a[l],s,r,o);if(i.containsKey(c)){const h=i.peek(c);if(h.getState()===se.LOADED)return h.endTransition(me(this)),_f(n,h,s),!0}}return!1}findAltTiles_(e,n,i,s){const r=e.getTileRangeForTileCoordAndZ(n,i,this.tempTileRange_);if(!r)return!1;let o=!0;const a=this.tileCache_,l=this.getLayer().getRenderSource(),c=l.getKey();for(let h=r.minX;h<=r.maxX;++h)for(let u=r.minY;u<=r.maxY;++u){const d=mf(l,c,i,h,u);let f=!1;if(a.containsKey(d)){const g=a.peek(d);g.getState()===se.LOADED&&(_f(s,g,i),f=!0)}f||(o=!1)}return o}renderFrame(e,n){this.renderComplete=!0;const i=e.layerStatesArray[e.layerIndex],s=e.viewState,r=s.projection,o=s.resolution,a=s.center,l=e.pixelRatio,c=this.getLayer(),h=c.getSource(),u=h.getTileGridForProjection(r),d=u.getZForResolution(o,h.zDirection),f=u.getResolution(d),g=h.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==g&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=g):this.renderedSourceKey_=g;let m=e.extent;const p=h.getTilePixelRatio(l);this.prepareContainer(e,n);const y=this.context.canvas.width,_=this.context.canvas.height,x=i.extent&&fi(i.extent);x&&(m=Cn(m,fi(i.extent)));const E=f*y/2/p,w=f*_/2/p,b=[a[0]-E,a[1]-w,a[0]+E,a[1]+w],v={};this.renderedTiles.length=0;const A=c.getPreload();if(e.nextExtent){const z=u.getZForResolution(s.nextResolution,h.zDirection),re=_x(e,e.nextExtent);this.enqueueTiles(e,re,z,v,A)}const P=_x(e,m);if(this.enqueueTiles(e,P,d,v,0),A>0&&setTimeout(()=>{this.enqueueTiles(e,P,d-1,v,A-1)},0),!(d in v))return this.container;const M=me(this),Y=e.time;for(const z of v[d]){const re=z.getState();if(re===se.EMPTY)continue;const ue=z.tileCoord;if(re===se.LOADED&&z.getAlpha(M,Y)===1){z.endTransition(M);continue}if(re!==se.ERROR&&(this.renderComplete=!1),this.findStaleTile_(ue,v)){wU(v,z,d),e.animate=!0;continue}if(this.findAltTiles_(u,ue,d+1,v))continue;const be=u.getMinZoom();for(let Z=d-1;Z>=be&&!this.findAltTiles_(u,ue,Z,v);--Z);}const j=f/o*l/p,K=this.getRenderContext(e);mi(this.tempTransform,y/2,_/2,j,j,0,-y/2,-_/2),i.extent&&this.clipUnrotated(K,e,x),h.getInterpolate()||(K.imageSmoothingEnabled=!1),this.preRender(K,e);const ee=Object.keys(v).map(Number);ee.sort(ts);let te;const Q=[],V=[];for(let z=ee.length-1;z>=0;--z){const re=ee[z],ue=h.getTilePixelSize(re,l,r),N=u.getResolution(re)/f,be=ue[0]*N*j,Z=ue[1]*N*j,H=u.getTileCoordForCoordAndZ(as(b),re),oe=u.getTileCoordExtent(H),ge=vt(this.tempTransform,[p*(oe[0]-b[0])/f,p*(b[3]-oe[3])/f]),Ie=p*h.getGutterForProjection(r);for(const je of v[re]){if(je.getState()!==se.LOADED)continue;const Xe=je.tileCoord,ui=H[1]-Xe[1],C=Math.round(ge[0]-(ui-1)*be),R=H[2]-Xe[2],O=Math.round(ge[1]-(R-1)*Z),G=Math.round(ge[0]-ui*be),B=Math.round(ge[1]-R*Z),$=C-G,ie=O-B,ne=ee.length===1;let q=!1;te=[G,B,G+$,B,G+$,B+ie,G,B+ie];for(let W=0,pe=Q.length;W<pe;++W)if(!ne&&re<V[W]){const J=Q[W];wn([G,B,G+$,B+ie],[J[0],J[3],J[4],J[7]])&&(q||(K.save(),q=!0),K.beginPath(),K.moveTo(te[0],te[1]),K.lineTo(te[2],te[3]),K.lineTo(te[4],te[5]),K.lineTo(te[6],te[7]),K.moveTo(J[6],J[7]),K.lineTo(J[4],J[5]),K.lineTo(J[2],J[3]),K.lineTo(J[0],J[1]),K.clip())}Q.push(te),V.push(re),this.drawTile(je,e,G,B,$,ie,Ie,ne),q&&K.restore(),this.renderedTiles.unshift(je),this.updateUsedTiles(e.usedTiles,h,je)}}if(this.renderedResolution=f,this.extentChanged=!this.renderedExtent_||!fl(this.renderedExtent_,b),this.renderedExtent_=b,this.renderedPixelRatio=l,this.postRender(this.context,e),i.extent&&K.restore(),K.imageSmoothingEnabled=!0,this.renderComplete){const z=(re,ue)=>{const ye=me(h),N=ue.wantedTiles[ye],be=N?Object.keys(N).length:0;this.updateCacheSize(be),this.tileCache_.expireCache()};e.postRenderFunctions.push(z)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,n,i,s,r,o,a,l){let c;if(e instanceof vl){if(c=$o(e.getData()),!c)throw new Error("Rendering array data is not yet supported")}else c=this.getTileImage(e);if(!c)return;const h=this.getRenderContext(n),u=me(this),d=n.layerStatesArray[n.layerIndex],f=d.opacity*(l?e.getAlpha(u,n.time):1),g=f!==h.globalAlpha;g&&(h.save(),h.globalAlpha=f),h.drawImage(c,a,a,c.width-2*a,c.height-2*a,i,s,r,o),g&&h.restore(),f!==d.opacity?n.animate=!0:l&&e.endTransition(u)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,n,i){const s=me(n);s in e||(e[s]={}),e[s][i.getKey()]=!0}}const yc={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class _T extends Tu{constructor(e){e=e||{};const n=Object.assign({},e),i=e.cacheSize;delete e.cacheSize,delete n.preload,delete n.useInterimTilesOnError,super(n),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(yc.PRELOAD)}setPreload(e){this.set(yc.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(yc.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(yc.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class yx extends _T{constructor(e){super(e)}createRenderer(){return new SU(this,{cacheSize:this.getCacheSize()})}}function sa(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function yT(t,e){return t[0]=e[0],t[1]=e[1],t[4]=e[2],t[5]=e[3],t[12]=e[4],t[13]=e[5],t}function Dg(t,e,n,i,s,r,o){o=o??sa();const a=1/(t-e),l=1/(n-i),c=1/(s-r);return o[0]=-2*a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*l,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*c,o[11]=0,o[12]=(t+e)*a,o[13]=(i+n)*l,o[14]=(r+s)*c,o[15]=1,o}function Ex(t,e,n,i,s){return s=s??sa(),s[0]=t[0]*e,s[1]=t[1]*e,s[2]=t[2]*e,s[3]=t[3]*e,s[4]=t[4]*n,s[5]=t[5]*n,s[6]=t[6]*n,s[7]=t[7]*n,s[8]=t[8]*i,s[9]=t[9]*i,s[10]=t[10]*i,s[11]=t[11]*i,s[12]=t[12],s[13]=t[13],s[14]=t[14],s[15]=t[15],s}function CU(t,e,n,i,s){s=s??sa();let r,o,a,l,c,h,u,d,f,g,m,p;return t===s?(s[12]=t[0]*e+t[4]*n+t[8]*i+t[12],s[13]=t[1]*e+t[5]*n+t[9]*i+t[13],s[14]=t[2]*e+t[6]*n+t[10]*i+t[14],s[15]=t[3]*e+t[7]*n+t[11]*i+t[15]):(r=t[0],o=t[1],a=t[2],l=t[3],c=t[4],h=t[5],u=t[6],d=t[7],f=t[8],g=t[9],m=t[10],p=t[11],s[0]=r,s[1]=o,s[2]=a,s[3]=l,s[4]=c,s[5]=h,s[6]=u,s[7]=d,s[8]=f,s[9]=g,s[10]=m,s[11]=p,s[12]=r*e+c*n+f*i+t[12],s[13]=o*e+h*n+g*i+t[13],s[14]=a*e+u*n+m*i+t[14],s[15]=l*e+d*n+p*i+t[15]),s}function bU(t,e,n,i){return i=i??sa(),i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=t,i[13]=e,i[14]=n,i[15]=1,i}const i_=34962,s_=34963,r_=35044,TU=5121,RU=5123,vU=5125,ET=5126,xx=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function AU(t,e){e=Object.assign({preserveDrawingBuffer:!0,antialias:!zk},e);const n=xx.length;for(let i=0;i<n;++i)try{const s=t.getContext(xx[i],e);if(s)return s}catch{}return null}const IU={STATIC_DRAW:r_};class xT{constructor(e,n){this.array_=null,this.type_=e,Je(e===i_||e===s_,"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`"),this.usage_=n!==void 0?n:IU.STATIC_DRAW}ofSize(e){return this.array_=new(Ec(this.type_))(e),this}fromArray(e){return this.array_=Ec(this.type_).from(e),this}fromArrayBuffer(e){return this.array_=new(Ec(this.type_))(e),this}getType(){return this.type_}getArray(){return this.array_}setArray(e){const n=Ec(this.type_);if(!(e instanceof n))throw new Error(`Expected ${n}`);this.array_=e}getUsage(){return this.usage_}getSize(){return this.array_?this.array_.length:0}}function Ec(t){switch(t){case i_:return Float32Array;case s_:return Uint32Array;default:return Float32Array}}const xc={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},PU=`
  precision mediump float;

  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;

  uniform vec2 u_screenSize;

  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,MU=`
  precision mediump float;

  uniform sampler2D u_image;
  uniform float u_opacity;

  varying vec2 v_texCoord;

  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`;class wx{constructor(e){this.gl_=e.webGlContext;const n=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=n.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=n.createFramebuffer(),this.depthBuffer_=n.createRenderbuffer();const i=n.createShader(n.VERTEX_SHADER);n.shaderSource(i,e.vertexShader||PU),n.compileShader(i);const s=n.createShader(n.FRAGMENT_SHADER);n.shaderSource(s,e.fragmentShader||MU),n.compileShader(s),this.renderTargetProgram_=n.createProgram(),n.attachShader(this.renderTargetProgram_,i),n.attachShader(this.renderTargetProgram_,s),n.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=n.createBuffer();const r=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];n.bindBuffer(n.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),n.bufferData(n.ARRAY_BUFFER,new Float32Array(r),n.STATIC_DRAW),this.renderTargetAttribLocation_=n.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=n.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=n.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=n.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(o=>{this.uniforms_.push({value:e.uniforms[o],location:n.getUniformLocation(this.renderTargetProgram_,o)})})}getRenderTargetTexture(){return this.renderTargetTexture_}getGL(){return this.gl_}init(e){const n=this.getGL(),i=[n.drawingBufferWidth*this.scaleRatio_,n.drawingBufferHeight*this.scaleRatio_];if(n.bindFramebuffer(n.FRAMEBUFFER,this.getFrameBuffer()),n.bindRenderbuffer(n.RENDERBUFFER,this.getDepthBuffer()),n.viewport(0,0,i[0],i[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==i[0]||this.renderTargetTextureSize_[1]!==i[1]){this.renderTargetTextureSize_=i;const s=0,r=n.RGBA,o=0,a=n.RGBA,l=n.UNSIGNED_BYTE,c=null;n.bindTexture(n.TEXTURE_2D,this.renderTargetTexture_),n.texImage2D(n.TEXTURE_2D,s,r,i[0],i[1],o,a,l,c),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.renderTargetTexture_,0),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,i[0],i[1]),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,this.depthBuffer_)}}apply(e,n,i,s){const r=this.getGL(),o=e.size;if(r.bindFramebuffer(r.FRAMEBUFFER,n?n.getFrameBuffer():null),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,this.renderTargetTexture_),!n){const l=me(r.canvas);if(!e.renderTargets[l]){const c=r.getContextAttributes();c&&c.preserveDrawingBuffer&&(r.clearColor(0,0,0,0),r.clearDepth(1),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT)),e.renderTargets[l]=!0}}r.disable(r.DEPTH_TEST),r.enable(r.BLEND),r.blendFunc(r.ONE,r.ONE_MINUS_SRC_ALPHA),r.viewport(0,0,r.drawingBufferWidth,r.drawingBufferHeight),r.bindBuffer(r.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),r.useProgram(this.renderTargetProgram_),r.enableVertexAttribArray(this.renderTargetAttribLocation_),r.vertexAttribPointer(this.renderTargetAttribLocation_,2,r.FLOAT,!1,0,0),r.uniform2f(this.renderTargetUniformLocation_,o[0],o[1]),r.uniform1i(this.renderTargetTextureLocation_,0);const a=e.layerStatesArray[e.layerIndex].opacity;r.uniform1f(this.renderTargetOpacityLocation_,a),this.applyUniforms(e),i&&i(r,e),r.drawArrays(r.TRIANGLES,0,6),s&&s(r,e)}getFrameBuffer(){return this.frameBuffer_}getDepthBuffer(){return this.depthBuffer_}applyUniforms(e){const n=this.getGL();let i,s=1;this.uniforms_.forEach(function(r){if(i=typeof r.value=="function"?r.value(e):r.value,i instanceof HTMLCanvasElement||i instanceof ImageData)r.texture||(r.texture=n.createTexture()),n.activeTexture(n[`TEXTURE${s}`]),n.bindTexture(n.TEXTURE_2D,r.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),i instanceof ImageData?n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,i.width,i.height,0,n.UNSIGNED_BYTE,new Uint8Array(i.data)):n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,i),n.uniform1i(r.location,s++);else if(Array.isArray(i))switch(i.length){case 2:n.uniform2f(r.location,i[0],i[1]);return;case 3:n.uniform3f(r.location,i[0],i[1],i[2]);return;case 4:n.uniform4f(r.location,i[0],i[1],i[2],i[3]);return;default:return}else typeof i=="number"&&n.uniform1f(r.location,i)})}}const ps={TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",ROTATION:"u_rotation",VIEWPORT_SIZE_PX:"u_viewportSizePx",PIXEL_RATIO:"u_pixelRatio",HIT_DETECTION:"u_hitDetection"},Fa={UNSIGNED_BYTE:TU,UNSIGNED_SHORT:RU,UNSIGNED_INT:vU,FLOAT:ET},Dh={};function Sx(t){return"shared/"+t}let Cx=0;function FU(){const t="unique/"+Cx;return Cx+=1,t}function DU(t){let e=Dh[t];if(!e){const n=document.createElement("canvas");n.width=1,n.height=1,n.style.position="absolute",n.style.left="0",e={users:0,context:AU(n)},Dh[t]=e}return e.users+=1,e.context}function OU(t){const e=Dh[t];if(!e||(e.users-=1,e.users>0))return;const n=e.context,i=n.getExtension("WEBGL_lose_context");i&&i.loseContext();const s=n.canvas;s.width=1,s.height=1,delete Dh[t]}class LU extends Ul{constructor(e){super(),e=e||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=e.canvasCacheKey?Sx(e.canvasCacheKey):FU(),this.gl_=DU(this.canvasCacheKey_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.needsToBeRecreated_=!1;const n=this.gl_.canvas;n.addEventListener(xc.LOST,this.boundHandleWebGLContextLost_),n.addEventListener(xc.RESTORED,this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=hn(),this.offsetScaleMatrix_=hn(),this.tmpMat4_=sa(),this.uniformLocationsByProgram_={},this.attribLocationsByProgram_={},this.uniforms_=[],e.uniforms&&this.setUniforms(e.uniforms),this.postProcessPasses_=e.postProcesses?e.postProcesses.map(i=>new wx({webGlContext:this.gl_,scaleRatio:i.scaleRatio,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,uniforms:i.uniforms})):[new wx({webGlContext:this.gl_})],this.shaderCompileErrors_=null,this.startTime_=Date.now(),this.maxAttributeCount_=this.gl_.getParameter(this.gl_.MAX_VERTEX_ATTRIBS)}setUniforms(e){this.uniforms_=[],this.addUniforms(e)}addUniforms(e){for(const n in e)this.uniforms_.push({name:n,value:e[n]})}canvasCacheKeyMatches(e){return this.canvasCacheKey_===Sx(e)}getExtension(e){if(e in this.extensionCache_)return this.extensionCache_[e];const n=this.gl_.getExtension(e);return this.extensionCache_[e]=n,n}bindBuffer(e){const n=this.gl_,i=me(e);let s=this.bufferCache_[i];if(!s){const r=n.createBuffer();s={buffer:e,webGlBuffer:r},this.bufferCache_[i]=s}n.bindBuffer(e.getType(),s.webGlBuffer)}flushBufferData(e){const n=this.gl_;this.bindBuffer(e),n.bufferData(e.getType(),e.getArray(),e.getUsage())}deleteBuffer(e){const n=me(e);delete this.bufferCache_[n]}disposeInternal(){const e=this.gl_.canvas;e.removeEventListener(xc.LOST,this.boundHandleWebGLContextLost_),e.removeEventListener(xc.RESTORED,this.boundHandleWebGLContextRestored_),OU(this.canvasCacheKey_),delete this.gl_}prepareDraw(e,n,i){const s=this.gl_,r=this.getCanvas(),o=e.size,a=e.pixelRatio;(r.width!==o[0]*a||r.height!==o[1]*a)&&(r.width=o[0]*a,r.height=o[1]*a,r.style.width=o[0]+"px",r.style.height=o[1]+"px");for(let l=this.postProcessPasses_.length-1;l>=0;l--)this.postProcessPasses_[l].init(e);s.bindTexture(s.TEXTURE_2D,null),s.clearColor(0,0,0,0),s.depthRange(0,1),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.enable(s.BLEND),s.blendFunc(s.ONE,n?s.ZERO:s.ONE_MINUS_SRC_ALPHA),i?(s.enable(s.DEPTH_TEST),s.depthFunc(s.LEQUAL)):s.disable(s.DEPTH_TEST)}bindFrameBuffer(e,n){const i=this.getGL();i.bindFramebuffer(i.FRAMEBUFFER,e),n&&i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,n,0)}bindInitialFrameBuffer(){const e=this.getGL(),n=this.postProcessPasses_[0].getFrameBuffer();e.bindFramebuffer(e.FRAMEBUFFER,n);const i=this.postProcessPasses_[0].getRenderTargetTexture();e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i,0)}bindTexture(e,n,i){const s=this.gl_;s.activeTexture(s.TEXTURE0+n),s.bindTexture(s.TEXTURE_2D,e),s.uniform1i(this.getUniformLocation(i),n)}bindAttribute(e,n,i){const s=this.getGL();this.bindBuffer(e);const r=this.getAttributeLocation(n);s.enableVertexAttribArray(r),s.vertexAttribPointer(r,i,s.FLOAT,!1,0,0)}prepareDrawToRenderTarget(e,n,i,s){const r=this.gl_,o=n.getSize();r.bindFramebuffer(r.FRAMEBUFFER,n.getFramebuffer()),r.bindRenderbuffer(r.RENDERBUFFER,n.getDepthbuffer()),r.viewport(0,0,o[0],o[1]),r.bindTexture(r.TEXTURE_2D,n.getTexture()),r.clearColor(0,0,0,0),r.depthRange(0,1),r.clearDepth(1),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),r.enable(r.BLEND),r.blendFunc(r.ONE,i?r.ZERO:r.ONE_MINUS_SRC_ALPHA),s?(r.enable(r.DEPTH_TEST),r.depthFunc(r.LEQUAL)):r.disable(r.DEPTH_TEST)}drawElements(e,n){const i=this.gl_;this.getExtension("OES_element_index_uint");const s=i.UNSIGNED_INT,r=4,o=n-e,a=e*r;i.drawElements(i.TRIANGLES,o,s,a)}finalizeDraw(e,n,i){for(let s=0,r=this.postProcessPasses_.length;s<r;s++)s===r-1?this.postProcessPasses_[s].apply(e,null,n,i):this.postProcessPasses_[s].apply(e,this.postProcessPasses_[s+1])}getCanvas(){return this.gl_.canvas}getGL(){return this.gl_}applyFrameState(e){const n=e.size,i=e.viewState.rotation,s=e.pixelRatio;this.setUniformFloatValue(ps.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(ps.ZOOM,e.viewState.zoom),this.setUniformFloatValue(ps.RESOLUTION,e.viewState.resolution),this.setUniformFloatValue(ps.PIXEL_RATIO,s),this.setUniformFloatVec2(ps.VIEWPORT_SIZE_PX,[n[0],n[1]]),this.setUniformFloatValue(ps.ROTATION,i)}applyHitDetectionUniform(e){const n=this.getUniformLocation(ps.HIT_DETECTION);this.getGL().uniform1i(n,e?1:0),e&&this.setUniformFloatValue(ps.PIXEL_RATIO,.5)}applyUniforms(e){const n=this.gl_;let i,s=0;this.uniforms_.forEach(r=>{if(i=typeof r.value=="function"?r.value(e):r.value,i instanceof HTMLCanvasElement||i instanceof HTMLImageElement||i instanceof ImageData||i instanceof WebGLTexture){i instanceof WebGLTexture&&!r.texture?(r.prevValue=void 0,r.texture=i):r.texture||(r.prevValue=void 0,r.texture=n.createTexture()),this.bindTexture(r.texture,s,r.name),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);const o=!(i instanceof HTMLImageElement)||i.complete;!(i instanceof WebGLTexture)&&o&&r.prevValue!==i&&(r.prevValue=i,n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,i)),s++}else if(Array.isArray(i)&&i.length===6)this.setUniformMatrixValue(r.name,yT(this.tmpMat4_,i));else if(Array.isArray(i)&&i.length<=4)switch(i.length){case 2:n.uniform2f(this.getUniformLocation(r.name),i[0],i[1]);return;case 3:n.uniform3f(this.getUniformLocation(r.name),i[0],i[1],i[2]);return;case 4:n.uniform4f(this.getUniformLocation(r.name),i[0],i[1],i[2],i[3]);return;default:return}else typeof i=="number"&&n.uniform1f(this.getUniformLocation(r.name),i)})}useProgram(e,n){this.disableAllAttributes_(),this.gl_.useProgram(e),this.currentProgram_=e,n&&(this.applyFrameState(n),this.applyUniforms(n))}compileShader(e,n){const i=this.gl_,s=i.createShader(n);return i.shaderSource(s,e),i.compileShader(s),s}getProgram(e,n){const i=this.gl_,s=this.compileShader(e,i.FRAGMENT_SHADER),r=this.compileShader(n,i.VERTEX_SHADER),o=i.createProgram();if(i.attachShader(o,s),i.attachShader(o,r),i.linkProgram(o),!i.getShaderParameter(s,i.COMPILE_STATUS)){const a=`Fragment shader compilation failed: ${i.getShaderInfoLog(s)}`;throw new Error(a)}if(i.deleteShader(s),!i.getShaderParameter(r,i.COMPILE_STATUS)){const a=`Vertex shader compilation failed: ${i.getShaderInfoLog(r)}`;throw new Error(a)}if(i.deleteShader(r),!i.getProgramParameter(o,i.LINK_STATUS)){const a=`GL program linking failed: ${i.getProgramInfoLog(o)}`;throw new Error(a)}return o}getUniformLocation(e){const n=me(this.currentProgram_);return this.uniformLocationsByProgram_[n]===void 0&&(this.uniformLocationsByProgram_[n]={}),this.uniformLocationsByProgram_[n][e]===void 0&&(this.uniformLocationsByProgram_[n][e]=this.gl_.getUniformLocation(this.currentProgram_,e)),this.uniformLocationsByProgram_[n][e]}getAttributeLocation(e){const n=me(this.currentProgram_);return this.attribLocationsByProgram_[n]===void 0&&(this.attribLocationsByProgram_[n]={}),this.attribLocationsByProgram_[n][e]===void 0&&(this.attribLocationsByProgram_[n][e]=this.gl_.getAttribLocation(this.currentProgram_,e)),this.attribLocationsByProgram_[n][e]}makeProjectionTransform(e,n){const i=e.size,s=e.viewState.rotation,r=e.viewState.resolution,o=e.viewState.center;return mi(n,0,0,2/(r*i[0]),2/(r*i[1]),-s,-o[0],-o[1]),n}setUniformFloatValue(e,n){this.gl_.uniform1f(this.getUniformLocation(e),n)}setUniformFloatVec2(e,n){this.gl_.uniform2fv(this.getUniformLocation(e),n)}setUniformFloatVec4(e,n){this.gl_.uniform4fv(this.getUniformLocation(e),n)}setUniformMatrixValue(e,n){this.gl_.uniformMatrix4fv(this.getUniformLocation(e),!1,n)}disableAllAttributes_(){for(let e=0;e<this.maxAttributeCount_;e++)this.gl_.disableVertexAttribArray(e)}enableAttributeArray_(e,n,i,s,r){const o=this.getAttributeLocation(e);o<0||(this.gl_.enableVertexAttribArray(o),this.gl_.vertexAttribPointer(o,n,i,!1,s,r))}enableAttributes(e){const n=kU(e);let i=0;for(let s=0;s<e.length;s++){const r=e[s];this.enableAttributeArray_(r.name,r.size,r.type||ET,n,i),i+=r.size*wT(r.type)}}handleWebGLContextLost(e){Fr(this.bufferCache_),this.currentProgram_=null,e.preventDefault()}handleWebGLContextRestored(){this.needsToBeRecreated_=!0}needsToBeRecreated(){return this.needsToBeRecreated_}createTexture(e,n,i,s){const r=this.gl_;i=i||r.createTexture();const o=s?r.NEAREST:r.LINEAR;r.bindTexture(r.TEXTURE_2D,i),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,o),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,o),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE);const a=0,l=r.RGBA,c=0,h=r.RGBA,u=r.UNSIGNED_BYTE;return n instanceof Uint8Array?r.texImage2D(r.TEXTURE_2D,a,l,e[0],e[1],c,h,u,n):n?r.texImage2D(r.TEXTURE_2D,a,l,h,u,n):r.texImage2D(r.TEXTURE_2D,a,l,e[0],e[1],c,h,u,null),i}}function kU(t){let e=0;for(let n=0;n<t.length;n++){const i=t[n];e+=i.size*wT(i.type)}return e}function wT(t){switch(t){case Fa.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case Fa.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case Fa.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case Fa.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}class NU extends Gl{constructor(e){super(),this.tile,this.handleTileChange_=this.handleTileChange_.bind(this),this.gutter=e.gutter||0,this.helper=e.helper,this.loaded=!1,this.ready=!1}setTile(e){if(e!==this.tile)if(this.tile&&this.tile.removeEventListener(xe.CHANGE,this.handleTileChange_),this.tile=e,this.loaded=e.getState()===se.LOADED,this.loaded)this.uploadTile();else{if(e instanceof Fu){const n=e.getImage();n instanceof Image&&!n.crossOrigin&&(n.crossOrigin="anonymous")}e.addEventListener(xe.CHANGE,this.handleTileChange_)}}uploadTile(){Se()}setReady(){this.ready=!0,this.dispatchEvent(xe.CHANGE)}handleTileChange_(){this.tile.getState()===se.LOADED&&(this.loaded=!0,this.uploadTile())}setHelper(e){this.helper=e,this.helper&&this.loaded&&this.uploadTile()}disposeInternal(){this.setHelper(null),this.tile.removeEventListener(xe.CHANGE,this.handleTileChange_)}}function ST(t,e,n){const i=n?t.LINEAR:t.NEAREST;t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,i)}function BU(t,e,n,i){ST(t,e,i),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)}function bx(t,e,n,i,s,r){const o=t.getGL();let a,l;n instanceof Float32Array?(a=o.FLOAT,t.getExtension("OES_texture_float"),l=t.getExtension("OES_texture_float_linear")!==null):(a=o.UNSIGNED_BYTE,l=!0),ST(o,e,r&&l);const c=n.byteLength/i[1];let h=1;c%8===0?h=8:c%4===0?h=4:c%2===0&&(h=2);let u;switch(s){case 1:{u=o.LUMINANCE;break}case 2:{u=o.LUMINANCE_ALPHA;break}case 3:{u=o.RGB;break}case 4:{u=o.RGBA;break}default:throw new Error(`Unsupported number of bands: ${s}`)}const d=o.getParameter(o.UNPACK_ALIGNMENT);o.pixelStorei(o.UNPACK_ALIGNMENT,h),o.texImage2D(o.TEXTURE_2D,0,u,i[0],i[1],0,u,a,n),o.pixelStorei(o.UNPACK_ALIGNMENT,d)}let oo=null;function UU(){oo=Et(1,1,void 0,{willReadFrequently:!0})}class GU extends NU{constructor(e){super(e),this.textures=[],this.renderSize_=Ct(e.grid.getTileSize(e.tile.tileCoord[0])),this.bandCount=NaN;const n=new xT(i_,r_);n.fromArray([0,1,1,1,1,0,0,0]),this.helper.flushBufferData(n),this.coords=n,this.setTile(e.tile)}setHelper(e){const n=this.helper?.getGL();if(n){this.helper.deleteBuffer(this.coords);for(let i=0;i<this.textures.length;++i)n.deleteTexture(this.textures[i])}super.setHelper(e),e&&e.flushBufferData(this.coords)}uploadTile(){const e=this.helper,n=e.getGL(),i=this.tile;this.textures.length=0;let s;i instanceof Fu||i instanceof n_?s=i.getImage():s=i.getData();const r=$o(s);if(r){const _=n.createTexture();this.textures.push(_),this.bandCount=4,BU(n,_,r,i.interpolate),this.setReady();return}s=Fg(s);const o=i.getSize(),a=[o[0]+2*this.gutter,o[1]+2*this.gutter],l=s instanceof Float32Array,c=a[0]*a[1],h=l?Float32Array:Uint8Array,u=h.BYTES_PER_ELEMENT,d=s.byteLength/a[1];this.bandCount=Math.floor(d/u/a[0]);const f=Math.ceil(this.bandCount/4);if(f===1){const _=n.createTexture();this.textures.push(_),bx(e,_,s,a,this.bandCount,i.interpolate),this.setReady();return}const g=new Array(f);for(let _=0;_<f;++_){const x=n.createTexture();this.textures.push(x);const E=_<f-1?4:(this.bandCount-1)%4+1;g[_]=new h(c*E)}let m=0,p=0;const y=a[0]*this.bandCount;for(let _=0;_<a[1];++_){for(let x=0;x<y;++x){const E=s[p+x],w=Math.floor(m/this.bandCount),b=x%this.bandCount,v=Math.floor(b/4),A=g[v],P=A.length/c,M=b%4;A[w*P+M]=E,++m}p+=d/u}for(let _=0;_<f;++_){const x=this.textures[_],E=g[_],w=E.length/c;bx(e,x,E,a,w,i.interpolate)}this.setReady()}getImagePixelData_(e,n,i){const s=this.gutter,r=this.renderSize_[0],o=this.renderSize_[1];oo||UU(),oo.clearRect(0,0,1,1);const a=e.width,l=e.height,c=a-2*s,h=l-2*s,u=s+Math.floor(c*(n/r)),d=s+Math.floor(h*(i/o));let f;try{oo.drawImage(e,u,d,1,1,0,0,1,1),f=oo.getImageData(0,0,1,1).data}catch{return oo=null,null}return f}getArrayPixelData_(e,n,i,s){const r=this.gutter,o=this.renderSize_[0],a=this.renderSize_[1],l=n[0],c=n[1],h=l+2*r,u=c+2*r,d=r+Math.floor(l*(i/o)),f=r+Math.floor(c*(s/a));if(e instanceof DataView){const m=e.byteLength/(h*u),p=m*(f*h+d),y=e.buffer.slice(p,p+m);return new DataView(y)}const g=this.bandCount*(f*h+d);return e.slice(g,g+this.bandCount)}getPixelData(e,n){if(!this.loaded)return null;if(this.tile instanceof vl){const i=this.tile.getData(),s=Fg(i);if(s){const r=this.tile.getSize();return this.getArrayPixelData_(s,r,e,n)}return this.getImagePixelData_($o(i),e,n)}return this.getImagePixelData_(this.tile.getImage(),e,n)}}class o_ extends pT{constructor(e,n){super(e),n=n||{},this.inversePixelTransform_=hn(),this.postProcesses_=n.postProcesses,this.uniforms_=n.uniforms,this.helper,this.onMapChanged_=()=>{this.clearCache(),this.removeHelper()},e.addChangeListener(Ke.MAP,this.onMapChanged_),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(e,n){const i=this.getLayer();if(i.hasListener(Ut.PRECOMPOSE)){const s=new Qa(Ut.PRECOMPOSE,void 0,n,e);i.dispatchEvent(s)}}dispatchPostComposeEvent(e,n){const i=this.getLayer();if(i.hasListener(Ut.POSTCOMPOSE)){const s=new Qa(Ut.POSTCOMPOSE,void 0,n,e);i.dispatchEvent(s)}}reset(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(e){if(this.getLayer().getRenderSource()){let n=!0,i=-1,s;for(let o=0,a=e.layerStatesArray.length;o<a;o++){const l=e.layerStatesArray[o].layer,c=l.getRenderer();if(!(c instanceof o_)){n=!0;continue}const h=l.getClassName();if((n||h!==s)&&(i+=1,n=!1),s=h,c===this)break}const r="map/"+e.mapId+"/group/"+i;(!this.helper||!this.helper.canvasCacheKeyMatches(r)||this.helper.needsToBeRecreated())&&(this.removeHelper(),this.helper=new LU({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:r}),s&&(this.helper.getCanvas().className=s),this.afterHelperCreated())}return this.prepareFrameInternal(e)}afterHelperCreated(){}prepareFrameInternal(e){return!0}clearCache(){}disposeInternal(){this.clearCache(),this.removeHelper(),this.getLayer()?.removeChangeListener(Ke.MAP,this.onMapChanged_),super.disposeInternal()}dispatchRenderEvent_(e,n,i){const s=this.getLayer();if(s.hasListener(e)){mi(this.inversePixelTransform_,0,0,i.pixelRatio,-i.pixelRatio,0,0,-i.size[1]);const r=new Qa(e,this.inversePixelTransform_,i,n);s.dispatchEvent(r)}}preRender(e,n){this.dispatchRenderEvent_(Ut.PRERENDER,e,n)}postRender(e,n){this.dispatchRenderEvent_(Ut.POSTRENDER,e,n)}}const $U={TILE_TRANSFORM:"u_tileTransform",TRANSITION_ALPHA:"u_transitionAlpha",DEPTH:"u_depth",RENDER_EXTENT:"u_renderExtent",PATTERN_ORIGIN:"u_patternOrigin",RESOLUTION:"u_resolution",ZOOM:"u_zoom",GLOBAL_ALPHA:"u_globalAlpha",PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix"};function Tx(t){return 1/(t+2)}function jU(){return{tileIds:new Set,representationsByZ:{}}}function Rx(t,e){return t.tileIds.has(me(e))}function vx(t,e,n){const i=t.representationsByZ;n in i||(i[n]=new Set),i[n].add(e),t.tileIds.add(me(e.tile))}function yf(t,e){const n=t.layerStatesArray[t.layerIndex];n.extent&&(e=Cn(e,fi(n.extent,t.viewState.projection)));const i=n.layer.getRenderSource();if(!i.getWrapX()){const s=i.getTileGridForProjection(t.viewState.projection).getExtent();s&&(e=Cn(e,s))}return e}function Og(t,e){return`${me(t)},${t.getKey()},${t.getRevision()},${so(e)}`}class zU extends o_{constructor(e,n){super(e,{uniforms:n.uniforms,postProcesses:n.postProcesses}),this.renderComplete=!1,this.tileTransform_=hn(),this.tempMat4=sa(),this.tempTileRange_=new Du(0,0,0,0),this.tempTileCoord_=jo(0,0,0),this.tempSize_=[0,0];const i=n.cacheSize!==void 0?n.cacheSize:512;this.tileRepresentationCache=new dT(i),this.frameState=null,this.renderedProjection_=void 0}reset(e){super.reset({uniforms:e.uniforms})}prepareFrameInternal(e){this.renderedProjection_?e.viewState.projection!==this.renderedProjection_&&(this.clearCache(),this.renderedProjection_=e.viewState.projection):this.renderedProjection_=e.viewState.projection;const i=this.getLayer().getRenderSource();return!i||Qo(yf(e,e.extent))?!1:i.getState()==="ready"}createTileRepresentation(e){return Se()}enqueueTiles(e,n,i,s,r){const o=e.viewState,a=this.getLayer(),l=a.getRenderSource(),c=l.getTileGridForProjection(o.projection),h=l.getGutterForProjection(o.projection),u=me(l);u in e.wantedTiles||(e.wantedTiles[u]={});const d=e.wantedTiles[u],f=this.tileRepresentationCache,g=a.getMapInternal(),m=Math.max(i-r,c.getMinZoom(),c.getZForResolution(Math.min(a.getMaxResolution(),g?g.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):c.getResolution(0)),l.zDirection)),p=o.rotation,y=p?_m(o.center,o.resolution,p,e.size):void 0;for(let _=i;_>=m;--_){const x=c.getTileRangeForExtentAndZ(n,_,this.tempTileRange_),E=c.getResolution(_);for(let w=x.minX;w<=x.maxX;++w)for(let b=x.minY;b<=x.maxY;++b){if(p&&!c.tileCoordIntersectsViewport([_,w,b],y))continue;const v=jo(_,w,b,this.tempTileCoord_),A=Og(l,v);let P,M;if(f.containsKey(A)&&(P=f.get(A),M=P.tile),(!P||P.tile.key!==l.getKey())&&(M=l.getTile(_,w,b,e.pixelRatio,o.projection),!M)||Rx(s,M))continue;P?P.setTile(M):(P=this.createTileRepresentation({tile:M,grid:c,helper:this.helper,gutter:h}),f.set(A,P)),vx(s,P,_);const Y=M.getKey();d[Y]=!0,M.getState()===se.IDLE&&(e.tileQueue.isKeyQueued(Y)||e.tileQueue.enqueue([M,u,c.getTileCoordCenter(v),E]))}}}beforeTilesRender(e,n){this.helper.prepareDraw(this.frameState,!n,!0)}beforeTilesMaskRender(e){return!1}renderTile(e,n,i,s,r,o,a,l,c,h,u){}renderTileMask(e,n,i,s){}drawTile_(e,n,i,s,r,o,a){if(!n.ready)return;const c=n.tile.tileCoord,h=so(c),u=h in o?o[h]:1,d=a.getResolution(i),f=Ct(a.getTileSize(i),this.tempSize_),g=a.getOrigin(i),m=a.getTileCoordExtent(c),p=u<1?-1:Tx(i);u<1&&(e.animate=!0);const y=e.viewState,_=y.center[0],x=y.center[1],E=f[0]+2*s,w=f[1]+2*s,b=E/w,v=(_-g[0])/(f[0]*d),A=(g[1]-x)/(f[1]*d),P=y.resolution/d,M=c[1],Y=c[2];GN(this.tileTransform_),jE(this.tileTransform_,2/(e.size[0]*P/E),-2/(e.size[1]*P/E)),jN(this.tileTransform_,y.rotation),jE(this.tileTransform_,1,1/b),zN(this.tileTransform_,(f[0]*(M-v)-s)/E,(f[1]*(Y-A)-s)/w),this.renderTile(n,this.tileTransform_,e,r,d,f,g,m,p,s,u)}renderFrame(e){this.frameState=e,this.renderComplete=!0;const n=this.helper.getGL();this.preRender(n,e);const i=e.viewState,s=this.getLayer(),r=s.getRenderSource(),o=r.getTileGridForProjection(i.projection),a=r.getGutterForProjection(i.projection),l=yf(e,e.extent),c=o.getZForResolution(i.resolution,r.zDirection),h=jU(),u=s.getPreload();if(e.nextExtent){const x=o.getZForResolution(i.nextResolution,r.zDirection),E=yf(e,e.nextExtent);this.enqueueTiles(e,E,x,h,u)}this.enqueueTiles(e,l,c,h,0),u>0&&setTimeout(()=>{this.enqueueTiles(e,l,c-1,h,u-1)},0);const d={};let f=!1;const g=h.representationsByZ;if(c in g){const x=me(this),E=e.time;for(const w of g[c]){const b=w.tile;if(b.getState()===se.EMPTY)continue;const v=b.tileCoord;if(w.ready){const M=b.getAlpha(x,E);if(M===1){b.endTransition(x);continue}f=!0;const Y=so(v);d[Y]=M}if(this.renderComplete=!1,this.findAltTiles_(o,v,c+1,h))continue;const P=o.getMinZoom();for(let M=c-1;M>=P&&!this.findAltTiles_(o,v,M,h);--M);}}const m=Object.keys(g).map(Number).sort(ab);if(this.beforeTilesMaskRender(e))for(let x=0,E=m.length;x<E;++x){const w=m[x];for(const b of g[w]){const v=b.tile.tileCoord;if(so(v)in d)continue;const P=o.getTileCoordExtent(v);this.renderTileMask(b,w,P,Tx(w))}}this.beforeTilesRender(e,f);for(let x=0,E=m.length;x<E;++x){const w=m[x];for(const b of g[w]){const v=b.tile.tileCoord;so(v)in d||this.drawTile_(e,b,w,a,l,d,o)}}if(c in g)for(const x of g[c]){const E=x.tile.tileCoord;so(E)in d&&this.drawTile_(e,x,c,a,l,d,o)}this.beforeFinalize(e),this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const y=this.helper.getCanvas(),_=this.tileRepresentationCache;for(;_.canExpireCache();)_.pop().dispose();return this.postRender(n,e),y}beforeFinalize(e){}findAltTiles_(e,n,i,s){const r=e.getTileRangeForTileCoordAndZ(n,i,this.tempTileRange_);if(!r)return!1;let o=!0;const a=this.tileRepresentationCache,l=this.getLayer().getRenderSource();for(let c=r.minX;c<=r.maxX;++c)for(let h=r.minY;h<=r.maxY;++h){const u=Og(l,[i,c,h]);let d=!1;if(a.containsKey(u)){const f=a.get(u);f.ready&&!Rx(s,f.tile)&&(vx(s,f,i),d=!0)}d||(o=!1)}return o}clearCache(){super.clearCache();const e=this.tileRepresentationCache;e.forEach(n=>n.dispose()),e.clear()}afterHelperCreated(){super.afterHelperCreated(),this.tileRepresentationCache.forEach(e=>e.setHelper(this.helper))}disposeInternal(){super.disposeInternal(),delete this.frameState}}const Ae={...$U,TILE_TEXTURE_ARRAY:"u_tileTextures",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight",TEXTURE_RESOLUTION:"u_textureResolution",TEXTURE_ORIGIN_X:"u_textureOriginX",TEXTURE_ORIGIN_Y:"u_textureOriginY"},Qc={TEXTURE_COORD:"a_textureCoord"},HU=[{name:Qc.TEXTURE_COORD,size:2,type:Fa.FLOAT}];class XU extends zU{constructor(e,n){super(e,n),this.program_,this.vertexShader_=n.vertexShader,this.fragmentShader_=n.fragmentShader,this.indices_=new xT(s_,r_),this.indices_.fromArray([0,1,3,1,2,3]),this.paletteTextures_=n.paletteTextures||[]}reset(e){if(super.reset(e),this.helper){const n=this.helper.getGL();for(const i of this.paletteTextures_)i.delete(n)}if(this.vertexShader_=e.vertexShader,this.fragmentShader_=e.fragmentShader,this.paletteTextures_=e.paletteTextures||[],this.helper){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_);const n=this.helper.getGL();for(const i of this.paletteTextures_)i.getTexture(n)}}afterHelperCreated(){super.afterHelperCreated();const e=this.helper.getGL();for(const n of this.paletteTextures_)n.getTexture(e);this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.helper.flushBufferData(this.indices_)}removeHelper(){if(this.helper){const e=this.helper.getGL();for(const n of this.paletteTextures_)n.delete(e)}super.removeHelper()}createTileRepresentation(e){return new GU(e)}beforeTilesRender(e,n){super.beforeTilesRender(e,n),this.helper.useProgram(this.program_,e)}renderTile(e,n,i,s,r,o,a,l,c,h,u){const d=this.helper.getGL();this.helper.bindBuffer(e.coords),this.helper.bindBuffer(this.indices_),this.helper.enableAttributes(HU);let f=0;for(;f<e.textures.length;){const b=`${Ae.TILE_TEXTURE_ARRAY}[${f}]`;this.helper.bindTexture(e.textures[f],f,b),++f}for(let b=0;b<this.paletteTextures_.length;++b){const v=this.paletteTextures_[b],A=v.getTexture(d);this.helper.bindTexture(A,f,v.name),++f}const g=i.viewState,m=o[0]+2*h,p=o[1]+2*h,_=e.tile.tileCoord,x=_[1],E=_[2];this.helper.setUniformMatrixValue(Ae.TILE_TRANSFORM,yT(this.tempMat4,n)),this.helper.setUniformFloatValue(Ae.TRANSITION_ALPHA,u),this.helper.setUniformFloatValue(Ae.DEPTH,c);let w=s;h>0&&(w=l,Cn(w,s,w)),this.helper.setUniformFloatVec4(Ae.RENDER_EXTENT,w),this.helper.setUniformFloatValue(Ae.RESOLUTION,g.resolution),this.helper.setUniformFloatValue(Ae.ZOOM,g.zoom),this.helper.setUniformFloatValue(Ae.TEXTURE_PIXEL_WIDTH,m),this.helper.setUniformFloatValue(Ae.TEXTURE_PIXEL_HEIGHT,p),this.helper.setUniformFloatValue(Ae.TEXTURE_RESOLUTION,r),this.helper.setUniformFloatValue(Ae.TEXTURE_ORIGIN_X,a[0]+x*o[0]*r-h*r),this.helper.setUniformFloatValue(Ae.TEXTURE_ORIGIN_Y,a[1]-E*o[1]*r+h*r),this.helper.drawElements(0,this.indices_.getSize())}getData(e){if(!this.helper.getGL())return null;const i=this.frameState;if(!i)return null;const s=this.getLayer(),r=vt(i.pixelToCoordinateTransform,e.slice()),o=i.viewState,a=s.getExtent();if(a&&!Hs(fi(a,o.projection),r))return null;const l=s.getSources(mn([r]),o.resolution);let c,h,u;for(c=l.length-1;c>=0;--c)if(h=l[c],h.getState()==="ready"){if(u=h.getTileGridForProjection(o.projection),h.getWrapX())break;const f=u.getExtent();if(!f||Hs(f,r))break}if(c<0)return null;const d=this.tileRepresentationCache;for(let f=u.getZForResolution(o.resolution);f>=u.getMinZoom();--f){const g=u.getTileCoordForCoordAndZ(r,f),m=Og(h,g);if(!d.containsKey(m))continue;const p=d.get(m);if(p.tile.getState()===se.EMPTY)return null;if(!p.loaded)continue;const _=u.getOrigin(f),x=Ct(u.getTileSize(f)),E=u.getResolution(f),w=(r[0]-_[0])/E-g[1]*x[0],b=(_[1]-r[1])/E-g[2]*x[1];return p.getPixelData(w,b)}return null}disposeInternal(){const e=this.helper;if(e){const n=e.getGL();for(const i of this.paletteTextures_)i.delete(n);this.paletteTextures_.length=0,n.deleteProgram(this.program_),delete this.program_,e.deleteBuffer(this.indices_)}super.disposeInternal(),delete this.indices_}}class VU{constructor(e,n){this.name=e,this.data=n,this.texture_=null}getTexture(e){if(!this.texture_){const n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=n}return this.texture_}delete(e){this.texture_&&e.deleteTexture(this.texture_),this.texture_=null}}function WU(t,e){return`operator_${t}_${Object.keys(e.functions).length}`}function Al(t){const e=t.toString();return e.includes(".")?e:e+".0"}function a_(t){if(t.length<2||t.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return`vec${t.length}(${t.map(Al).join(", ")})`}function KU(t){const e=Vs(t),n=e.length>3?e[3]:1;return a_([e[0]/255,e[1]/255,e[2]/255,n])}function YU(t){const e=Ct(t);return a_(e)}const Ef={};let qU=0;function CT(t){return t in Ef||(Ef[t]=qU++),Ef[t]}function ZU(t){return Al(CT(t))}function bT(t){return"u_var_"+t}function JU(){return{variables:{},properties:{},functions:{},bandCount:0,featureId:!1,geometryType:!1}}const xf="getBandValue",TT="u_paletteTextures",QU="featureId",eG="geometryType",tG=-9999999;function nG(t,e,n,i){const s=zt(t,e,n);return l_(s,e,i)}function We(t){return(e,n,i)=>{const s=n.args.length,r=new Array(s);for(let o=0;o<s;++o)r[o]=l_(n.args[o],i,e);return t(r,e)}}const iG={[I.Get]:(t,e)=>{const i=e.args[0].value;return i in t.properties||(t.properties[i]={name:i,type:e.type}),"a_prop_"+i},[I.Id]:t=>(t.featureId=!0,"a_"+QU),[I.GeometryType]:t=>(t.geometryType=!0,"a_"+eG),[I.LineMetric]:()=>"currentLineMetric",[I.Var]:(t,e)=>{const i=e.args[0].value;return i in t.variables||(t.variables[i]={name:i,type:e.type}),bT(i)},[I.Has]:(t,e)=>{const i=e.args[0].value;return i in t.properties||(t.properties[i]={name:i,type:e.type}),`(a_prop_${i} != ${Al(tG)})`},[I.Resolution]:()=>"u_resolution",[I.Zoom]:()=>"u_zoom",[I.Time]:()=>"u_time",[I.Any]:We(t=>`(${t.join(" || ")})`),[I.All]:We(t=>`(${t.join(" && ")})`),[I.Not]:We(([t])=>`(!${t})`),[I.Equal]:We(([t,e])=>`(${t} == ${e})`),[I.NotEqual]:We(([t,e])=>`(${t} != ${e})`),[I.GreaterThan]:We(([t,e])=>`(${t} > ${e})`),[I.GreaterThanOrEqualTo]:We(([t,e])=>`(${t} >= ${e})`),[I.LessThan]:We(([t,e])=>`(${t} < ${e})`),[I.LessThanOrEqualTo]:We(([t,e])=>`(${t} <= ${e})`),[I.Multiply]:We(t=>`(${t.join(" * ")})`),[I.Divide]:We(([t,e])=>`(${t} / ${e})`),[I.Add]:We(t=>`(${t.join(" + ")})`),[I.Subtract]:We(([t,e])=>`(${t} - ${e})`),[I.Clamp]:We(([t,e,n])=>`clamp(${t}, ${e}, ${n})`),[I.Mod]:We(([t,e])=>`mod(${t}, ${e})`),[I.Pow]:We(([t,e])=>`pow(${t}, ${e})`),[I.Abs]:We(([t])=>`abs(${t})`),[I.Floor]:We(([t])=>`floor(${t})`),[I.Ceil]:We(([t])=>`ceil(${t})`),[I.Round]:We(([t])=>`floor(${t} + 0.5)`),[I.Sin]:We(([t])=>`sin(${t})`),[I.Cos]:We(([t])=>`cos(${t})`),[I.Atan]:We(([t,e])=>e!==void 0?`atan(${t}, ${e})`:`atan(${t})`),[I.Sqrt]:We(([t])=>`sqrt(${t})`),[I.Match]:We(t=>{const e=t[0],n=t[t.length-1];let i=null;for(let s=t.length-3;s>=1;s-=2){const r=t[s],o=t[s+1];i=`(${e} == ${r} ? ${o} : ${i||n})`}return i}),[I.Between]:We(([t,e,n])=>`(${t} >= ${e} && ${t} <= ${n})`),[I.Interpolate]:We(([t,e,...n])=>{let i="";for(let s=0;s<n.length-2;s+=2){const r=n[s],o=i||n[s+1],a=n[s+2],l=n[s+3];let c;t===Al(1)?c=`(${e} - ${r}) / (${a} - ${r})`:c=`(pow(${t}, (${e} - ${r})) - 1.0) / (pow(${t}, (${a} - ${r})) - 1.0)`,i=`mix(${o}, ${l}, clamp(${c}, 0.0, 1.0))`}return i}),[I.Case]:We(t=>{const e=t[t.length-1];let n=null;for(let i=t.length-3;i>=0;i-=2){const s=t[i],r=t[i+1];n=`(${s} ? ${r} : ${n||e})`}return n}),[I.In]:We(([t,...e],n)=>{const i=WU("in",n),s=[];for(let r=0;r<e.length;r+=1)s.push(`  if (inputValue == ${e[r]}) { return true; }`);return n.functions[i]=`bool ${i}(float inputValue) {
${s.join(`
`)}
  return false;
}`,`${i}(${t})`}),[I.Array]:We(t=>`vec${t.length}(${t.join(", ")})`),[I.Color]:We(t=>{if(t.length===1)return`vec4(vec3(${t[0]} / 255.0), 1.0)`;if(t.length===2)return`vec4(vec3(${t[0]} / 255.0), ${t[1]})`;const e=t.slice(0,3).map(i=>`${i} / 255.0`);if(t.length===3)return`vec4(${e.join(", ")}, 1.0)`;const n=t[3];return`vec4(${e.join(", ")}, ${n})`}),[I.Band]:We(([t,e,n],i)=>{if(!(xf in i.functions)){let s="";const r=i.bandCount||1;for(let o=0;o<r;o++){const a=Math.floor(o/4);let l=o%4;o===r-1&&l===1&&(l=3);const c=`${Ae.TILE_TEXTURE_ARRAY}[${a}]`;s+=`  if (band == ${o+1}.0) {
    return texture2D(${c}, v_textureCoord + vec2(dx, dy))[${l}];
  }
`}i.functions[xf]=`float getBandValue(float band, float xOffset, float yOffset) {
  float dx = xOffset / ${Ae.TEXTURE_PIXEL_WIDTH};
  float dy = yOffset / ${Ae.TEXTURE_PIXEL_HEIGHT};
${s}
}`}return`${xf}(${t}, ${e??"0.0"}, ${n??"0.0"})`}),[I.Palette]:(t,e)=>{const[n,...i]=e.args,s=i.length,r=new Uint8Array(s*4);for(let c=0;c<i.length;c++){const h=i[c].value,u=Vs(h),d=c*4;r[d]=u[0],r[d+1]=u[1],r[d+2]=u[2],r[d+3]=u[3]*255}t.paletteTextures||(t.paletteTextures=[]);const o=`${TT}[${t.paletteTextures.length}]`,a=new VU(o,r);t.paletteTextures.push(a);const l=l_(n,Pe,t);return`texture2D(${o}, vec2((${l} + 0.5) / ${s}.0, 0.5))`}};function l_(t,e,n){if(t instanceof Kb){const i=iG[t.operator];if(i===void 0)throw new Error(`No compiler defined for this operator: ${JSON.stringify(t.operator)}`);return i(n,t,e)}if((t.type&Pe)>0)return Al(t.value);if((t.type&an)>0)return t.value.toString();if((t.type&En)>0)return ZU(t.value.toString());if((t.type&Hn)>0)return KU(t.value);if((t.type&Ws)>0)return a_(t.value);if((t.type&co)>0)return YU(t.value);throw new Error(`Unexpected expression ${t.value} (expected type ${ho(e)})`)}function Kr(t,e,n){const i=Zm();return nG(e,n,i,t)}function Ax(t,e){const n=`
    attribute vec2 ${Qc.TEXTURE_COORD};
    uniform mat4 ${Ae.TILE_TRANSFORM};
    uniform float ${Ae.TEXTURE_PIXEL_WIDTH};
    uniform float ${Ae.TEXTURE_PIXEL_HEIGHT};
    uniform float ${Ae.TEXTURE_RESOLUTION};
    uniform float ${Ae.TEXTURE_ORIGIN_X};
    uniform float ${Ae.TEXTURE_ORIGIN_Y};
    uniform float ${Ae.DEPTH};

    varying vec2 v_textureCoord;
    varying vec2 v_mapCoord;

    void main() {
      v_textureCoord = ${Qc.TEXTURE_COORD};
      v_mapCoord = vec2(
        ${Ae.TEXTURE_ORIGIN_X} + ${Ae.TEXTURE_RESOLUTION} * ${Ae.TEXTURE_PIXEL_WIDTH} * v_textureCoord[0],
        ${Ae.TEXTURE_ORIGIN_Y} - ${Ae.TEXTURE_RESOLUTION} * ${Ae.TEXTURE_PIXEL_HEIGHT} * v_textureCoord[1]
      );
      gl_Position = ${Ae.TILE_TRANSFORM} * vec4(${Qc.TEXTURE_COORD}, ${Ae.DEPTH}, 1.0);
    }
  `,i={...JU(),bandCount:e},s=[];if(t.color!==void 0){const u=Kr(i,t.color,Hn);s.push(`color = ${u};`)}if(t.contrast!==void 0){const u=Kr(i,t.contrast,Pe);s.push(`color.rgb = clamp((${u} + 1.0) * color.rgb - (${u} / 2.0), vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));`)}if(t.exposure!==void 0){const u=Kr(i,t.exposure,Pe);s.push(`color.rgb = clamp((${u} + 1.0) * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));`)}if(t.saturation!==void 0){const u=Kr(i,t.saturation,Pe);s.push(`
      float saturation = ${u} + 1.0;
      float sr = (1.0 - saturation) * 0.2126;
      float sg = (1.0 - saturation) * 0.7152;
      float sb = (1.0 - saturation) * 0.0722;
      mat3 saturationMatrix = mat3(
        sr + saturation, sr, sr,
        sg, sg + saturation, sg,
        sb, sb, sb + saturation
      );
      color.rgb = clamp(saturationMatrix * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));
    `)}if(t.gamma!==void 0){const u=Kr(i,t.gamma,Pe);s.push(`color.rgb = pow(color.rgb, vec3(1.0 / ${u}));`)}if(t.brightness!==void 0){const u=Kr(i,t.brightness,Pe);s.push(`color.rgb = clamp(color.rgb + ${u}, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));`)}const r={},o=Object.keys(i.variables).length;if(o>1&&!t.variables)throw new Error(`Missing variables in style (expected ${i.variables})`);for(let u=0;u<o;++u){const d=i.variables[Object.keys(i.variables)[u]];if(!(d.name in t.variables))throw new Error(`Missing '${d.name}' in style variables`);const f=bT(d.name);r[f]=function(){let g=t.variables[d.name];return typeof g=="string"&&(g=CT(g)),g!==void 0?g:-9999999}}const a=Object.keys(r).map(function(u){return`uniform float ${u};`}),l=Math.ceil(e/4);a.push(`uniform sampler2D ${Ae.TILE_TEXTURE_ARRAY}[${l}];`),i.paletteTextures&&a.push(`uniform sampler2D ${TT}[${i.paletteTextures.length}];`);const c=Object.keys(i.functions).map(function(u){return i.functions[u]}),h=`
    #ifdef GL_FRAGMENT_PRECISION_HIGH
    precision highp float;
    #else
    precision mediump float;
    #endif

    varying vec2 v_textureCoord;
    varying vec2 v_mapCoord;
    uniform vec4 ${Ae.RENDER_EXTENT};
    uniform float ${Ae.TRANSITION_ALPHA};
    uniform float ${Ae.TEXTURE_PIXEL_WIDTH};
    uniform float ${Ae.TEXTURE_PIXEL_HEIGHT};
    uniform float ${Ae.RESOLUTION};
    uniform float ${Ae.ZOOM};

    ${a.join(`
`)}

    ${c.join(`
`)}

    void main() {
      if (
        v_mapCoord[0] < ${Ae.RENDER_EXTENT}[0] ||
        v_mapCoord[1] < ${Ae.RENDER_EXTENT}[1] ||
        v_mapCoord[0] > ${Ae.RENDER_EXTENT}[2] ||
        v_mapCoord[1] > ${Ae.RENDER_EXTENT}[3]
      ) {
        discard;
      }

      vec4 color = texture2D(${Ae.TILE_TEXTURE_ARRAY}[0],  v_textureCoord);

      ${s.join(`
`)}

      gl_FragColor = color;
      gl_FragColor.rgb *= gl_FragColor.a;
      gl_FragColor *= ${Ae.TRANSITION_ALPHA};
    }`;return{vertexShader:n,fragmentShader:h,uniforms:r,paletteTextures:i.paletteTextures}}class RT extends _T{constructor(e){e=e?Object.assign({},e):{};const n=e.style||{};delete e.style,super(e),this.sources_=e.sources,this.renderedSource_=null,this.renderedResolution_=NaN,this.style_=n,this.styleVariables_=this.style_.variables||{},this.handleSourceUpdate_(),this.addChangeListener(Ke.SOURCE,this.handleSourceUpdate_)}getSources(e,n){const i=this.getSource();return this.sources_?typeof this.sources_=="function"?this.sources_(e,n):this.sources_:i?[i]:[]}getRenderSource(){return this.renderedSource_||this.getSource()}getSourceState(){const e=this.getRenderSource();return e?e.getState():"undefined"}handleSourceUpdate_(){this.hasRenderer()&&this.getRenderer().clearCache();const e=this.getSource();if(e)if(e.getState()==="loading"){const n=()=>{e.getState()==="ready"&&(e.removeEventListener("change",n),this.setStyle(this.style_))};e.addEventListener("change",n)}else this.setStyle(this.style_)}getSourceBandCount_(){const e=Number.MAX_SAFE_INTEGER,n=this.getSources([-e,-e,e,e],e);return n&&n.length&&"bandCount"in n[0]?n[0].bandCount:4}createRenderer(){const e=Ax(this.style_,this.getSourceBandCount_());return new XU(this,{vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,cacheSize:this.getCacheSize(),paletteTextures:e.paletteTextures})}renderSources(e,n){const i=this.getRenderer();let s;for(let r=0,o=n.length;r<o;++r)this.renderedSource_=n[r],i.prepareFrame(e)&&(s=i.renderFrame(e));return s}render(e,n){this.rendered=!0;const i=e.viewState,s=this.getSources(e.extent,i.resolution);let r=!0;for(let a=0,l=s.length;a<l;++a){const c=s[a],h=c.getState();if(h=="loading"){const u=()=>{c.getState()=="ready"&&(c.removeEventListener("change",u),this.changed())};c.addEventListener("change",u)}r=r&&h=="ready"}const o=this.renderSources(e,s);if(this.getRenderer().renderComplete&&r)return this.renderedResolution_=i.resolution,o;if(this.renderedResolution_>.5*i.resolution){const a=this.getSources(e.extent,this.renderedResolution_).filter(l=>!s.includes(l));if(a.length>0)return this.renderSources(e,a)}return o}setStyle(e){if(this.styleVariables_=e.variables||{},this.style_=e,this.hasRenderer()){const n=Ax(this.style_,this.getSourceBandCount_());this.getRenderer().reset({vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,uniforms:n.uniforms,paletteTextures:n.paletteTextures}),this.changed()}}updateStyleVariables(e){Object.assign(this.styleVariables_,e),this.changed()}}RT.prototype.dispose;class vT{drawCustom(e,n,i,s,r){}drawGeometry(e){}setStyle(e){}drawCircle(e,n,i){}drawFeature(e,n,i){}drawGeometryCollection(e,n,i){}drawLineString(e,n,i){}drawMultiLineString(e,n,i){}drawMultiPoint(e,n,i){}drawMultiPolygon(e,n,i){}drawPoint(e,n,i){}drawPolygon(e,n,i){}drawText(e,n,i){}setFillStrokeStyle(e,n){}setImageStyle(e,n){}setTextStyle(e,n){}}const Ee={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},wc=[Ee.FILL],As=[Ee.STROKE],Er=[Ee.BEGIN_PATH],Ix=[Ee.CLOSE_PATH];class Wl extends vT{constructor(e,n,i,s){super(),this.tolerance=e,this.maxExtent=n,this.pixelRatio=s,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const n=this.pixelRatio;return n==1?e:e.map(function(i){return i*n})}appendFlatPointCoordinates(e,n){const i=this.getBufferedMaxExtent(),s=this.tmpCoordinate_,r=this.coordinates;let o=r.length;for(let a=0,l=e.length;a<l;a+=n)s[0]=e[a],s[1]=e[a+1],Hs(i,s)&&(r[o++]=s[0],r[o++]=s[1]);return o}appendFlatLineCoordinates(e,n,i,s,r,o){const a=this.coordinates;let l=a.length;const c=this.getBufferedMaxExtent();o&&(n+=s);let h=e[n],u=e[n+1];const d=this.tmpCoordinate_;let f=!0,g,m,p;for(g=n+s;g<i;g+=s)d[0]=e[g],d[1]=e[g+1],p=_g(c,d),p!==m?(f&&(a[l++]=h,a[l++]=u,f=!1),a[l++]=d[0],a[l++]=d[1]):p===Bt.INTERSECTING?(a[l++]=d[0],a[l++]=d[1],f=!1):f=!0,h=d[0],u=d[1],m=p;return(r&&f||g===n+s)&&(a[l++]=h,a[l++]=u),l}drawCustomCoordinates_(e,n,i,s,r){for(let o=0,a=i.length;o<a;++o){const l=i[o],c=this.appendFlatLineCoordinates(e,n,l,s,!1,!1);r.push(c),n=l}return n}drawCustom(e,n,i,s,r){this.beginGeometry(e,n,r);const o=e.getType(),a=e.getStride(),l=this.coordinates.length;let c,h,u,d,f;switch(o){case"MultiPolygon":c=e.getOrientedFlatCoordinates(),d=[];const g=e.getEndss();f=0;for(let m=0,p=g.length;m<p;++m){const y=[];f=this.drawCustomCoordinates_(c,f,g[m],a,y),d.push(y)}this.instructions.push([Ee.CUSTOM,l,d,e,i,Sg,r]),this.hitDetectionInstructions.push([Ee.CUSTOM,l,d,e,s||i,Sg,r]);break;case"Polygon":case"MultiLineString":u=[],c=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),f=this.drawCustomCoordinates_(c,0,e.getEnds(),a,u),this.instructions.push([Ee.CUSTOM,l,u,e,i,El,r]),this.hitDetectionInstructions.push([Ee.CUSTOM,l,u,e,s||i,El,r]);break;case"LineString":case"Circle":c=e.getFlatCoordinates(),h=this.appendFlatLineCoordinates(c,0,c.length,a,!1,!1),this.instructions.push([Ee.CUSTOM,l,h,e,i,vs,r]),this.hitDetectionInstructions.push([Ee.CUSTOM,l,h,e,s||i,vs,r]);break;case"MultiPoint":c=e.getFlatCoordinates(),h=this.appendFlatPointCoordinates(c,a),h>l&&(this.instructions.push([Ee.CUSTOM,l,h,e,i,vs,r]),this.hitDetectionInstructions.push([Ee.CUSTOM,l,h,e,s||i,vs,r]));break;case"Point":c=e.getFlatCoordinates(),this.coordinates.push(c[0],c[1]),h=this.coordinates.length,this.instructions.push([Ee.CUSTOM,l,h,e,i,void 0,r]),this.hitDetectionInstructions.push([Ee.CUSTOM,l,h,e,s||i,void 0,r]);break}this.endGeometry(n)}beginGeometry(e,n,i){this.beginGeometryInstruction1_=[Ee.BEGIN_GEOMETRY,n,0,e,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Ee.BEGIN_GEOMETRY,n,0,e,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let n;const i=e.length;let s,r,o=-1;for(n=0;n<i;++n)s=e[n],r=s[0],r==Ee.END_GEOMETRY?o=n:r==Ee.BEGIN_GEOMETRY&&(s[2]=n,Bk(this.hitDetectionInstructions,o,n),o=-1)}fillStyleToState(e,n={}){if(e){const i=e.getColor();n.fillPatternScale=i&&typeof i=="object"&&"src"in i?this.pixelRatio:1,n.fillStyle=Mi(i||Fn)}else n.fillStyle=void 0;return n}strokeStyleToState(e,n={}){if(e){const i=e.getColor();n.strokeStyle=Mi(i||Sl);const s=e.getLineCap();n.lineCap=s!==void 0?s:Uo;const r=e.getLineDash();n.lineDash=r?r.slice():is;const o=e.getLineDashOffset();n.lineDashOffset=o||ss;const a=e.getLineJoin();n.lineJoin=a!==void 0?a:Go;const l=e.getWidth();n.lineWidth=l!==void 0?l:bl;const c=e.getMiterLimit();n.miterLimit=c!==void 0?c:wl,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0;return n}setFillStrokeStyle(e,n){const i=this.state;this.fillStyleToState(e,i),this.strokeStyleToState(n,i)}createFill(e){const n=e.fillStyle,i=[Ee.SET_FILL_STYLE,n];return typeof n!="string"&&i.push(e.fillPatternScale),i}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[Ee.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,n){const i=e.fillStyle;(typeof i!="string"||e.currentFillStyle!=i)&&(this.instructions.push(n.call(this,e)),e.currentFillStyle=i)}updateStrokeStyle(e,n){const i=e.strokeStyle,s=e.lineCap,r=e.lineDash,o=e.lineDashOffset,a=e.lineJoin,l=e.lineWidth,c=e.miterLimit;(e.currentStrokeStyle!=i||e.currentLineCap!=s||r!=e.currentLineDash&&!cs(e.currentLineDash,r)||e.currentLineDashOffset!=o||e.currentLineJoin!=a||e.currentLineWidth!=l||e.currentMiterLimit!=c)&&(n.call(this,e),e.currentStrokeStyle=i,e.currentLineCap=s,e.currentLineDash=r,e.currentLineDashOffset=o,e.currentLineJoin=a,e.currentLineWidth=l,e.currentMiterLimit=c)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const n=[Ee.END_GEOMETRY,e];this.instructions.push(n),this.hitDetectionInstructions.push(n)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=fb(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;uu(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class sG extends Wl{constructor(e,n,i,s){super(e,n,i,s),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,n,i){if(!this.image_||this.maxExtent&&!Hs(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,n,i);const s=e.getFlatCoordinates(),r=e.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(s,r);this.instructions.push([Ee.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ee.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(n)}drawMultiPoint(e,n,i){if(!this.image_)return;this.beginGeometry(e,n,i);const s=e.getFlatCoordinates(),r=[];for(let l=0,c=s.length;l<c;l+=e.getStride())(!this.maxExtent||Hs(this.maxExtent,s.slice(l,l+2)))&&r.push(s[l],s[l+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(r,2);this.instructions.push([Ee.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ee.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(n)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,n){const i=e.getAnchor(),s=e.getSize(),r=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=s[1],this.opacity_=e.getOpacity(),this.originX_=r[0],this.originY_=r[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=s[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=n}}class rG extends Wl{constructor(e,n,i,s){super(e,n,i,s)}drawFlatCoordinates_(e,n,i,s){const r=this.coordinates.length,o=this.appendFlatLineCoordinates(e,n,i,s,!1,!1),a=[Ee.MOVE_TO_LINE_TO,r,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(e,n,i){const s=this.state,r=s.strokeStyle,o=s.lineWidth;if(r===void 0||o===void 0)return;this.updateStrokeStyle(s,this.applyStroke),this.beginGeometry(e,n,i),this.hitDetectionInstructions.push([Ee.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,is,ss],Er);const a=e.getFlatCoordinates(),l=e.getStride();this.drawFlatCoordinates_(a,0,a.length,l),this.hitDetectionInstructions.push(As),this.endGeometry(n)}drawMultiLineString(e,n,i){const s=this.state,r=s.strokeStyle,o=s.lineWidth;if(r===void 0||o===void 0)return;this.updateStrokeStyle(s,this.applyStroke),this.beginGeometry(e,n,i),this.hitDetectionInstructions.push([Ee.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,is,ss],Er);const a=e.getEnds(),l=e.getFlatCoordinates(),c=e.getStride();let h=0;for(let u=0,d=a.length;u<d;++u)h=this.drawFlatCoordinates_(l,h,a[u],c);this.hitDetectionInstructions.push(As),this.endGeometry(n)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(As),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(As),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(Er)}}class Px extends Wl{constructor(e,n,i,s){super(e,n,i,s)}drawFlatCoordinatess_(e,n,i,s){const r=this.state,o=r.fillStyle!==void 0,a=r.strokeStyle!==void 0,l=i.length;this.instructions.push(Er),this.hitDetectionInstructions.push(Er);for(let c=0;c<l;++c){const h=i[c],u=this.coordinates.length,d=this.appendFlatLineCoordinates(e,n,h,s,!0,!a),f=[Ee.MOVE_TO_LINE_TO,u,d];this.instructions.push(f),this.hitDetectionInstructions.push(f),a&&(this.instructions.push(Ix),this.hitDetectionInstructions.push(Ix)),n=h}return o&&(this.instructions.push(wc),this.hitDetectionInstructions.push(wc)),a&&(this.instructions.push(As),this.hitDetectionInstructions.push(As)),n}drawCircle(e,n,i){const s=this.state,r=s.fillStyle,o=s.strokeStyle;if(r===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,i),s.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ee.SET_FILL_STYLE,Fn]),s.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ee.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,is,ss]);const a=e.getFlatCoordinates(),l=e.getStride(),c=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,l,!1,!1);const h=[Ee.CIRCLE,c];this.instructions.push(Er,h),this.hitDetectionInstructions.push(Er,h),s.fillStyle!==void 0&&(this.instructions.push(wc),this.hitDetectionInstructions.push(wc)),s.strokeStyle!==void 0&&(this.instructions.push(As),this.hitDetectionInstructions.push(As)),this.endGeometry(n)}drawPolygon(e,n,i){const s=this.state,r=s.fillStyle,o=s.strokeStyle;if(r===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,i),s.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ee.SET_FILL_STYLE,Fn]),s.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ee.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,is,ss]);const a=e.getEnds(),l=e.getOrientedFlatCoordinates(),c=e.getStride();this.drawFlatCoordinatess_(l,0,a,c),this.endGeometry(n)}drawMultiPolygon(e,n,i){const s=this.state,r=s.fillStyle,o=s.strokeStyle;if(r===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,i),s.fillStyle!==void 0&&this.hitDetectionInstructions.push([Ee.SET_FILL_STYLE,Fn]),s.strokeStyle!==void 0&&this.hitDetectionInstructions.push([Ee.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,is,ss]);const a=e.getEndss(),l=e.getOrientedFlatCoordinates(),c=e.getStride();let h=0;for(let u=0,d=a.length;u<d;++u)h=this.drawFlatCoordinatess_(l,h,a[u],c);this.endGeometry(n)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const n=this.coordinates;for(let i=0,s=n.length;i<s;++i)n[i]=lr(n[i],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function oG(t,e,n,i,s){const r=[];let o=n,a=0,l=e.slice(n,2);for(;a<t&&o+s<i;){const[c,h]=l.slice(-2),u=e[o+s],d=e[o+s+1],f=Math.sqrt((u-c)*(u-c)+(d-h)*(d-h));if(a+=f,a>=t){const g=(t-a+f)/f,m=$n(c,u,g),p=$n(h,d,g);l.push(m,p),r.push(l),l=[m,p],a==t&&(o+=s),a=0}else if(a<t)l.push(e[o+s],e[o+s+1]),o+=s;else{const g=f-a,m=$n(c,u,g/f),p=$n(h,d,g/f);l.push(m,p),r.push(l),l=[m,p],a=0,o+=s}}return a>0&&r.push(l),r}function aG(t,e,n,i,s){let r=n,o=n,a=0,l=0,c=n,h,u,d,f,g,m,p,y,_,x;for(u=n;u<i;u+=s){const E=e[u],w=e[u+1];g!==void 0&&(_=E-g,x=w-m,f=Math.sqrt(_*_+x*x),p!==void 0&&(l+=d,h=Math.acos((p*_+y*x)/(d*f)),h>t&&(l>a&&(a=l,r=c,o=u),l=0,c=u-s)),d=f,p=_,y=x),g=E,m=w}return l+=f,l>a?[c,u]:[r,o]}const Oh={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class lG extends Wl{constructor(e,n,i,s){super(e,n,i,s),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[Fn]={fillStyle:Fn},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,n,i){const s=this.textFillState_,r=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!s&&!r)return;const a=this.coordinates;let l=a.length;const c=e.getType();let h=null,u=e.getStride();if(o.placement==="line"&&(c=="LineString"||c=="MultiLineString"||c=="Polygon"||c=="MultiPolygon")){if(!wn(this.maxExtent,e.getExtent()))return;let d;if(h=e.getFlatCoordinates(),c=="LineString")d=[h.length];else if(c=="MultiLineString")d=e.getEnds();else if(c=="Polygon")d=e.getEnds().slice(0,1);else if(c=="MultiPolygon"){const p=e.getEndss();d=[];for(let y=0,_=p.length;y<_;++y)d.push(p[y][0])}this.beginGeometry(e,n,i);const f=o.repeat,g=f?void 0:o.textAlign;let m=0;for(let p=0,y=d.length;p<y;++p){let _;f?_=oG(f*this.resolution,h,m,d[p],u):_=[h.slice(m,d[p])];for(let x=0,E=_.length;x<E;++x){const w=_[x];let b=0,v=w.length;if(g==null){const P=aG(o.maxAngle,w,0,w.length,2);b=P[0],v=P[1]}for(let P=b;P<v;P+=u)a.push(w[P],w[P+1]);const A=a.length;m=d[p],this.drawChars_(l,A),l=A}}this.endGeometry(n)}else{let d=o.overflow?null:[];switch(c){case"Point":case"MultiPoint":h=e.getFlatCoordinates();break;case"LineString":h=e.getFlatMidpoint();break;case"Circle":h=e.getCenter();break;case"MultiLineString":h=e.getFlatMidpoints(),u=2;break;case"Polygon":h=e.getFlatInteriorPoint(),o.overflow||d.push(h[2]/this.resolution),u=3;break;case"MultiPolygon":const E=e.getFlatInteriorPoints();h=[];for(let w=0,b=E.length;w<b;w+=3)o.overflow||d.push(E[w+2]/this.resolution),h.push(E[w],E[w+1]);if(h.length===0)return;u=2;break}const f=this.appendFlatPointCoordinates(h,u);if(f===l)return;if(d&&(f-l)/2!==h.length/u){let E=l/2;d=d.filter((w,b)=>{const v=a[(E+b)*2]===h[b*u]&&a[(E+b)*2+1]===h[b*u+1];return v||--E,v})}this.saveTextStates_();const g=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,m=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,n,i);let p=o.padding;if(p!=yr&&(o.scale[0]<0||o.scale[1]<0)){let E=o.padding[0],w=o.padding[1],b=o.padding[2],v=o.padding[3];o.scale[0]<0&&(w=-w,v=-v),o.scale[1]<0&&(E=-E,b=-b),p=[E,w,b,v]}const y=this.pixelRatio;this.instructions.push([Ee.DRAW_IMAGE,l,f,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,p==yr?yr:p.map(function(E){return E*y}),g,m,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]);const _=1/y,x=g?g.slice(0):null;x&&(x[1]=Fn),this.hitDetectionInstructions.push([Ee.DRAW_IMAGE,l,f,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[_,_],NaN,this.declutterMode_,this.declutterImageWithText_,p,x,m,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?Fn:this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]),this.endGeometry(n)}}saveTextStates_(){const e=this.textStrokeState_,n=this.textState_,i=this.textFillState_,s=this.strokeKey_;e&&(s in this.strokeStates||(this.strokeStates[s]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const r=this.textKey_;r in this.textStates||(this.textStates[r]={font:n.font,textAlign:n.textAlign||Cl,justify:n.justify,textBaseline:n.textBaseline||Ph,scale:n.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(e,n){const i=this.textStrokeState_,s=this.textState_,r=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,c=Oh[s.textBaseline],h=this.textOffsetY_*l,u=this.text_,d=i?i.lineWidth*Math.abs(s.scale[0])/2:0;this.instructions.push([Ee.DRAW_CHARS,e,n,c,s.overflow,a,s.maxAngle,l,h,r,d*l,u,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([Ee.DRAW_CHARS,e,n,c,s.overflow,a&&Fn,s.maxAngle,l,h,r,d*l,u,o,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,n){let i,s,r;if(!e)this.text_="";else{const o=e.getFill();o?(s=this.textFillState_,s||(s={},this.textFillState_=s),s.fillStyle=Mi(o.getColor()||Fn)):(s=null,this.textFillState_=s);const a=e.getStroke();if(!a)r=null,this.textStrokeState_=r;else{r=this.textStrokeState_,r||(r={},this.textStrokeState_=r);const m=a.getLineDash(),p=a.getLineDashOffset(),y=a.getWidth(),_=a.getMiterLimit();r.lineCap=a.getLineCap()||Uo,r.lineDash=m?m.slice():is,r.lineDashOffset=p===void 0?ss:p,r.lineJoin=a.getLineJoin()||Go,r.lineWidth=y===void 0?bl:y,r.miterLimit=_===void 0?wl:_,r.strokeStyle=Mi(a.getColor()||Sl)}i=this.textState_;const l=e.getFont()||Jb;kB(l);const c=e.getScaleArray();i.overflow=e.getOverflow(),i.font=l,i.maxAngle=e.getMaxAngle(),i.placement=e.getPlacement(),i.textAlign=e.getTextAlign(),i.repeat=e.getRepeat(),i.justify=e.getJustify(),i.textBaseline=e.getTextBaseline()||Ph,i.backgroundFill=e.getBackgroundFill(),i.backgroundStroke=e.getBackgroundStroke(),i.padding=e.getPadding()||yr,i.scale=c===void 0?[1,1]:c;const h=e.getOffsetX(),u=e.getOffsetY(),d=e.getRotateWithView(),f=e.getKeepUpright(),g=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=h===void 0?0:h,this.textOffsetY_=u===void 0?0:u,this.textRotateWithView_=d===void 0?!1:d,this.textKeepUpright_=f===void 0?!0:f,this.textRotation_=g===void 0?0:g,this.strokeKey_=r?(typeof r.strokeStyle=="string"?r.strokeStyle:me(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=s&&s.fillStyle?typeof s.fillStyle=="string"?s.fillStyle:"|"+me(s.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=n}}const cG={Circle:Px,Default:Wl,Image:sG,LineString:rG,Polygon:Px,Text:lG};class hG{constructor(e,n,i,s){this.tolerance_=e,this.maxExtent_=n,this.pixelRatio_=s,this.resolution_=i,this.buildersByZIndex_={}}finish(){const e={};for(const n in this.buildersByZIndex_){e[n]=e[n]||{};const i=this.buildersByZIndex_[n];for(const s in i){const r=i[s].finish();e[n][s]=r}}return e}getBuilder(e,n){const i=e!==void 0?e.toString():"0";let s=this.buildersByZIndex_[i];s===void 0&&(s={},this.buildersByZIndex_[i]=s);let r=s[n];if(r===void 0){const o=cG[n];r=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),s[n]=r}return r}}function c_(t,e,n,i){let s=t[e],r=t[e+1],o=0;for(let a=e+i;a<n;a+=i){const l=t[a],c=t[a+1];o+=Math.sqrt((l-s)*(l-s)+(c-r)*(c-r)),s=l,r=c}return o}function uG(t,e,n,i,s,r,o,a,l,c,h,u,d=!0){let f=t[e],g=t[e+1],m=0,p=0,y=0,_=0;function x(){m=f,p=g,e+=i,f=t[e],g=t[e+1],_+=y,y=Math.sqrt((f-m)*(f-m)+(g-p)*(g-p))}do x();while(e<n-i&&_+y<r);let E=y===0?0:(r-_)/y;const w=$n(m,f,E),b=$n(p,g,E),v=e-i,A=_,P=r+a*l(c,s,h);for(;e<n-i&&_+y<P;)x();E=y===0?0:(P-_)/y;const M=$n(m,f,E),Y=$n(p,g,E);let j=!1;if(d)if(u){const V=[w,b,M,Y];vm(V,0,4,2,u,V,V),j=V[0]>V[2]}else j=w>M;const K=Math.PI,ee=[],te=v+i===e;e=v,y=0,_=A,f=t[e],g=t[e+1];let Q;if(te){x(),Q=Math.atan2(g-p,f-m),j&&(Q+=Q>0?-K:K);const V=(M+w)/2,z=(Y+b)/2;return ee[0]=[V,z,(P-r)/2,Q,s],ee}s=s.replace(/\n/g," ");for(let V=0,z=s.length;V<z;){x();let re=Math.atan2(g-p,f-m);if(j&&(re+=re>0?-K:K),Q!==void 0){let H=re-Q;if(H+=H>K?-2*K:H<-K?2*K:0,Math.abs(H)>o)return null}Q=re;const ue=V;let ye=0;for(;V<z;++V){const H=j?z-V-1:V,oe=a*l(c,s[H],h);if(e+i<n&&_+y<r+ye+oe/2)break;ye+=oe}if(V===ue)continue;const N=j?s.substring(z-ue,z-V):s.substring(ue,V);E=y===0?0:(r+ye/2-_)/y;const be=$n(m,f,E),Z=$n(p,g,E);ee.push([be,Z,ye/2,re,N]),r+=ye}return ee}const Yr=Yn(),ms=[],Wi=[],Ki=[],_s=[];function Mx(t){return t[3].declutterBox}const Fx=new RegExp("[֑-ࣿיִ-﷿ﹰ-ﻼࠀ-࿿-]");function wf(t,e){return e==="start"?e=Fx.test(t)?"right":"left":e==="end"&&(e=Fx.test(t)?"left":"right"),Oh[e]}function dG(t,e,n){return n>0&&t.push(`
`,""),t.push(e,""),t}function fG(t,e,n){return n%2===0&&(t+=e),t}class gG{constructor(e,n,i,s,r){this.overlaps=i,this.pixelRatio=n,this.resolution=e,this.alignAndScaleFill_,this.instructions=s.instructions,this.coordinates=s.coordinates,this.coordinateCache_={},this.renderedTransform_=hn(),this.hitDetectionInstructions=s.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=s.fillStates||{},this.strokeStates=s.strokeStates||{},this.textStates=s.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=r?new gT:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,n,i,s){const r=e+n+i+s;if(this.labels_[r])return this.labels_[r];const o=s?this.strokeStates[s]:null,a=i?this.fillStates[i]:null,l=this.textStates[n],c=this.pixelRatio,h=[l.scale[0]*c,l.scale[1]*c],u=l.justify?Oh[l.justify]:wf(Array.isArray(e)?e[0]:e,l.textAlign||Cl),d=s&&o.lineWidth?o.lineWidth:0,f=Array.isArray(e)?e:String(e).split(`
`).reduce(dG,[]),{width:g,height:m,widths:p,heights:y,lineWidths:_}=BB(l,f),x=g+d,E=[],w=(x+2)*h[0],b=(m+d)*h[1],v={width:w<0?Math.floor(w):Math.ceil(w),height:b<0?Math.floor(b):Math.ceil(b),contextInstructions:E};(h[0]!=1||h[1]!=1)&&E.push("scale",h),s&&(E.push("strokeStyle",o.strokeStyle),E.push("lineWidth",d),E.push("lineCap",o.lineCap),E.push("lineJoin",o.lineJoin),E.push("miterLimit",o.miterLimit),E.push("setLineDash",[o.lineDash]),E.push("lineDashOffset",o.lineDashOffset)),i&&E.push("fillStyle",a.fillStyle),E.push("textBaseline","middle"),E.push("textAlign","center");const A=.5-u;let P=u*x+A*d;const M=[],Y=[];let j=0,K=0,ee=0,te=0,Q;for(let V=0,z=f.length;V<z;V+=2){const re=f[V];if(re===`
`){K+=j,j=0,P=u*x+A*d,++te;continue}const ue=f[V+1]||l.font;ue!==Q&&(s&&M.push("font",ue),i&&Y.push("font",ue),Q=ue),j=Math.max(j,y[ee]);const ye=[re,P+A*p[ee]+u*(p[ee]-_[te]),.5*(d+j)+K];P+=p[ee],s&&M.push("strokeText",ye),i&&Y.push("fillText",ye),++ee}return Array.prototype.push.apply(E,M),Array.prototype.push.apply(E,Y),this.labels_[r]=v,v}replayTextBackground_(e,n,i,s,r,o,a){e.beginPath(),e.moveTo.apply(e,n),e.lineTo.apply(e,i),e.lineTo.apply(e,s),e.lineTo.apply(e,r),e.lineTo.apply(e,n),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),a&&(this.setStrokeStyle_(e,a),e.stroke())}calculateImageOrLabelDimensions_(e,n,i,s,r,o,a,l,c,h,u,d,f,g,m,p){a*=d[0],l*=d[1];let y=i-a,_=s-l;const x=r+c>e?e-c:r,E=o+h>n?n-h:o,w=g[3]+x*d[0]+g[1],b=g[0]+E*d[1]+g[2],v=y-g[3],A=_-g[0];(m||u!==0)&&(ms[0]=v,_s[0]=v,ms[1]=A,Wi[1]=A,Wi[0]=v+w,Ki[0]=Wi[0],Ki[1]=A+b,_s[1]=Ki[1]);let P;return u!==0?(P=mi(hn(),i,s,1,1,u,-i,-s),vt(P,ms),vt(P,Wi),vt(P,Ki),vt(P,_s),Bi(Math.min(ms[0],Wi[0],Ki[0],_s[0]),Math.min(ms[1],Wi[1],Ki[1],_s[1]),Math.max(ms[0],Wi[0],Ki[0],_s[0]),Math.max(ms[1],Wi[1],Ki[1],_s[1]),Yr)):Bi(Math.min(v,v+w),Math.min(A,A+b),Math.max(v,v+w),Math.max(A,A+b),Yr),f&&(y=Math.round(y),_=Math.round(_)),{drawImageX:y,drawImageY:_,drawImageW:x,drawImageH:E,originX:c,originY:h,declutterBox:{minX:Yr[0],minY:Yr[1],maxX:Yr[2],maxY:Yr[3],value:p},canvasTransform:P,scale:d}}replayImageOrLabel_(e,n,i,s,r,o,a){const l=!!(o||a),c=s.declutterBox,h=a?a[2]*s.scale[0]/2:0;return c.minX-h<=n[0]&&c.maxX+h>=0&&c.minY-h<=n[1]&&c.maxY+h>=0&&(l&&this.replayTextBackground_(e,ms,Wi,Ki,_s,o,a),UB(e,s.canvasTransform,r,i,s.originX,s.originY,s.drawImageW,s.drawImageH,s.drawImageX,s.drawImageY,s.scale)),!0}fill_(e){const n=this.alignAndScaleFill_;if(n){const i=vt(this.renderedTransform_,[0,0]),s=512*this.pixelRatio;e.save(),e.translate(i[0]%s,i[1]%s),n!==1&&e.scale(n,n),e.rotate(this.viewRotation_)}e.fill(),n&&e.restore()}setStrokeStyle_(e,n){e.strokeStyle=n[1],n[1]&&(e.lineWidth=n[2],e.lineCap=n[3],e.lineJoin=n[4],e.miterLimit=n[5],e.lineDashOffset=n[7],e.setLineDash(n[6]))}drawLabelWithPointPlacement_(e,n,i,s){const r=this.textStates[n],o=this.createLabel(e,n,s,i),a=this.strokeStates[i],l=this.pixelRatio,c=wf(Array.isArray(e)?e[0]:e,r.textAlign||Cl),h=Oh[r.textBaseline||Ph],u=a&&a.lineWidth?a.lineWidth:0,d=o.width/l-2*r.scale[0],f=c*d+2*(.5-c)*u,g=h*o.height/l+2*(.5-h)*u;return{label:o,anchorX:f,anchorY:g}}execute_(e,n,i,s,r,o,a,l){const c=this.zIndexContext_;let h;this.pixelCoordinates_&&cs(i,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=Ls(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),$N(this.renderedTransform_,i));let u=0;const d=s.length;let f=0,g,m,p,y,_,x,E,w,b,v,A,P,M,Y=0,j=0;const K=this.coordinateCache_,ee=this.viewRotation_,te=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,Q={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:ee},V=this.instructions!=s||this.overlaps?0:200;let z,re,ue,ye;for(;u<d;){const N=s[u];switch(N[0]){case Ee.BEGIN_GEOMETRY:z=N[1],ye=N[3],z.getGeometry()?a!==void 0&&!wn(a,ye.getExtent())?u=N[2]+1:++u:u=N[2],c&&(c.zIndex=N[4]);break;case Ee.BEGIN_PATH:Y>V&&(this.fill_(e),Y=0),j>V&&(e.stroke(),j=0),!Y&&!j&&(e.beginPath(),_=NaN,x=NaN),++u;break;case Ee.CIRCLE:f=N[1];const Z=h[f],H=h[f+1],oe=h[f+2],ge=h[f+3],Ie=oe-Z,je=ge-H,Xe=Math.sqrt(Ie*Ie+je*je);e.moveTo(Z+Xe,H),e.arc(Z,H,Xe,0,2*Math.PI,!0),++u;break;case Ee.CLOSE_PATH:e.closePath(),++u;break;case Ee.CUSTOM:f=N[1],g=N[2];const ui=N[3],C=N[4],R=N[5];Q.geometry=ui,Q.feature=z,u in K||(K[u]=[]);const O=K[u];R?R(h,f,g,2,O):(O[0]=h[f],O[1]=h[f+1],O.length=2),c&&(c.zIndex=N[6]),C(O,Q),++u;break;case Ee.DRAW_IMAGE:f=N[1],g=N[2],b=N[3],m=N[4],p=N[5];let G=N[6];const B=N[7],$=N[8],ie=N[9],ne=N[10];let q=N[11];const W=N[12];let pe=N[13];y=N[14]||"declutter";const J=N[15];if(!b&&N.length>=20){v=N[19],A=N[20],P=N[21],M=N[22];const Zn=this.drawLabelWithPointPlacement_(v,A,P,M);b=Zn.label,N[3]=b;const Qs=N[23];m=(Zn.anchorX-Qs)*this.pixelRatio,N[4]=m;const Jn=N[24];p=(Zn.anchorY-Jn)*this.pixelRatio,N[5]=p,G=b.height,N[6]=G,pe=b.width,N[13]=pe}let _e;N.length>25&&(_e=N[25]);let we,Ne,Ye;N.length>17?(we=N[16],Ne=N[17],Ye=N[18]):(we=yr,Ne=null,Ye=null),ne&&te?q+=ee:!ne&&!te&&(q-=ee);let qe=0;for(;f<g;f+=2){if(_e&&_e[qe++]<pe/this.pixelRatio)continue;const Zn=this.calculateImageOrLabelDimensions_(b.width,b.height,h[f],h[f+1],pe,G,m,p,$,ie,q,W,r,we,!!Ne||!!Ye,z),Qs=[e,n,b,Zn,B,Ne,Ye];if(l){let Jn,yi,Qn;if(J){const yt=g-f;if(!J[yt]){J[yt]={args:Qs,declutterMode:y};continue}const un=J[yt];Jn=un.args,yi=un.declutterMode,delete J[yt],Qn=Mx(Jn)}let zi,Hi;if(Jn&&(yi!=="declutter"||!l.collides(Qn))&&(zi=!0),(y!=="declutter"||!l.collides(Zn.declutterBox))&&(Hi=!0),yi==="declutter"&&y==="declutter"){const yt=zi&&Hi;zi=yt,Hi=yt}zi&&(yi!=="none"&&l.insert(Qn),this.replayImageOrLabel_.apply(this,Jn)),Hi&&(y!=="none"&&l.insert(Zn.declutterBox),this.replayImageOrLabel_.apply(this,Qs))}else this.replayImageOrLabel_.apply(this,Qs)}++u;break;case Ee.DRAW_CHARS:const Xt=N[1],Vt=N[2],vn=N[3],qn=N[4];M=N[5];const Js=N[6],aa=N[7],Zt=N[8];P=N[9];const An=N[10];v=N[11],Array.isArray(v)&&(v=v.reduce(fG,"")),A=N[12];const la=[N[13],N[13]];y=N[14]||"declutter";const ql=N[15],Nu=this.textStates[A],ca=Nu.font,ha=[Nu.scale[0]*aa,Nu.scale[1]*aa];let ua;ca in this.widths_?ua=this.widths_[ca]:(ua={},this.widths_[ca]=ua);const v_=c_(h,Xt,Vt,2),A_=Math.abs(ha[0])*rx(ca,v,ua);if(qn||A_<=v_){const Zn=this.textStates[A].textAlign,Qs=(v_-A_)*wf(v,Zn),Jn=uG(h,Xt,Vt,2,v,Qs,Js,Math.abs(ha[0]),rx,ca,ua,te?0:this.viewRotation_,ql);e:if(Jn){const yi=[];let Qn,zi,Hi,yt,un;if(P)for(Qn=0,zi=Jn.length;Qn<zi;++Qn){un=Jn[Qn],Hi=un[4],yt=this.createLabel(Hi,A,"",P),m=un[2]+(ha[0]<0?-An:An),p=vn*yt.height+(.5-vn)*2*An*ha[1]/ha[0]-Zt;const Xi=this.calculateImageOrLabelDimensions_(yt.width,yt.height,un[0],un[1],yt.width,yt.height,m,p,0,0,un[3],la,!1,yr,!1,z);if(l&&y==="declutter"&&l.collides(Xi.declutterBox))break e;yi.push([e,n,yt,Xi,1,null,null])}if(M)for(Qn=0,zi=Jn.length;Qn<zi;++Qn){un=Jn[Qn],Hi=un[4],yt=this.createLabel(Hi,A,M,""),m=un[2],p=vn*yt.height-Zt;const Xi=this.calculateImageOrLabelDimensions_(yt.width,yt.height,un[0],un[1],yt.width,yt.height,m,p,0,0,un[3],la,!1,yr,!1,z);if(l&&y==="declutter"&&l.collides(Xi.declutterBox))break e;yi.push([e,n,yt,Xi,1,null,null])}l&&y!=="none"&&l.load(yi.map(Mx));for(let Xi=0,o1=yi.length;Xi<o1;++Xi)this.replayImageOrLabel_.apply(this,yi[Xi])}}++u;break;case Ee.END_GEOMETRY:if(o!==void 0){z=N[1];const Zn=o(z,ye,y);if(Zn)return Zn}++u;break;case Ee.FILL:V?Y++:this.fill_(e),++u;break;case Ee.MOVE_TO_LINE_TO:for(f=N[1],g=N[2],re=h[f],ue=h[f+1],e.moveTo(re,ue),_=re+.5|0,x=ue+.5|0,f+=2;f<g;f+=2)re=h[f],ue=h[f+1],E=re+.5|0,w=ue+.5|0,(f==g-2||E!==_||w!==x)&&(e.lineTo(re,ue),_=E,x=w);++u;break;case Ee.SET_FILL_STYLE:this.alignAndScaleFill_=N[2],Y&&(this.fill_(e),Y=0,j&&(e.stroke(),j=0)),e.fillStyle=N[1],++u;break;case Ee.SET_STROKE_STYLE:j&&(e.stroke(),j=0),this.setStrokeStyle_(e,N),++u;break;case Ee.STROKE:V?j++:e.stroke(),++u;break;default:++u;break}}Y&&this.fill_(e),j&&e.stroke()}execute(e,n,i,s,r,o){this.viewRotation_=s,this.execute_(e,n,i,this.instructions,r,void 0,void 0,o)}executeHitDetection(e,n,i,s,r){return this.viewRotation_=i,this.execute_(e,[e.canvas.width,e.canvas.height],n,this.hitDetectionInstructions,!0,s,r)}}const fr=["Polygon","Circle","LineString","Image","Text","Default"],AT=["Image","Text"],pG=fr.filter(t=>!AT.includes(t));class mG{constructor(e,n,i,s,r,o,a){this.maxExtent_=e,this.overlaps_=s,this.pixelRatio_=i,this.resolution_=n,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=hn(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(r,a)}clip(e,n){const i=this.getClipCoords(n);e.beginPath(),e.moveTo(i[0],i[1]),e.lineTo(i[2],i[3]),e.lineTo(i[4],i[5]),e.lineTo(i[6],i[7]),e.clip()}createExecutors_(e,n){for(const i in e){let s=this.executorsByZIndex_[i];s===void 0&&(s={},this.executorsByZIndex_[i]=s);const r=e[i];for(const o in r){const a=r[o];s[o]=new gG(this.resolution_,this.pixelRatio_,this.overlaps_,a,n)}}}hasExecutors(e){for(const n in this.executorsByZIndex_){const i=this.executorsByZIndex_[n];for(let s=0,r=e.length;s<r;++s)if(e[s]in i)return!0}return!1}forEachFeatureAtCoordinate(e,n,i,s,r,o){s=Math.round(s);const a=s*2+1,l=mi(this.hitDetectionTransform_,s+.5,s+.5,1/n,-1/n,-i,-e[0],-e[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=Et(a,a));const h=this.hitDetectionContext_;h.canvas.width!==a||h.canvas.height!==a?(h.canvas.width=a,h.canvas.height=a):c||h.clearRect(0,0,a,a);let u;this.renderBuffer_!==void 0&&(u=Yn(),Za(u,e),uu(u,n*(this.renderBuffer_+s),u));const d=_G(s);let f;function g(w,b,v){const A=h.getImageData(0,0,a,a).data;for(let P=0,M=d.length;P<M;P++)if(A[d[P]]>0){if(!o||v==="none"||f!=="Image"&&f!=="Text"||o.includes(w)){const Y=(d[P]-3)/4,j=s-Y%a,K=s-(Y/a|0),ee=r(w,b,j*j+K*K);if(ee)return ee}h.clearRect(0,0,a,a);break}}const m=Object.keys(this.executorsByZIndex_).map(Number);m.sort(ts);let p,y,_,x,E;for(p=m.length-1;p>=0;--p){const w=m[p].toString();for(_=this.executorsByZIndex_[w],y=fr.length-1;y>=0;--y)if(f=fr[y],x=_[f],x!==void 0&&(E=x.executeHitDetection(h,l,i,g,u),E))return E}}getClipCoords(e){const n=this.maxExtent_;if(!n)return null;const i=n[0],s=n[1],r=n[2],o=n[3],a=[i,s,i,o,r,o,r,s];return Ls(a,0,8,2,e,a),a}isEmpty(){return Ir(this.executorsByZIndex_)}execute(e,n,i,s,r,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(a?ab:ts),o=o||fr;const c=fr.length;for(let h=0,u=l.length;h<u;++h){const d=l[h].toString(),f=this.executorsByZIndex_[d];for(let g=0,m=o.length;g<m;++g){const p=o[g],y=f[p];if(y!==void 0){const _=a===null?void 0:y.getZIndexContext(),x=_?_.getContext():e,E=this.maxExtent_&&p!=="Image"&&p!=="Text";if(E&&(x.save(),this.clip(x,i)),!_||p==="Text"||p==="Image"?y.execute(x,n,i,s,r,a):_.pushFunction(w=>y.execute(w,n,i,s,r,a)),E&&x.restore(),_){_.offset();const w=l[h]*c+fr.indexOf(p);this.deferredZIndexContexts_[w]||(this.deferredZIndexContexts_[w]=[]),this.deferredZIndexContexts_[w].push(_)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,n=Object.keys(e).map(Number).sort(ts);for(let i=0,s=n.length;i<s;++i)e[n[i]].forEach(r=>{r.draw(this.renderedContext_),r.clear()}),e[n[i]].length=0}}const Sf={};function _G(t){if(Sf[t]!==void 0)return Sf[t];const e=t*2+1,n=t*t,i=new Array(n+1);for(let r=0;r<=t;++r)for(let o=0;o<=t;++o){const a=r*r+o*o;if(a>n)break;let l=i[a];l||(l=[],i[a]=l),l.push(((t+r)*e+(t+o))*4+3),r>0&&l.push(((t-r)*e+(t+o))*4+3),o>0&&(l.push(((t+r)*e+(t-o))*4+3),r>0&&l.push(((t-r)*e+(t-o))*4+3))}const s=[];for(let r=0,o=i.length;r<o;++r)i[r]&&s.push(...i[r]);return Sf[t]=s,s}class yG extends vT{constructor(e,n,i,s,r,o,a){super(),this.context_=e,this.pixelRatio_=n,this.extent_=i,this.transform_=s,this.transformRotation_=s?jl(Math.atan2(s[1],s[0]),10):0,this.viewRotation_=r,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=hn()}drawImages_(e,n,i,s){if(!this.image_)return;const r=Ls(e,n,i,s,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);let c=this.imageRotation_;this.transformRotation_===0&&(c-=this.viewRotation_),this.imageRotateWithView_&&(c+=this.viewRotation_);for(let h=0,u=r.length;h<u;h+=2){const d=r[h]-this.imageAnchorX_,f=r[h+1]-this.imageAnchorY_;if(c!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const g=d+this.imageAnchorX_,m=f+this.imageAnchorY_;mi(a,g,m,1,1,c,-g,-m),o.save(),o.transform.apply(o,a),o.translate(g,m),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,d,f,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}drawText_(e,n,i,s){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const r=Ls(e,n,i,s,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);n<i;n+=s){const l=r[n]+this.textOffsetX_,c=r[n+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(l-this.textOffsetX_,c-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,l,c),this.textFillState_&&o.fillText(this.text_,l,c))}}moveToLineTo_(e,n,i,s,r){const o=this.context_,a=Ls(e,n,i,s,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let l=a.length;r&&(l-=2);for(let c=2;c<l;c+=2)o.lineTo(a[c],a[c+1]);return r&&o.closePath(),i}drawRings_(e,n,i,s){for(let r=0,o=i.length;r<o;++r)n=this.moveToLineTo_(e,n,i[r],s,!0);return n}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!wn(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const n=ZN(e,this.transform_,this.pixelCoordinates_),i=n[2]-n[0],s=n[3]-n[1],r=Math.sqrt(i*i+s*s),o=this.context_;o.beginPath(),o.arc(n[0],n[1],r,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,n){const i=n.getGeometryFunction()(e);i&&(this.setStyle(n),this.drawGeometry(i))}drawGeometryCollection(e){const n=e.getGeometriesArray();for(let i=0,s=n.length;i<s;++i)this.drawGeometry(n[i])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(n,0,n.length,i),this.text_!==""&&this.drawText_(n,0,n.length,i)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getFlatCoordinates(),i=e.getStride();this.image_&&this.drawImages_(n,0,n.length,i),this.text_!==""&&this.drawText_(n,0,n.length,i)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!wn(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const n=this.context_,i=e.getFlatCoordinates();n.beginPath(),this.moveToLineTo_(i,0,i.length,e.getStride(),!1),n.stroke()}if(this.text_!==""){const n=e.getFlatMidpoint();this.drawText_(n,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getExtent();if(wn(this.extent_,n)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,s=e.getFlatCoordinates();let r=0;const o=e.getEnds(),a=e.getStride();i.beginPath();for(let l=0,c=o.length;l<c;++l)r=this.moveToLineTo_(s,r,o[l],a,!1);i.stroke()}if(this.text_!==""){const i=e.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!wn(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const n=this.context_;n.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}if(this.text_!==""){const n=e.getFlatInteriorPoint();this.drawText_(n,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!wn(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const n=this.context_,i=e.getOrientedFlatCoordinates();let s=0;const r=e.getEndss(),o=e.getStride();n.beginPath();for(let a=0,l=r.length;a<l;++a){const c=r[a];s=this.drawRings_(i,s,c,o)}this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}if(this.text_!==""){const n=e.getFlatInteriorPoints();this.drawText_(n,0,n.length,2)}}}setContextFillState_(e){const n=this.context_,i=this.contextFillState_;i?i.fillStyle!=e.fillStyle&&(i.fillStyle=e.fillStyle,n.fillStyle=e.fillStyle):(n.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const n=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=e.lineCap&&(i.lineCap=e.lineCap,n.lineCap=e.lineCap),cs(i.lineDash,e.lineDash)||n.setLineDash(i.lineDash=e.lineDash),i.lineDashOffset!=e.lineDashOffset&&(i.lineDashOffset=e.lineDashOffset,n.lineDashOffset=e.lineDashOffset),i.lineJoin!=e.lineJoin&&(i.lineJoin=e.lineJoin,n.lineJoin=e.lineJoin),i.lineWidth!=e.lineWidth&&(i.lineWidth=e.lineWidth,n.lineWidth=e.lineWidth),i.miterLimit!=e.miterLimit&&(i.miterLimit=e.miterLimit,n.miterLimit=e.miterLimit),i.strokeStyle!=e.strokeStyle&&(i.strokeStyle=e.strokeStyle,n.strokeStyle=e.strokeStyle)):(n.lineCap=e.lineCap,n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset,n.lineJoin=e.lineJoin,n.lineWidth=e.lineWidth,n.miterLimit=e.miterLimit,n.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const n=this.context_,i=this.contextTextState_,s=e.textAlign?e.textAlign:Cl;i?(i.font!=e.font&&(i.font=e.font,n.font=e.font),i.textAlign!=s&&(i.textAlign=s,n.textAlign=s),i.textBaseline!=e.textBaseline&&(i.textBaseline=e.textBaseline,n.textBaseline=e.textBaseline)):(n.font=e.font,n.textAlign=s,n.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:s,textBaseline:e.textBaseline})}setFillStrokeStyle(e,n){if(!e)this.fillState_=null;else{const i=e.getColor();this.fillState_={fillStyle:Mi(i||Fn)}}if(!n)this.strokeState_=null;else{const i=n.getColor(),s=n.getLineCap(),r=n.getLineDash(),o=n.getLineDashOffset(),a=n.getLineJoin(),l=n.getWidth(),c=n.getMiterLimit(),h=r||is;this.strokeState_={lineCap:s!==void 0?s:Uo,lineDash:this.pixelRatio_===1?h:h.map(u=>u*this.pixelRatio_),lineDashOffset:(o||ss)*this.pixelRatio_,lineJoin:a!==void 0?a:Go,lineWidth:(l!==void 0?l:bl)*this.pixelRatio_,miterLimit:c!==void 0?c:wl,strokeStyle:Mi(i||Sl)}}}setImageStyle(e){let n;if(!e||!(n=e.getSize())){this.image_=null;return}const i=e.getPixelRatio(this.pixelRatio_),s=e.getAnchor(),r=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=s[0]*i,this.imageAnchorY_=s[1]*i,this.imageHeight_=n[1]*i,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=r[0],this.imageOriginY_=r[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=n[0]*i}setTextStyle(e){if(!e)this.text_="";else{const n=e.getFill();if(!n)this.textFillState_=null;else{const f=n.getColor();this.textFillState_={fillStyle:Mi(f||Fn)}}const i=e.getStroke();if(!i)this.textStrokeState_=null;else{const f=i.getColor(),g=i.getLineCap(),m=i.getLineDash(),p=i.getLineDashOffset(),y=i.getLineJoin(),_=i.getWidth(),x=i.getMiterLimit();this.textStrokeState_={lineCap:g!==void 0?g:Uo,lineDash:m||is,lineDashOffset:p||ss,lineJoin:y!==void 0?y:Go,lineWidth:_!==void 0?_:bl,miterLimit:x!==void 0?x:wl,strokeStyle:Mi(f||Sl)}}const s=e.getFont(),r=e.getOffsetX(),o=e.getOffsetY(),a=e.getRotateWithView(),l=e.getRotation(),c=e.getScaleArray(),h=e.getText(),u=e.getTextAlign(),d=e.getTextBaseline();this.textState_={font:s!==void 0?s:Jb,textAlign:u!==void 0?u:Cl,textBaseline:d!==void 0?d:Ph},this.text_=h!==void 0?Array.isArray(h)?h.reduce((f,g,m)=>f+=m%2?" ":g,""):h:"",this.textOffsetX_=r!==void 0?this.pixelRatio_*r:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}}}const Pi=.5;function EG(t,e,n,i,s,r,o,a,l){const c=s,h=t[0]*Pi,u=t[1]*Pi,d=Et(h,u);d.imageSmoothingEnabled=!1;const f=d.canvas,g=new yG(d,Pi,s,null,o,a,null),m=n.length,p=Math.floor((256*256*256-1)/m),y={};for(let x=1;x<=m;++x){const E=n[x-1],w=E.getStyleFunction()||i;if(!w)continue;let b=w(E,r);if(!b)continue;Array.isArray(b)||(b=[b]);const A=(x*p).toString(16).padStart(7,"#00000");for(let P=0,M=b.length;P<M;++P){const Y=b[P],j=Y.getGeometryFunction()(E);if(!j||!wn(c,j.getExtent()))continue;const K=Y.clone(),ee=K.getFill();ee&&ee.setColor(A);const te=K.getStroke();te&&(te.setColor(A),te.setLineDash(null)),K.setText(void 0);const Q=Y.getImage();if(Q){const ue=Q.getImageSize();if(!ue)continue;const ye=Et(ue[0],ue[1],void 0,{alpha:!1}),N=ye.canvas;ye.fillStyle=A,ye.fillRect(0,0,N.width,N.height),K.setImage(new Au({img:N,anchor:Q.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:Q.getOrigin(),opacity:1,size:Q.getSize(),scale:Q.getScale(),rotation:Q.getRotation(),rotateWithView:Q.getRotateWithView()}))}const V=K.getZIndex()||0;let z=y[V];z||(z={},y[V]=z,z.Polygon=[],z.Circle=[],z.LineString=[],z.Point=[]);const re=j.getType();if(re==="GeometryCollection"){const ue=j.getGeometriesArrayRecursive();for(let ye=0,N=ue.length;ye<N;++ye){const be=ue[ye];z[be.getType().replace("Multi","")].push(be,K)}}else z[re.replace("Multi","")].push(j,K)}}const _=Object.keys(y).map(Number).sort(ts);for(let x=0,E=_.length;x<E;++x){const w=y[_[x]];for(const b in w){const v=w[b];for(let A=0,P=v.length;A<P;A+=2){g.setStyle(v[A+1]);for(let M=0,Y=e.length;M<Y;++M)g.setTransform(e[M]),g.drawGeometry(v[A])}}}return d.getImageData(0,0,f.width,f.height)}function xG(t,e,n){const i=[];if(n){const s=Math.floor(Math.round(t[0])*Pi),r=Math.floor(Math.round(t[1])*Pi),o=(lt(s,0,n.width-1)+lt(r,0,n.height-1)*n.width)*4,a=n.data[o],l=n.data[o+1],h=n.data[o+2]+256*(l+256*a),u=Math.floor((256*256*256-1)/e.length);h&&h%u===0&&i.push(e[h/u-1])}return i}const wG=.5,IT={Point:IG,LineString:RG,Polygon:MG,MultiPoint:PG,MultiLineString:vG,MultiPolygon:AG,GeometryCollection:TG,Circle:CG};function SG(t,e){return parseInt(me(t),10)-parseInt(me(e),10)}function Dx(t,e){const n=PT(t,e);return n*n}function PT(t,e){return wG*t/e}function CG(t,e,n,i,s){const r=n.getFill(),o=n.getStroke();if(r||o){const l=t.getBuilder(n.getZIndex(),"Circle");l.setFillStrokeStyle(r,o),l.drawCircle(e,i,s)}const a=n.getText();if(a&&a.getText()){const l=t.getBuilder(n.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,i)}}function Ox(t,e,n,i,s,r,o,a){const l=[],c=n.getImage();if(c){let d=!0;const f=c.getImageState();f==ke.LOADED||f==ke.ERROR?d=!1:f==ke.IDLE&&c.load(),d&&l.push(c.ready())}const h=n.getFill();h&&h.loading()&&l.push(h.ready());const u=l.length>0;return u&&Promise.all(l).then(()=>s(null)),bG(t,e,n,i,r,o,a),u}function bG(t,e,n,i,s,r,o){const a=n.getGeometryFunction()(e);if(!a)return;const l=a.simplifyTransformed(i,s);if(n.getRenderer())MT(t,l,n,e,o);else{const h=IT[l.getType()];h(t,l,n,e,o,r)}}function MT(t,e,n,i,s){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let a=0,l=o.length;a<l;++a)MT(t,o[a],n,i,s);return}t.getBuilder(n.getZIndex(),"Default").drawCustom(e,i,n.getRenderer(),n.getHitDetectionRenderer(),s)}function TG(t,e,n,i,s,r){const o=e.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a){const c=IT[o[a].getType()];c(t,o[a],n,i,s,r)}}function RG(t,e,n,i,s){const r=n.getStroke();if(r){const a=t.getBuilder(n.getZIndex(),"LineString");a.setFillStrokeStyle(null,r),a.drawLineString(e,i,s)}const o=n.getText();if(o&&o.getText()){const a=t.getBuilder(n.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,i,s)}}function vG(t,e,n,i,s){const r=n.getStroke();if(r){const a=t.getBuilder(n.getZIndex(),"LineString");a.setFillStrokeStyle(null,r),a.drawMultiLineString(e,i,s)}const o=n.getText();if(o&&o.getText()){const a=t.getBuilder(n.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,i,s)}}function AG(t,e,n,i,s){const r=n.getFill(),o=n.getStroke();if(o||r){const l=t.getBuilder(n.getZIndex(),"Polygon");l.setFillStrokeStyle(r,o),l.drawMultiPolygon(e,i,s)}const a=n.getText();if(a&&a.getText()){const l=t.getBuilder(n.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,i,s)}}function IG(t,e,n,i,s,r){const o=n.getImage(),a=n.getText(),l=a&&a.getText(),c=r&&o&&l?{}:void 0;if(o){if(o.getImageState()!=ke.LOADED)return;const h=t.getBuilder(n.getZIndex(),"Image");h.setImageStyle(o,c),h.drawPoint(e,i,s)}if(l){const h=t.getBuilder(n.getZIndex(),"Text");h.setTextStyle(a,c),h.drawText(e,i,s)}}function PG(t,e,n,i,s,r){const o=n.getImage(),a=o&&o.getOpacity()!==0,l=n.getText(),c=l&&l.getText(),h=r&&a&&c?{}:void 0;if(a){if(o.getImageState()!=ke.LOADED)return;const u=t.getBuilder(n.getZIndex(),"Image");u.setImageStyle(o,h),u.drawMultiPoint(e,i,s)}if(c){const u=t.getBuilder(n.getZIndex(),"Text");u.setTextStyle(l,h),u.drawText(e,i,s)}}function MG(t,e,n,i,s){const r=n.getFill(),o=n.getStroke();if(r||o){const l=t.getBuilder(n.getZIndex(),"Polygon");l.setFillStrokeStyle(r,o),l.drawPolygon(e,i,s)}const a=n.getText();if(a&&a.getText()){const l=t.getBuilder(n.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,i,s)}}class FG extends mT{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Yn(),this.wrappedRenderedExtent_=Yn(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,n,i){const s=n.extent,r=n.viewState,o=r.center,a=r.resolution,l=r.projection,c=r.rotation,h=l.getExtent(),u=this.getLayer().getSource(),d=this.getLayer().getDeclutter(),f=n.pixelRatio,g=n.viewHints,m=!(g[sn.ANIMATING]||g[sn.INTERACTING]),p=this.context,y=Math.round(Ve(s)/a*f),_=Math.round(jt(s)/a*f),x=u.getWrapX()&&l.canWrapX(),E=x?Ve(h):null,w=x?Math.ceil((s[2]-h[2])/E)+1:1;let b=x?Math.floor((s[0]-h[0])/E):0;do{let v=this.getRenderTransform(o,a,0,f,y,_,b*E);n.declutter&&(v=v.slice(0)),e.execute(p,[p.canvas.width,p.canvas.height],v,c,m,i===void 0?fr:i?AT:pG,i?d&&n.declutter[d]:void 0)}while(++b<w)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Et(this.context.canvas.width,this.context.canvas.height,mx))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,Cu(this.context),mx.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,n){const i=e.layerStatesArray[e.layerIndex];this.opacity_=i.opacity;const s=e.viewState;this.prepareContainer(e,n);const r=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(Ut.PRERENDER)||this.getLayer().hasListener(Ut.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(r,e),s.projection,this.clipped_=!1,a&&i.extent&&this.clipping){const l=fi(i.extent);a=wn(l,e.extent),this.clipped_=a&&!va(l,e.extent),this.clipped_&&this.clipUnrotated(r,e,l)}return a&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&r.restore(),this.postRender(r,e),this.renderedRotation_!==s.rotation&&(this.renderedRotation_=s.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(n=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),s=this.renderedCenter_,r=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,c=this.getLayer(),h=[],u=i[0]*Pi,d=i[1]*Pi;h.push(this.getRenderTransform(s,r,o,Pi,u,d,0).slice());const f=c.getSource(),g=a.getExtent();if(f.getWrapX()&&a.canWrapX()&&!va(g,l)){let m=l[0];const p=Ve(g);let y=0,_;for(;m<g[0];)--y,_=p*y,h.push(this.getRenderTransform(s,r,o,Pi,u,d,_).slice()),m+=p;for(y=0,m=l[2];m>g[2];)++y,_=p*y,h.push(this.getRenderTransform(s,r,o,Pi,u,d,_).slice()),m-=p}this.hitDetectionImageData_=EG(i,h,this.renderedFeatures_,c.getStyleFunction(),l,r,o,Dx(r,this.renderedPixelRatio_))}n(xG(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,n,i,s,r){if(!this.replayGroup_)return;const o=n.viewState.resolution,a=n.viewState.rotation,l=this.getLayer(),c={},h=function(d,f,g){const m=me(d),p=c[m];if(p){if(p!==!0&&g<p.distanceSq){if(g===0)return c[m]=!0,r.splice(r.lastIndexOf(p),1),s(d,l,f);p.geometry=f,p.distanceSq=g}}else{if(g===0)return c[m]=!0,s(d,l,f);r.push(c[m]={feature:d,layer:l,geometry:f,distanceSq:g,callback:s})}},u=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,a,i,h,u?n.declutter?.[u]?.all().map(d=>d.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const n=this.getLayer(),i=n.getSource();if(!i)return!1;const s=e.viewHints[sn.ANIMATING],r=e.viewHints[sn.INTERACTING],o=n.getUpdateWhileAnimating(),a=n.getUpdateWhileInteracting();if(this.ready&&!o&&s||!a&&r)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=e.extent,c=e.viewState,h=c.projection,u=c.resolution,d=e.pixelRatio,f=n.getRevision(),g=n.getRenderBuffer();let m=n.getRenderOrder();m===void 0&&(m=SG);const p=c.center.slice(),y=uu(l,g*u),_=y.slice(),x=[y.slice()],E=h.getExtent();if(i.getWrapX()&&h.canWrapX()&&!va(E,e.extent)){const ee=Ve(E),te=Math.max(Ve(y)/2,ee);y[0]=E[0]-te,y[2]=E[2]+te,_b(p,h);const Q=pb(x[0],h);Q[0]<E[0]&&Q[2]<E[2]?x.push([Q[0]+ee,Q[1],Q[2]+ee,Q[3]]):Q[0]>E[0]&&Q[2]>E[2]&&x.push([Q[0]-ee,Q[1],Q[2]-ee,Q[3]])}if(this.ready&&this.renderedResolution_==u&&this.renderedRevision_==f&&this.renderedRenderOrder_==m&&this.renderedFrameDeclutter_===!!e.declutter&&va(this.wrappedRenderedExtent_,y))return cs(this.renderedExtent_,_)||(this.hitDetectionImageData_=null,this.renderedExtent_=_),this.renderedCenter_=p,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const w=new hG(PT(u,d),y,u,d);let b;for(let ee=0,te=x.length;ee<te;++ee)i.loadFeatures(x[ee],u,h);const v=Dx(u,d);let A=!0;const P=(ee,te)=>{let Q;const V=ee.getStyleFunction()||n.getStyleFunction();if(V&&(Q=V(ee,u)),Q){const z=this.renderFeature(ee,v,Q,w,b,this.getLayer().getDeclutter(),te);A=A&&!z}},M=yu(y),Y=i.getFeaturesInExtent(M);m&&Y.sort(m);for(let ee=0,te=Y.length;ee<te;++ee)P(Y[ee],ee);this.renderedFeatures_=Y,this.ready=A;const j=w.finish(),K=new mG(y,u,d,i.getOverlaps(),j,n.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=u,this.renderedRevision_=f,this.renderedRenderOrder_=m,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=_,this.wrappedRenderedExtent_=y,this.renderedCenter_=p,this.renderedProjection_=h,this.renderedPixelRatio_=d,this.replayGroup_=K,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,n,i,s,r,o,a){if(!i)return!1;let l=!1;if(Array.isArray(i))for(let c=0,h=i.length;c<h;++c)l=Ox(s,e,i[c],n,this.boundHandleStyleImageChange_,r,o,a)||l;else l=Ox(s,e,i,n,this.boundHandleStyleImageChange_,r,o,a);return l}}class Il extends oT{constructor(e){super(e)}createRenderer(){return new FG(this)}}let DG=!1;function OG(t,e,n,i,s,r,o){const a=new XMLHttpRequest;a.open("GET",typeof t=="function"?t(n,i,s):t,!0),e.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=DG,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const c=e.getType();try{let h;c=="text"||c=="json"?h=a.responseText:c=="xml"?h=a.responseXML||a.responseText:c=="arraybuffer"&&(h=a.response),h?r(e.readFeatures(h,{extent:n,featureProjection:s}),e.readProjection(h)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function Lx(t,e){return function(n,i,s,r,o){OG(t,e,n,i,s,(a,l)=>{this.addFeatures(a),r!==void 0&&r(a)},()=>{this.changed(),o!==void 0&&o()})}}function LG(t,e){return[[-1/0,-1/0,1/0,1/0]]}class Ln extends ji{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const n=e;this.setGeometry(n)}else{const n=e;this.setProperties(n)}}clone(){const e=new Ln(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const n=this.getGeometry();n&&e.setGeometry(n.clone());const i=this.getStyle();return i&&e.setStyle(i),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(at(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=He(e,xe.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?kG(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function kG(t){if(typeof t=="function")return t;let e;return Array.isArray(t)?e=t:(Je(typeof t.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[t]),function(){return e}}function FT(t,e,n,i){const s=[];let r=Yn();for(let o=0,a=n.length;o<a;++o){const l=n[o];r=gm(t,e,l[0],i),s.push((r[0]+r[2])/2,(r[1]+r[3])/2),e=l[l.length-1]}return s}function Lh(t,e,n,i,s,r,o){let a,l;const c=(n-e)/i;if(c===1)a=e;else if(c===2)a=e,l=s;else if(c!==0){let h=t[e],u=t[e+1],d=0;const f=[0];for(let p=e+i;p<n;p+=i){const y=t[p],_=t[p+1];d+=Math.sqrt((y-h)*(y-h)+(_-u)*(_-u)),f.push(d),h=y,u=_}const g=s*d,m=Nk(f,g);m<0?(l=(g-f[-m-2])/(f[-m-1]-f[-m-2]),a=e+(-m-2)*i):a=e+m*i}o=o>1?o:2,r=r||new Array(o);for(let h=0;h<o;++h)r[h]=a===void 0?NaN:l===void 0?t[a+h]:$n(t[a+h],t[a+i+h],l);return r}function Lg(t,e,n,i,s,r){if(n==e)return null;let o;if(s<t[e+i-1])return r?(o=t.slice(e,e+i),o[i-1]=s,o):null;if(t[n-1]<s)return r?(o=t.slice(n-i,n),o[i-1]=s,o):null;if(s==t[e+i-1])return t.slice(e,e+i);let a=e/i,l=n/i;for(;a<l;){const d=a+l>>1;s<t[(d+1)*i-1]?l=d:a=d+1}const c=t[a*i-1];if(s==c)return t.slice((a-1)*i,(a-1)*i+i);const h=t[(a+1)*i-1],u=(s-c)/(h-c);o=[];for(let d=0;d<i-1;++d)o.push($n(t[(a-1)*i+d],t[a*i+d],u));return o.push(s),o}function NG(t,e,n,i,s,r,o){if(o)return Lg(t,e,n[n.length-1],i,s,r);let a;if(s<t[i-1])return r?(a=t.slice(0,i),a[i-1]=s,a):null;if(t[t.length-1]<s)return r?(a=t.slice(t.length-i),a[i-1]=s,a):null;for(let l=0,c=n.length;l<c;++l){const h=n[l];if(e!=h){if(s<t[e+i-1])return null;if(s<=t[h-1])return Lg(t,e,h,i,s,!1);e=h}}return null}class Ou extends qs{constructor(e,n,i){super(),i!==void 0&&n===void 0?this.setFlatCoordinates(i,e):(n=n||0,this.setCenterAndRadius(e,n,i))}clone(){const e=new Ou(this.flatCoordinates.slice(),void 0,this.layout);return e.applyProperties(this),e}closestPointXY(e,n,i,s){const r=this.flatCoordinates,o=e-r[0],a=n-r[1],l=o*o+a*a;if(l<s){if(l===0)for(let c=0;c<this.stride;++c)i[c]=r[c];else{const c=this.getRadius()/Math.sqrt(l);i[0]=r[0]+c*o,i[1]=r[1]+c*a;for(let h=2;h<this.stride;++h)i[h]=r[h]}return i.length=this.stride,l}return s}containsXY(e,n){const i=this.flatCoordinates,s=e-i[0],r=n-i[1];return s*s+r*r<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(e){const n=this.flatCoordinates,i=n[this.stride]-n[0];return Bi(n[0]-i,n[1]-i,n[0]+i,n[1]+i,e)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],n=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+n*n}getType(){return"Circle"}intersectsExtent(e){const n=this.getExtent();if(wn(e,n)){const i=this.getCenter();return e[0]<=i[0]&&e[2]>=i[0]||e[1]<=i[1]&&e[3]>=i[1]?!0:mm(e,this.intersectsCoordinate.bind(this))}return!1}setCenter(e){const n=this.stride,i=this.flatCoordinates[n]-this.flatCoordinates[0],s=e.slice();s[n]=s[0]+i;for(let r=1;r<n;++r)s[n+r]=e[r];this.setFlatCoordinates(this.layout,s),this.changed()}setCenterAndRadius(e,n,i){this.setLayout(i,e,0),this.flatCoordinates||(this.flatCoordinates=[]);const s=this.flatCoordinates;let r=Pb(s,0,e,this.stride);s[r++]=s[0]+n;for(let o=1,a=this.stride;o<a;++o)s[r++]=s[o];s.length=r,this.changed()}getCoordinates(){return null}setCoordinates(e,n){}setRadius(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()}rotate(e,n){const i=this.getCenter(),s=this.getStride();this.setCenter(vm(i,0,i.length,s,e,n,i)),this.changed()}}Ou.prototype.transform;class Pl extends vb{constructor(e){super(),this.geometries_=e,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(at),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const e=this.geometries_;for(let n=0,i=e.length;n<i;++n)this.changeEventsKeys_.push(He(e[n],xe.CHANGE,this.changed,this))}clone(){const e=new Pl(Cf(this.geometries_));return e.applyProperties(this),e}closestPointXY(e,n,i,s){if(s<Dr(this.getExtent(),e,n))return s;const r=this.geometries_;for(let o=0,a=r.length;o<a;++o)s=r[o].closestPointXY(e,n,i,s);return s}containsXY(e,n){const i=this.geometries_;for(let s=0,r=i.length;s<r;++s)if(i[s].containsXY(e,n))return!0;return!1}computeExtent(e){Jo(e);const n=this.geometries_;for(let i=0,s=n.length;i<s;++i)pm(e,n[i].getExtent());return e}getGeometries(){return Cf(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const n=this.geometries_;for(let i=0,s=n.length;i<s;++i)n[i].getType()===this.getType()?e=e.concat(n[i].getGeometriesArrayRecursive()):e.push(n[i]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const n=[],i=this.geometries_;let s=!1;for(let r=0,o=i.length;r<o;++r){const a=i[r],l=a.getSimplifiedGeometry(e);n.push(l),l!==a&&(s=!0)}return s?new Pl(n):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getType(){return"GeometryCollection"}intersectsExtent(e){const n=this.geometries_;for(let i=0,s=n.length;i<s;++i)if(n[i].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,n){const i=this.geometries_;for(let s=0,r=i.length;s<r;++s)i[s].rotate(e,n);this.changed()}scale(e,n,i){i||(i=Ui(this.getExtent()));const s=this.geometries_;for(let r=0,o=s.length;r<o;++r)s[r].scale(e,n,i);this.changed()}setGeometries(e){this.setGeometriesArray(Cf(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const n=this.geometries_;for(let i=0,s=n.length;i<s;++i)n[i].applyTransform(e);this.changed()}translate(e,n){const i=this.geometries_;for(let s=0,r=i.length;s<r;++s)i[s].translate(e,n);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function Cf(t){return t.map(e=>e.clone())}class ki extends qs{constructor(e,n){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,n!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(n,e):this.setCoordinates(e,n)}appendCoordinate(e){ai(this.flatCoordinates,e),this.changed()}clone(){const e=new ki(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,n,i,s){return s<Dr(this.getExtent(),e,n)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Am(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Pm(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,n,i,s))}forEachSegment(e){return Ob(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,n){return this.layout!="XYM"&&this.layout!="XYZM"?null:(n=n!==void 0?n:!1,Lg(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n))}getCoordinates(){return vs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,n){return Lh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n,this.stride)}getLength(){return c_(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const n=[];return n.length=wu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n,0),new ki(n,"XY")}getType(){return"LineString"}intersectsExtent(e){return Su(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,this.getExtent())}setCoordinates(e,n){this.setLayout(n,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=xu(this.flatCoordinates,0,e,this.stride),this.changed()}}class zo extends qs{constructor(e,n,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,n);else if(n!==void 0&&i)this.setFlatCoordinates(n,e),this.ends_=i;else{const s=e,r=[],o=[];for(let l=0,c=s.length;l<c;++l){const h=s[l];ai(r,h.getFlatCoordinates()),o.push(r.length)}const a=s.length===0?this.getLayout():s[0].getLayout();this.setFlatCoordinates(a,r),this.ends_=o}}appendLineString(e){ai(this.flatCoordinates,e.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new zo(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,n,i,s){return s<Dr(this.getExtent(),e,n)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Im(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Mm(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,n,i,s))}getCoordinateAtM(e,n,i){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(n=n!==void 0?n:!1,i=i!==void 0?i:!1,NG(this.flatCoordinates,0,this.ends_,this.stride,e,n,i))}getCoordinates(){return El(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new ki(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){const e=this.flatCoordinates,n=this.ends_,i=this.layout,s=[];let r=0;for(let o=0,a=n.length;o<a;++o){const l=n[o],c=new ki(e.slice(r,l),i);s.push(c),r=l}return s}getLength(){const e=this.ends_;let n=0,i=0;for(let s=0,r=e.length;s<r;++s)i+=c_(this.flatCoordinates,n,e[s],this.stride),n=e[s];return i}getFlatMidpoints(){const e=[],n=this.flatCoordinates;let i=0;const s=this.ends_,r=this.stride;for(let o=0,a=s.length;o<a;++o){const l=s[o],c=Lh(n,i,l,r,.5);ai(e,c),i=l}return e}getSimplifiedGeometryInternal(e){const n=[],i=[];return n.length=Fb(this.flatCoordinates,0,this.ends_,this.stride,e,n,0,i),new zo(n,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(e){return r3(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,n){this.setLayout(n,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=Hl(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}class Kl extends qs{constructor(e,n){super(),n&&!Array.isArray(e[0])?this.setFlatCoordinates(n,e):this.setCoordinates(e,n)}appendPoint(e){ai(this.flatCoordinates,e.getFlatCoordinates()),this.changed()}clone(){const e=new Kl(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,n,i,s){if(s<Dr(this.getExtent(),e,n))return s;const r=this.flatCoordinates,o=this.stride;for(let a=0,l=r.length;a<l;a+=o){const c=ns(e,n,r[a],r[a+1]);if(c<s){s=c;for(let h=0;h<o;++h)i[h]=r[a+h];i.length=o}}return s}getCoordinates(){return vs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){const n=this.flatCoordinates.length/this.stride;return e<0||n<=e?null:new ci(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){const e=this.flatCoordinates,n=this.layout,i=this.stride,s=[];for(let r=0,o=e.length;r<o;r+=i){const a=new ci(e.slice(r,r+i),n);s.push(a)}return s}getType(){return"MultiPoint"}intersectsExtent(e){const n=this.flatCoordinates,i=this.stride;for(let s=0,r=n.length;s<r;s+=i){const o=n[s],a=n[s+1];if(fm(e,o,a))return!0}return!1}setCoordinates(e,n){this.setLayout(n,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=xu(this.flatCoordinates,0,e,this.stride),this.changed()}}class Ho extends qs{constructor(e,n,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(e[0])){const s=e,r=[],o=[];for(let a=0,l=s.length;a<l;++a){const c=s[a],h=r.length,u=c.getEnds();for(let d=0,f=u.length;d<f;++d)u[d]+=h;ai(r,c.getFlatCoordinates()),o.push(u)}n=s.length===0?this.getLayout():s[0].getLayout(),e=r,i=o}n!==void 0&&i?(this.setFlatCoordinates(n,e),this.endss_=i):this.setCoordinates(e,n)}appendPolygon(e){let n;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),n=e.getEnds().slice(),this.endss_.push();else{const i=this.flatCoordinates.length;ai(this.flatCoordinates,e.getFlatCoordinates()),n=e.getEnds().slice();for(let s=0,r=n.length;s<r;++s)n[s]+=i}this.endss_.push(n),this.changed()}clone(){const e=this.endss_.length,n=new Array(e);for(let s=0;s<e;++s)n[s]=this.endss_[s].slice();const i=new Ho(this.flatCoordinates.slice(),this.layout,n);return i.applyProperties(this),i}closestPointXY(e,n,i,s){return s<Dr(this.getExtent(),e,n)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(QN(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),e3(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,n,i,s))}containsXY(e,n){return s3(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,n)}getArea(){return JN(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let n;return e!==void 0?(n=this.getOrientedFlatCoordinates().slice(),Cg(n,0,this.endss_,this.stride,e)):n=this.flatCoordinates,Sg(n,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const e=FT(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=Db(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new Kl(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;Nb(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=Cg(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const n=[],i=[];return n.length=n3(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),n,0,i),new Ho(n,"XY",i)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let n;if(e===0)n=0;else{const r=this.endss_[e-1];n=r[r.length-1]}const i=this.endss_[e].slice(),s=i[i.length-1];if(n!==0)for(let r=0,o=i.length;r<o;++r)i[r]-=n;return new Gi(this.flatCoordinates.slice(n,s),this.layout,i)}getPolygons(){const e=this.layout,n=this.flatCoordinates,i=this.endss_,s=[];let r=0;for(let o=0,a=i.length;o<a;++o){const l=i[o].slice(),c=l[l.length-1];if(r!==0)for(let u=0,d=l.length;u<d;++u)l[u]-=r;const h=new Gi(n.slice(r,c),e,l);s.push(h),r=c}return s}getType(){return"MultiPolygon"}intersectsExtent(e){return o3(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,n){this.setLayout(n,e,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=Mb(this.flatCoordinates,0,e,this.stride,this.endss_);if(i.length===0)this.flatCoordinates.length=0;else{const s=i[i.length-1];this.flatCoordinates.length=s.length===0?0:s[s.length-1]}this.changed()}}const kx=hn();class jn{constructor(e,n,i,s,r,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=n,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=r,this.squaredTolerance_,this.stride_=s,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?qa(this.flatCoordinates_):gm(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=Ui(this.getExtent());this.flatInteriorPoints_=Om(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=l3(this.flatCoordinates_,this.ends_),n=FT(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=Db(this.flatCoordinates_,0,e,2,n)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=Lh(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let n=0;const i=this.ends_;for(let s=0,r=i.length;s<r;++s){const o=i[s],a=Lh(e,n,o,2,.5);ai(this.flatMidpoints_,a),n=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,n){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=ft(e);const n=e.getExtent(),i=e.getWorldExtent();if(n&&i){const s=jt(i)/jt(n);mi(kx,i[0],i[3],s,-s,0,0,0),Ls(this.flatCoordinates_,0,this.flatCoordinates_.length,2,kx,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new jn(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=lb((e,n)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),n&&this.simplifiedGeometry_.applyTransform(n);const i=this.simplifiedGeometry_.getFlatCoordinates();let s;switch(this.type_){case"LineString":i.length=wu(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,i,0),s=[i.length];break;case"MultiLineString":s=[],i.length=Fb(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,i,0,s);break;case"Polygon":s=[],i.length=Fm(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),i,0,s);break}return s&&(this.simplifiedGeometry_=new jn(this.type_,i,s,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}jn.prototype.getFlatCoordinates=jn.prototype.getOrientedFlatCoordinates;class kg{constructor(e){this.rbush_=new Vb(e),this.items_={}}insert(e,n){const i={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:n};this.rbush_.insert(i),this.items_[me(n)]=i}load(e,n){const i=new Array(n.length);for(let s=0,r=n.length;s<r;s++){const o=e[s],a=n[s],l={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[s]=l,this.items_[me(a)]=l}this.rbush_.load(i)}remove(e){const n=me(e),i=this.items_[n];return delete this.items_[n],this.rbush_.remove(i)!==null}update(e,n){const i=this.items_[me(n)],s=[i.minX,i.minY,i.maxX,i.maxY];fl(s,e)||(this.remove(n),this.insert(e,n))}getAll(){return this.rbush_.all().map(function(n){return n.value})}getInExtent(e){const n={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(n).map(function(s){return s.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,n){return this.forEach_(this.getInExtent(e),n)}forEach_(e,n){let i;for(let s=0,r=e.length;s<r;s++)if(i=n(e[s]),i)return i;return i}isEmpty(){return Ir(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const n=this.rbush_.toJSON();return Bi(n.minX,n.minY,n.maxX,n.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const n in e.items_)this.items_[n]=e.items_[n]}}class DT extends ji{constructor(e){super(),this.projection=ft(e.projection),this.attributions_=Nx(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const n=this;this.viewPromise_=new Promise(function(i,s){n.viewResolver=i,n.viewRejector=s})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=Nx(e),this.changed()}setState(e){this.state_=e,this.changed()}}function Nx(t){return t?typeof t=="function"?t:(Array.isArray(t)||(t=[t]),e=>t):null}const Pn={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class ys extends hi{constructor(e,n,i){super(e),this.feature=n,this.features=i}}class kh extends DT{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=dl,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(Je(this.format_,"`format` must be set when `url` is set"),this.loader_=Lx(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:LG;const n=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=n?new kg:null,this.loadedExtentsRtree_=new kg,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,s;Array.isArray(e.features)?s=e.features:e.features&&(i=e.features,s=i.getArray()),!n&&i===void 0&&(i=new Vn(s)),s!==void 0&&this.addFeaturesInternal(s),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const n=me(e);if(!this.addToIndex_(n,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(n,e);const i=e.getGeometry();if(i){const s=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(s,e)}else this.nullGeometryFeatures_[n]=e;this.dispatchEvent(new ys(Pn.ADDFEATURE,e))}setupChangeEvents_(e,n){n instanceof jn||(this.featureChangeKeys_[e]=[He(n,xe.CHANGE,this.handleFeatureChange_,this),He(n,Lo.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,n){let i=!0;if(n.getId()!==void 0){const s=String(n.getId());if(!(s in this.idIndex_))this.idIndex_[s]=n;else if(n instanceof jn){const r=this.idIndex_[s];r instanceof jn?Array.isArray(r)?r.push(n):this.idIndex_[s]=[r,n]:i=!1}else i=!1}return i&&(Je(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=n),i}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const n=[],i=[],s=[];for(let r=0,o=e.length;r<o;r++){const a=e[r],l=me(a);this.addToIndex_(l,a)&&i.push(a)}for(let r=0,o=i.length;r<o;r++){const a=i[r],l=me(a);this.setupChangeEvents_(l,a);const c=a.getGeometry();if(c){const h=c.getExtent();n.push(h),s.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(n,s),this.hasListener(Pn.ADDFEATURE))for(let r=0,o=i.length;r<o;r++)this.dispatchEvent(new ys(Pn.ADDFEATURE,i[r]))}bindFeaturesCollection_(e){let n=!1;this.addEventListener(Pn.ADDFEATURE,function(i){n||(n=!0,e.push(i.feature),n=!1)}),this.addEventListener(Pn.REMOVEFEATURE,function(i){n||(n=!0,e.remove(i.feature),n=!1)}),e.addEventListener(It.ADD,i=>{n||(n=!0,this.addFeature(i.element),n=!1)}),e.addEventListener(It.REMOVE,i=>{n||(n=!0,this.removeFeature(i.element),n=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(at);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(i=>{this.removeFeatureInternal(i)});for(const i in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[i])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const n=new ys(Pn.CLEAR);this.dispatchEvent(n),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,n){const i=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(i,function(s){const r=s.getGeometry();if(r instanceof jn||r.intersectsCoordinate(e))return n(s)})}forEachFeatureInExtent(e,n){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,n);this.featuresCollection_&&this.featuresCollection_.forEach(n)}forEachFeatureIntersectingExtent(e,n){return this.forEachFeatureInExtent(e,function(i){const s=i.getGeometry();if(s instanceof jn||s.intersectsExtent(e)){const r=n(i);if(r)return r}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),Ir(this.nullGeometryFeatures_)||ai(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const n=[];return this.forEachFeatureAtCoordinateDirect(e,function(i){n.push(i)}),n}getFeaturesInExtent(e,n){if(this.featuresRtree_){if(!(n&&n.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const s=ym(e,n);return[].concat(...s.map(r=>this.featuresRtree_.getInExtent(r)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,n){const i=e[0],s=e[1];let r=null;const o=[NaN,NaN];let a=1/0;const l=[-1/0,-1/0,1/0,1/0];return n=n||zs,this.featuresRtree_.forEachInExtent(l,function(c){if(n(c)){const h=c.getGeometry(),u=a;if(a=h instanceof jn?0:h.closestPointXY(i,s,o,a),a<u){r=c;const d=Math.sqrt(a);l[0]=i-d,l[1]=s-d,l[2]=i+d,l[3]=s+d}}}),r}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const n=this.idIndex_[e.toString()];return n!==void 0?n:null}getFeatureByUid(e){const n=this.uidIndex_[e];return n!==void 0?n:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const n=e.target,i=me(n),s=n.getGeometry();if(!s)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(n),this.nullGeometryFeatures_[i]=n);else{const o=s.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,n)):this.featuresRtree_&&this.featuresRtree_.update(o,n)}const r=n.getId();if(r!==void 0){const o=r.toString();this.idIndex_[o]!==n&&(this.removeFromIdIndex_(n),this.idIndex_[o]=n)}else this.removeFromIdIndex_(n),this.uidIndex_[i]=n;this.changed(),this.dispatchEvent(new ys(Pn.CHANGEFEATURE,n))}hasFeature(e){const n=e.getId();return n!==void 0?n in this.idIndex_:me(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&Ir(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,n,i){const s=this.loadedExtentsRtree_,r=this.strategy_(e,n,i);for(let o=0,a=r.length;o<a;++o){const l=r[o];s.forEachInExtent(l,function(h){return va(h.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new ys(Pn.FEATURESLOADSTART)),this.loader_.call(this,l,n,i,h=>{--this.loadingExtentsCount_,this.dispatchEvent(new ys(Pn.FEATURESLOADEND,void 0,h))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new ys(Pn.FEATURESLOADERROR))}),s.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const n=this.loadedExtentsRtree_,i=n.forEachInExtent(e,function(s){if(fl(s.extent,e))return s});i&&n.remove(i)}removeFeatures(e){let n=!1;for(let i=0,s=e.length;i<s;++i)n=this.removeFeatureInternal(e[i])||n;n&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const n=me(e);if(!(n in this.uidIndex_))return!1;n in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[n]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.featureChangeKeys_[n]?.forEach(at),delete this.featureChangeKeys_[n];const s=e.getId();if(s!==void 0){const r=s.toString(),o=this.idIndex_[r];o===e?delete this.idIndex_[r]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[r]=o[0]))}return delete this.uidIndex_[n],this.hasListener(Pn.REMOVEFEATURE)&&this.dispatchEvent(new ys(Pn.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const n in this.idIndex_)if(this.idIndex_[n]===e){delete this.idIndex_[n];break}}setLoader(e){this.loader_=e}setUrl(e){Je(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(Lx(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}const qr=[0,0,0],Es=5;class h_{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,Je(Uk(this.resolutions_,(s,r)=>r-s),"`resolutions` must be sorted in descending order");let n;if(!e.origins){for(let s=0,r=this.resolutions_.length-1;s<r;++s)if(!n)n=this.resolutions_[s]/this.resolutions_[s+1];else if(this.resolutions_[s]/this.resolutions_[s+1]!==n){n=void 0;break}}this.zoomFactor_=n,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,Je(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=e.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=as(i)),Je(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,Je(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:Gm,Je(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((s,r)=>{const o=new Du(Math.min(0,s[0]),Math.max(s[0]-1,-1),Math.min(0,s[1]),Math.max(s[1]-1,-1));if(i){const a=this.getTileRangeForExtentAndZ(i,r);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(e,n,i){const s=this.getTileRangeForExtentAndZ(e,n);for(let r=s.minX,o=s.maxX;r<=o;++r)for(let a=s.minY,l=s.maxY;a<=l;++a)i([n,r,a])}forEachTileCoordParentTileRange(e,n,i,s){let r,o,a,l=null,c=e[0]-1;for(this.zoomFactor_===2?(o=e[1],a=e[2]):l=this.getTileCoordExtent(e,s);c>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),r=Wr(o,o,a,a,i)):r=this.getTileRangeForExtentAndZ(l,c,i),n(c,r))return!0;--c}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,n,i){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const r=e[1]*2,o=e[2]*2;return Wr(r,r+1,o,o+1,n)}const s=this.getTileCoordExtent(e,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(s,e[0]+1,n)}return null}getTileRangeForTileCoordAndZ(e,n,i){if(n>this.maxZoom||n<this.minZoom)return null;const s=e[0],r=e[1],o=e[2];if(n===s)return Wr(r,o,r,o,i);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,n-s),c=Math.floor(r*l),h=Math.floor(o*l);if(n<s)return Wr(c,c,h,h,i);const u=Math.floor(l*(r+1))-1,d=Math.floor(l*(o+1))-1;return Wr(c,u,h,d,i)}const a=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,n,i)}getTileRangeForExtentAndZ(e,n,i){this.getTileCoordForXYAndZ_(e[0],e[3],n,!1,qr);const s=qr[1],r=qr[2];this.getTileCoordForXYAndZ_(e[2],e[1],n,!0,qr);const o=qr[1],a=qr[2];return Wr(s,o,r,a,i)}getTileCoordCenter(e){const n=this.getOrigin(e[0]),i=this.getResolution(e[0]),s=Ct(this.getTileSize(e[0]),this.tmpSize_);return[n[0]+(e[1]+.5)*s[0]*i,n[1]-(e[2]+.5)*s[1]*i]}getTileCoordExtent(e,n){const i=this.getOrigin(e[0]),s=this.getResolution(e[0]),r=Ct(this.getTileSize(e[0]),this.tmpSize_),o=i[0]+e[1]*r[0]*s,a=i[1]-(e[2]+1)*r[1]*s,l=o+r[0]*s,c=a+r[1]*s;return Bi(o,a,l,c,n)}getTileCoordForCoordAndResolution(e,n,i){return this.getTileCoordForXYAndResolution_(e[0],e[1],n,!1,i)}getTileCoordForXYAndResolution_(e,n,i,s,r){const o=this.getZForResolution(i),a=i/this.getResolution(o),l=this.getOrigin(o),c=Ct(this.getTileSize(o),this.tmpSize_);let h=a*(e-l[0])/i/c[0],u=a*(l[1]-n)/i/c[1];return s?(h=hc(h,Es)-1,u=hc(u,Es)-1):(h=cc(h,Es),u=cc(u,Es)),jo(o,h,u,r)}getTileCoordForXYAndZ_(e,n,i,s,r){const o=this.getOrigin(i),a=this.getResolution(i),l=Ct(this.getTileSize(i),this.tmpSize_);let c=(e-o[0])/a/l[0],h=(o[1]-n)/a/l[1];return s?(c=hc(c,Es)-1,h=hc(h,Es)-1):(c=cc(c,Es),h=cc(h,Es)),jo(i,c,h,r)}getTileCoordForCoordAndZ(e,n,i){return this.getTileCoordForXYAndZ_(e[0],e[1],n,!1,i)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,n){const i=dm(this.resolutions_,e,n||0);return lt(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,n){return Lb(n,0,n.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const n=this.resolutions_.length,i=new Array(n);for(let s=this.minZoom;s<n;++s)i[s]=this.getTileRangeForExtentAndZ(e,s);this.fullTileRanges_=i}}function u_(t){let e=t.getDefaultTileGrid();return e||(e=GG(t),t.setDefaultTileGrid(e)),e}function BG(t,e,n){const i=e[0],s=t.getTileCoordCenter(e),r=Lu(n);if(!Hs(r,s)){const o=Ve(r),a=Math.ceil((r[0]-s[0])/o);return s[0]+=o*a,t.getTileCoordForCoordAndZ(s,i)}return e}function UG(t,e,n,i){i=i!==void 0?i:"top-left";const s=LT(t,e,n);return new h_({extent:t,origin:tN(t,i),resolutions:s,tileSize:n})}function OT(t){const e=t||{},n=e.extent||ft("EPSG:3857").getExtent(),i={extent:n,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:LT(n,e.maxZoom,e.tileSize,e.maxResolution)};return new h_(i)}function LT(t,e,n,i){e=e!==void 0?e:f3,n=Ct(n!==void 0?n:Gm);const s=jt(t),r=Ve(t);i=i>0?i:Math.max(r/n[0],s/n[1]);const o=e+1,a=new Array(o);for(let l=0;l<o;++l)a[l]=i/Math.pow(2,l);return a}function GG(t,e,n,i){const s=Lu(t);return UG(s,e,n,i)}function Lu(t){t=ft(t);let e=t.getExtent();if(!e){const n=180*No.degrees/t.getMetersPerUnit();e=Bi(-n,-n,n,n)}return e}const $G=/\{z\}/g,jG=/\{x\}/g,zG=/\{y\}/g,HG=/\{-y\}/g;function XG(t,e,n,i,s){return t.replace($G,e.toString()).replace(jG,n.toString()).replace(zG,i.toString()).replace(HG,function(){if(s===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(s-i).toString()})}function VG(t){const e=[];let n=/\{([a-z])-([a-z])\}/.exec(t);if(n){const i=n[1].charCodeAt(0),s=n[2].charCodeAt(0);let r;for(r=i;r<=s;++r)e.push(t.replace(n[0],String.fromCharCode(r)));return e}if(n=/\{(\d+)-(\d+)\}/.exec(t),n){const i=parseInt(n[2],10);for(let s=parseInt(n[1],10);s<=i;s++)e.push(t.replace(n[0],s.toString()));return e}return e.push(t),e}function WG(t,e){return function(n,i,s){if(!n)return;let r;const o=n[0];if(e){const a=e.getFullTileRange(o);a&&(r=a.getHeight()-1)}return XG(t,o,n[1],n[2],r)}}function KG(t,e){const n=t.length,i=new Array(n);for(let s=0;s<n;++s)i[s]=WG(t[s],e);return YG(i)}function YG(t){return t.length===1?t[0]:function(e,n,i){if(!e)return;const s=mU(e),r=br(s,t.length);return t[r](e,n,i)}}class kT extends DT{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const n=[256,256];this.tileGrid&&Ct(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),n),this.tmpSize=[0,0],this.key_=e.key||me(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const n=e?this.getTileGridForProjection(e):this.tileGrid;return n?n.getResolutions():null}getTile(e,n,i,s,r){return Se()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:u_(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,n,i){const s=this.getTileGridForProjection(i),r=this.getTilePixelRatio(n),o=Ct(s.getTileSize(e),this.tmpSize);return r==1?o:rB(o,r,this.tmpSize)}getTileCoordForTileUrlFunction(e,n){const i=n!==void 0?n:this.getProjection(),s=n!==void 0?this.getTileGridForProjection(i):this.tileGrid||this.getTileGridForProjection(i);return this.getWrapX()&&i.isGlobal()&&(e=BG(s,e,i)),yU(e,s)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class NT extends hi{constructor(e,n){super(e),this.tile=n}}const To={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class d_ extends kT{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===d_.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const n=e.target,i=me(n),s=n.getState();let r;s==se.LOADING?(this.tileLoadingKeys_[i]=!0,r=To.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],r=s==se.ERROR?To.TILELOADERROR:s==se.LOADED?To.TILELOADEND:void 0),r!=null&&this.dispatchEvent(new NT(r,n))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,n){this.tileUrlFunction=e,typeof n<"u"?this.setKey(n):this.changed()}setUrl(e){const n=VG(e);this.urls=n,this.setUrls(n)}setUrls(e){this.urls=e;const n=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(KG(e,this.tileGrid),n):this.setKey(n)}tileUrlFunction(e,n,i){}}class qG extends d_{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:ZG,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:Fu,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!Tr(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const n=this.getProjection();if(this.tileGrid&&(!n||Tr(n,e)))return this.tileGrid;const i=me(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=u_(e)),this.tileGridForProjection[i]}createTile_(e,n,i,s,r,o){const a=[e,n,i],l=this.getTileCoordForTileUrlFunction(a,r),c=l?this.tileUrlFunction(l,s,r):void 0,h=new this.tileClass(a,c!==void 0?se.IDLE:se.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return h.key=o,h.addEventListener(xe.CHANGE,this.handleTileChange.bind(this)),h}getTile(e,n,i,s,r){const o=this.getProjection();if(!o||!r||Tr(o,r))return this.getTileInternal(e,n,i,s,o||r);const a=[e,n,i],l=this.getKey(),c=this.getTileGridForProjection(o),h=this.getTileGridForProjection(r),u=this.getTileCoordForTileUrlFunction(a,r),d=new n_(o,c,r,h,a,u,this.getTilePixelRatio(s),this.getGutter(),(f,g,m,p)=>this.getTileInternal(f,g,m,p,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return d.key=l,d}getTileInternal(e,n,i,s,r){const o=this.getKey();return this.createTile_(e,n,i,s,r,o)}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,n){const i=ft(e);if(i){const s=me(i);s in this.tileGridForProjection||(this.tileGridForProjection[s]=n)}}}function ZG(t,e){t.getImage().src=e}class BT extends qG{constructor(e){e=e||{};const n=e.projection!==void 0?e.projection:"EPSG:3857",i=e.tileGrid!==void 0?e.tileGrid:OT({extent:Lu(n),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:n,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}const JG='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class QG extends BT{constructor(e){e=e||{};let n;e.attributions!==void 0?n=e.attributions:n=[JG];const i=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",s=e.url!==void 0?e.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:n,attributionsCollapsible:!1,cacheSize:e.cacheSize,crossOrigin:i,interpolate:e.interpolate,maxZoom:e.maxZoom!==void 0?e.maxZoom:19,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,transition:e.transition,url:s,wrapX:e.wrapX,zDirection:e.zDirection})}}function qt(t){return(e,...n)=>e4(t,e,n)}function ra(t,e){return qt(UT(t,e).get)}const{apply:e4,getOwnPropertyDescriptor:UT,getPrototypeOf:f_,ownKeys:t4}=Reflect,{iterator:Yl,toStringTag:n4}=Symbol,i4=Object,{create:g_,defineProperty:s4}=i4,r4=Array,o4=r4.prototype,GT=o4[Yl],a4=qt(GT),$T=ArrayBuffer,l4=$T.prototype;ra(l4,"byteLength");const Bx=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:null;Bx&&ra(Bx.prototype,"byteLength");const jT=f_(Uint8Array);jT.from;const Rn=jT.prototype;Rn[Yl];qt(Rn.keys);qt(Rn.values);qt(Rn.entries);qt(Rn.set);qt(Rn.reverse);qt(Rn.fill);qt(Rn.copyWithin);qt(Rn.sort);qt(Rn.slice);qt(Rn.subarray);ra(Rn,"buffer");ra(Rn,"byteOffset");ra(Rn,"length");ra(Rn,n4);const c4=Uint8Array,zT=Uint16Array,p_=Uint32Array,h4=Float32Array,Ml=f_([][Yl]()),HT=qt(Ml.next),u4=qt(function*(){}().next),d4=f_(Ml),f4=DataView.prototype,g4=qt(f4.getUint16),m_=WeakMap,XT=m_.prototype,VT=qt(XT.get),p4=qt(XT.set),WT=new m_,m4=g_(null,{next:{value:function(){const e=VT(WT,this);return HT(e)}},[Yl]:{value:function(){return this}}});function _4(t){if(t[Yl]===GT&&Ml.next===HT)return t;const e=g_(m4);return p4(WT,e,a4(t)),e}const y4=new m_,E4=g_(d4,{next:{value:function(){const e=VT(y4,this);return u4(e)},writable:!0,configurable:!0}});for(const t of t4(Ml))t!=="next"&&s4(E4,t,UT(Ml,t));const KT=new $T(4),x4=new h4(KT),w4=new p_(KT),Ci=new zT(512),bi=new c4(512);for(let t=0;t<256;++t){const e=t-127;e<-24?(Ci[t]=0,Ci[t|256]=32768,bi[t]=24,bi[t|256]=24):e<-14?(Ci[t]=1024>>-e-14,Ci[t|256]=1024>>-e-14|32768,bi[t]=-e-1,bi[t|256]=-e-1):e<=15?(Ci[t]=e+15<<10,Ci[t|256]=e+15<<10|32768,bi[t]=13,bi[t|256]=13):e<128?(Ci[t]=31744,Ci[t|256]=64512,bi[t]=24,bi[t|256]=24):(Ci[t]=31744,Ci[t|256]=64512,bi[t]=13,bi[t|256]=13)}const __=new p_(2048);for(let t=1;t<1024;++t){let e=t<<13,n=0;for(;(e&8388608)===0;)e<<=1,n-=8388608;e&=-8388609,n+=947912704,__[t]=e|n}for(let t=1024;t<2048;++t)__[t]=939524096+(t-1024<<13);const oa=new p_(64);for(let t=1;t<31;++t)oa[t]=t<<23;oa[31]=1199570944;oa[32]=2147483648;for(let t=33;t<63;++t)oa[t]=2147483648+(t-32<<23);oa[63]=3347054592;const YT=new zT(64);for(let t=1;t<64;++t)t!==32&&(YT[t]=1024);function S4(t){const e=t>>10;return w4[0]=__[YT[e]+(t&1023)]+oa[e],x4[0]}function qT(t,e,...n){return S4(g4(t,e,..._4(n)))}function ZT(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Sc={exports:{}},Ux;function C4(){if(Ux)return Sc.exports;Ux=1;function t(e,n,i){const s=i&&i.debug||!1;s&&console.log("[xml-utils] getting "+n+" in "+e);const r=typeof e=="object"?e.outer:e,o=r.slice(0,r.indexOf(">")+1),a=['"',"'"];for(let l=0;l<a.length;l++){const c=a[l],h=n+"\\="+c+"([^"+c+"]*)"+c;s&&console.log("[xml-utils] pattern:",h);const d=new RegExp(h).exec(o);if(s&&console.log("[xml-utils] match:",d),d)return d[1]}}return Sc.exports=t,Sc.exports.default=t,Sc.exports}var b4=C4();const bf=ZT(b4);var Cc={exports:{}},bc={exports:{}},Tc={exports:{}},Gx;function T4(){if(Gx)return Tc.exports;Gx=1;function t(e,n,i){const r=new RegExp(n).exec(e.slice(i));return r?i+r.index:-1}return Tc.exports=t,Tc.exports.default=t,Tc.exports}var Rc={exports:{}},$x;function R4(){if($x)return Rc.exports;$x=1;function t(e,n,i){const r=new RegExp(n).exec(e.slice(i));return r?i+r.index+r[0].length-1:-1}return Rc.exports=t,Rc.exports.default=t,Rc.exports}var vc={exports:{}},jx;function v4(){if(jx)return vc.exports;jx=1;function t(e,n){const i=new RegExp(n,"g"),s=e.match(i);return s?s.length:0}return vc.exports=t,vc.exports.default=t,vc.exports}var zx;function A4(){if(zx)return bc.exports;zx=1;const t=T4(),e=R4(),n=v4();function i(s,r,o){const a=o&&o.debug||!1,l=!(o&&typeof o.nested===!1),c=o&&o.startIndex||0;a&&console.log("[xml-utils] starting findTagByName with",r," and ",o);const h=t(s,`<${r}[ 
>/]`,c);if(a&&console.log("[xml-utils] start:",h),h===-1)return;const u=s.slice(h+r.length);let d=e(u,"^[^<]*[ /]>",0);const f=d!==-1&&u[d-1]==="/";if(a&&console.log("[xml-utils] selfClosing:",f),f===!1)if(l){let y=0,_=1,x=0;for(;(d=e(u,"[ /]"+r+">",y))!==-1;){const E=u.substring(y,d+1);if(_+=n(E,"<"+r+`[ 
	>]`),x+=n(E,"</"+r+">"),x>=_)break;y=d}}else d=e(u,"[ /]"+r+">",0);const g=h+r.length+d+1;if(a&&console.log("[xml-utils] end:",g),g===-1)return;const m=s.slice(h,g);let p;return f?p=null:p=m.slice(m.indexOf(">")+1,m.lastIndexOf("<")),{inner:p,outer:m,start:h,end:g}}return bc.exports=i,bc.exports.default=i,bc.exports}var Hx;function I4(){if(Hx)return Cc.exports;Hx=1;const t=A4();function e(n,i,s){const r=[],o=s&&s.debug||!1,a=s&&typeof s.nested=="boolean"?s.nested:!0;let l=s&&s.startIndex||0,c;for(;c=t(n,i,{debug:o,startIndex:l});)a?l=c.start+1+i.length:l=c.end,r.push(c);return o&&console.log("findTagsByName found",r.length,"tags"),r}return Cc.exports=e,Cc.exports.default=e,Cc.exports}var P4=I4();const M4=ZT(P4),el={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},Ti={};for(const t in el)el.hasOwnProperty(t)&&(Ti[el[t]]=parseInt(t,10));const F4=[Ti.BitsPerSample,Ti.ExtraSamples,Ti.SampleFormat,Ti.StripByteCounts,Ti.StripOffsets,Ti.StripRowCounts,Ti.TileByteCounts,Ti.TileOffsets,Ti.SubIFDs],Tf={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},De={};for(const t in Tf)Tf.hasOwnProperty(t)&&(De[Tf[t]]=parseInt(t,10));const In={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},D4={Unspecified:0},O8={AddCompression:1},L8={None:0,Deflate:1,Zstandard:2},O4={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"};function L4(t,e){const{width:n,height:i}=t,s=new Uint8Array(n*i*3);let r;for(let o=0,a=0;o<t.length;++o,a+=3)r=256-t[o]/e*256,s[a]=r,s[a+1]=r,s[a+2]=r;return s}function k4(t,e){const{width:n,height:i}=t,s=new Uint8Array(n*i*3);let r;for(let o=0,a=0;o<t.length;++o,a+=3)r=t[o]/e*256,s[a]=r,s[a+1]=r,s[a+2]=r;return s}function N4(t,e){const{width:n,height:i}=t,s=new Uint8Array(n*i*3),r=e.length/3,o=e.length/3*2;for(let a=0,l=0;a<t.length;++a,l+=3){const c=t[a];s[l]=e[c]/65536*256,s[l+1]=e[c+r]/65536*256,s[l+2]=e[c+o]/65536*256}return s}function B4(t){const{width:e,height:n}=t,i=new Uint8Array(e*n*3);for(let s=0,r=0;s<t.length;s+=4,r+=3){const o=t[s],a=t[s+1],l=t[s+2],c=t[s+3];i[r]=255*((255-o)/256)*((255-c)/256),i[r+1]=255*((255-a)/256)*((255-c)/256),i[r+2]=255*((255-l)/256)*((255-c)/256)}return i}function U4(t){const{width:e,height:n}=t,i=new Uint8ClampedArray(e*n*3);for(let s=0,r=0;s<t.length;s+=3,r+=3){const o=t[s],a=t[s+1],l=t[s+2];i[r]=o+1.402*(l-128),i[r+1]=o-.34414*(a-128)-.71414*(l-128),i[r+2]=o+1.772*(a-128)}return i}const G4=.95047,$4=1,j4=1.08883;function z4(t){const{width:e,height:n}=t,i=new Uint8Array(e*n*3);for(let s=0,r=0;s<t.length;s+=3,r+=3){const o=t[s+0],a=t[s+1]<<24>>24,l=t[s+2]<<24>>24;let c=(o+16)/116,h=a/500+c,u=c-l/200,d,f,g;h=G4*(h*h*h>.008856?h*h*h:(h-16/116)/7.787),c=$4*(c*c*c>.008856?c*c*c:(c-16/116)/7.787),u=j4*(u*u*u>.008856?u*u*u:(u-16/116)/7.787),d=h*3.2406+c*-1.5372+u*-.4986,f=h*-.9689+c*1.8758+u*.0415,g=h*.0557+c*-.204+u*1.057,d=d>.0031308?1.055*d**(1/2.4)-.055:12.92*d,f=f>.0031308?1.055*f**(1/2.4)-.055:12.92*f,g=g>.0031308?1.055*g**(1/2.4)-.055:12.92*g,i[r]=Math.max(0,Math.min(1,d))*255,i[r+1]=Math.max(0,Math.min(1,f))*255,i[r+2]=Math.max(0,Math.min(1,g))*255}return i}const JT=new Map;function Zs(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>JT.set(n,e))}async function QT(t){const e=JT.get(t.Compression);if(!e)throw new Error(`Unknown compression method identifier: ${t.Compression}`);const n=await e();return new n(t)}Zs([void 0,1],()=>$i(()=>import("./raw-in9isEBO.js"),__vite__mapDeps([0,1])).then(t=>t.default));Zs(5,()=>$i(()=>import("./lzw-_aCqfs4w.js"),__vite__mapDeps([2,1])).then(t=>t.default));Zs(6,()=>{throw new Error("old style JPEG compression is not supported.")});Zs(7,()=>$i(()=>import("./jpeg-CKYXsxFN.js"),__vite__mapDeps([3,1])).then(t=>t.default));Zs([8,32946],()=>$i(()=>import("./deflate-B9JhHpvg.js"),__vite__mapDeps([4,5,1])).then(t=>t.default));Zs(32773,()=>$i(()=>import("./packbits-DDWKfGV_.js"),__vite__mapDeps([6,1])).then(t=>t.default));Zs(34887,()=>$i(()=>import("./lerc-oLJ7S0dO.js"),__vite__mapDeps([7,5,1])).then(async t=>(await t.zstd.init(),t)).then(t=>t.default));Zs(50001,()=>$i(()=>import("./webimage-DBgUwIbt.js"),__vite__mapDeps([8,1])).then(t=>t.default));function ku(t,e,n,i=1){return new(Object.getPrototypeOf(t)).constructor(e*n*i)}function H4(t,e,n,i,s){const r=e/i,o=n/s;return t.map(a=>{const l=ku(a,i,s);for(let c=0;c<s;++c){const h=Math.min(Math.round(o*c),n-1);for(let u=0;u<i;++u){const d=Math.min(Math.round(r*u),e-1),f=a[h*e+d];l[c*i+u]=f}}return l})}function Ro(t,e,n){return(1-n)*t+n*e}function X4(t,e,n,i,s){const r=e/i,o=n/s;return t.map(a=>{const l=ku(a,i,s);for(let c=0;c<s;++c){const h=o*c,u=Math.floor(h),d=Math.min(Math.ceil(h),n-1);for(let f=0;f<i;++f){const g=r*f,m=g%1,p=Math.floor(g),y=Math.min(Math.ceil(g),e-1),_=a[u*e+p],x=a[u*e+y],E=a[d*e+p],w=a[d*e+y],b=Ro(Ro(_,x,m),Ro(E,w,m),h%1);l[c*i+f]=b}}return l})}function V4(t,e,n,i,s,r="nearest"){switch(r.toLowerCase()){case"nearest":return H4(t,e,n,i,s);case"bilinear":case"linear":return X4(t,e,n,i,s);default:throw new Error(`Unsupported resampling method: '${r}'`)}}function W4(t,e,n,i,s,r){const o=e/i,a=n/s,l=ku(t,i,s,r);for(let c=0;c<s;++c){const h=Math.min(Math.round(a*c),n-1);for(let u=0;u<i;++u){const d=Math.min(Math.round(o*u),e-1);for(let f=0;f<r;++f){const g=t[h*e*r+d*r+f];l[c*i*r+u*r+f]=g}}}return l}function K4(t,e,n,i,s,r){const o=e/i,a=n/s,l=ku(t,i,s,r);for(let c=0;c<s;++c){const h=a*c,u=Math.floor(h),d=Math.min(Math.ceil(h),n-1);for(let f=0;f<i;++f){const g=o*f,m=g%1,p=Math.floor(g),y=Math.min(Math.ceil(g),e-1);for(let _=0;_<r;++_){const x=t[u*e*r+p*r+_],E=t[u*e*r+y*r+_],w=t[d*e*r+p*r+_],b=t[d*e*r+y*r+_],v=Ro(Ro(x,E,m),Ro(w,b,m),h%1);l[c*i*r+f*r+_]=v}}}return l}function Y4(t,e,n,i,s,r,o="nearest"){switch(o.toLowerCase()){case"nearest":return W4(t,e,n,i,s,r);case"bilinear":case"linear":return K4(t,e,n,i,s,r);default:throw new Error(`Unsupported resampling method: '${o}'`)}}function q4(t,e,n){let i=0;for(let s=e;s<n;++s)i+=t[s];return i}function Ng(t,e,n){switch(t){case 1:if(e<=8)return new Uint8Array(n);if(e<=16)return new Uint16Array(n);if(e<=32)return new Uint32Array(n);break;case 2:if(e===8)return new Int8Array(n);if(e===16)return new Int16Array(n);if(e===32)return new Int32Array(n);break;case 3:switch(e){case 16:case 32:return new Float32Array(n);case 64:return new Float64Array(n)}break}throw Error("Unsupported data format/bitsPerSample")}function Z4(t,e){return(t===1||t===2)&&e<=32&&e%8===0?!1:!(t===3&&(e===16||e===32||e===64))}function J4(t,e,n,i,s,r,o){const a=new DataView(t),l=n===2?o*r:o*r*i,c=n===2?1:i,h=Ng(e,s,l),u=parseInt("1".repeat(s),2);if(e===1){let d;n===1?d=i*s:d=s;let f=r*d;(f&7)!==0&&(f=f+7&-8);for(let g=0;g<o;++g){const m=g*f;for(let p=0;p<r;++p){const y=m+p*c*s;for(let _=0;_<c;++_){const x=y+_*s,E=(g*r+p)*c+_,w=Math.floor(x/8),b=x%8;if(b+s<=8)h[E]=a.getUint8(w)>>8-s-b&u;else if(b+s<=16)h[E]=a.getUint16(w)>>16-s-b&u;else if(b+s<=24){const v=a.getUint16(w)<<8|a.getUint8(w+2);h[E]=v>>24-s-b&u}else h[E]=a.getUint32(w)>>32-s-b&u}}}}return h.buffer}class e1{constructor(e,n,i,s,r,o){this.fileDirectory=e,this.geoKeys=n,this.dataView=i,this.littleEndian=s,this.tiles=r?{}:null,this.isTiled=!e.StripOffsets;const a=e.PlanarConfiguration;if(this.planarConfiguration=typeof a>"u"?1:a,this.planarConfiguration!==1&&this.planarConfiguration!==2)throw new Error("Invalid planar configuration.");this.source=o}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return typeof this.fileDirectory.SamplesPerPixel<"u"?this.fileDirectory.SamplesPerPixel:1}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:typeof this.fileDirectory.RowsPerStrip<"u"?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBlockWidth(){return this.getTileWidth()}getBlockHeight(e){return this.isTiled||(e+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-e*this.getTileHeight()}getBytesPerPixel(){let e=0;for(let n=0;n<this.fileDirectory.BitsPerSample.length;++n)e+=this.getSampleByteSize(n);return e}getSampleByteSize(e){if(e>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${e} is out of range.`);return Math.ceil(this.fileDirectory.BitsPerSample[e]/8)}getReaderForSample(e){const n=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1,i=this.fileDirectory.BitsPerSample[e];switch(n){case 1:if(i<=8)return DataView.prototype.getUint8;if(i<=16)return DataView.prototype.getUint16;if(i<=32)return DataView.prototype.getUint32;break;case 2:if(i<=8)return DataView.prototype.getInt8;if(i<=16)return DataView.prototype.getInt16;if(i<=32)return DataView.prototype.getInt32;break;case 3:switch(i){case 16:return function(s,r){return qT(this,s,r)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}break}throw Error("Unsupported data format/bitsPerSample")}getSampleFormat(e=0){return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1}getBitsPerSample(e=0){return this.fileDirectory.BitsPerSample[e]}getArrayForSample(e,n){const i=this.getSampleFormat(e),s=this.getBitsPerSample(e);return Ng(i,s,n)}async getTileOrStrip(e,n,i,s,r){const o=Math.ceil(this.getWidth()/this.getTileWidth()),a=Math.ceil(this.getHeight()/this.getTileHeight());let l;const{tiles:c}=this;this.planarConfiguration===1?l=n*o+e:this.planarConfiguration===2&&(l=i*o*a+n*o+e);let h,u;this.isTiled?(h=this.fileDirectory.TileOffsets[l],u=this.fileDirectory.TileByteCounts[l]):(h=this.fileDirectory.StripOffsets[l],u=this.fileDirectory.StripByteCounts[l]);const d=(await this.source.fetch([{offset:h,length:u}],r))[0];let f;return c===null||!c[l]?(f=(async()=>{let g=await s.decode(this.fileDirectory,d);const m=this.getSampleFormat(),p=this.getBitsPerSample();return Z4(m,p)&&(g=J4(g,m,this.planarConfiguration,this.getSamplesPerPixel(),p,this.getTileWidth(),this.getBlockHeight(n))),g})(),c!==null&&(c[l]=f)):f=c[l],{x:e,y:n,sample:i,data:await f}}async _readRaster(e,n,i,s,r,o,a,l,c){const h=this.getTileWidth(),u=this.getTileHeight(),d=this.getWidth(),f=this.getHeight(),g=Math.max(Math.floor(e[0]/h),0),m=Math.min(Math.ceil(e[2]/h),Math.ceil(d/h)),p=Math.max(Math.floor(e[1]/u),0),y=Math.min(Math.ceil(e[3]/u),Math.ceil(f/u)),_=e[2]-e[0];let x=this.getBytesPerPixel();const E=[],w=[];for(let A=0;A<n.length;++A)this.planarConfiguration===1?E.push(q4(this.fileDirectory.BitsPerSample,0,n[A])/8):E.push(0),w.push(this.getReaderForSample(n[A]));const b=[],{littleEndian:v}=this;for(let A=p;A<y;++A)for(let P=g;P<m;++P){let M;this.planarConfiguration===1&&(M=this.getTileOrStrip(P,A,0,r,c));for(let Y=0;Y<n.length;++Y){const j=Y,K=n[Y];this.planarConfiguration===2&&(x=this.getSampleByteSize(K),M=this.getTileOrStrip(P,A,K,r,c));const ee=M.then(te=>{const Q=te.data,V=new DataView(Q),z=this.getBlockHeight(te.y),re=te.y*u,ue=te.x*h,ye=re+z,N=(te.x+1)*h,be=w[j],Z=Math.min(z,z-(ye-e[3]),f-re),H=Math.min(h,h-(N-e[2]),d-ue);for(let oe=Math.max(0,e[1]-re);oe<Z;++oe)for(let ge=Math.max(0,e[0]-ue);ge<H;++ge){const Ie=(oe*h+ge)*x,je=be.call(V,Ie+E[j],v);let Xe;s?(Xe=(oe+re-e[1])*_*n.length+(ge+ue-e[0])*n.length+j,i[Xe]=je):(Xe=(oe+re-e[1])*_+ge+ue-e[0],i[j][Xe]=je)}});b.push(ee)}}if(await Promise.all(b),o&&e[2]-e[0]!==o||a&&e[3]-e[1]!==a){let A;return s?A=Y4(i,e[2]-e[0],e[3]-e[1],o,a,n.length,l):A=V4(i,e[2]-e[0],e[3]-e[1],o,a,l),A.width=o,A.height=a,A}return i.width=o||e[2]-e[0],i.height=a||e[3]-e[1],i}async readRasters({window:e,samples:n=[],interleave:i,pool:s=null,width:r,height:o,resampleMethod:a,fillValue:l,signal:c}={}){const h=e||[0,0,this.getWidth(),this.getHeight()];if(h[0]>h[2]||h[1]>h[3])throw new Error("Invalid subsets");const u=h[2]-h[0],d=h[3]-h[1],f=u*d,g=this.getSamplesPerPixel();if(!n||!n.length)for(let _=0;_<g;++_)n.push(_);else for(let _=0;_<n.length;++_)if(n[_]>=g)return Promise.reject(new RangeError(`Invalid sample index '${n[_]}'.`));let m;if(i){const _=this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,x=Math.max.apply(null,this.fileDirectory.BitsPerSample);m=Ng(_,x,f*n.length),l&&m.fill(l)}else{m=[];for(let _=0;_<n.length;++_){const x=this.getArrayForSample(n[_],f);Array.isArray(l)&&_<l.length?x.fill(l[_]):l&&!Array.isArray(l)&&x.fill(l),m.push(x)}}const p=s||await QT(this.fileDirectory);return await this._readRaster(h,n,m,i,p,r,o,a,c)}async readRGB({window:e,interleave:n=!0,pool:i=null,width:s,height:r,resampleMethod:o,enableAlpha:a=!1,signal:l}={}){const c=e||[0,0,this.getWidth(),this.getHeight()];if(c[0]>c[2]||c[1]>c[3])throw new Error("Invalid subsets");const h=this.fileDirectory.PhotometricInterpretation;if(h===In.RGB){let y=[0,1,2];if(this.fileDirectory.ExtraSamples!==D4.Unspecified&&a){y=[];for(let _=0;_<this.fileDirectory.BitsPerSample.length;_+=1)y.push(_)}return this.readRasters({window:e,interleave:n,samples:y,pool:i,width:s,height:r,resampleMethod:o,signal:l})}let u;switch(h){case In.WhiteIsZero:case In.BlackIsZero:case In.Palette:u=[0];break;case In.CMYK:u=[0,1,2,3];break;case In.YCbCr:case In.CIELab:u=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const d={window:c,interleave:!0,samples:u,pool:i,width:s,height:r,resampleMethod:o,signal:l},{fileDirectory:f}=this,g=await this.readRasters(d),m=2**this.fileDirectory.BitsPerSample[0];let p;switch(h){case In.WhiteIsZero:p=L4(g,m);break;case In.BlackIsZero:p=k4(g,m);break;case In.Palette:p=N4(g,f.ColorMap);break;case In.CMYK:p=B4(g);break;case In.YCbCr:p=U4(g);break;case In.CIELab:p=z4(g);break;default:throw new Error("Unsupported photometric interpretation.")}if(!n){const y=new Uint8Array(p.length/3),_=new Uint8Array(p.length/3),x=new Uint8Array(p.length/3);for(let E=0,w=0;E<p.length;E+=3,++w)y[w]=p[E],_[w]=p[E+1],x[w]=p[E+2];p=[y,_,x]}return p.width=g.width,p.height=g.height,p}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const e=[];for(let n=0;n<this.fileDirectory.ModelTiepoint.length;n+=6)e.push({i:this.fileDirectory.ModelTiepoint[n],j:this.fileDirectory.ModelTiepoint[n+1],k:this.fileDirectory.ModelTiepoint[n+2],x:this.fileDirectory.ModelTiepoint[n+3],y:this.fileDirectory.ModelTiepoint[n+4],z:this.fileDirectory.ModelTiepoint[n+5]});return e}getGDALMetadata(e=null){const n={};if(!this.fileDirectory.GDAL_METADATA)return null;const i=this.fileDirectory.GDAL_METADATA;let s=M4(i,"Item");e===null?s=s.filter(r=>bf(r,"sample")===void 0):s=s.filter(r=>Number(bf(r,"sample"))===e);for(let r=0;r<s.length;++r){const o=s[r];n[bf(o,"name")]=o.inner}return n}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const e=this.fileDirectory.GDAL_NODATA;return Number(e.substring(0,e.length-1))}getOrigin(){const e=this.fileDirectory.ModelTiepoint,n=this.fileDirectory.ModelTransformation;if(e&&e.length===6)return[e[3],e[4],e[5]];if(n)return[n[3],n[7],n[11]];throw new Error("The image does not have an affine transformation.")}getResolution(e=null){const n=this.fileDirectory.ModelPixelScale,i=this.fileDirectory.ModelTransformation;if(n)return[n[0],-n[1],n[2]];if(i)return i[1]===0&&i[4]===0?[i[0],-i[5],i[10]]:[Math.sqrt(i[0]*i[0]+i[4]*i[4]),-Math.sqrt(i[1]*i[1]+i[5]*i[5]),i[10]];if(e){const[s,r,o]=e.getResolution();return[s*e.getWidth()/this.getWidth(),r*e.getHeight()/this.getHeight(),o*e.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return this.geoKeys.GTRasterTypeGeoKey===1}getBoundingBox(e=!1){const n=this.getHeight(),i=this.getWidth();if(this.fileDirectory.ModelTransformation&&!e){const[s,r,o,a,l,c,h,u]=this.fileDirectory.ModelTransformation,f=[[0,0],[0,n],[i,0],[i,n]].map(([p,y])=>[a+s*p+r*y,u+l*p+c*y]),g=f.map(p=>p[0]),m=f.map(p=>p[1]);return[Math.min(...g),Math.min(...m),Math.max(...g),Math.max(...m)]}else{const s=this.getOrigin(),r=this.getResolution(),o=s[0],a=s[1],l=o+r[0]*i,c=a+r[1]*n;return[Math.min(o,l),Math.min(a,c),Math.max(o,l),Math.max(a,c)]}}}class Q4{constructor(e){this._dataView=new DataView(e)}get buffer(){return this._dataView.buffer}getUint64(e,n){const i=this.getUint32(e,n),s=this.getUint32(e+4,n);let r;if(n){if(r=i+2**32*s,!Number.isSafeInteger(r))throw new Error(`${r} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return r}if(r=2**32*i+s,!Number.isSafeInteger(r))throw new Error(`${r} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return r}getInt64(e,n){let i=0;const s=(this._dataView.getUint8(e+(n?7:0))&128)>0;let r=!0;for(let o=0;o<8;o++){let a=this._dataView.getUint8(e+(n?o:7-o));s&&(r?a!==0&&(a=~(a-1)&255,r=!1):a=~a&255),i+=a*256**o}return s&&(i=-i),i}getUint8(e,n){return this._dataView.getUint8(e,n)}getInt8(e,n){return this._dataView.getInt8(e,n)}getUint16(e,n){return this._dataView.getUint16(e,n)}getInt16(e,n){return this._dataView.getInt16(e,n)}getUint32(e,n){return this._dataView.getUint32(e,n)}getInt32(e,n){return this._dataView.getInt32(e,n)}getFloat16(e,n){return qT(this._dataView,e,n)}getFloat32(e,n){return this._dataView.getFloat32(e,n)}getFloat64(e,n){return this._dataView.getFloat64(e,n)}}class e6{constructor(e,n,i,s){this._dataView=new DataView(e),this._sliceOffset=n,this._littleEndian=i,this._bigTiff=s}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(e,n){return this.sliceOffset<=e&&this.sliceTop>=e+n}readUint8(e){return this._dataView.getUint8(e-this._sliceOffset,this._littleEndian)}readInt8(e){return this._dataView.getInt8(e-this._sliceOffset,this._littleEndian)}readUint16(e){return this._dataView.getUint16(e-this._sliceOffset,this._littleEndian)}readInt16(e){return this._dataView.getInt16(e-this._sliceOffset,this._littleEndian)}readUint32(e){return this._dataView.getUint32(e-this._sliceOffset,this._littleEndian)}readInt32(e){return this._dataView.getInt32(e-this._sliceOffset,this._littleEndian)}readFloat32(e){return this._dataView.getFloat32(e-this._sliceOffset,this._littleEndian)}readFloat64(e){return this._dataView.getFloat64(e-this._sliceOffset,this._littleEndian)}readUint64(e){const n=this.readUint32(e),i=this.readUint32(e+4);let s;if(this._littleEndian){if(s=n+2**32*i,!Number.isSafeInteger(s))throw new Error(`${s} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return s}if(s=2**32*n+i,!Number.isSafeInteger(s))throw new Error(`${s} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return s}readInt64(e){let n=0;const i=(this._dataView.getUint8(e+(this._littleEndian?7:0))&128)>0;let s=!0;for(let r=0;r<8;r++){let o=this._dataView.getUint8(e+(this._littleEndian?r:7-r));i&&(s?o!==0&&(o=~(o-1)&255,s=!1):o=~o&255),n+=o*256**r}return i&&(n=-n),n}readOffset(e){return this._bigTiff?this.readUint64(e):this.readUint32(e)}}const t6=typeof navigator<"u"&&navigator.hardwareConcurrency||2;class n6{constructor(e=t6,n){this.workers=null,this._awaitingDecoder=null,this.size=e,this.messageId=0,e&&(this._awaitingDecoder=n?Promise.resolve(n):new Promise(i=>{$i(()=>import("./decoder-tqM1uIvc.js"),[]).then(s=>{i(s.create)})}),this._awaitingDecoder.then(i=>{this._awaitingDecoder=null,this.workers=[];for(let s=0;s<e;s++)this.workers.push({worker:i(),idle:!0})}))}async decode(e,n){return this._awaitingDecoder&&await this._awaitingDecoder,this.size===0?QT(e).then(i=>i.decode(e,n)):new Promise(i=>{const s=this.workers.find(a=>a.idle)||this.workers[Math.floor(Math.random()*this.size)];s.idle=!1;const r=this.messageId++,o=a=>{a.data.id===r&&(s.idle=!0,i(a.data.decoded),s.worker.removeEventListener("message",o))};s.worker.addEventListener("message",o),s.worker.postMessage({fileDirectory:e,buffer:n,id:r},[n])})}destroy(){this.workers&&(this.workers.forEach(e=>{e.worker.terminate()}),this.workers=null)}}const Xx=`\r
\r
`;function t1(t){if(typeof Object.fromEntries<"u")return Object.fromEntries(t);const e={};for(const[n,i]of t)e[n.toLowerCase()]=i;return e}function i6(t){const e=t.split(`\r
`).map(n=>{const i=n.split(":").map(s=>s.trim());return i[0]=i[0].toLowerCase(),i});return t1(e)}function s6(t){const[e,...n]=t.split(";").map(s=>s.trim()),i=n.map(s=>s.split("="));return{type:e,params:t1(i)}}function Bg(t){let e,n,i;return t&&([,e,n,i]=t.match(/bytes (\d+)-(\d+)\/(\d+)/),e=parseInt(e,10),n=parseInt(n,10),i=parseInt(i,10)),{start:e,end:n,total:i}}function r6(t,e){let n=null;const i=new TextDecoder("ascii"),s=[],r=`--${e}`,o=`${r}--`;for(let a=0;a<10;++a)i.decode(new Uint8Array(t,a,r.length))===r&&(n=a);if(n===null)throw new Error("Could not find initial boundary");for(;n<t.byteLength;){const a=i.decode(new Uint8Array(t,n,Math.min(r.length+1024,t.byteLength-n)));if(a.length===0||a.startsWith(o))break;if(!a.startsWith(r))throw new Error("Part does not start with boundary");const l=a.substr(r.length+2);if(l.length===0)break;const c=l.indexOf(Xx),h=i6(l.substr(0,c)),{start:u,end:d,total:f}=Bg(h["content-range"]),g=n+r.length+c+Xx.length,m=parseInt(d,10)+1-parseInt(u,10);s.push({headers:h,data:t.slice(g,g+m),offset:u,length:m,fileSize:f}),n=g+m+4}return s}class y_{async fetch(e,n=void 0){return Promise.all(e.map(i=>this.fetchSlice(i,n)))}async fetchSlice(e){throw new Error(`fetching of slice ${e} not possible, not implemented`)}get fileSize(){return null}async close(){}}class o6 extends Map{constructor(e={}){if(super(),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if(typeof e.maxAge=="number"&&e.maxAge===0)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=e.maxSize,this.maxAge=e.maxAge||Number.POSITIVE_INFINITY,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(e){if(typeof this.onEviction=="function")for(const[n,i]of e)this.onEviction(n,i.value)}_deleteIfExpired(e,n){return typeof n.expiry=="number"&&n.expiry<=Date.now()?(typeof this.onEviction=="function"&&this.onEviction(e,n.value),this.delete(e)):!1}_getOrDeleteIfExpired(e,n){if(this._deleteIfExpired(e,n)===!1)return n.value}_getItemValue(e,n){return n.expiry?this._getOrDeleteIfExpired(e,n):n.value}_peek(e,n){const i=n.get(e);return this._getItemValue(e,i)}_set(e,n){this.cache.set(e,n),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(e,n){this.oldCache.delete(e),this._set(e,n)}*_entriesAscending(){for(const e of this.oldCache){const[n,i]=e;this.cache.has(n)||this._deleteIfExpired(n,i)===!1&&(yield e)}for(const e of this.cache){const[n,i]=e;this._deleteIfExpired(n,i)===!1&&(yield e)}}get(e){if(this.cache.has(e)){const n=this.cache.get(e);return this._getItemValue(e,n)}if(this.oldCache.has(e)){const n=this.oldCache.get(e);if(this._deleteIfExpired(e,n)===!1)return this._moveToRecent(e,n),n.value}}set(e,n,{maxAge:i=this.maxAge}={}){const s=typeof i=="number"&&i!==Number.POSITIVE_INFINITY?Date.now()+i:void 0;return this.cache.has(e)?this.cache.set(e,{value:n,expiry:s}):this._set(e,{value:n,expiry:s}),this}has(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):this.oldCache.has(e)?!this._deleteIfExpired(e,this.oldCache.get(e)):!1}peek(e){if(this.cache.has(e))return this._peek(e,this.cache);if(this.oldCache.has(e))return this._peek(e,this.oldCache)}delete(e){const n=this.cache.delete(e);return n&&this._size--,this.oldCache.delete(e)||n}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");const n=[...this._entriesAscending()],i=n.length-e;i<0?(this.cache=new Map(n),this.oldCache=new Map,this._size=n.length):(i>0&&this._emitEvictions(n.slice(0,i)),this.oldCache=new Map(n.slice(i)),this.cache=new Map,this._size=0),this.maxSize=e}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache){const[n,i]=e;this._deleteIfExpired(n,i)===!1&&(yield[n,i.value])}for(const e of this.oldCache){const[n,i]=e;this.cache.has(n)||this._deleteIfExpired(n,i)===!1&&(yield[n,i.value])}}*entriesDescending(){let e=[...this.cache];for(let n=e.length-1;n>=0;--n){const i=e[n],[s,r]=i;this._deleteIfExpired(s,r)===!1&&(yield[s,r.value])}e=[...this.oldCache];for(let n=e.length-1;n>=0;--n){const i=e[n],[s,r]=i;this.cache.has(s)||this._deleteIfExpired(s,r)===!1&&(yield[s,r.value])}}*entriesAscending(){for(const[e,n]of this._entriesAscending())yield[e,n.value]}get size(){if(!this._size)return this.oldCache.size;let e=0;for(const n of this.oldCache.keys())this.cache.has(n)||e++;return Math.min(this._size+e,this.maxSize)}entries(){return this.entriesAscending()}forEach(e,n=this){for(const[i,s]of this.entriesAscending())e.call(n,s,i,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}async function a6(t){return new Promise(e=>setTimeout(e,t))}function l6(t,e){const n=Array.isArray(t)?t:Array.from(t),i=Array.isArray(e)?e:Array.from(e);return n.map((s,r)=>[s,i[r]])}class Xo extends Error{constructor(e){super(e),Error.captureStackTrace&&Error.captureStackTrace(this,Xo),this.name="AbortError"}}class c6 extends Error{constructor(e,n){super(n),this.errors=e,this.message=n,this.name="AggregateError"}}const h6=c6;class u6{constructor(e,n,i=null){this.offset=e,this.length=n,this.data=i}get top(){return this.offset+this.length}}class Vx{constructor(e,n,i){this.offset=e,this.length=n,this.blockIds=i}}class d6 extends y_{constructor(e,{blockSize:n=65536,cacheSize:i=100}={}){super(),this.source=e,this.blockSize=n,this.blockCache=new o6({maxSize:i,onEviction:(s,r)=>{this.evictedBlocks.set(s,r)}}),this.evictedBlocks=new Map,this.blockRequests=new Map,this.blockIdsToFetch=new Set,this.abortedBlockIds=new Set}get fileSize(){return this.source.fileSize}async fetch(e,n){const i=[],s=[],r=[];this.evictedBlocks.clear();for(const{offset:d,length:f}of e){let g=d+f;const{fileSize:m}=this;m!==null&&(g=Math.min(g,m));const p=Math.floor(d/this.blockSize)*this.blockSize;for(let y=p;y<g;y+=this.blockSize){const _=Math.floor(y/this.blockSize);!this.blockCache.has(_)&&!this.blockRequests.has(_)&&(this.blockIdsToFetch.add(_),s.push(_)),this.blockRequests.has(_)&&i.push(this.blockRequests.get(_)),r.push(_)}}await a6(),this.fetchBlocks(n);const o=[];for(const d of s)this.blockRequests.has(d)&&o.push(this.blockRequests.get(d));await Promise.allSettled(i),await Promise.allSettled(o);const a=[],l=r.filter(d=>this.abortedBlockIds.has(d)||!this.blockCache.has(d));if(l.forEach(d=>this.blockIdsToFetch.add(d)),l.length>0&&n&&!n.aborted){this.fetchBlocks(null);for(const d of l){const f=this.blockRequests.get(d);if(!f)throw new Error(`Block ${d} is not in the block requests`);a.push(f)}await Promise.allSettled(a)}if(n&&n.aborted)throw new Xo("Request was aborted");const c=r.map(d=>this.blockCache.get(d)||this.evictedBlocks.get(d)),h=c.filter(d=>!d);if(h.length)throw new h6(h,"Request failed");const u=new Map(l6(r,c));return this.readSliceData(e,u)}fetchBlocks(e){if(this.blockIdsToFetch.size>0){const n=this.groupBlocks(this.blockIdsToFetch),i=this.source.fetch(n,e);for(let s=0;s<n.length;++s){const r=n[s];for(const o of r.blockIds)this.blockRequests.set(o,(async()=>{try{const a=(await i)[s],l=o*this.blockSize,c=l-a.offset,h=Math.min(c+this.blockSize,a.data.byteLength),u=a.data.slice(c,h),d=new u6(l,u.byteLength,u,o);this.blockCache.set(o,d),this.abortedBlockIds.delete(o)}catch(a){if(a.name==="AbortError")a.signal=e,this.blockCache.delete(o),this.abortedBlockIds.add(o);else throw a}finally{this.blockRequests.delete(o)}})())}this.blockIdsToFetch.clear()}}groupBlocks(e){const n=Array.from(e).sort((o,a)=>o-a);if(n.length===0)return[];let i=[],s=null;const r=[];for(const o of n)s===null||s+1===o?(i.push(o),s=o):(r.push(new Vx(i[0]*this.blockSize,i.length*this.blockSize,i)),i=[o],s=o);return r.push(new Vx(i[0]*this.blockSize,i.length*this.blockSize,i)),r}readSliceData(e,n){return e.map(i=>{let s=i.offset+i.length;this.fileSize!==null&&(s=Math.min(this.fileSize,s));const r=Math.floor(i.offset/this.blockSize),o=Math.floor(s/this.blockSize),a=new ArrayBuffer(i.length),l=new Uint8Array(a);for(let c=r;c<=o;++c){const h=n.get(c),u=h.offset-i.offset,d=h.top-s;let f=0,g=0,m;u<0?f=-u:u>0&&(g=u),d<0?m=h.length-f:m=s-h.offset-f;const p=new Uint8Array(h.data,f,m);l.set(p,g)}return a})}}class E_{get ok(){return this.status>=200&&this.status<=299}get status(){throw new Error("not implemented")}getHeader(e){throw new Error("not implemented")}async getData(){throw new Error("not implemented")}}class x_{constructor(e){this.url=e}async request({headers:e,signal:n}={}){throw new Error("request is not implemented")}}class f6 extends E_{constructor(e){super(),this.response=e}get status(){return this.response.status}getHeader(e){return this.response.headers.get(e)}async getData(){return this.response.arrayBuffer?await this.response.arrayBuffer():(await this.response.buffer()).buffer}}class g6 extends x_{constructor(e,n){super(e),this.credentials=n}async request({headers:e,signal:n}={}){const i=await fetch(this.url,{headers:e,credentials:this.credentials,signal:n});return new f6(i)}}class p6 extends E_{constructor(e,n){super(),this.xhr=e,this.data=n}get status(){return this.xhr.status}getHeader(e){return this.xhr.getResponseHeader(e)}async getData(){return this.data}}class m6 extends x_{constructRequest(e,n){return new Promise((i,s)=>{const r=new XMLHttpRequest;r.open("GET",this.url),r.responseType="arraybuffer";for(const[o,a]of Object.entries(e))r.setRequestHeader(o,a);r.onload=()=>{const o=r.response;i(new p6(r,o))},r.onerror=s,r.onabort=()=>s(new Xo("Request aborted")),r.send(),n&&(n.aborted&&r.abort(),n.addEventListener("abort",()=>r.abort()))})}async request({headers:e,signal:n}={}){return await this.constructRequest(e,n)}}class _6 extends E_{constructor(e,n){super(),this.response=e,this.dataPromise=n}get status(){return this.response.statusCode}getHeader(e){return this.response.headers[e]}async getData(){return await this.dataPromise}}class y6 extends x_{constructor(e){super(e),this.parsedUrl=Kd.parse(this.url),this.httpApi=(this.parsedUrl.protocol==="http:",Kd)}constructRequest(e,n){return new Promise((i,s)=>{const r=this.httpApi.get({...this.parsedUrl,headers:e},o=>{const a=new Promise(l=>{const c=[];o.on("data",h=>{c.push(h)}),o.on("end",()=>{const h=Buffer.concat(c).buffer;l(h)}),o.on("error",s)});i(new _6(o,a))});r.on("error",s),n&&(n.aborted&&r.destroy(new Xo("Request aborted")),n.addEventListener("abort",()=>r.destroy(new Xo("Request aborted"))))})}async request({headers:e,signal:n}={}){return await this.constructRequest(e,n)}}class w_ extends y_{constructor(e,n,i,s){super(),this.client=e,this.headers=n,this.maxRanges=i,this.allowFullFile=s,this._fileSize=null}async fetch(e,n){return this.maxRanges>=e.length?this.fetchSlices(e,n):(this.maxRanges>0&&e.length>1,Promise.all(e.map(i=>this.fetchSlice(i,n))))}async fetchSlices(e,n){const i=await this.client.request({headers:{...this.headers,Range:`bytes=${e.map(({offset:s,length:r})=>`${s}-${s+r}`).join(",")}`},signal:n});if(i.ok)if(i.status===206){const{type:s,params:r}=s6(i.getHeader("content-type"));if(s==="multipart/byteranges"){const u=r6(await i.getData(),r.boundary);return this._fileSize=u[0].fileSize||null,u}const o=await i.getData(),{start:a,end:l,total:c}=Bg(i.getHeader("content-range"));this._fileSize=c||null;const h=[{data:o,offset:a,length:l-a}];if(e.length>1){const u=await Promise.all(e.slice(1).map(d=>this.fetchSlice(d,n)));return h.concat(u)}return h}else{if(!this.allowFullFile)throw new Error("Server responded with full file");const s=await i.getData();return this._fileSize=s.byteLength,[{data:s,offset:0,length:s.byteLength}]}else throw new Error("Error fetching data.")}async fetchSlice(e,n){const{offset:i,length:s}=e,r=await this.client.request({headers:{...this.headers,Range:`bytes=${i}-${i+s}`},signal:n});if(r.ok)if(r.status===206){const o=await r.getData(),{total:a}=Bg(r.getHeader("content-range"));return this._fileSize=a||null,{data:o,offset:i,length:s}}else{if(!this.allowFullFile)throw new Error("Server responded with full file");const o=await r.getData();return this._fileSize=o.byteLength,{data:o,offset:0,length:o.byteLength}}else throw new Error("Error fetching data.")}get fileSize(){return this._fileSize}}function S_(t,{blockSize:e,cacheSize:n}){return e===null?t:new d6(t,{blockSize:e,cacheSize:n})}function E6(t,{headers:e={},credentials:n,maxRanges:i=0,allowFullFile:s=!1,...r}={}){const o=new g6(t,n),a=new w_(o,e,i,s);return S_(a,r)}function x6(t,{headers:e={},maxRanges:n=0,allowFullFile:i=!1,...s}={}){const r=new m6(t),o=new w_(r,e,n,i);return S_(o,s)}function w6(t,{headers:e={},maxRanges:n=0,allowFullFile:i=!1,...s}={}){const r=new y6(t),o=new w_(r,e,n,i);return S_(o,s)}function Ug(t,{forceXHR:e=!1,...n}={}){return typeof fetch=="function"&&!e?E6(t,n):typeof XMLHttpRequest<"u"?x6(t,n):w6(t,n)}class S6 extends y_{constructor(e){super(),this.file=e}async fetchSlice(e,n){return new Promise((i,s)=>{const r=this.file.slice(e.offset,e.offset+e.length),o=new FileReader;o.onload=a=>i(a.target.result),o.onerror=s,o.onabort=s,o.readAsArrayBuffer(r),n&&n.addEventListener("abort",()=>o.abort())})}}function C6(t){return new S6(t)}function Gg(t){switch(t){case De.BYTE:case De.ASCII:case De.SBYTE:case De.UNDEFINED:return 1;case De.SHORT:case De.SSHORT:return 2;case De.LONG:case De.SLONG:case De.FLOAT:case De.IFD:return 4;case De.RATIONAL:case De.SRATIONAL:case De.DOUBLE:case De.LONG8:case De.SLONG8:case De.IFD8:return 8;default:throw new RangeError(`Invalid field type: ${t}`)}}function b6(t){const e=t.GeoKeyDirectory;if(!e)return null;const n={};for(let i=4;i<=e[3]*4;i+=4){const s=O4[e[i]],r=e[i+1]?el[e[i+1]]:null,o=e[i+2],a=e[i+3];let l=null;if(!r)l=a;else{if(l=t[r],typeof l>"u"||l===null)throw new Error(`Could not get value of geoKey '${s}'.`);typeof l=="string"?l=l.substring(a,a+o-1):l.subarray&&(l=l.subarray(a,a+o),o===1&&(l=l[0]))}n[s]=l}return n}function Zr(t,e,n,i){let s=null,r=null;const o=Gg(e);switch(e){case De.BYTE:case De.ASCII:case De.UNDEFINED:s=new Uint8Array(n),r=t.readUint8;break;case De.SBYTE:s=new Int8Array(n),r=t.readInt8;break;case De.SHORT:s=new Uint16Array(n),r=t.readUint16;break;case De.SSHORT:s=new Int16Array(n),r=t.readInt16;break;case De.LONG:case De.IFD:s=new Uint32Array(n),r=t.readUint32;break;case De.SLONG:s=new Int32Array(n),r=t.readInt32;break;case De.LONG8:case De.IFD8:s=new Array(n),r=t.readUint64;break;case De.SLONG8:s=new Array(n),r=t.readInt64;break;case De.RATIONAL:s=new Uint32Array(n*2),r=t.readUint32;break;case De.SRATIONAL:s=new Int32Array(n*2),r=t.readInt32;break;case De.FLOAT:s=new Float32Array(n),r=t.readFloat32;break;case De.DOUBLE:s=new Float64Array(n),r=t.readFloat64;break;default:throw new RangeError(`Invalid field type: ${e}`)}if(e===De.RATIONAL||e===De.SRATIONAL)for(let a=0;a<n;a+=2)s[a]=r.call(t,i+a*o),s[a+1]=r.call(t,i+(a*o+4));else for(let a=0;a<n;++a)s[a]=r.call(t,i+a*o);return e===De.ASCII?new TextDecoder("utf-8").decode(s):s}class T6{constructor(e,n,i){this.fileDirectory=e,this.geoKeyDirectory=n,this.nextIFDByteOffset=i}}class Ac extends Error{constructor(e){super(`No image at index ${e}`),this.index=e}}class n1{async readRasters(e={}){const{window:n,width:i,height:s}=e;let{resX:r,resY:o,bbox:a}=e;const l=await this.getImage();let c=l;const h=await this.getImageCount(),u=l.getBoundingBox();if(n&&a)throw new Error('Both "bbox" and "window" passed.');if(i||s){if(n){const[g,m]=l.getOrigin(),[p,y]=l.getResolution();a=[g+n[0]*p,m+n[1]*y,g+n[2]*p,m+n[3]*y]}const f=a||u;if(i){if(r)throw new Error("Both width and resX passed");r=(f[2]-f[0])/i}if(s){if(o)throw new Error("Both width and resY passed");o=(f[3]-f[1])/s}}if(r||o){const f=[];for(let g=0;g<h;++g){const m=await this.getImage(g),{SubfileType:p,NewSubfileType:y}=m.fileDirectory;(g===0||p===2||y&1)&&f.push(m)}f.sort((g,m)=>g.getWidth()-m.getWidth());for(let g=0;g<f.length;++g){const m=f[g],p=(u[2]-u[0])/m.getWidth(),y=(u[3]-u[1])/m.getHeight();if(c=m,r&&r>p||o&&o>y)break}}let d=n;if(a){const[f,g]=l.getOrigin(),[m,p]=c.getResolution(l);d=[Math.round((a[0]-f)/m),Math.round((a[1]-g)/p),Math.round((a[2]-f)/m),Math.round((a[3]-g)/p)],d=[Math.min(d[0],d[2]),Math.min(d[1],d[3]),Math.max(d[0],d[2]),Math.max(d[1],d[3])]}return c.readRasters({...e,window:d})}}class Vo extends n1{constructor(e,n,i,s,r={}){super(),this.source=e,this.littleEndian=n,this.bigTiff=i,this.firstIFDOffset=s,this.cache=r.cache||!1,this.ifdRequests=[],this.ghostValues=null}async getSlice(e,n){const i=this.bigTiff?4048:1024;return new e6((await this.source.fetch([{offset:e,length:typeof n<"u"?n:i}]))[0],e,this.littleEndian,this.bigTiff)}async parseFileDirectoryAt(e){const n=this.bigTiff?20:12,i=this.bigTiff?8:2;let s=await this.getSlice(e);const r=this.bigTiff?s.readUint64(e):s.readUint16(e),o=r*n+(this.bigTiff?16:6);s.covers(e,o)||(s=await this.getSlice(e,o));const a={};let l=e+(this.bigTiff?8:2);for(let u=0;u<r;l+=n,++u){const d=s.readUint16(l),f=s.readUint16(l+2),g=this.bigTiff?s.readUint64(l+4):s.readUint32(l+4);let m,p;const y=Gg(f),_=l+(this.bigTiff?12:8);if(y*g<=(this.bigTiff?8:4))m=Zr(s,f,g,_);else{const x=s.readOffset(_),E=Gg(f)*g;if(s.covers(x,E))m=Zr(s,f,g,x);else{const w=await this.getSlice(x,E);m=Zr(w,f,g,x)}}g===1&&F4.indexOf(d)===-1&&!(f===De.RATIONAL||f===De.SRATIONAL)?p=m[0]:p=m,a[el[d]]=p}const c=b6(a),h=s.readOffset(e+i+n*r);return new T6(a,c,h)}async requestIFD(e){if(this.ifdRequests[e])return this.ifdRequests[e];if(e===0)return this.ifdRequests[e]=this.parseFileDirectoryAt(this.firstIFDOffset),this.ifdRequests[e];if(!this.ifdRequests[e-1])try{this.ifdRequests[e-1]=this.requestIFD(e-1)}catch(n){throw n instanceof Ac?new Ac(e):n}return this.ifdRequests[e]=(async()=>{const n=await this.ifdRequests[e-1];if(n.nextIFDByteOffset===0)throw new Ac(e);return this.parseFileDirectoryAt(n.nextIFDByteOffset)})(),this.ifdRequests[e]}async getImage(e=0){const n=await this.requestIFD(e);return new e1(n.fileDirectory,n.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){let e=0,n=!0;for(;n;)try{await this.requestIFD(e),++e}catch(i){if(i instanceof Ac)n=!1;else throw i}return e}async getGhostValues(){const e=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;const n="GDAL_STRUCTURAL_METADATA_SIZE=",i=n.length+100;let s=await this.getSlice(e,i);if(n===Zr(s,De.ASCII,n.length,e)){const o=Zr(s,De.ASCII,i,e).split(`
`)[0],a=Number(o.split("=")[1].split(" ")[0])+o.length;a>i&&(s=await this.getSlice(e,a));const l=Zr(s,De.ASCII,a,e);this.ghostValues={},l.split(`
`).filter(c=>c.length>0).map(c=>c.split("=")).forEach(([c,h])=>{this.ghostValues[c]=h})}return this.ghostValues}static async fromSource(e,n,i){const s=(await e.fetch([{offset:0,length:1024}],i))[0],r=new Q4(s),o=r.getUint16(0,0);let a;if(o===18761)a=!0;else if(o===19789)a=!1;else throw new TypeError("Invalid byte order value.");const l=r.getUint16(2,a);let c;if(l===42)c=!1;else if(l===43){if(c=!0,r.getUint16(4,a)!==8)throw new Error("Unsupported offset byte-size.")}else throw new TypeError("Invalid magic number.");const h=c?r.getUint64(8,a):r.getUint32(4,a);return new Vo(e,a,c,h,n)}close(){return typeof this.source.close=="function"?this.source.close():!1}}class R6 extends n1{constructor(e,n){super(),this.mainFile=e,this.overviewFiles=n,this.imageFiles=[e].concat(n),this.fileDirectoriesPerFile=null,this.fileDirectoriesPerFileParsing=null,this.imageCount=null}async parseFileDirectoriesPerFile(){const e=[this.mainFile.parseFileDirectoryAt(this.mainFile.firstIFDOffset)].concat(this.overviewFiles.map(n=>n.parseFileDirectoryAt(n.firstIFDOffset)));return this.fileDirectoriesPerFile=await Promise.all(e),this.fileDirectoriesPerFile}async getImage(e=0){await this.getImageCount(),await this.parseFileDirectoriesPerFile();let n=0,i=0;for(let s=0;s<this.imageFiles.length;s++){const r=this.imageFiles[s];for(let o=0;o<this.imageCounts[s];o++){if(e===n){const a=await r.requestIFD(i);return new e1(a.fileDirectory,a.geoKeyDirectory,r.dataView,r.littleEndian,r.cache,r.source)}n++,i++}i=0}throw new RangeError("Invalid image index")}async getImageCount(){if(this.imageCount!==null)return this.imageCount;const e=[this.mainFile.getImageCount()].concat(this.overviewFiles.map(n=>n.getImageCount()));return this.imageCounts=await Promise.all(e),this.imageCount=this.imageCounts.reduce((n,i)=>n+i,0),this.imageCount}}async function v6(t,e={},n){return Vo.fromSource(Ug(t,e),n)}async function A6(t,e){return Vo.fromSource(C6(t),e)}async function I6(t,e=[],n={},i){const s=await Vo.fromSource(Ug(t,n),i),r=await Promise.all(e.map(o=>Vo.fromSource(Ug(o,n))));return new R6(s,r)}const P6=`
  attribute vec4 a_position;
  attribute vec4 a_texcoord;

  uniform mat4 u_matrix;
  uniform mat4 u_textureMatrix;

  varying vec2 v_texcoord;

  void main() {
    gl_Position = u_matrix * a_position;
    vec2 texcoord = (u_textureMatrix * a_texcoord).xy;
    v_texcoord = texcoord;
  }
`,M6=`
  precision mediump float;

  varying vec2 v_texcoord;

  uniform sampler2D u_texture;

  void main() {
    if (
      v_texcoord.x < 0.0 ||
      v_texcoord.y < 0.0 ||
      v_texcoord.x > 1.0 ||
      v_texcoord.y > 1.0
    ) {
      discard;
    }
    gl_FragColor = texture2D(u_texture, v_texcoord);
  }
`;class F6{constructor(e){this.gl_=e,this.program_=$g(e,M6,P6),this.positionLocation=e.getAttribLocation(this.program_,"a_position"),this.texcoordLocation=e.getAttribLocation(this.program_,"a_texcoord"),this.matrixLocation=e.getUniformLocation(this.program_,"u_matrix"),this.textureMatrixLocation=e.getUniformLocation(this.program_,"u_textureMatrix"),this.textureLocation=e.getUniformLocation(this.program_,"u_texture"),this.positionBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.positionBuffer),this.positions=[0,0,0,1,1,0,1,0,0,1,1,1],e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.positions),e.STATIC_DRAW),this.texcoordBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.texcoordBuffer),this.texcoords=[0,0,0,1,1,0,1,0,0,1,1,1],e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.texcoords),e.STATIC_DRAW)}drawImage(e,n,i,s,r,o,a,l,c,h,u,d,f){const g=this.gl_;l===void 0&&(l=s),c===void 0&&(c=r),o===void 0&&(o=n),a===void 0&&(a=i),h===void 0&&(h=o),u===void 0&&(u=a),d===void 0&&(d=g.canvas.width),f===void 0&&(f=g.canvas.height),g.bindTexture(g.TEXTURE_2D,e),g.useProgram(this.program_),g.bindBuffer(g.ARRAY_BUFFER,this.positionBuffer),g.enableVertexAttribArray(this.positionLocation),g.vertexAttribPointer(this.positionLocation,2,g.FLOAT,!1,0,0),g.bindBuffer(g.ARRAY_BUFFER,this.texcoordBuffer),g.enableVertexAttribArray(this.texcoordLocation),g.vertexAttribPointer(this.texcoordLocation,2,g.FLOAT,!1,0,0);let m=Dg(0,d,0,f,-1,1);m=CU(m,l,c,0),m=Ex(m,h,u,1),g.uniformMatrix4fv(this.matrixLocation,!1,m);let p=bU(s/n,r/i,0);p=Ex(p,o/n,a/i,1),g.uniformMatrix4fv(this.textureMatrixLocation,!1,p),g.uniform1i(this.textureLocation,0),g.drawArrays(g.TRIANGLES,0,this.positions.length/2)}}function Wx(t,e,n){const i=t.createShader(e);if(i===null)throw new Error("Shader compilation failed");if(t.shaderSource(i,n),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS)){const s=t.getShaderInfoLog(i);throw s===null?new Error("Shader info log creation failed"):new Error(s)}return i}function $g(t,e,n){const i=t.createProgram(),s=Wx(t,t.VERTEX_SHADER,n),r=Wx(t,t.FRAGMENT_SHADER,e);if(i===null)throw new Error("Program creation failed");if(t.attachShader(i,s),t.attachShader(i,r),t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS))throw t.getProgramInfoLog(i)===null?new Error("Program info log creation failed"):new Error;return i}const D6=`
  attribute vec4 a_position;

  uniform mat4 u_matrix;

  void main() {
     gl_Position = u_matrix * a_position;
  }
`,O6=`
  precision mediump float;

  uniform vec4 u_val;
  void main() {
     gl_FragColor = u_val;
  }
`,L6=`
  attribute vec4 a_position;
  attribute vec2 a_texcoord;

  varying vec2 v_texcoord;

  uniform mat4 u_matrix;

  void main() {
     gl_Position = u_matrix * a_position;
     v_texcoord = a_texcoord;
  }
`,k6=`
  precision mediump float;

  varying vec2 v_texcoord;

  uniform sampler2D u_texture;

  void main() {
    if (v_texcoord.x < 0.0 || v_texcoord.x > 1.0 || v_texcoord.y < 0.0 || v_texcoord.y > 1.0) {
      discard;
    }
    gl_FragColor = texture2D(u_texture, v_texcoord);
  }
`;function N6(t,e,n,i){let s;return n&&n.length?s=n.shift():hu?s=new OffscreenCanvas(t||300,e||300):s=document.createElement("canvas"),t&&(s.width=t),e&&(s.height=e),s.getContext("webgl",i)}function B6(t){const e=t.canvas;e.width=1,e.height=1,t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT)}const Kx=[];function U6(t,e,n,i,s,r,o,a,l,c,h,u,d,f){const g=Math.round(i*e),m=Math.round(i*n);t.canvas.width=g,t.canvas.height=m;let p,y;if(y=t.createTexture(),t.bindTexture(t.TEXTURE_2D,y),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),d?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,g,m,0,t.RGBA,h,null),p=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,p),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,y,0),p===null)throw new Error("Could not create framebuffer");if(y===null)throw new Error("Could not create texture");if(l.length===0)return{width:g,height:m,framebuffer:p,texture:y};const _=Yn();l.forEach(function(M,Y,j){pm(_,M.extent)});let x,E,w;const b=1/s;{if(x=t.createTexture(),y===null)throw new Error("Could not create texture");E=Math.round(Ve(_)*b),w=Math.round(jt(_)*b);const M=t.getParameter(t.MAX_TEXTURE_SIZE),Y=Math.max(E,w),j=Y>M?M/Y:1,K=Math.round(E*j),ee=Math.round(w*j);t.bindTexture(t.TEXTURE_2D,x),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),d?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,K,ee,0,t.RGBA,h,null);const te=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,te),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,x,0);const Q=new F6(t);l.forEach(function(V,z,re){const ue=(V.extent[0]-_[0])*b*j,ye=-(V.extent[3]-_[3])*b*j,N=Ve(V.extent)*b*j,be=jt(V.extent)*b*j;if(t.bindFramebuffer(t.FRAMEBUFFER,te),t.viewport(0,0,K,ee),V.clipExtent){const Z=(V.clipExtent[0]-_[0])*b*j,H=-(V.clipExtent[3]-_[3])*b*j,oe=Ve(V.clipExtent)*b*j,ge=jt(V.clipExtent)*b*j;t.enable(t.SCISSOR_TEST),t.scissor(d?Z:Math.round(Z),d?H:Math.round(H),d?oe:Math.round(Z+oe)-Math.round(Z),d?ge:Math.round(H+ge)-Math.round(H))}Q.drawImage(V.texture,V.width,V.height,c,c,V.width-2*c,V.height-2*c,d?ue:Math.round(ue),d?ye:Math.round(ye),d?N:Math.round(ue+N)-Math.round(ue),d?be:Math.round(ye+be)-Math.round(ye),K,ee),t.disable(t.SCISSOR_TEST)}),t.deleteFramebuffer(te)}const v=as(o),A=as(_),P=M=>{const Y=(M[0][0]-v[0])/r*i,j=-(M[0][1]-v[1])/r*i,K=(M[1][0]-v[0])/r*i,ee=-(M[1][1]-v[1])/r*i,te=(M[2][0]-v[0])/r*i,Q=-(M[2][1]-v[1])/r*i;return{u1:K,v1:ee,u0:Y,v0:j,u2:te,v2:Q}};t.bindFramebuffer(t.FRAMEBUFFER,p),t.viewport(0,0,g,m);{const M=[],Y=[],j=$g(t,k6,L6);t.useProgram(j);const K=t.getUniformLocation(j,"u_texture");t.bindTexture(t.TEXTURE_2D,x),t.uniform1i(K,0),a.getTriangles().forEach(function(ue,ye,N){const be=ue.source,Z=ue.target,{u1:H,v1:oe,u0:ge,v0:Ie,u2:je,v2:Xe}=P(Z),ui=(be[0][0]-A[0])/s/E,C=-(be[0][1]-A[1])/s/w,R=(be[1][0]-A[0])/s/E,O=-(be[1][1]-A[1])/s/w,G=(be[2][0]-A[0])/s/E,B=-(be[2][1]-A[1])/s/w;M.push(H,oe,ge,Ie,je,Xe),Y.push(R,O,ui,C,G,B)});const ee=Dg(0,g,m,0,-1,1),te=t.getUniformLocation(j,"u_matrix");t.uniformMatrix4fv(te,!1,ee);const Q=t.getAttribLocation(j,"a_position"),V=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,V),t.bufferData(t.ARRAY_BUFFER,new Float32Array(M),t.STATIC_DRAW),t.vertexAttribPointer(Q,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(Q);const z=t.getAttribLocation(j,"a_texcoord"),re=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,re),t.bufferData(t.ARRAY_BUFFER,new Float32Array(Y),t.STATIC_DRAW),t.vertexAttribPointer(z,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(z),t.drawArrays(t.TRIANGLES,0,M.length/2)}if(u){const M=$g(t,O6,D6);t.useProgram(M);const Y=Dg(0,g,m,0,-1,1),j=t.getUniformLocation(M,"u_matrix");t.uniformMatrix4fv(j,!1,Y);const K=Array.isArray(u)?u:[0,0,0,255],ee=t.getUniformLocation(M,"u_val");t.uniform4fv(ee,K);const te=t.getAttribLocation(M,"a_position"),Q=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,Q),t.vertexAttribPointer(te,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(te);const V=a.getTriangles().reduce(function(z,re){const ue=re.target,{u1:ye,v1:N,u0:be,v0:Z,u2:H,v2:oe}=P(ue);return z.concat([ye,N,be,Z,be,Z,H,oe,H,oe,ye,N])},[]);t.bufferData(t.ARRAY_BUFFER,new Float32Array(V),t.STATIC_DRAW),t.drawArrays(t.LINES,0,V.length/2)}return{width:g,height:m,framebuffer:p,texture:y}}class G6 extends vl{constructor(e){super({tileCoord:e.tileCoord,loader:()=>Promise.resolve(new Uint8ClampedArray(4)),interpolate:e.interpolate,transition:e.transition}),this.renderEdges_=e.renderEdges!==void 0?e.renderEdges:!1,this.pixelRatio_=e.pixelRatio,this.gutter_=e.gutter,this.reprojData_=null,this.reprojError_=null,this.reprojSize_=void 0,this.sourceTileGrid_=e.sourceTileGrid,this.targetTileGrid_=e.targetTileGrid,this.wrappedTileCoord_=e.wrappedTileCoord||e.tileCoord,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const n=e.sourceProj,i=n.getExtent(),s=e.sourceTileGrid.getExtent();this.clipExtent_=n.canWrapX()?s?Cn(i,s):i:s;const r=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),o=this.targetTileGrid_.getExtent();let a=this.sourceTileGrid_.getExtent();const l=o?Cn(r,o):r;if(gl(l)===0){this.state=se.EMPTY;return}i&&(a?a=Cn(a,i):a=i);const c=this.targetTileGrid_.getResolution(this.wrappedTileCoord_[0]),h=e.targetProj,u=cT(n,h,l,c);if(!isFinite(u)||u<=0){this.state=se.EMPTY;return}const d=e.errorThreshold!==void 0?e.errorThreshold:uT;if(this.triangulation_=new hT(n,h,l,a,u*d,c,e.transformMatrix),this.triangulation_.getTriangles().length===0){this.state=se.EMPTY;return}this.sourceZ_=this.sourceTileGrid_.getZForResolution(u);let f=this.triangulation_.calculateSourceExtent();if(a&&(n.canWrapX()?(f[1]=lt(f[1],a[1],a[3]),f[3]=lt(f[3],a[1],a[3])):f=Cn(f,a)),!gl(f))this.state=se.EMPTY;else{let g=0,m=0;n.canWrapX()&&(g=Ve(i),m=Math.floor((f[0]-i[0])/g)),ym(f.slice(),n,!0).forEach(y=>{const _=this.sourceTileGrid_.getTileRangeForExtentAndZ(y,this.sourceZ_),x=e.getTileFunction;for(let E=_.minX;E<=_.maxX;E++)for(let w=_.minY;w<=_.maxY;w++){const b=x(this.sourceZ_,E,w,this.pixelRatio_);if(b){const v=m*g;this.sourceTiles_.push({tile:b,offset:v})}}++m}),this.sourceTiles_.length===0&&(this.state=se.EMPTY)}}getSize(){return this.reprojSize_}getData(){return this.reprojData_}getError(){return this.reprojError_}reproject_(){const e=[];let n=!1;if(this.sourceTiles_.forEach(E=>{const w=E.tile;if(!w||w.getState()!==se.LOADED)return;const b=w.getSize(),v=this.gutter_;let A;const P=Fg(w.getData());P?A=P:(n=!0,A=hU($o(w.getData())));const M=[b[0]+2*v,b[1]+2*v],Y=A instanceof Float32Array,j=M[0]*M[1],K=Y?Float32Array:Uint8ClampedArray,ee=new K(A.buffer),te=K.BYTES_PER_ELEMENT,Q=te*ee.length/j,V=ee.byteLength/M[1],z=Math.floor(V/te/M[0]),re=this.sourceTileGrid_.getTileCoordExtent(w.tileCoord);re[0]+=E.offset,re[2]+=E.offset;const ue=this.clipExtent_?.slice();ue&&(ue[0]+=E.offset,ue[2]+=E.offset),e.push({extent:re,clipExtent:ue,data:ee,dataType:K,bytesPerPixel:Q,pixelSize:M,bandCount:z})}),this.sourceTiles_.length=0,e.length===0){this.state=se.ERROR,this.changed();return}const i=this.wrappedTileCoord_[0],s=this.targetTileGrid_.getTileSize(i),r=typeof s=="number"?s:s[0],o=typeof s=="number"?s:s[1],a=r*this.pixelRatio_,l=o*this.pixelRatio_,c=this.targetTileGrid_.getResolution(i),h=this.sourceTileGrid_.getResolution(this.sourceZ_),u=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),d=e[0].bandCount,f=new e[0].dataType(d*a*l),g=N6(a,l,Kx,{premultipliedAlpha:!1,antialias:!1});let m;const p=g.RGBA;let y;e[0].dataType==Float32Array?(y=g.FLOAT,g.getExtension("WEBGL_color_buffer_float"),g.getExtension("OES_texture_float"),g.getExtension("EXT_float_blend"),m=g.getExtension("OES_texture_float_linear")!==null&&this.interpolate):(y=g.UNSIGNED_BYTE,m=this.interpolate);const _=4,x=Math.ceil(d/_);for(let E=x-1;E>=0;--E){const w=[];for(let K=0,ee=e.length;K<ee;++K){const te=e[K],Q=te.pixelSize,V=Q[0],z=Q[1],re=new te.dataType(_*V*z),ue=te.data;let ye=E*_;for(let be=0,Z=re.length;be<Z;be+=_)re[be]=ue[ye],re[be+1]=ue[ye+1],re[be+2]=ue[ye+2],re[be+3]=ue[ye+3],ye+=d;const N=g.createTexture();g.bindTexture(g.TEXTURE_2D,N),m?(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.LINEAR),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.LINEAR)):(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.NEAREST),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.NEAREST)),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE),g.texImage2D(g.TEXTURE_2D,0,p,V,z,0,p,y,re),w.push({extent:te.extent,clipExtent:te.clipExtent,texture:N,width:V,height:z})}const{framebuffer:b,width:v,height:A}=U6(g,r,o,this.pixelRatio_,h,c,u,this.triangulation_,w,this.gutter_,y,this.renderEdges_,m),P=v,M=A*_,Y=new e[0].dataType(P*M);g.bindFramebuffer(g.FRAMEBUFFER,b),g.readPixels(0,0,v,A,g.RGBA,y,Y);let j=E*_;for(let K=0,ee=Y.length;K<ee;K+=_){const te=(P-1-(K/M|0))*M+K%M;f[j]=Y[te],f[j+1]=Y[te+1],f[j+2]=Y[te+2],f[j+3]=Y[te+3],j+=d}}if(B6(g),Kx.push(g.canvas),n){const E=Et(r,o),w=new ImageData(f,r);E.putImageData(w,0,0),this.reprojData_=E.canvas}else this.reprojData_=f;this.reprojSize_=[Math.round(a),Math.round(l)],this.state=se.LOADED,this.changed()}load(){if(this.state!==se.IDLE&&this.state!==se.ERROR)return;this.state=se.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:n})=>{const i=n.getState();if(i!==se.IDLE&&i!==se.LOADING)return;e++;const s=He(n,xe.CHANGE,()=>{const r=n.getState();(r==se.LOADED||r==se.ERROR||r==se.EMPTY)&&(at(s),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(s)}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:n}){n.getState()==se.IDLE&&n.load()})}unlistenSources_(){this.sourcesListenerKeys_.forEach(at),this.sourcesListenerKeys_=null}}class $6 extends kT{constructor(e){const n=e.projection===void 0?"EPSG:3857":e.projection;let i=e.tileGrid;i===void 0&&n&&(i=OT({extent:Lu(n),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize})),super({cacheSize:.1,attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:n,tileGrid:i,state:e.state,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.tileSize_=e.tileSize?Ct(e.tileSize):null,this.tileSizes_=null,this.tileLoadingKeys_={},this.loader_=e.loader,this.handleTileChange_=this.handleTileChange_.bind(this),this.bandCount=e.bandCount===void 0?4:e.bandCount,this.tileGridForProjection_={},this.crossOrigin_=e.crossOrigin||"anonymous",this.transformMatrix=null}setTileSizes(e){this.tileSizes_=e}getTileSize(e){if(this.tileSizes_)return this.tileSizes_[e];if(this.tileSize_)return this.tileSize_;const n=this.getTileGrid();return n?Ct(n.getTileSize(e)):[256,256]}getGutterForProjection(e){const n=this.getProjection();return(!n||Tr(n,e))&&!this.transformMatrix?this.gutter_:0}setLoader(e){this.loader_=e}getReprojTile_(e,n,i,s,r){const o=this.tileGrid||this.getTileGridForProjection(r||s),a=Math.max.apply(null,o.getResolutions().map((f,g)=>{const m=Ct(o.getTileSize(g)),p=this.getTileSize(g);return Math.max(p[0]/m[0],p[1]/m[1])})),l=this.getTileGridForProjection(s),c=[e,n,i],h=this.getTileCoordForTileUrlFunction(c,s),u=Object.assign({sourceProj:r||s,sourceTileGrid:o,targetProj:s,targetTileGrid:l,tileCoord:c,wrappedTileCoord:h,pixelRatio:a,gutter:this.gutter_,getTileFunction:(f,g,m,p)=>this.getTile(f,g,m,p),transformMatrix:this.transformMatrix},this.tileOptions),d=new G6(u);return d.key=this.getKey(),d}getTile(e,n,i,s,r){const o=this.getProjection();if(r&&(o&&!Tr(o,r)||this.transformMatrix))return this.getReprojTile_(e,n,i,r,o);const a=this.getTileSize(e),l=this.loader_,c=new AbortController,h={signal:c.signal,crossOrigin:this.crossOrigin_},u=this.getTileCoordForTileUrlFunction([e,n,i]);if(!u)return null;const d=u[0],f=u[1],g=u[2],m=this.getTileGrid()?.getFullTileRange(d);m&&(h.maxY=m.getHeight()-1);function p(){return cb(function(){return l(d,f,g,h)})}const y=Object.assign({tileCoord:[e,n,i],loader:p,size:a,controller:c},this.tileOptions),_=new vl(y);return _.key=this.getKey(),_.addEventListener(xe.CHANGE,this.handleTileChange_),_}handleTileChange_(e){const n=e.target,i=me(n),s=n.getState();let r;s==se.LOADING?(this.tileLoadingKeys_[i]=!0,r=To.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],r=s==se.ERROR?To.TILELOADERROR:s==se.LOADED?To.TILELOADEND:void 0),r&&this.dispatchEvent(new NT(r,n))}getTileGridForProjection(e){const n=this.getProjection();if(this.tileGrid&&(!n||Tr(n,e))&&!this.transformMatrix)return this.tileGrid;const i=me(e);return i in this.tileGridForProjection_||(this.tileGridForProjection_[i]=u_(e)),this.tileGridForProjection_[i]}setTileGridForProjection(e,n){const i=ft(e);if(i){const s=me(i);s in this.tileGridForProjection_||(this.tileGridForProjection_[s]=n)}}}function j6(t){return((t.fileDirectory.NewSubfileType||0)&4)===4}function z6(t,e){if(!t)return!1;if(t===!0)return!0;if(e.getSamplesPerPixel()!==3)return!1;const n=e.fileDirectory.PhotometricInterpretation,i=In;return n===i.CMYK||n===i.YCbCr||n===i.CIELab||n===i.ICCLab}const Yx="STATISTICS_MAXIMUM",qx="STATISTICS_MINIMUM",Rf=256;let vf;function H6(){return vf||(vf=new n6),vf}function X6(t){try{return t.getBoundingBox(!0)}catch{return[0,0,t.getWidth(),t.getHeight()]}}function V6(t){try{return t.getOrigin().slice(0,2)}catch{return[0,t.getHeight()]}}function W6(t,e){try{return t.getResolution(e)}catch{return[e.getWidth()/t.getWidth(),e.getHeight()/t.getHeight()]}}function K6(t){const e=t.geoKeys;if(!e)return null;if(e.ProjectedCSTypeGeoKey&&e.ProjectedCSTypeGeoKey!==32767){const n="EPSG:"+e.ProjectedCSTypeGeoKey;let i=ft(n);if(!i){const s=ME(e.ProjLinearUnitsGeoKey);s&&(i=new pl({code:n,units:s}))}return i}if(e.GeographicTypeGeoKey&&e.GeographicTypeGeoKey!==32767){const n="EPSG:"+e.GeographicTypeGeoKey;let i=ft(n);if(!i){const s=ME(e.GeogAngularUnitsGeoKey);s&&(i=new pl({code:n,units:s}))}return i}return null}function Y6(t){return t.getImageCount().then(function(e){const n=new Array(e);for(let i=0;i<e;++i)n[i]=t.getImage(i);return Promise.all(n)})}function q6(t,e){let n;return t.blob?n=A6(t.blob):t.overviews?n=I6(t.url,t.overviews,e):n=v6(t.url,e),n.then(Y6)}function Da(t,e,n,i,s){if(Array.isArray(t)){const r=t.length;if(!Array.isArray(e)||r!=e.length){const o=new Error(i);throw s(o),o}for(let o=0;o<r;++o)Da(t[o],e[o],n,i,s);return}if(e=e,Math.abs(t-e)>n*t)throw new Error(i)}function Z6(t){return t instanceof Int8Array?-128:t instanceof Int16Array?-32768:t instanceof Int32Array?-2147483648:t instanceof Float32Array?12e-39:0}function J6(t){return t instanceof Int8Array?127:t instanceof Uint8Array||t instanceof Uint8ClampedArray?255:t instanceof Int16Array?32767:t instanceof Uint16Array?65535:t instanceof Int32Array?2147483647:t instanceof Uint32Array?4294967295:t instanceof Float32Array?34e37:255}class Q6 extends $6{constructor(e){super({state:"loading",tileGrid:null,projection:e.projection||null,transition:e.transition,interpolate:e.interpolate!==!1,wrapX:e.wrapX}),this.sourceInfo_=e.sources;const n=this.sourceInfo_.length;this.sourceOptions_=e.sourceOptions,this.sourceImagery_=new Array(n),this.sourceMasks_=new Array(n),this.resolutionFactors_=new Array(n),this.samplesPerPixel_,this.nodataValues_,this.metadata_,this.normalize_=e.normalize!==!1,this.addAlpha_=!1,this.error_=null,this.convertToRGB_=e.convertToRGB||!1,this.setKey(this.sourceInfo_.map(r=>r.url).join(","));const i=this,s=new Array(n);for(let r=0;r<n;++r)s[r]=q6(this.sourceInfo_[r],this.sourceOptions_);Promise.all(s).then(function(r){i.configure_(r)}).catch(function(r){PE(r),i.error_=r,i.setState("error")})}getError(){return this.error_}determineProjection(e){const n=e[0];for(let i=n.length-1;i>=0;--i){const s=n[i],r=K6(s);if(r){this.projection=r;break}}}determineTransformMatrix(e){const n=e[0];for(let i=n.length-1;i>=0;--i){const r=n[i].fileDirectory.ModelTransformation;if(r){const[o,a,l,c,h,u,d,f]=r,g=yl(yl([1/Math.sqrt(o*o+h*h),0,0,-1/Math.sqrt(a*a+u*u),c,f],[o,h,a,u,0,0]),[1,0,0,1,-c,-f]);this.transformMatrix=g,this.addAlpha_=!0;break}}}configure_(e){let n,i,s,r,o;const a=new Array(e.length),l=new Array(e.length),c=new Array(e.length);let h=0;const u=e.length;for(let p=0;p<u;++p){const y=[],_=[];e[p].forEach(P=>{j6(P)?_.push(P):y.push(P)});const x=y.length;if(_.length>0&&_.length!==x)throw new Error(`Expected one mask per image found ${_.length} masks and ${x} images`);let E,w;const b=new Array(x),v=new Array(x),A=new Array(x);l[p]=new Array(x),c[p]=new Array(x);for(let P=0;P<x;++P){const M=y[P],Y=M.getGDALNoData();c[p][P]=M.getGDALMetadata(0),l[p][P]=Y;const j=this.sourceInfo_[p].bands;a[p]=j?j.length:M.getSamplesPerPixel();const K=x-(P+1);E||(E=X6(M)),w||(w=V6(M));const ee=W6(M,y[0]);A[K]=ee[0];const te=[M.getTileWidth(),M.getTileHeight()];te[0]!==te[1]&&te[1]<Rf&&(te[0]=Rf,te[1]=Rf),b[K]=te;const Q=ee[0]/Math.abs(ee[1]);v[K]=[te[0],te[1]/Q]}if(n?Cn(n,E,n):n=E,!i)i=w;else{const P=`Origin mismatch for source ${p}, got [${w}] but expected [${i}]`;Da(i,w,0,P,this.viewRejector)}if(!o)o=A,this.resolutionFactors_[p]=1;else{o.length-h>A.length&&(h=o.length-A.length);const P=o[o.length-1]/A[A.length-1];this.resolutionFactors_[p]=P;const M=A.map(j=>j*=P),Y=`Resolution mismatch for source ${p}, got [${M}] but expected [${o}]`;Da(o.slice(h,o.length),M,.02,Y,this.viewRejector)}s?Da(s.slice(h,s.length),v,.01,`Tile size mismatch for source ${p}`,this.viewRejector):s=v,r?Da(r.slice(h,r.length),b,0,`Tile size mismatch for source ${p}`,this.viewRejector):r=b,this.sourceImagery_[p]=y.reverse(),this.sourceMasks_[p]=_.reverse()}for(let p=0,y=this.sourceImagery_.length;p<y;++p){const _=this.sourceImagery_[p];for(;_.length<o.length;)_.unshift(void 0)}this.getProjection()||this.determineProjection(e),this.determineTransformMatrix(e),this.samplesPerPixel_=a,this.nodataValues_=l,this.metadata_=c;e:for(let p=0;p<u;++p){if(this.sourceInfo_[p].nodata!==void 0){this.addAlpha_=!0;break}if(this.sourceMasks_[p].length){this.addAlpha_=!0;break}const y=l[p],_=this.sourceInfo_[p].bands;if(_){for(let x=0;x<_.length;++x)if(y[_[x]-1]!==null){this.addAlpha_=!0;break e}continue}for(let x=0;x<y.length;++x)if(y[x]!==null){this.addAlpha_=!0;break e}}let d=this.addAlpha_?1:0;for(let p=0;p<u;++p)d+=a[p];this.bandCount=d;const f=new h_({extent:n,minZoom:h,origin:i,resolutions:o,tileSizes:s});this.tileGrid=f,this.setTileSizes(r),this.setLoader(this.loadTile_.bind(this)),this.setState("ready");const g=1;o.length===2?o=[o[0],o[1],o[1]/2]:o.length===1&&(o=[o[0]*2,o[0],o[0]/2]);let m=n;if(this.transformMatrix){const p=Rm(hn(),this.transformMatrix.slice()),y=Rb(_=>vt(p,_));m=sN(n,y)}this.viewResolver({showFullExtent:!0,projection:this.projection,resolutions:o,center:Xs(Ui(m),this.projection),extent:yu(m,this.projection),zoom:g})}loadTile_(e,n,i,s){const r=this.getTileSize(e),o=this.sourceImagery_.length,a=new Array(o*2),l=this.nodataValues_,c=this.sourceInfo_,h=H6();for(let u=0;u<o;++u){const d=c[u],f=this.resolutionFactors_[u],g=[Math.round(n*(r[0]*f)),Math.round(i*(r[1]*f)),Math.round((n+1)*(r[0]*f)),Math.round((i+1)*(r[1]*f))],m=this.sourceImagery_[u][e];let p;d.bands&&(p=d.bands.map(function(w){return w-1}));let y;"nodata"in d&&d.nodata!==null?y=d.nodata:p?y=p.map(function(w){return l[u][w]}):y=l[u];const _={window:g,width:r[0],height:r[1],samples:p,fillValue:y,pool:h,interleave:!1,signal:s.signal};z6(this.convertToRGB_,m)?a[u]=m.readRGB(_):a[u]=m.readRasters(_);const x=o+u,E=this.sourceMasks_[u][e];if(!E){a[x]=Promise.resolve(null);continue}a[x]=E.readRasters({window:g,width:r[0],height:r[1],samples:[0],pool:h,interleave:!1})}return Promise.all(a).then(this.composeTile_.bind(this,r)).catch(function(u){throw PE(u),u})}composeTile_(e,n){const i=this.metadata_,s=this.sourceInfo_,r=this.sourceImagery_.length,o=this.bandCount,a=this.samplesPerPixel_,l=this.nodataValues_,c=this.normalize_,h=this.addAlpha_,u=e[0]*e[1],d=u*o;let f;c?f=new Uint8Array(d):f=new Float32Array(d);let g=0;for(let m=0;m<u;++m){let p=h;for(let y=0;y<r;++y){const _=s[y];let x=_.min,E=_.max,w,b;if(c){const v=i[y][0];x===void 0&&(v&&qx in v?x=parseFloat(v[qx]):x=Z6(n[y][0])),E===void 0&&(v&&Yx in v?E=parseFloat(v[Yx]):E=J6(n[y][0])),w=255/(E-x),b=-x*w}for(let v=0;v<a[y];++v){const A=n[y][v][m];let P;if(c?P=lt(w*A+b,0,255):P=A,!h)f[g]=P;else{let M=_.nodata;if(M===void 0){let j;_.bands?j=_.bands[v]-1:j=v,M=l[y][j]}const Y=isNaN(M);(!Y&&A!==M||Y&&!isNaN(A))&&(p=!1,f[g]=P)}g++}if(!p){const v=r+y,A=n[v];A&&!A[0][m]&&(p=!0)}}h&&(p||(f[g]=255),g++)}return f}}const Af="units",e5=[1,2,5],Ca=25.4/.28;class t5 extends bu{constructor(e){e=e||{};const n=document.createElement("div");n.style.pointerEvents="none",super({element:n,render:e.render,target:e.target}),this.on,this.once,this.un;const i=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=i+"-inner",this.element.className=i+" "+Xl,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(Af,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(Af)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(Af,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const n=e.center,i=e.projection,s=this.getUnits(),r=s=="degrees"?"degrees":"m";let o=Th(i,e.resolution,n,r);const a=this.minWidth_*(this.dpi_||Ca)/Ca,l=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||Ca)/Ca:void 0;let c=a*o,h="";if(s=="degrees"){const x=No.degrees;c*=x,c<x/60?(h="″",o*=3600):c<x?(h="′",o*=60):h="°"}else if(s=="imperial")c<.9144?(h="in",o/=.0254):c<1609.344?(h="ft",o/=.3048):(h="mi",o/=1609.344);else if(s=="nautical")o/=1852,h="NM";else if(s=="metric")c<1e-6?(h="nm",o*=1e9):c<.001?(h="μm",o*=1e6):c<1?(h="mm",o*=1e3):c<1e3?h="m":(h="km",o/=1e3);else if(s=="us")c<.9144?(h="in",o*=39.37):c<1609.344?(h="ft",o/=.30480061):(h="mi",o/=1609.3472);else throw new Error("Invalid units");let u=3*Math.floor(Math.log(a*o)/Math.log(10)),d,f,g,m=0,p,y;for(;;){g=Math.floor(u/3);const x=Math.pow(10,g);if(d=e5[(u%3+3)%3]*x,f=Math.round(d/o),isNaN(f)){this.element.style.display="none",this.renderedVisible_=!1;return}if(l!==void 0&&f>=l){d=m,f=p,g=y;break}else if(f>=a)break;m=d,p=f,y=g,++u}const _=this.scaleBar_?this.createScaleBar(f,d,h):d.toFixed(g<0?-g:0)+" "+h;this.renderedHTML_!=_&&(this.innerElement_.innerHTML=_,this.renderedHTML_=_),this.renderedWidth_!=f&&(this.innerElement_.style.width=f+"px",this.renderedWidth_=f),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,n,i){const s=this.getScaleForResolution(),r=s<1?Math.round(1/s).toLocaleString()+" : 1":"1 : "+Math.round(s).toLocaleString(),o=this.scaleBarSteps_,a=e/o,l=[this.createMarker("absolute")];for(let h=0;h<o;++h){const u=h%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";l.push(`<div><div class="ol-scale-singlebar ${u}" style="width: ${a}px;"></div>`+this.createMarker("relative")+(h%2===0||o===2?this.createStepText(h,e,!1,n,i):"")+"</div>")}return l.push(this.createStepText(o,e,!0,n,i)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+r+"</div>":"")+l.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,n,i,s,r){const a=(e===0?0:Math.round(s/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+r),l=e===0?-3:n/this.scaleBarSteps_*-1,c=e===0?0:n/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${l}px;text-align: ${e===0?"left":"center"};min-width: ${c}px;left: ${i?n+"px":"unset"};">`+a+"</div>"}getScaleForResolution(){const e=Th(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),n=this.dpi_||Ca,i=1e3/25.4;return e*i*n}render(e){const n=e.frameState;n?this.viewState_=n.viewState:this.viewState_=null,this.updateElement_()}}const Ic={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"};class Pc extends hi{constructor(e,n){super(e),this.feature=n}}function n5(t,e){const n=[];for(let i=0;i<e.length;++i){const r=e[i].getGeometry();i1(t,r,n)}return n}function Mc(t,e){return ns(t[0],t[1],e[0],e[1])}function uo(t,e){const n=t.length;return e<0?t[e+n]:e>=n?t[e-n]:t[e]}function Fc(t,e,n){let i,s;e<n?(i=e,s=n):(i=n,s=e);const r=Math.ceil(i),o=Math.floor(s);if(r>o){const l=fo(t,i),c=fo(t,s);return Mc(l,c)}let a=0;if(i<r){const l=fo(t,i),c=uo(t,r);a+=Mc(l,c)}if(o<s){const l=uo(t,o),c=fo(t,s);a+=Mc(l,c)}for(let l=r;l<o-1;++l){const c=uo(t,l),h=uo(t,l+1);a+=Mc(c,h)}return a}function i1(t,e,n){if(e instanceof ki){Dc(t,e.getCoordinates(),!1,n);return}if(e instanceof zo){const i=e.getCoordinates();for(let s=0,r=i.length;s<r;++s)Dc(t,i[s],!1,n);return}if(e instanceof Gi){const i=e.getCoordinates();for(let s=0,r=i.length;s<r;++s)Dc(t,i[s],!0,n);return}if(e instanceof Ho){const i=e.getCoordinates();for(let s=0,r=i.length;s<r;++s){const o=i[s];for(let a=0,l=o.length;a<l;++a)Dc(t,o[a],!0,n)}return}if(e instanceof Pl){const i=e.getGeometries();for(let s=0;s<i.length;++s)i1(t,i[s],n);return}}const If={index:-1,endIndex:NaN};function i5(t,e,n,i){const s=t[0],r=t[1];let o=1/0,a=-1,l=NaN;for(let u=0;u<e.targets.length;++u){const d=e.targets[u],f=d.coordinates;let g=1/0,m;for(let p=0;p<f.length-1;++p){const y=f[p],_=f[p+1],x=s1(s,r,y,_);x.squaredDistance<g&&(g=x.squaredDistance,m=p+x.along)}g<o&&(o=g,d.ring&&e.targetIndex===u&&(d.endIndex>d.startIndex?m<d.startIndex&&(m+=f.length):d.endIndex<d.startIndex&&m>d.startIndex&&(m-=f.length)),l=m,a=u)}const c=e.targets[a];let h=c.ring;if(e.targetIndex===a&&h){const u=fo(c.coordinates,l),d=n.getPixelFromCoordinate(u);Sh(d,e.startPx)>i&&(h=!1)}if(h){const u=c.coordinates,d=u.length,f=c.startIndex,g=l;if(f<g){const m=Fc(u,f,g);Fc(u,f,g-d)<m&&(l-=d)}else{const m=Fc(u,f,g);Fc(u,f,g+d)<m&&(l+=d)}}return If.index=a,If.endIndex=l,If}function Dc(t,e,n,i){const s=t[0],r=t[1];for(let o=0,a=e.length-1;o<a;++o){const l=e[o],c=e[o+1],h=s1(s,r,l,c);if(h.squaredDistance===0){const u=o+h.along;i.push({coordinates:e,ring:n,startIndex:u,endIndex:u});return}}}const Pf={along:0,squaredDistance:0};function s1(t,e,n,i){const s=n[0],r=n[1],o=i[0],a=i[1],l=o-s,c=a-r;let h=0,u=s,d=r;return(l!==0||c!==0)&&(h=lt(((t-s)*l+(e-r)*c)/(l*l+c*c),0,1),u+=l*h,d+=c*h),Pf.along=h,Pf.squaredDistance=jl(ns(t,e,u,d),10),Pf}function fo(t,e){const n=t.length;let i=Math.floor(e);const s=e-i;i>=n?i-=n:i<0&&(i+=n);let r=i+1;r>=n&&(r-=n);const o=t[i],a=o[0],l=o[1],c=t[r],h=c[0]-a,u=c[1]-l;return[a+h*s,l+u*s]}class s5 extends Lr{constructor(e){const n=e;n.stopDown||(n.stopDown=Zo),super(n),this.on,this.once,this.un,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=e.source?e.source:null,this.features_=e.features?e.features:null,this.snapTolerance_=e.snapTolerance?e.snapTolerance:12,this.type_=e.type,this.mode_=o5(this.type_),this.stopClick_=!!e.stopClick,this.minPoints_=e.minPoints?e.minPoints:this.mode_==="Polygon"?3:2,this.maxPoints_=this.mode_==="Circle"?2:e.maxPoints?e.maxPoints:1/0,this.finishCondition_=e.finishCondition?e.finishCondition:zs,this.geometryLayout_=e.geometryLayout?e.geometryLayout:"XY";let i=e.geometryFunction;if(!i){const s=this.mode_;if(s==="Circle")i=(r,o,a)=>{const l=o||new Ou([NaN,NaN]),c=mt(r[0]),h=ko(c,mt(r[r.length-1]));return l.setCenterAndRadius(c,Math.sqrt(h),this.geometryLayout_),l};else{let r;s==="Point"?r=ci:s==="LineString"?r=ki:s==="Polygon"&&(r=Gi),i=(o,a,l)=>(a?s==="Polygon"?o[0].length?a.setCoordinates([o[0].concat([o[0][0]])],this.geometryLayout_):a.setCoordinates([],this.geometryLayout_):a.setCoordinates(o,this.geometryLayout_):a=new r(o,this.geometryLayout_),a)}}this.geometryFunction_=i,this.dragVertexDelay_=e.dragVertexDelay!==void 0?e.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,this.overlay_=new Il({source:new kh({useSpatialIndex:!1,wrapX:e.wrapX?e.wrapX:!1}),style:e.style?e.style:r5(),updateWhileInteracting:!0}),this.geometryName_=e.geometryName,this.condition_=e.condition?e.condition:zm,this.freehandCondition_,e.freehand?this.freehandCondition_=Ih:this.freehandCondition_=e.freehandCondition?e.freehandCondition:Hm,this.traceCondition_,this.setTrace(e.trace||!1),this.traceState_={active:!1},this.traceSource_=e.traceSource||e.source||null,this.addChangeListener(Rg.ACTIVE,this.updateState_)}setTrace(e){let n;e?e===!0?n=Ih:n=e:n=Ag,this.traceCondition_=n}setMap(e){super.setMap(e),this.updateState_()}getOverlay(){return this.overlay_}handleEvent(e){e.originalEvent.type===xe.CONTEXTMENU&&e.originalEvent.preventDefault(),this.freehand_=this.mode_!=="Point"&&this.freehandCondition_(e);let n=e.type===Ge.POINTERMOVE,i=!0;return!this.freehand_&&this.lastDragTime_&&e.type===Ge.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,n=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_!==void 0&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&e.type===Ge.POINTERDRAG&&this.sketchFeature_!==null?(this.addToDrawing_(e.coordinate),i=!1):this.freehand_&&e.type===Ge.POINTERDOWN?i=!1:n&&this.getPointerCount()<2?(i=e.type===Ge.POINTERMOVE,i&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):(e.originalEvent.pointerType==="mouse"||e.type===Ge.POINTERDRAG&&this.downTimeout_===void 0)&&this.handlePointerMove_(e)):e.type===Ge.DBLCLICK&&(i=!1),super.handleEvent(e)&&i}handleDownEvent(e){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e.coordinate),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new qi(Ge.POINTERMOVE,e.map,e.originalEvent,!1,e.frameState))},this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(e){if(!this.traceSource_||!this.traceCondition_(e))return;if(this.traceState_.active){this.deactivateTrace_();return}const n=this.getMap(),i=n.getCoordinateFromPixel([e.pixel[0]-this.snapTolerance_,e.pixel[1]+this.snapTolerance_]),s=n.getCoordinateFromPixel([e.pixel[0]+this.snapTolerance_,e.pixel[1]-this.snapTolerance_]),r=mn([i,s]),o=this.traceSource_.getFeaturesInExtent(r);if(o.length===0)return;const a=n5(e.coordinate,o);a.length&&(this.traceState_={active:!0,startPx:e.pixel.slice(),targets:a,targetIndex:-1})}addOrRemoveTracedCoordinates_(e,n){const i=e.startIndex<=e.endIndex,s=e.startIndex<=n;i===s?i&&n>e.endIndex||!i&&n<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,n):(i&&n<e.endIndex||!i&&n>e.endIndex)&&this.removeTracedCoordinates_(n,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,n))}removeTracedCoordinates_(e,n){if(e===n)return;let i=0;if(e<n){const s=Math.ceil(e);let r=Math.floor(n);r===n&&(r-=1),i=r-s+1}else{const s=Math.floor(e);let r=Math.ceil(n);r===n&&(r+=1),i=s-r+1}i>0&&this.removeLastPoints_(i)}addTracedCoordinates_(e,n,i){if(n===i)return;const s=[];if(n<i){const r=Math.ceil(n);let o=Math.floor(i);o===i&&(o-=1);for(let a=r;a<=o;++a)s.push(uo(e.coordinates,a))}else{const r=Math.floor(n);let o=Math.ceil(i);o===i&&(o+=1);for(let a=r;a>=o;--a)s.push(uo(e.coordinates,a))}s.length&&this.appendCoordinates(s)}updateTrace_(e){const n=this.traceState_;if(!n.active||n.targetIndex===-1&&Sh(n.startPx,e.pixel)<this.snapTolerance_)return;const i=i5(e.coordinate,n,this.getMap(),this.snapTolerance_);if(n.targetIndex!==i.index){if(n.targetIndex!==-1){const l=n.targets[n.targetIndex];this.removeTracedCoordinates_(l.startIndex,l.endIndex)}const a=n.targets[i.index];this.addTracedCoordinates_(a,a.startIndex,i.endIndex)}else{const a=n.targets[n.targetIndex];this.addOrRemoveTracedCoordinates_(a,i.endIndex)}n.targetIndex=i.index;const s=n.targets[n.targetIndex];s.endIndex=i.endIndex;const r=fo(s.coordinates,s.endIndex),o=this.getMap().getPixelFromCoordinate(r);e.coordinate=r,e.pixel=[Math.round(o[0]),Math.round(o[1])]}handleUpEvent(e){let n=!0;if(this.getPointerCount()===0){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e);const i=this.traceState_.active;if(this.toggleTraceState_(e),this.shouldHandle_){const s=!this.finishCoordinate_;s&&this.startDrawing_(e.coordinate),!s&&this.freehand_?this.finishDrawing():!this.freehand_&&(!s||this.mode_==="Point")&&(this.atFinish_(e.pixel,i)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e.coordinate)),n=!1}else this.freehand_&&this.abortDrawing()}return!n&&this.stopClick_&&e.preventDefault(),n}handlePointerMove_(e){if(this.pointerType_=e.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const n=this.downPx_,i=e.pixel,s=n[0]-i[0],r=n[1]-i[1],o=s*s+r*r;if(this.shouldHandle_=this.freehand_?o>this.squaredClickTolerance_:o<=this.squaredClickTolerance_,!this.shouldHandle_)return}if(!this.finishCoordinate_){this.createOrUpdateSketchPoint_(e.coordinate.slice());return}this.updateTrace_(e),this.modifyDrawing_(e.coordinate)}atFinish_(e,n){let i=!1;if(this.sketchFeature_){let s=!1,r=[this.finishCoordinate_];const o=this.mode_;if(o==="Point")i=!0;else if(o==="Circle")i=this.sketchCoords_.length===2;else if(o==="LineString")s=!n&&this.sketchCoords_.length>this.minPoints_;else if(o==="Polygon"){const a=this.sketchCoords_;s=a[0].length>this.minPoints_,r=[a[0][0],a[0][a[0].length-2]],n?r=[a[0][0]]:r=[a[0][0],a[0][a[0].length-2]]}if(s){const a=this.getMap();for(let l=0,c=r.length;l<c;l++){const h=r[l],u=a.getPixelFromCoordinate(h),d=e[0]-u[0],f=e[1]-u[1],g=this.freehand_?1:this.snapTolerance_;if(i=Math.sqrt(d*d+f*f)<=g,i){this.finishCoordinate_=h;break}}}}return i}createOrUpdateSketchPoint_(e){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new Ln(new ci(e)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(e){this.sketchLine_||(this.sketchLine_=new Ln);const n=e.getLinearRing(0);let i=this.sketchLine_.getGeometry();i?(i.setFlatCoordinates(n.getLayout(),n.getFlatCoordinates()),i.changed()):(i=new ki(n.getFlatCoordinates(),n.getLayout()),this.sketchLine_.setGeometry(i))}startDrawing_(e){const n=this.getMap().getView().getProjection(),i=Rh(this.geometryLayout_);for(;e.length<i;)e.push(0);this.finishCoordinate_=e,this.mode_==="Point"?this.sketchCoords_=e.slice():this.mode_==="Polygon"?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new Ln(new ki(this.sketchLineCoords_)));const s=this.geometryFunction_(this.sketchCoords_,void 0,n);this.sketchFeature_=new Ln,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(s),this.updateSketchFeatures_(),this.dispatchEvent(new Pc(Ic.DRAWSTART,this.sketchFeature_))}modifyDrawing_(e){const n=this.getMap(),i=this.sketchFeature_.getGeometry(),s=n.getView().getProjection(),r=Rh(this.geometryLayout_);let o,a;for(;e.length<r;)e.push(0);this.mode_==="Point"?a=this.sketchCoords_:this.mode_==="Polygon"?(o=this.sketchCoords_[0],a=o[o.length-1],this.atFinish_(n.getPixelFromCoordinate(e))&&(e=this.finishCoordinate_.slice())):(o=this.sketchCoords_,a=o[o.length-1]),a[0]=e[0],a[1]=e[1],this.geometryFunction_(this.sketchCoords_,i,s),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(e),i.getType()==="Polygon"&&this.mode_!=="Polygon"?this.createOrUpdateCustomSketchLine_(i):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(e){const n=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection();let s,r;const o=this.mode_;return o==="LineString"||o==="Circle"?(this.finishCoordinate_=e.slice(),r=this.sketchCoords_,r.length>=this.maxPoints_&&(this.freehand_?r.pop():s=!0),r.push(e.slice()),this.geometryFunction_(r,n,i)):o==="Polygon"&&(r=this.sketchCoords_[0],r.length>=this.maxPoints_&&(this.freehand_?r.pop():s=!0),r.push(e.slice()),s&&(this.finishCoordinate_=r[0]),this.geometryFunction_(this.sketchCoords_,n,i)),this.createOrUpdateSketchPoint_(e.slice()),this.updateSketchFeatures_(),s?this.finishDrawing():this.sketchFeature_}removeLastPoints_(e){if(!this.sketchFeature_)return;const n=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection(),s=this.mode_;for(let r=0;r<e;++r){let o;if(s==="LineString"||s==="Circle"){if(o=this.sketchCoords_,o.splice(-2,1),o.length>=2){this.finishCoordinate_=o[o.length-2].slice();const a=this.finishCoordinate_.slice();o[o.length-1]=a,this.createOrUpdateSketchPoint_(a)}this.geometryFunction_(o,n,i),n.getType()==="Polygon"&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(n)}else if(s==="Polygon"){o=this.sketchCoords_[0],o.splice(-2,1);const a=this.sketchLine_.getGeometry();if(o.length>=2){const l=o[o.length-2].slice();o[o.length-1]=l,this.createOrUpdateSketchPoint_(l)}a.setCoordinates(o),this.geometryFunction_(this.sketchCoords_,n,i)}if(o.length===1){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const e=this.abortDrawing_();if(!e)return null;let n=this.sketchCoords_;const i=e.getGeometry(),s=this.getMap().getView().getProjection();return this.mode_==="LineString"?(n.pop(),this.geometryFunction_(n,i,s)):this.mode_==="Polygon"&&(n[0].pop(),this.geometryFunction_(n,i,s),n=i.getCoordinates()),this.type_==="MultiPoint"?e.setGeometry(new Kl([n])):this.type_==="MultiLineString"?e.setGeometry(new zo([n])):this.type_==="MultiPolygon"&&e.setGeometry(new Ho([n])),this.dispatchEvent(new Pc(Ic.DRAWEND,e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e),e}abortDrawing_(){this.finishCoordinate_=null;const e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),e}abortDrawing(){const e=this.abortDrawing_();e&&this.dispatchEvent(new Pc(Ic.DRAWABORT,e))}appendCoordinates(e){const n=this.mode_,i=!this.sketchFeature_;i&&this.startDrawing_(e[0]);let s;if(n==="LineString"||n==="Circle")s=this.sketchCoords_;else if(n==="Polygon")s=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[];else return;i&&s.shift(),s.pop();for(let o=0;o<e.length;o++)this.addToDrawing_(e[o]);const r=e[e.length-1];this.sketchFeature_=this.addToDrawing_(r),this.modifyDrawing_(r)}extend(e){const i=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=i.getCoordinates();const s=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=s.slice(),this.sketchCoords_.push(s.slice()),this.sketchPoint_=new Ln(new ci(s)),this.updateSketchFeatures_(),this.dispatchEvent(new Pc(Ic.DRAWSTART,this.sketchFeature_))}updateSketchFeatures_(){const e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);const n=this.overlay_.getSource();n.clear(!0),n.addFeatures(e)}updateState_(){const e=this.getMap(),n=this.getActive();(!e||!n)&&this.abortDrawing(),this.overlay_.setMap(n?e:null)}}function r5(){const t=Qm();return function(e,n){return t[e.getGeometry().getType()]}}function o5(t){switch(t){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+t)}}const Zx=0,tl=1,Jx=[0,0,0,0],vo=[],Mf={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"};class Ff extends hi{constructor(e,n,i){super(e),this.features=n,this.mapBrowserEvent=i}}class a5 extends Lr{constructor(e){super(e),this.on,this.once,this.un,this.boundHandleFeatureChange_=this.handleFeatureChange_.bind(this),this.condition_=e.condition?e.condition:zb,this.defaultDeleteCondition_=function(i){return v3(i)&&$b(i)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:Ih,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.featuresBeingModified_=null,this.rBush_=new kg,this.pixelTolerance_=e.pixelTolerance!==void 0?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new Il({source:new kh({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:c5(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_.bind(this),LineString:this.writeLineStringGeometry_.bind(this),LinearRing:this.writeLineStringGeometry_.bind(this),Polygon:this.writePolygonGeometry_.bind(this),MultiPoint:this.writeMultiPointGeometry_.bind(this),MultiLineString:this.writeMultiLineStringGeometry_.bind(this),MultiPolygon:this.writeMultiPolygonGeometry_.bind(this),Circle:this.writeCircleGeometry_.bind(this),GeometryCollection:this.writeGeometryCollectionGeometry_.bind(this)},this.source_=null,this.hitDetection_=null;let n;if(e.features?n=e.features:e.source&&(this.source_=e.source,n=new Vn(this.source_.getFeatures()),this.source_.addEventListener(Pn.ADDFEATURE,this.handleSourceAdd_.bind(this)),this.source_.addEventListener(Pn.REMOVEFEATURE,this.handleSourceRemove_.bind(this))),!n)throw new Error("The modify interaction requires features, a source or a layer");e.hitDetection&&(this.hitDetection_=e.hitDetection),this.features_=n,this.features_.forEach(this.addFeature_.bind(this)),this.features_.addEventListener(It.ADD,this.handleFeatureAdd_.bind(this)),this.features_.addEventListener(It.REMOVE,this.handleFeatureRemove_.bind(this)),this.lastPointerEvent_=null,this.delta_=[0,0],this.snapToPointer_=e.snapToPointer===void 0?!this.hitDetection_:e.snapToPointer}addFeature_(e){const n=e.getGeometry();if(n){const s=this.SEGMENT_WRITERS_[n.getType()];s&&s(e,n)}const i=this.getMap();i&&i.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(i.getCoordinateFromPixel(this.lastPixel_)),e.addEventListener(xe.CHANGE,this.boundHandleFeatureChange_)}willModifyFeatures_(e,n){if(!this.featuresBeingModified_){this.featuresBeingModified_=new Vn;const i=this.featuresBeingModified_.getArray();for(let s=0,r=n.length;s<r;++s){const o=n[s].feature;o&&!i.includes(o)&&this.featuresBeingModified_.push(o)}this.featuresBeingModified_.getLength()===0?this.featuresBeingModified_=null:this.dispatchEvent(new Ff(Mf.MODIFYSTART,this.featuresBeingModified_,e))}}removeFeature_(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&this.features_.getLength()===0&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener(xe.CHANGE,this.boundHandleFeatureChange_)}removeFeatureSegmentData_(e){const n=this.rBush_,i=[];n.forEach(function(s){e===s.feature&&i.push(s)});for(let s=i.length-1;s>=0;--s){const r=i[s];for(let o=this.dragSegments_.length-1;o>=0;--o)this.dragSegments_[o][0]===r&&this.dragSegments_.splice(o,1);n.remove(r)}}setActive(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),super.setActive(e)}setMap(e){this.overlay_.setMap(e),super.setMap(e)}getOverlay(){return this.overlay_}handleSourceAdd_(e){e.feature&&this.features_.push(e.feature)}handleSourceRemove_(e){e.feature&&this.features_.remove(e.feature)}handleFeatureAdd_(e){this.addFeature_(e.element)}handleFeatureChange_(e){if(!this.changingFeature_){const n=e.target;this.removeFeature_(n),this.addFeature_(n)}}handleFeatureRemove_(e){this.removeFeature_(e.element)}writePointGeometry_(e,n){const i=n.getCoordinates(),s={feature:e,geometry:n,segment:[i,i]};this.rBush_.insert(n.getExtent(),s)}writeMultiPointGeometry_(e,n){const i=n.getCoordinates();for(let s=0,r=i.length;s<r;++s){const o=i[s],a={feature:e,geometry:n,depth:[s],index:s,segment:[o,o]};this.rBush_.insert(n.getExtent(),a)}}writeLineStringGeometry_(e,n){const i=n.getCoordinates();for(let s=0,r=i.length-1;s<r;++s){const o=i.slice(s,s+2),a={feature:e,geometry:n,index:s,segment:o};this.rBush_.insert(mn(o),a)}}writeMultiLineStringGeometry_(e,n){const i=n.getCoordinates();for(let s=0,r=i.length;s<r;++s){const o=i[s];for(let a=0,l=o.length-1;a<l;++a){const c=o.slice(a,a+2),h={feature:e,geometry:n,depth:[s],index:a,segment:c};this.rBush_.insert(mn(c),h)}}}writePolygonGeometry_(e,n){const i=n.getCoordinates();for(let s=0,r=i.length;s<r;++s){const o=i[s];for(let a=0,l=o.length-1;a<l;++a){const c=o.slice(a,a+2),h={feature:e,geometry:n,depth:[s],index:a,segment:c};this.rBush_.insert(mn(c),h)}}}writeMultiPolygonGeometry_(e,n){const i=n.getCoordinates();for(let s=0,r=i.length;s<r;++s){const o=i[s];for(let a=0,l=o.length;a<l;++a){const c=o[a];for(let h=0,u=c.length-1;h<u;++h){const d=c.slice(h,h+2),f={feature:e,geometry:n,depth:[a,s],index:h,segment:d};this.rBush_.insert(mn(d),f)}}}}writeCircleGeometry_(e,n){const i=n.getCenter(),s={feature:e,geometry:n,index:Zx,segment:[i,i]},r={feature:e,geometry:n,index:tl,segment:[i,i]},o=[s,r];s.featureSegments=o,r.featureSegments=o,this.rBush_.insert(qa(i),s);let a=n;this.rBush_.insert(a.getExtent(),r)}writeGeometryCollectionGeometry_(e,n){const i=n.getGeometriesArray();for(let s=0;s<i.length;++s){const r=i[s],o=this.SEGMENT_WRITERS_[r.getType()];o(e,r)}}createOrUpdateVertexFeature_(e,n,i,s){let r=this.vertexFeature_;return r?r.getGeometry().setCoordinates(e):(r=new Ln(new ci(e)),this.vertexFeature_=r,this.overlay_.getSource().addFeature(r)),r.set("features",n),r.set("geometries",i),r.set("existing",s),r}handleEvent(e){if(!e.originalEvent)return!0;this.lastPointerEvent_=e;let n;return!e.map.getView().getInteracting()&&e.type==Ge.POINTERMOVE&&!this.handlingDownUpSequence&&this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(e.type!=Ge.SINGLECLICK||!this.ignoreNextSingleClick_?n=this.removePoint():n=!0),e.type==Ge.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),super.handleEvent(e)&&!n}findInsertVerticesAndUpdateDragSegments_(e){this.handlePointerAtPixel_(e),this.dragSegments_.length=0,this.featuresBeingModified_=null;const n=this.vertexFeature_;if(!n)return;this.getMap().getView().getProjection();const i=[],s=n.getGeometry().getCoordinates(),r=mn([s]),o=this.rBush_.getInExtent(r),a={};o.sort(l5);for(let l=0,c=o.length;l<c;++l){const h=o[l],u=h.segment;let d=me(h.geometry);const f=h.depth;if(f&&(d+="-"+f.join("-")),a[d]||(a[d]=new Array(2)),h.geometry.getType()==="Circle"&&h.index===tl){const g=ew(e,h);_n(g,s)&&!a[d][0]&&(this.dragSegments_.push([h,0]),a[d][0]=h);continue}if(_n(u[0],s)&&!a[d][0]){this.dragSegments_.push([h,0]),a[d][0]=h;continue}if(_n(u[1],s)&&!a[d][1]){if(a[d][0]&&a[d][0].index===0){let g=h.geometry.getCoordinates();switch(h.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":g=g[f[1]];case"Polygon":if(h.index!==g[f[0]].length-2)continue;break}}this.dragSegments_.push([h,1]),a[d][1]=h;continue}me(u)in this.vertexSegments_&&!a[d][0]&&!a[d][1]&&i.push(h)}return i}handleDragEvent(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e,this.dragSegments_.map(([r])=>r));const n=[e.coordinate[0]+this.delta_[0],e.coordinate[1]+this.delta_[1]],i=[],s=[];for(let r=0,o=this.dragSegments_.length;r<o;++r){const a=this.dragSegments_[r],l=a[0],c=l.feature;i.includes(c)||i.push(c);const h=l.geometry;s.includes(h)||s.push(h);const u=l.depth;let d;const f=l.segment,g=a[1];for(;n.length<h.getStride();)n.push(f[g][n.length]);switch(h.getType()){case"Point":d=n,f[0]=n,f[1]=n;break;case"MultiPoint":d=h.getCoordinates(),d[l.index]=n,f[0]=n,f[1]=n;break;case"LineString":d=h.getCoordinates(),d[l.index+g]=n,f[g]=n;break;case"MultiLineString":d=h.getCoordinates(),d[u[0]][l.index+g]=n,f[g]=n;break;case"Polygon":d=h.getCoordinates(),d[u[0]][l.index+g]=n,f[g]=n;break;case"MultiPolygon":d=h.getCoordinates(),d[u[1]][u[0]][l.index+g]=n,f[g]=n;break;case"Circle":const m=h;if(f[0]=n,f[1]=n,l.index===Zx)this.changingFeature_=!0,m.setCenter(n),this.changingFeature_=!1;else{this.changingFeature_=!0,e.map.getView().getProjection();let p=Sh(mt(m.getCenter()),mt(n));m.setRadius(p),this.changingFeature_=!1}break}d&&this.setGeometryCoordinates_(h,d)}this.createOrUpdateVertexFeature_(n,i,s,!0)}handleDownEvent(e){if(!this.condition_(e))return!1;const n=e.coordinate,i=this.findInsertVerticesAndUpdateDragSegments_(n);if(i?.length&&this.insertVertexCondition_(e)&&(this.willModifyFeatures_(e,i),this.vertexFeature_)){const s=this.vertexFeature_.getGeometry().getCoordinates();for(let r=i.length-1;r>=0;--r)this.insertVertex_(i[r],s);this.ignoreNextSingleClick_=!0}return!!this.vertexFeature_}handleUpEvent(e){for(let n=this.dragSegments_.length-1;n>=0;--n){const i=this.dragSegments_[n][0],s=i.geometry;if(s.getType()==="Circle"){const r=s,o=r.getCenter(),a=i.featureSegments[0],l=i.featureSegments[1];a.segment[0]=o,a.segment[1]=o,l.segment[0]=o,l.segment[1]=o,this.rBush_.update(qa(o),a);let c=r;this.rBush_.update(c.getExtent(),l)}else this.rBush_.update(mn(i.segment),i)}return this.featuresBeingModified_&&(this.dispatchEvent(new Ff(Mf.MODIFYEND,this.featuresBeingModified_,e)),this.featuresBeingModified_=null),!1}handlePointerMove_(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.coordinate)}handlePointerAtPixel_(e){const n=this.getMap(),i=n.getPixelFromCoordinate(e);n.getView().getProjection();const s=function(a,l){return Qx(e,a)-Qx(e,l)};let r,o;if(this.hitDetection_){const a=typeof this.hitDetection_=="object"?l=>l===this.hitDetection_:void 0;n.forEachFeatureAtPixel(i,(l,c,h)=>{h&&h.getType()==="Point"&&(h=new ci(Xs(h.getCoordinates())));const u=h||l.getGeometry();if(u&&u.getType()==="Point"&&l instanceof Ln&&this.features_.getArray().includes(l)){o=u;const d=l.getGeometry().getFlatCoordinates().slice(0,2);r=[{feature:l,geometry:o,segment:[d,d]}]}return!0},{layerFilter:a})}if(!r){const a=fi(qa(e,Jx)),l=n.getView().getResolution()*this.pixelTolerance_,c=yu(uu(a,l,Jx));r=this.rBush_.getInExtent(c)}if(r&&r.length>0){const a=r.sort(s)[0],l=a.segment;let c=ew(e,a);const h=n.getPixelFromCoordinate(c);let u=Sh(i,h);if(o||u<=this.pixelTolerance_){const d={};if(d[me(l)]=!0,this.snapToPointer_||(this.delta_[0]=c[0]-e[0],this.delta_[1]=c[1]-e[1]),a.geometry.getType()==="Circle"&&a.index===tl)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(c,[a.feature],[a.geometry],this.snappedToVertex_);else{const f=n.getPixelFromCoordinate(l[0]),g=n.getPixelFromCoordinate(l[1]),m=ko(h,f),p=ko(h,g);if(u=Math.sqrt(Math.min(m,p)),this.snappedToVertex_=u<=this.pixelTolerance_,!this.snappedToVertex_&&!this.insertVertexCondition_(this.lastPointerEvent_)){this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null);return}this.snappedToVertex_&&(c=m>p?l[1]:l[0]),this.createOrUpdateVertexFeature_(c,[a.feature],[a.geometry],this.snappedToVertex_);const y={};y[me(a.geometry)]=!0;for(let _=1,x=r.length;_<x;++_){const E=r[_].segment;if(_n(l[0],E[0])&&_n(l[1],E[1])||_n(l[0],E[1])&&_n(l[1],E[0])){const w=me(r[_].geometry);w in y||(y[w]=!0,d[me(E)]=!0)}else break}}this.vertexSegments_=d;return}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}insertVertex_(e,n){const i=e.segment,s=e.feature,r=e.geometry,o=e.depth,a=e.index;let l;for(;n.length<r.getStride();)n.push(0);switch(r.getType()){case"MultiLineString":l=r.getCoordinates(),l[o[0]].splice(a+1,0,n);break;case"Polygon":l=r.getCoordinates(),l[o[0]].splice(a+1,0,n);break;case"MultiPolygon":l=r.getCoordinates(),l[o[1]][o[0]].splice(a+1,0,n);break;case"LineString":l=r.getCoordinates(),l.splice(a+1,0,n);break;default:return!1}this.setGeometryCoordinates_(r,l);const c=this.rBush_;c.remove(e),this.updateSegmentIndices_(r,a,o,1);const h={segment:[i[0],n],feature:s,geometry:r,depth:o,index:a};c.insert(mn(h.segment),h),this.dragSegments_.push([h,1]);const u={segment:[n,i[1]],feature:s,geometry:r,depth:o,index:a+1};return c.insert(mn(u.segment),u),this.dragSegments_.push([u,0]),!0}updatePointer_(e){return e&&this.findInsertVerticesAndUpdateDragSegments_(e),this.vertexFeature_?.getGeometry().getCoordinates()}getPoint(){const e=this.vertexFeature_?.getGeometry().getCoordinates();return e?Xs(e,this.getMap().getView().getProjection()):null}canRemovePoint(){if(!this.vertexFeature_||this.vertexFeature_.get("geometries").every(i=>i.getType()==="Circle"||i.getType().endsWith("Point")))return!1;const e=this.vertexFeature_.getGeometry().getCoordinates();return this.rBush_.getInExtent(mn([e])).some(({segment:i})=>_n(i[0],e)||_n(i[1],e))}removePoint(e){if(e&&(e=mt(e,this.getMap().getView().getProjection()),this.updatePointer_(e)),!this.lastPointerEvent_||this.lastPointerEvent_&&this.lastPointerEvent_.type!=Ge.POINTERDRAG){const n=this.lastPointerEvent_;this.willModifyFeatures_(n,this.dragSegments_.map(([s])=>s));const i=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new Ff(Mf.MODIFYEND,this.featuresBeingModified_,n)),this.featuresBeingModified_=null,i}return!1}removeVertex_(){const e=this.dragSegments_,n={};let i=!1,s,r,o,a,l,c,h,u,d,f,g;for(l=e.length-1;l>=0;--l)o=e[l],f=o[0],g=me(f.feature),f.depth&&(g+="-"+f.depth.join("-")),g in n||(n[g]={}),o[1]===0?(n[g].right=f,n[g].index=f.index):o[1]==1&&(n[g].left=f,n[g].index=f.index+1);for(g in n){switch(d=n[g].right,h=n[g].left,c=n[g].index,u=c-1,h!==void 0?f=h:f=d,u<0&&(u=0),a=f.geometry,r=a.getCoordinates(),s=r,i=!1,a.getType()){case"MultiLineString":r[f.depth[0]].length>2&&(r[f.depth[0]].splice(c,1),i=!0);break;case"LineString":r.length>2&&(r.splice(c,1),i=!0);break;case"MultiPolygon":s=s[f.depth[1]];case"Polygon":s=s[f.depth[0]],s.length>4&&(c==s.length-1&&(c=0),s.splice(c,1),i=!0,c===0&&(s.pop(),s.push(s[0]),u=s.length-1));break}if(i){this.setGeometryCoordinates_(a,r);const m=[];if(h!==void 0&&(this.rBush_.remove(h),m.push(h.segment[0])),d!==void 0&&(this.rBush_.remove(d),m.push(d.segment[1])),h!==void 0&&d!==void 0){const p={depth:f.depth,feature:f.feature,geometry:f.geometry,index:u,segment:m};this.rBush_.insert(mn(p.segment),p)}this.updateSegmentIndices_(a,c,f.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.length=0}}return i}canInsertPoint(){if(!this.vertexFeature_||this.vertexFeature_.get("geometries").every(i=>i.getType()==="Circle"||i.getType().endsWith("Point")))return!1;const e=this.vertexFeature_.getGeometry().getCoordinates();return this.rBush_.getInExtent(mn([e])).some(({segment:i})=>!(_n(i[0],e)||_n(i[1],e)))}insertPoint(e){const n=e?mt(e,this.getMap().getView().getProjection()):this.vertexFeature_?.getGeometry().getCoordinates();return n?this.findInsertVerticesAndUpdateDragSegments_(n).reduce((s,r)=>s||this.insertVertex_(r,n),!1):!1}setGeometryCoordinates_(e,n){this.changingFeature_=!0,e.setCoordinates(n),this.changingFeature_=!1}updateSegmentIndices_(e,n,i,s){this.rBush_.forEachInExtent(e.getExtent(),function(r){r.geometry===e&&(i===void 0||r.depth===void 0||cs(r.depth,i))&&r.index>n&&(r.index+=s)})}}function l5(t,e){return t.index-e.index}function Qx(t,e,n){const i=e.geometry;if(i.getType()==="Circle"){let r=i;if(e.index===tl){const o=ko(r.getCenter(),mt(t)),a=Math.sqrt(o)-r.getRadius();return a*a}}const s=mt(t);return vo[0]=mt(e.segment[0]),vo[1]=mt(e.segment[1]),aN(s,vo)}function ew(t,e,n){const i=e.geometry;if(i.getType()==="Circle"&&e.index===tl)return Xs(i.getClosestPoint(mt(t)));const s=mt(t);return vo[0]=mt(e.segment[0]),vo[1]=mt(e.segment[1]),Xs(mb(s,vo))}function c5(){const t=Qm();return function(e,n){return t.Point}}const h5={SELECT:"select"};class u5 extends hi{constructor(e,n,i,s){super(e),this.selected=n,this.deselected=i,this.mapBrowserEvent=s}}const Oc={};class C_ extends ta{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=e.condition?e.condition:$b,this.addCondition_=e.addCondition?e.addCondition:Ag,this.removeCondition_=e.removeCondition?e.removeCondition:Ag,this.toggleCondition_=e.toggleCondition?e.toggleCondition:Hm,this.multi_=e.multi?e.multi:!1,this.filter_=e.filter?e.filter:zs,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.style_=e.style!==void 0?e.style:d5(),this.features_=e.features||new Vn;let n;if(e.layers)if(typeof e.layers=="function")n=e.layers;else{const i=e.layers;n=function(s){return i.includes(s)}}else n=zs;this.layerFilter_=n,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(e,n){this.featureLayerAssociation_[me(e)]=n}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(e){return this.featureLayerAssociation_[me(e)]}setHitTolerance(e){this.hitTolerance_=e}setMap(e){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(e),e?(this.features_.addEventListener(It.ADD,this.boundAddFeature_),this.features_.addEventListener(It.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(It.ADD,this.boundAddFeature_),this.features_.removeEventListener(It.REMOVE,this.boundRemoveFeature_))}addFeature_(e){const n=e.element;if(this.style_&&this.applySelectedStyle_(n),!this.getLayer(n)){const i=this.getMap().getAllLayers().find(function(s){if(s instanceof Il&&s.getSource()&&s.getSource().hasFeature(n))return s});i&&this.addFeatureLayerAssociation_(n,i)}}removeFeature_(e){this.style_&&this.restorePreviousStyle_(e.element)}getStyle(){return this.style_}applySelectedStyle_(e){const n=me(e);n in Oc||(Oc[n]=e.getStyle()),e.setStyle(this.style_)}restorePreviousStyle_(e){const n=this.getMap().getInteractions().getArray();for(let s=n.length-1;s>=0;--s){const r=n[s];if(r!==this&&r instanceof C_&&r.getStyle()&&r.getFeatures().getArray().lastIndexOf(e)!==-1){e.setStyle(r.getStyle());return}}const i=me(e);e.setStyle(Oc[i]),delete Oc[i]}removeFeatureLayerAssociation_(e){delete this.featureLayerAssociation_[me(e)]}handleEvent(e){if(!this.condition_(e))return!0;const n=this.addCondition_(e),i=this.removeCondition_(e),s=this.toggleCondition_(e),r=!n&&!i&&!s,o=e.map,a=this.getFeatures(),l=[],c=[];if(r){Fr(this.featureLayerAssociation_),o.forEachFeatureAtPixel(e.pixel,(h,u)=>{if(!(!(h instanceof Ln)||!this.filter_(h,u)))return this.addFeatureLayerAssociation_(h,u),c.push(h),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let h=a.getLength()-1;h>=0;--h){const u=a.item(h),d=c.indexOf(u);d>-1?c.splice(d,1):(a.remove(u),l.push(u))}c.length!==0&&a.extend(c)}else{o.forEachFeatureAtPixel(e.pixel,(h,u)=>{if(!(!(h instanceof Ln)||!this.filter_(h,u)))return(n||s)&&!a.getArray().includes(h)?(this.addFeatureLayerAssociation_(h,u),c.push(h)):(i||s)&&a.getArray().includes(h)&&(l.push(h),this.removeFeatureLayerAssociation_(h)),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let h=l.length-1;h>=0;--h)a.remove(l[h]);a.extend(c)}return(c.length>0||l.length>0)&&this.dispatchEvent(new u5(h5.SELECT,c,l,e)),!0}}function d5(){const t=Qm();return ai(t.Polygon,t.LineString),ai(t.GeometryCollection,t.LineString),function(e){return e.getGeometry()?t[e.getGeometry().getType()]:null}}class f5{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=Ln,this.supportedMediaTypes=null}getReadOptions(e,n){if(n){let i=n.dataProjection?ft(n.dataProjection):this.readProjection(e);n.extent&&i&&i.getUnits()==="tile-pixels"&&(i=ft(i),i.setWorldExtent(n.extent)),n={dataProjection:i,featureProjection:n.featureProjection}}return this.adaptOptions(n)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return Se()}readFeature(e,n){return Se()}readFeatures(e,n){return Se()}readGeometry(e,n){return Se()}readProjection(e){return Se()}writeFeature(e,n){return Se()}writeFeatures(e,n){return Se()}writeGeometry(e,n){return Se()}}function b_(t,e,n){const i=n?ft(n.featureProjection):null,s=n?ft(n.dataProjection):null;let r=t;if(i&&s&&!Tr(i,s)){e&&(r=t.clone());const o=e?i:s,a=e?s:i;o.getUnits()==="tile-pixels"?r.transform(o,a):r.applyTransform(_l(o,a))}if(e&&n&&n.decimals!==void 0){const o=Math.pow(10,n.decimals),a=function(l){for(let c=0,h=l.length;c<h;++c)l[c]=Math.round(l[c]*o)/o;return l};r===t&&(r=t.clone()),r.applyTransform(a)}return r}const g5={Point:ci,LineString:ki,Polygon:Gi,MultiPoint:Kl,MultiLineString:zo,MultiPolygon:Ho};function p5(t,e,n){return Array.isArray(e[0])?(Nb(t,0,e,n)||(t=t.slice(),Cg(t,0,e,n)),t):(km(t,0,e,n)||(t=t.slice(),vh(t,0,e,n)),t)}function r1(t,e){const n=t.geometry;if(!n)return[];if(Array.isArray(n))return n.map(r=>r1({...t,geometry:r})).flat();const i=n.type==="MultiPolygon"?"Polygon":n.type;if(i==="GeometryCollection"||i==="Circle")throw new Error("Unsupported geometry type: "+i);const s=n.layout.length;return b_(new jn(i,i==="Polygon"?p5(n.flatCoordinates,n.ends,s):n.flatCoordinates,n.ends?.flat(),s,t.properties||{},t.id).enableSimplifyTransformed(),!1,e)}function T_(t,e){if(!t)return null;if(Array.isArray(t)){const i=t.map(s=>T_(s,e));return new Pl(i)}const n=g5[t.type];return b_(new n(t.flatCoordinates,t.layout||"XY",t.ends),!1,e)}class m5 extends f5{constructor(){super()}getType(){return"json"}readFeature(e,n){return this.readFeatureFromObject(Lc(e),this.getReadOptions(e,n))}readFeatures(e,n){return this.readFeaturesFromObject(Lc(e),this.getReadOptions(e,n))}readFeatureFromObject(e,n){return Se()}readFeaturesFromObject(e,n){return Se()}readGeometry(e,n){return this.readGeometryFromObject(Lc(e),this.getReadOptions(e,n))}readGeometryFromObject(e,n){return Se()}readProjection(e){return this.readProjectionFromObject(Lc(e))}readProjectionFromObject(e){return Se()}writeFeature(e,n){return JSON.stringify(this.writeFeatureObject(e,n))}writeFeatureObject(e,n){return Se()}writeFeatures(e,n){return JSON.stringify(this.writeFeaturesObject(e,n))}writeFeaturesObject(e,n){return Se()}writeGeometry(e,n){return JSON.stringify(this.writeGeometryObject(e,n))}writeGeometryObject(e,n){return Se()}}function Lc(t){if(typeof t=="string"){const e=JSON.parse(t);return e||null}return t!==null?t:null}class _5 extends m5{constructor(e){e=e||{},super(),this.dataProjection=ft(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=ft(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,n){let i=null;e.type==="Feature"?i=e:i={type:"Feature",geometry:e,properties:null};const s=R_(i.geometry);if(this.featureClass===jn)return r1({geometry:s,id:i.id,properties:i.properties},n);const r=new Ln;return this.geometryName_?r.setGeometryName(this.geometryName_):this.extractGeometryName_&&i.geometry_name&&r.setGeometryName(i.geometry_name),r.setGeometry(T_(s,n)),"id"in i&&r.setId(i.id),i.properties&&r.setProperties(i.properties,!0),r}readFeaturesFromObject(e,n){const i=e;let s=null;if(i.type==="FeatureCollection"){const r=e;s=[];const o=r.features;for(let a=0,l=o.length;a<l;++a){const c=this.readFeatureFromObject(o[a],n);c&&s.push(c)}}else s=[this.readFeatureFromObject(e,n)];return s.flat()}readGeometryFromObject(e,n){return y5(e,n)}readProjectionFromObject(e){const n=e.crs;let i;if(n)if(n.type=="name")i=ft(n.properties.name);else if(n.type==="EPSG")i=ft("EPSG:"+n.properties.code);else throw new Error("Unknown SRS type");else i=this.dataProjection;return i}writeFeatureObject(e,n){n=this.adaptOptions(n);const i={type:"Feature",geometry:null,properties:null},s=e.getId();if(s!==void 0&&(i.id=s),!e.hasProperties())return i;const r=e.getProperties(),o=e.getGeometry();return o&&(i.geometry=jg(o,n),delete r[e.getGeometryName()]),Ir(r)||(i.properties=r),i}writeFeaturesObject(e,n){n=this.adaptOptions(n);const i=[];for(let s=0,r=e.length;s<r;++s)i.push(this.writeFeatureObject(e[s],n));return{type:"FeatureCollection",features:i}}writeGeometryObject(e,n){return jg(e,this.adaptOptions(n))}}function R_(t,e){if(!t)return null;let n;switch(t.type){case"Point":{n=x5(t);break}case"LineString":{n=w5(t);break}case"Polygon":{n=T5(t);break}case"MultiPoint":{n=C5(t);break}case"MultiLineString":{n=S5(t);break}case"MultiPolygon":{n=b5(t);break}case"GeometryCollection":{n=E5(t);break}default:throw new Error("Unsupported GeoJSON type: "+t.type)}return n}function y5(t,e){const n=R_(t);return T_(n,e)}function E5(t,e){return t.geometries.map(function(i){return R_(i)})}function x5(t){const e=t.coordinates;return{type:"Point",flatCoordinates:e,layout:Or(e.length)}}function w5(t){const e=t.coordinates,n=e.flat();return{type:"LineString",flatCoordinates:n,ends:[n.length],layout:Or(e[0]?.length||2)}}function S5(t){const e=t.coordinates,n=e[0]?.[0]?.length||2,i=[],s=Hl(i,0,e,n);return{type:"MultiLineString",flatCoordinates:i,ends:s,layout:Or(n)}}function C5(t){const e=t.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:Or(e[0]?.length||2)}}function b5(t){const e=t.coordinates,n=[],i=e[0]?.[0]?.[0].length||2,s=Mb(n,0,e,i);return{type:"MultiPolygon",flatCoordinates:n,ends:s,layout:Or(i)}}function T5(t){const e=t.coordinates,n=[],i=e[0]?.[0]?.length,s=Hl(n,0,e,i);return{type:"Polygon",flatCoordinates:n,ends:s,layout:Or(i)}}function jg(t,e){t=b_(t,!0,e);const n=t.getType();let i;switch(n){case"Point":{i=M5(t);break}case"LineString":{i=v5(t);break}case"Polygon":{i=F5(t,e);break}case"MultiPoint":{i=I5(t);break}case"MultiLineString":{i=A5(t);break}case"MultiPolygon":{i=P5(t,e);break}case"GeometryCollection":{i=R5(t,e);break}case"Circle":{i={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+n)}return i}function R5(t,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:t.getGeometriesArray().map(function(i){return jg(i,e)})}}function v5(t,e){return{type:"LineString",coordinates:t.getCoordinates()}}function A5(t,e){return{type:"MultiLineString",coordinates:t.getCoordinates()}}function I5(t,e){return{type:"MultiPoint",coordinates:t.getCoordinates()}}function P5(t,e){let n;return e&&(n=e.rightHanded),{type:"MultiPolygon",coordinates:t.getCoordinates(n)}}function M5(t,e){return{type:"Point",coordinates:t.getCoordinates()}}function F5(t,e){let n;return e&&(n=e.rightHanded),{type:"Polygon",coordinates:t.getCoordinates(n)}}const D5={__name:"MapView",props:{mode:{type:String,required:!0},drawShape:{type:String,required:!0},layersConfig:{type:Array,default:()=>[]}},emits:["features","info","request-layer-sync","suggest-mode"],setup(t,{expose:e,emit:n}){const i=t,s=n,r=es(null);let o,a,l,c,h,u,d,f,g=null;const m=es(!1),p=new _5;function y(Z){let H=2166136261;for(let oe=0;oe<Z.length;oe++)H^=Z.charCodeAt(oe),H=H+((H<<1)+(H<<4)+(H<<7)+(H<<8)+(H<<24))>>>0;return(H>>>0).toString(16)}function _(Z){const H={...Z.getProperties()};if(delete H.geometry,H.id!==void 0&&H.id!==null&&String(H.id)!=="")return String(H.id);const oe=V(Z),[ge,Ie]=$E(oe),je=Number.isFinite(Ie)?Ie.toFixed(6):"0",Xe=Number.isFinite(ge)?ge.toFixed(6):"0",ui=p.writeFeatureObject(Z,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}).geometry,C=y(JSON.stringify(ui)).slice(0,8),R=`${Z.getGeometry().getType()}@${je},${Xe}#${C}`;return Z.set("id",R),R}function x(Z){const H={...Z.getProperties()};return delete H.geometry,H.id!==void 0&&H.id!==null&&String(H.id)!==""?String(H.id):_(Z)}function E(){for(const Z of l.getFeatures())_(Z)}function w(Z,H={dedupe:!0,prefer:"incoming"}){if(!l||!Z)return;const oe=b(Z);if(oe.length){if(E(),H.dedupe){const ge=new Map;for(const Ie of l.getFeatures())ge.set(x(Ie),Ie);for(const Ie of oe){const je=x(Ie);ge.has(je)?H.prefer==="incoming"&&(l.removeFeature(ge.get(je)),l.addFeature(Ie),ge.set(je,Ie)):(l.addFeature(Ie),ge.set(je,Ie))}}else{for(const ge of oe)_(ge);l.addFeatures(oe)}z()}}function b(Z){try{return Z.type==="FeatureCollection"?p.readFeatures(Z,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}):Z.type==="Feature"?[p.readFeature(Z,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"})]:[]}catch{return[]}}function v(){N({type:"FeatureCollection",features:[]})}function A(){return p.writeFeaturesObject(l.getFeatures(),{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"})}const P=new Map;function M(Z,H){if(!m.value||!o)return;const oe=P.get(Z);oe&&oe.setVisible(!!H)}function Y(Z,H,oe=13){o.getView().animate({zoom:7,duration:250},{center:GE([H,Z]),duration:650},{zoom:oe,duration:300})}function j(Z={}){if(!g)return null;const H={...g.getProperties()};delete H.geometry;const oe={...H,...Z};g.setProperties(oe),z();const ge=V(g),{lat:Ie,lon:je}=be(ge),Xe=p.writeFeatureObject(g,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});return s("info",{visible:!0,lat:Ie,lon:je,feature:Xe}),Xe}function K(){return g?(l.removeFeature(g),u.getFeatures().clear(),g=null,z(),s("info",{visible:!1,lat:0,lon:0,feature:null}),!0):!1}e({loadGeoJSON:w,clearFeatures:v,getFeaturesFC:A,setLayerVisibility:M,flyTo:Y,updateSelectedFeatureProps:j,deleteSelectedFeature:K});function ee(){return new Nn({image:new ia({radius:6,fill:new Oi({color:"#ffffff"}),stroke:new Li({color:"#000",width:2})})})}function te(){return new Nn({stroke:new Li({color:"#ffff00",width:2}),fill:new Oi({color:"rgba(0,0,0,0)"})})}function Q(){return new Nn({text:new Iu({text:"⌖",font:"bold 24px sans-serif",fill:new Oi({color:"#ffffff"}),stroke:new Li({color:"#000",width:3})})})}function V(Z){const H=Z.getGeometry(),oe=H.getType();if(oe==="Point")return H.getCoordinates();if(oe==="LineString")return H.getCoordinateAt(.5);if(oe==="Polygon")return H.getInteriorPoint().getCoordinates();try{return Ui(H.getExtent())}catch{return H.getFirstCoordinate()}}function z(){s("features",A())}function re(){if(!m.value||!u||!d)return;const Z=i.mode==="modify",H=i.mode==="draw";u.setActive(!H||Z),d.setActive(Z),f&&(o.removeInteraction(f),f=null),H&&(f=new s5({source:l,type:i.drawShape}),o.addInteraction(f),f.on("drawend",oe=>{Aw(()=>z());const ge=oe.feature;_(ge),g=ge;const Ie=u.getFeatures();Ie.clear(),Ie.push(ge);const je=V(ge),{lat:Xe,lon:ui}=be(je),C=p.writeFeatureObject(ge,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});s("info",{visible:!0,lat:Xe,lon:ui,feature:C}),s("suggest-mode",{mode:"modify"})}))}function ue(){if(!(!m.value||!o)){o.getLayers().getArray().slice().forEach(Z=>{Z!==a&&Z!==c&&o.removeLayer(Z)}),P.clear();for(const Z of i.layersConfig){const H=ye(Z);H&&(H.setVisible(!!Z.visible),o.addLayer(H),P.set(Z.id,H))}}}function ye(Z){const{type:H,url:oe,attributionText:ge,attributionUrl:Ie,maxZoom:je}=Z;return H==="osm"?new yx({source:new QG}):H==="satellite"?new yx({source:new BT({url:oe,attributions:ge&&Ie?`Tiles © <a href="${Ie}">${ge}</a>`:ge||"",maxZoom:je})}):H==="geotiff"?new RT({source:new Q6({sources:[{url:oe}],attributions:ge||""})}):(console.warn("Unknown layer type:",H),null)}function N(Z){if(l.clear(),Z?.features?.length){const H=p.readFeatures(Z,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});for(const oe of H)_(oe);l.addFeatures(H)}z()}function be(Z){const[H,oe]=$E(Z);return{lat:oe,lon:H}}return kw(()=>{l=new kh,a=new Il({source:l,style:Z=>Z.getGeometry().getType()==="Point"?ee():te(),zIndex:1e3}),h=new kh,c=new Il({source:h,style:Q(),zIndex:1100}),o=new aU({target:r.value,layers:[a,c],view:new Ii({center:GE([115.367526,-8.129998]),zoom:18}),controls:Bb().extend([new t5({units:"metric",bar:!0,steps:6,minWidth:180})])}),u=new C_,d=new a5({source:l}),d.setActive(!1),o.addInteraction(u),o.addInteraction(d),l.on("addfeature",z),l.on("changefeature",z),l.on("removefeature",z),u.on("select",Z=>{if(g=Z.selected[0]||null,!g){i.mode==="modify"&&s("info",{visible:!1,lat:0,lon:0,feature:null});return}const H=V(g),{lat:oe,lon:ge}=be(H),Ie=p.writeFeatureObject(g,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});s("info",{visible:!0,lat:oe,lon:ge,feature:Ie})}),o.on("singleclick",Z=>{h.clear();const H=o.forEachFeatureAtPixel(Z.pixel,oe=>oe,{layerFilter:oe=>oe===a});if(i.mode==="browse"){const oe=H?V(H):Z.coordinate,{lat:ge,lon:Ie}=be(oe);H||h.addFeature(new Ln(new ci(Z.coordinate)));const je=H?p.writeFeatureObject(H,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"}):null;s("info",{visible:!0,lat:ge,lon:Ie,feature:je})}}),re(),ue(),m.value=!0,s("request-layer-sync")}),Eo(()=>[i.mode,i.drawShape],()=>re()),Eo(()=>i.layersConfig,()=>ue()),Nw(()=>{o&&o.setTarget(void 0)}),(Z,H)=>(it(),dt("div",{ref_key:"mapEl",ref:r,style:{height:"100%",width:"100%"}},null,512))}},O5={class:"topbar"},L5={class:"group",role:"toolbar","aria-label":"Mode"},k5=["aria-pressed"],N5=["aria-pressed"],B5=["aria-pressed"],U5={class:"group","aria-label":"Draw type"},G5=["aria-pressed"],$5=["aria-pressed"],j5=["aria-pressed"],z5={__name:"TopBar",props:{mode:{type:String,required:!0},drawShape:{type:String,required:!0}},emits:["change"],setup(t,{emit:e}){const n=e;function i(r){n("change",{mode:r})}function s(r){n("change",{mode:"draw",drawShape:r})}return(r,o)=>(it(),dt("div",O5,[de("div",L5,[de("button",{class:"iconbtn","aria-pressed":t.mode==="browse",onClick:o[0]||(o[0]=a=>i("browse")),title:"Select"},"☝️",8,k5),de("button",{class:"iconbtn","aria-pressed":t.mode==="modify",onClick:o[1]||(o[1]=a=>i("modify")),title:"Modify"},"✏️",8,N5),de("button",{class:"iconbtn","aria-pressed":t.mode==="draw",onClick:o[2]||(o[2]=a=>i("draw")),title:"Draw"},"✚",8,B5)]),cr(de("div",U5,[de("button",{class:"chip","aria-pressed":t.drawShape==="Point",onClick:o[3]||(o[3]=a=>s("Point"))},"•",8,G5),de("button",{class:"chip","aria-pressed":t.drawShape==="LineString",onClick:o[4]||(o[4]=a=>s("LineString"))},"—",8,$5),de("button",{class:"chip","aria-pressed":t.drawShape==="Polygon",onClick:o[5]||(o[5]=a=>s("Polygon"))},"⬠",8,j5)],512),[[ov,t.mode==="draw"]])]))}},H5={style:{"margin-top":".5rem",display:"flex",gap:".5rem","flex-wrap":"wrap"}},X5=["disabled"],V5={key:0,class:"list"},W5=["onClick"],K5=["disabled"],Y5={style:{"margin-top":".5rem"}},q5={key:0,class:"list"},Z5=["onClick"],J5={key:1,style:{opacity:".7",padding:".5rem 0"}},Q5={open:""},e8={style:{"margin-top":".35rem"}},t8=["checked","onChange"],n8={style:{"margin-top":".5rem"}},i8={__name:"ToolsDrawer",props:{open:{type:Boolean,default:!1},layers:{type:Array,default:()=>[]},hasFeatures:{type:Boolean,default:!1},manifestUrl:{type:String,default:""},remoteFeatureCollections:{type:Array,default:()=>[]}},emits:["close","toggle-layer","load-geojson","save-geojson","clear-geojson","list-geojson-remote","load-geojson-remote","save-geojson-remote","refresh-manifest","fly-to"],setup(t,{emit:e}){const n=e,i=es(null),s=es(""),r=es(!1),o=es([]);function a(h){const u=h.target.files?.[0];if(!u)return;const d=new FileReader;d.onload=()=>{try{const f=JSON.parse(d.result);if(f?.type!=="FeatureCollection")throw new Error("Must be a GeoJSON FeatureCollection");n("load-geojson",f)}catch(f){alert("Error loading GeoJSON: "+f.message)}finally{i.value.value=""}},d.readAsText(u)}let l;async function c(){clearTimeout(l);const h=s.value.trim();if(h.length<3){o.value=[];return}l=setTimeout(async()=>{r.value=!0;try{const u=`https://nominatim.openstreetmap.org/search?format=json&limit=6&q=${encodeURIComponent(h)}`,d=await fetch(u,{headers:{"Accept-Language":navigator.language||"en"}});o.value=d.ok?await d.json():[]}catch{o.value=[]}finally{r.value=!1}},350)}return(h,u)=>(it(),dt("aside",{class:$h(["drawer",{open:t.open}]),onKeydown:u[8]||(u[8]=Tv(Cv(d=>n("close"),["stop","prevent"]),["esc"]))},[de("header",null,[u[9]||(u[9]=de("strong",null,"Tools",-1)),de("button",{class:"iconbtn",onClick:u[0]||(u[0]=d=>n("close"))},"×")]),de("section",null,[de("details",null,[u[10]||(u[10]=de("summary",null,"Load / Save Features",-1)),de("div",H5,[de("button",{class:"chip",disabled:!t.hasFeatures,onClick:u[1]||(u[1]=d=>n("save-geojson"))},"💾 Save GeoJSON (Local)",8,X5),de("button",{class:"chip",onClick:u[2]||(u[2]=d=>i.value.click())},"📁 Load GeoJSON (Local)"),de("input",{ref_key:"fileEl",ref:i,type:"file",accept:".geojson,.json",class:"hidden",onChange:a},null,544),de("button",{class:"chip",onClick:u[3]||(u[3]=d=>h.$emit("save-geojson-remote"))},"⬆️ Save GeoJSON (Remote) "),de("button",{class:"chip",onClick:u[4]||(u[4]=d=>h.$emit("list-geojson-remote"))},"📜 Load GeoJSON (Remote) "),t.remoteFeatureCollections.length?(it(),dt("div",V5,[(it(!0),dt(on,null,Nc(t.remoteFeatureCollections,d=>(it(),dt("button",{key:d,onClick:f=>h.$emit("load-geojson-remote",d)},Un(d),9,W5))),128))])):vi("",!0),de("button",{class:"chip",disabled:!t.hasFeatures,onClick:u[5]||(u[5]=d=>n("clear-geojson"))},"🧹 Clear all",8,K5)])]),de("details",null,[u[11]||(u[11]=de("summary",null,"Search / Fly-to",-1)),de("div",Y5,[cr(de("input",{type:"search",placeholder:"Search places (Nominatim)…","onUpdate:modelValue":u[6]||(u[6]=d=>s.value=d),onInput:c},null,544),[[eo,s.value]]),o.value.length?(it(),dt("div",q5,[(it(!0),dt(on,null,Nc(o.value,d=>(it(),dt("button",{key:d.place_id,onClick:f=>{n("fly-to",parseFloat(d.lat),parseFloat(d.lon),15),o.value=[]}},Un(d.display_name),9,Z5))),128))])):r.value?(it(),dt("div",J5,"Searching…")):vi("",!0)])]),de("details",Q5,[u[12]||(u[12]=de("summary",null,"Layers",-1)),de("div",e8,[(it(!0),dt(on,null,Nc(t.layers,d=>(it(),dt("div",{class:"switch",key:d.id},[de("input",{type:"checkbox",checked:!!d.visible,onChange:f=>n("toggle-layer",d.id,f.target.checked)},null,40,t8),de("label",null,Un(d.label||d.id),1)]))),128)),de("div",n8,[de("button",{class:"chip",onClick:u[7]||(u[7]=d=>n("refresh-manifest"))},"↻ Reload manifest")])])])])],34))}},s8=(t,e)=>{const n=t.__vccOpts||t;for(const[i,s]of e)n[i]=s;return n},r8={class:"info",role:"dialog","aria-label":"Map info"},o8={class:"info__coords"},a8={class:"info__section"},l8={class:"info__title"},c8={key:0,class:"info__descr"},h8={key:1,class:"info__tags"},u8={key:2,class:"info__dates"},d8={key:0},f8={key:1},g8={class:"info__raw"},p8={class:"info__section"},m8={class:"field"},_8={class:"field"},y8={class:"field"},E8={class:"grid2"},x8={class:"field"},w8={class:"field"},S8={key:0,class:"info__raw"},C8={__name:"InfoToast",props:{mode:{type:String,required:!0},lat:{type:Number,required:!0},lon:{type:Number,required:!0},feature:{type:Object,default:null}},emits:["close","save-props","delete"],setup(t,{emit:e}){const n=t,i=e,s=or(()=>n.feature?.properties??null),r=or(()=>s.value?.name||s.value?.id||"Selected feature"),o=or(()=>s.value?.description||""),a=or(()=>{const g=s.value?.tags;return g?Array.isArray(g)?g:String(g).split(",").map(m=>m.trim()).filter(Boolean):[]}),l=or(()=>({added:s.value?.dateAdded||"",removed:s.value?.dateRemoved||""})),c=or(()=>n.mode==="modify"&&!!n.feature),h=Ao({name:"",description:"",tags:"",dateAdded:"",dateRemoved:""});Eo(()=>n.feature,g=>{const m=g?.properties||{};h.name=m.name||"",h.description=m.description||"",h.tags=Array.isArray(m.tags)?m.tags.join(", "):m.tags||"",h.dateAdded=m.dateAdded||"",h.dateRemoved=m.dateRemoved||""},{immediate:!0});function u(g){return typeof g=="number"&&isFinite(g)?g.toFixed(6):String(g??"")}function d(){const g={};h.name!==""&&(g.name=h.name),h.description!==""&&(g.description=h.description);const m=h.tags.split(",").map(p=>p.trim()).filter(Boolean);m.length&&(g.tags=m),h.dateAdded!==""&&(g.dateAdded=h.dateAdded),h.dateRemoved!==""&&(g.dateRemoved=h.dateRemoved),i("save-props",g)}function f(){i("delete")}return(g,m)=>(it(),dt("div",r8,[de("div",o8,[de("span",null,"Lon/Lat: [ "+Un(u(t.lon))+", "+Un(u(t.lat))+" ]",1),de("button",{class:"iconbtn info__close",onClick:m[0]||(m[0]=p=>i("close")),"aria-label":"Close"},"×")]),c.value?(it(),dt(on,{key:1},[de("div",p8,[de("div",{class:"actions"},[de("button",{class:"chip",onClick:d},"💾 Save"),de("button",{class:"chip danger",onClick:f},"🗑️ Delete")]),de("label",m8,[m[7]||(m[7]=de("span",{class:"label"},"Name",-1)),cr(de("input",{type:"text","onUpdate:modelValue":m[1]||(m[1]=p=>h.name=p),placeholder:"—"},null,512),[[eo,h.name]])]),de("label",_8,[m[8]||(m[8]=de("span",{class:"label"},"Description",-1)),cr(de("textarea",{"onUpdate:modelValue":m[2]||(m[2]=p=>h.description=p),rows:"2",placeholder:"—"},null,512),[[eo,h.description]])]),de("label",y8,[m[9]||(m[9]=de("span",{class:"label"},"Tags (comma separated)",-1)),cr(de("input",{type:"text","onUpdate:modelValue":m[3]||(m[3]=p=>h.tags=p),placeholder:"reef, coral, site-42"},null,512),[[eo,h.tags]])]),de("div",E8,[de("label",x8,[m[10]||(m[10]=de("span",{class:"label"},"Date added",-1)),cr(de("input",{type:"text","onUpdate:modelValue":m[4]||(m[4]=p=>h.dateAdded=p),placeholder:"YYYY-MM-DD"},null,512),[[eo,h.dateAdded]])]),de("label",w8,[m[11]||(m[11]=de("span",{class:"label"},"Date removed",-1)),cr(de("input",{type:"text","onUpdate:modelValue":m[5]||(m[5]=p=>h.dateRemoved=p),placeholder:"YYYY-MM-DD"},null,512),[[eo,h.dateRemoved]])])])]),t.feature?(it(),dt("details",S8,[m[12]||(m[12]=de("summary",null,"Feature JSON",-1)),de("pre",null,[de("code",null,Un(JSON.stringify(t.feature,null,2)),1)])])):vi("",!0)],64)):(it(),dt(on,{key:0},[t.feature&&s.value?(it(),dt(on,{key:0},[de("div",a8,[de("div",l8,Un(r.value),1),o.value?(it(),dt("div",c8,Un(o.value),1)):vi("",!0),a.value.length?(it(),dt("div",h8,[(it(!0),dt(on,null,Nc(a.value,p=>(it(),dt("span",{class:"tag",key:p},"#"+Un(p),1))),128))])):vi("",!0),l.value.added||l.value.removed?(it(),dt("div",u8,[l.value.added?(it(),dt("small",d8,"added: "+Un(l.value.added),1)):vi("",!0),l.value.removed?(it(),dt("small",f8," • removed: "+Un(l.value.removed),1)):vi("",!0)])):vi("",!0)]),de("details",g8,[m[6]||(m[6]=de("summary",null,"Feature JSON",-1)),de("pre",null,[de("code",null,Un(JSON.stringify(t.feature,null,2)),1)])])],64)):vi("",!0)],64))]))}},b8=s8(C8,[["__scopeId","data-v-ebdddc60"]]),T8={class:"app"},R8={__name:"App",setup(t){const e="https://dinamap-les.s3.ap-southeast-1.amazonaws.com/public/config/config_manifest_202507200627.json",n=es(null),i=es(!1),s=Ao({mode:"browse",drawShape:"Point",manifestUrl:e,layersConfig:[],features:{type:"FeatureCollection",features:[]}}),r=Ao({visible:!1,lat:0,lon:0,feature:null});function o({mode:b,drawShape:v}){s.mode=b,v&&(s.drawShape=v)}async function a(){try{const b=await fetch(s.manifestUrl,{cache:"no-store"});if(!b.ok)throw new Error("HTTP "+b.status);const v=await b.json();s.layersConfig=v.layers||[]}catch{s.layersConfig=[{id:"osm",type:"osm",label:"OpenStreetMap",visible:!0}]}}function l(b){s.features=b}function c(b){r.visible=!!b.visible,r.lat=b.lat??0,r.lon=b.lon??0,r.feature=b.feature??null}function h({mode:b}){b&&(s.mode=b)}function u(b){n.value?.loadGeoJSON(b)}function d(){const b=new Blob([JSON.stringify(s.features,null,2)],{type:"application/json"}),v=document.createElement("a");v.href=URL.createObjectURL(b),v.download=`features-${new Date().toISOString().slice(0,10)}.geojson`,v.click(),URL.revokeObjectURL(v.href)}function f(){n.value?.clearFeatures()}const g=es([]);async function m(){const b=n.value?.getFeaturesFC();if(!b)return;const A=`features-${new Date().toISOString().replace(/[:.]/g,"-")}.geojson`,P=await Ok(A,b);alert(`Saved to S3:
${P}`)}async function p(){g.value=await Lk()}async function y(b){const v=await kk(b);n.value?.loadGeoJSON(v,{dedupe:!0,prefer:"incoming"})}function _(b,v){n.value?.setLayerVisibility(b,v)}function x(b,v,A=15){n.value?.flyTo(b,v,A)}function E(b){const v=n.value?.updateSelectedFeatureProps(b);v&&(r.feature=v),s.mode="browse"}function w(){n.value?.deleteSelectedFeature()&&(s.mode="browse",r.visible=!1)}return(b,v)=>(it(),dt("div",T8,[oi(z5,{mode:s.mode,"draw-shape":s.drawShape,onChange:o},null,8,["mode","draw-shape"]),de("button",{class:"drawer-toggle iconbtn",onClick:v[0]||(v[0]=A=>i.value=!i.value),"aria-label":"Open tools"},"☰"),oi(i8,{open:i.value,layers:s.layersConfig,"has-features":s.features.features.length>0,"manifest-url":s.manifestUrl,onClose:v[1]||(v[1]=A=>i.value=!1),onRefreshManifest:a,onToggleLayer:_,onLoadGeojson:u,onSaveGeojson:d,"remote-feature-collections":g.value,onSaveGeojsonRemote:m,onListGeojsonRemote:p,onLoadGeojsonRemote:y,onClearGeojson:f,onFlyTo:x},null,8,["open","layers","has-features","manifest-url","remote-feature-collections"]),oi(D5,{ref_key:"mapRef",ref:n,class:"map-wrap",mode:s.mode,"draw-shape":s.drawShape,"layers-config":s.layersConfig,onFeatures:l,onInfo:c,onRequestLayerSync:a,onSuggestMode:h},null,8,["mode","draw-shape","layers-config"]),r.visible?(it(),iS(b8,{key:0,mode:s.mode,lat:r.lat,lon:r.lon,feature:r.feature,onClose:v[2]||(v[2]=A=>r.visible=!1),onSaveProps:E,onDelete:w},null,8,["mode","lat","lon","feature"])):vi("",!0)]))}};Av(R8).mount("#app");export{I8 as $,uS as A,Fv as B,MI as C,c2 as D,cF as E,cp as F,lF as G,v2 as H,WF as I,l2 as J,P8 as K,HF as L,O2 as M,gp as N,ZF as O,gM as P,_M as Q,SM as R,mL as S,Vv as T,YA as U,Qv as V,ao as W,Wn as X,Ft as Y,OI as Z,Tn as _,AF as a,At as a0,Ps as a1,A8 as a2,Kf as a3,Ol as a4,Kh as a5,Qh as a6,ZT as a7,O8 as a8,L8 as a9,ZS as b,WI as c,dh as d,Yh as e,vr as f,Wo as g,ap as h,sk as i,qL as j,gh as k,SL as l,PI as m,pi as n,VF as o,fh as p,XF as q,vI as r,gS as s,lp as t,kI as u,ak as v,$I as w,Mv as x,lk as y,jI as z};
